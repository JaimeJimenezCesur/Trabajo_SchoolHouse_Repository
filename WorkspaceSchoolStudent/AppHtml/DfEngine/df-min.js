(()=>{var __webpack_modules__={9697:(e,t,i)=>{"use strict";i.d(t,{x:()=>s});class s{constructor(e,t){this.oL=e,this.oM=t,this.iRowChangeCount=0,this.onCellClick=new df.events.JSHandler,this.onCellDblClick=new df.events.JSHandler,this.onAfterCellClick=new df.events.JSHandler,e._onKeyDown.addListener(this.keyDown,this)}cellClick(e,t,i,s){var o,n,r=this.oL,a=this.oM,l="";if(r._bHasFocus=!0,(n=a.rowIndexByRowId(t))>=0){if(i>=0&&(o=r._aColumns[i]._iColIndex,l=a.aData[n].aCells[o].sValue),i>=0&&r._aColumns[i].cellClickBefore(e,t,l))return!1;if(s||this.selectRow("row",n),i>=0&&r._aColumns[i].cellClickAfter(e,t,l))return r.focus(),!1;if(this.fireRowClick(t,i))return!0}return!1}fireRowClick(e,t){return this.onCellClick.fire(this,{sRowId:e,iCol:t}),this.oL.fire("OnRowClick",[e,null!==t?t:-1],(function(i){this.onAfterCellClick.fire(this,{sRowId:e,iCol:t})}),this)}cellDblClick(e,t,i){return!this.onCellDblClick.fire(this,{sRowId:t,iCol:i})}headClick(e,t){var i=this.oL,s=!1,o=i._aColumns[t];return o&&(o.fire("OnHeaderClick")?s=!0:i.pbColumnSortable&&o.pbSortable&&(i.piSortColumn===t?this.changeSorting(t,!i.pbReverseOrdering):this.changeSorting(t,!1),s=!0)),i.focus(),s}headDblClick(e,t){return!1}changeSorting(e,t){var i=this.oL,s=i.piSortColumn,o=i.pbReverseOrdering;i.addSync("piSortColumn"),i.addSync("pbReverseOrdering"),i.piSortColumn=e,i.pbReverseOrdering=t,i._onSettingChange.fire(this,{sType:"sorting"}),this.oM.bPaged&&i.serverAction("ChangeSorting",[e,t,s,o])}keyPress(e){var t,i=this.oL;if(i.isEnabled())return!(i.pbAutoSearch&&i.piSortColumn>=0&&!this.bNoSearch&&i.hasFocus()&&e.getCharCode()>32&&!e.isSpecialKey())||(t=String.fromCharCode(e.getCharCode()),i._aColumns[i.piSortColumn].peDataType===df.ciTypeBCD?"0123456789,.-".indexOf(t)<0&&(t=""):i._aColumns[i.piSortColumn].peDataType===df.ciTypeDate&&"0123456789-".indexOf(t)<0&&(t=""),this.showSearch(t),e.stop(),!1)}search(e){var t,i,s,o,n,r=this.oM,a=this.oL,l=r.aData,h=0,d=l.length-1,p=null;if(n=a.pbReverseOrdering,!((i=a._aColumns[a.piSortColumn]._iColIndex)<0))if(this.oM.bPaged)a.serverAction("OnSearch",[e]);else{for(a._aColumns[i].peDataType===df.ciTypeText?(t=function(e,t){return(e=e.substr(0,t.length).toLowerCase()).localeCompare(t)},e=e.toLowerCase()):t=df.sys.data.compareFunction(a._aColumns[i].peDataType);h<d;)if(o=t(l[s=Math.floor((h+d)/2)].aCells[i].sValue,e),(o=n?-o:o)<0)h=s+1;else{if(!(o>0)){p=s;break}d=s-1}if(0===o){if(p>0)for(o=t(l[p-1].aCells[i].sValue,e),o=n?-o:o;0===o&&p>0;)--p>0&&(o=t(l[p-1].aCells[i].sValue,e))}else p=s<h?h:s>h?d:s;this.moveToRow(p)}}showSearch(e){var t,i,s,o,n,r,a=this.oL,l=df.dom.windowWidth(),h=a.piSortColumn;h<0||((t=new df.WebModalDialog(null,a)).psCaption=a.getWebApp().getTrans("search")+": "+a._aColumns[h].psCaption,t.pbShowClose=!0,t.pbDDHotKeys=!1,t.pbResizable=!1,t.piMinWidth=l>390?370:l-20,t.psCSSClass="WebMsgBox",(i=new df.WebPanel(null,t)).peRegion=df.ciRegionCenter,t.addChild(i),(s=new df.WebForm(null,t)).psLabel="",s.pbShowLabel=!1,s.psValue=e||"",s.peDataType=a._aColumns[h].peDataType,s.psMask=a._aColumns[h].psMask,s.piPrecision=a._aColumns[h].piPrecision,s.piMaxLength=a._aColumns[h].piMaxLength,s.pbCapslock=a._aColumns[h].pbCapslock,s.peAlign=df.ciAlignLeft,i.addChild(s),(o=new df.WebPanel(null,t)).peRegion=df.ciRegionBottom,o.piColumnCount=3,o.psCSSClass="WebMsgBoxOneBtn",t.addChild(o),(n=new df.WebButton(null,t)).psCaption=a.getWebApp().getTrans("ok"),n.piColumnIndex=1,n.pbShowLabel=!1,n.OnClick.addListener((function(e){t.fire("OnSubmit")}),this),o.addChild(n),(r=new df.WebButton(null,t)).psCaption=a.getWebApp().getTrans("cancel"),r.piColumnIndex=2,r.pbShowLabel=!1,r.OnClick.addListener((function(e){t.hide()}),this),o.addChild(r),t.OnSubmit.addListener((function(e){var i=s.get("psValue");t.hide(),a.objFocus(),this.search(i),a._eFocus&&a._eFocus.focus()}),this),t.show(),s.peDataType!==df.ciTypeDate&&s.peDataType!==df.ciTypeDateTime&&s.peDataType!==df.ciTypeTime||(s.focus(),e&&s.setControlValue(e)),df.sys.isMobile||df.dom.setCaretPosition(s._eControl,s._eControl.value.length))}keyDown(e){var t=this.oL,i=this;const s=e.oDOMEvent;if(t._bHasFocus||t._eKeyBuddy){if(s.matchKey(df.settings.listKeys.scrollUp))this.moveUpRow();else if(s.matchKey(df.settings.listKeys.scrollDown))this.moveDownRow();else if(s.matchKey(df.settings.listKeys.scrollPageUp))this.movePageUp();else if(s.matchKey(df.settings.listKeys.scrollPageDown))this.movePageDown();else if(s.matchKey(df.settings.listKeys.scrollTop))this.moveToFirstRow();else if(s.matchKey(df.settings.listKeys.scrollBottom))this.moveToLastRow();else if(s.matchKey(df.settings.listKeys.leftSwipeBtns)&&t._oTouchHandler&&t._oTouchHandler.showSwipeLeft());else if(!(s.matchKey(df.settings.listKeys.rightSwipeBtns)&&t._oTouchHandler&&t._oTouchHandler.showSwipeRight()))return!s.matchKey(df.settings.formKeys.submit)||(!this.oM.sCurrentRowId||!this.fireRowClick(this.oM.sCurrentRowId,null)||(s.stop(),!1));return this.bNoSearch=!0,setTimeout((function(){i.bNoSearch=!1}),50),s.stop(),!1}}handleData(e,t,i,s,o){this.oM.handleData(e,t,i,s,o),this.pbDataAware||this.updateColumnsFromCache("page"===t)}setCurrentRowId(e){this.oM.setCurrentRowId(e)}updateRow(e,t,i){this.oM.updateRow(e,t,i)}updateCell(e,t){this.oM.updateCell(e,t)}removeRow(e){var t,i=this.oM,s=!1;i.sCurrentRowId===e&&(s=!0,t=i.iCurrentRow,i.sCurrentRowId="",i.iCurrentRow=-1),i.removeRow(e),s&&(t<i.aData.length?this.selectRow("row",t):t>0?this.selectRow("row",t-1):this.appendNewRow())}appendRow(e){this.oM.appendRow(e)}insertBefore(e,t){this.oM.insertBefore(e,t)}insertAfter(e,t){this.oM.insertAfter(e,t)}selectRow(e,t,i,s){var o,n,r=this.oL,a=this.oM,l=a.sCurrentRowId,h=!0,d="",p=s||null;function u(e){var t=o!==this.iRowChangeCount;n.bSuccess=df.toBool(e),a.onAfterRowChange.fire(a,n),r.pbOfflineEditing||df.toBool(e)?i&&i.call(this,!0,t):i.call(this,!1,t)}r.cancelServerAction("ChangeCurrentRow"),"row"===e&&(h=null!==(d=a.rowIdByRowIndex(t))&&d!==l,r.pbDataAware||(p=a.aData[t])),n={sPrevRowId:a.sCurrentRowId,iPrevRowIndex:a.iCurrentRow,sGotoRow:d,iGotoRowIndex:t},this.iRowChangeCount++,o=this.iRowChangeCount,h?(a.onBeforeRowChange.fire(a,n),r.pbOfflineEditing?("row"===e&&(this.setCurrentRowId(d),this.updateColumnsFromCache(!0)),u.call(this)):(this.handleRowChange=u,r.serverAction("ChangeCurrentRow",[e,d],p&&r.serializeRows([p])||null))):i&&i.call(this,!1)}handleRowChange(e){}updateColumnsFromCache(e){var t,i,s=this.oL,o=this.oM;if(!s.pbDataAware&&(t=o.rowIndexByRowId(o.sCurrentRowId))>=0)for(i=0;i<s._aColumns.length;i++)s._aColumns[i].set("psValue",o.aData[t].aCells[s._aColumns[i]._iColIndex].sValue),e&&s._aColumns[i].set("pbChanged",!1)}triggerCacheUpdate(e,t){var i=this.oM;i.bPaged&&(i.bLast||i.aData.length-t<i.iPrefCacheOffset&&this.loadCachePage("next"),i.bFirst||e<i.iPrefCacheOffset&&this.loadCachePage("prev"))}loadCachePage(e,t,i){var s=this.oL,o=this.oM,n="";this.bLoading||(this.bLoading=!0,"next"===e?o.aData.length&&(n=o.aData[o.aData.length-1].sRowId):"prev"===e?o.aData.length&&(n=o.aData[0].sRowId):this._bNoRender=!0,s.serverAction("LoadDataPage",[e,n],null,(function(e){this.bLoading=!1,e.bError||t&&t.call(i||this)}),this))}processDataSet(e){var t=this.oM,i=this.oL;i.serverAction("HandleProcessDataSet",[e,t.iCurrentRow],i.serializeRows(t.aData))}moveToFirstRow(){var e,t=this.oM,i=this.oL;e=function(){t.aData.length>0?this.selectRow("row",0):this.appendNewRow()},t.bPaged?i.pbOfflineEditing||0===t.iCurrentRow&&""===t.sCurrentRowId?this.loadCachePage("first",(function(){e.call(this)})):this.selectRow("first",-1):e.call(this)}moveToLastRow(){var e,t=this.oM,i=this.oL;e=function(){t.aData.length>0?this.selectRow("row",t.aData.length-1):this.appendNewRow()},t.bPaged?i.pbOfflineEditing||0===t.iCurrentRow&&""===t.sCurrentRowId?this.loadCachePage("last",(function(){e.call(this)})):this.selectRow("last",-1):e.call(this)}moveDownRow(){var e=this.oM;return e.iCurrentRow>=0&&e.iCurrentRow<e.aData.length-1&&(this.selectRow("row",e.iCurrentRow+1),!0)}moveUpRow(){var e=this.oM;e.iCurrentRow>0&&this.selectRow("row",e.iCurrentRow-1)}movePageDown(){var e,t=this.oM;(e=Math.round(t.iCurrentRow+this.oL._oBody.getViewSize()-1))>=t.aData.length&&(e=t.aData.length-1),this.selectRow("row",e)}movePageUp(){var e,t=this.oM;(e=Math.round(t.iCurrentRow-this.oL._oBody.getViewSize()+1))<0&&(e=0),this.selectRow("row",e)}moveToRow(e){(e=parseInt(e,10))>=0&&e<this.oM.aData.length&&this.selectRow("row",e)}moveToRowByID(e){var t=this.oM.rowIndexByRowId(e);t>=0&&this.moveToRow(t)}appendNewRow(){}}},5804:(e,t,i)=>{"use strict";i.d(t,{M:()=>s});class s{static displayTypes={row:1,header:2,custom:3};constructor(e){this.oL=e,this.bPaged=!1,this.sCurrentRowId=e.psCurrentRowId,this.iCurrentRow=-1,this.aDisplay=[],this.aData=[],this.aGroupHeaders=[],this.aGroups=[],this.bIsGrouped=!1,this.onDataUpdate=new df.events.JSHandler,this.onBeforeDataUpdate=new df.events.JSHandler,this.onBeforeRowChange=new df.events.JSHandler,this.onRowChange=new df.events.JSHandler,this.onAfterRowChange=new df.events.JSHandler,e._onSettingChange.on(this.onSettingChange,this)}prepDisplay(){let e=[];const t=(i,o)=>{const n=this.aGroupHeaders[i];if(n.iParentHeaderIndex>=0&&t(n.iParentHeaderIndex,o),e.length>0){if(e[e.length-1]<n.iGroupIndex)return;e.pop()}n.bCollapsed&&e.push(n.iGroupIndex),n._iItemIndex=this.aDisplay.push({eType:s.displayTypes.header,iIndex:i})-1};this.aDisplay=[],this.aGroupHeaders.forEach((e=>e._iItemIndex=null)),this.aData.forEach(((i,o)=>{i._iItemIndex=null,i.iGroupHeaderIndex>=0&&this.bIsGrouped&&t(i.iGroupHeaderIndex,o),0==e.length&&(i._iItemIndex=this.aDisplay.push({eType:s.displayTypes.row,iIndex:o})-1)}))}handleData(e){if(e&&(!Array.isArray(e.aRows)||!Array.isArray(e.aGroupHeaders)||!Array.isArray(e.aGroups)))throw new df.Error(999,"Invalid data structure for weblist data.",this);this.onBeforeDataUpdate.fire(this),e&&(this.aData=e.aRows,this.oL.peGrouping==df.grpCustom&&(this.aGroupHeaders=e.aGroupHeaders,this.aGroups=e.aGroups,this.bIsGrouped=this.aGroups.length>0)),this.bIsGrouped?this.groupData():this.sortData(),this.prepDisplay(),this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId),this.iCurrentRow<0&&this.aData.length>0&&(this.iCurrentRow=0,this.sCurrentRowId=this.aData[0].sRowId),this.onDataUpdate.fire(this,{sType:"full"})}isFirst(e){return this.aData[0]==e}isLast(e){return this.aData[this.aData.length-1]==e}groupData(){this.oL._oGrouping?.groupData()}sortData(){const e=this.oL;if(e.piSortColumn>=0){let t=[],i=[];return e.piSortColumn>=0&&-1==t.indexOf(e.piSortColumn)&&(t.push(e.piSortColumn),i.push(df.sys.data.compareFunction(e._aColumns[e.piSortColumn].peDataType,e.pbReverseOrdering))),e._aColumns.forEach(((s,o)=>{-1==t.indexOf(o)&&(t.push(o),i.push(df.sys.data.compareFunction(s.peDataType,e.pbReverseOrdering)))})),this.customSortData(t,i),!0}return!1}customSortData(e,t){this.aData.sort(((i,s)=>{for(let o=0;o<e.length;o++){const n=e[o],r=t[o](i.aCells[n].sValue,s.aCells[n].sValue);if(0!=r)return r}return 0}))}rowIndexByRowId(e){return this.aData.findIndex((t=>t.sRowId==e))}rowIdByRowIndex(e){return this.aData[e]?this.aData[e].sRowId:null}rowByRowIndex(e){return this.aData[e]}rowByRowId(e){return this.aData.find((t=>t.sRowId==e))||null}rowIndexToItemIndex(e){return this.aData[e]&&null!=this.aData[e]._iItemIndex?this.aData[e]._iItemIndex:-1}setCurrentRowId(e){if(this.sCurrentRowId!==e){var t={sPrevRowId:this.sCurrentRowId,iPrevRowIndex:this.iCurrentRow,sGotoRowId:e,iGotoRowIndex:this.rowIndexByRowId(e)};this.sCurrentRowId=t.sGotoRowId,this.iCurrentRow=t.iGotoRowIndex,this.onRowChange.fire(this,t)}}updateRow(e,t,i){var s=this.rowIndexByRowId(e);if(s>=0){if(this.onBeforeDataUpdate.fire(this),i){this.aData[s].sRowId=t.sRowId,t.sCssClassName&&t.sCssClassName,t.aCells.forEach(((e,t)=>{const i=this.aData[s].aCells[t];i.sValue=e.sValue,e.sTooltip&&(i.sTooltip=e.sTooltip),e.sCssClassName&&(i.sCssClassName=e.sCssClassName),e.aOptions.length&&(i.aOptions=e.aOptions)}))}else this.aData[s]=t;this.sCurrentRowId!==e&&this.sCurrentRowId!==t.sRowId||(this.sCurrentRowId=t.sRowId,this.iCurrentRow=s),this.onDataUpdate.fire(this,{sType:"row",sUpdateRowId:e,sNewRowId:t.sRowId})}}removeRow(e){var t=this.rowIndexByRowId(e);t>=0&&(this.iCurrentRow>t&&this.iCurrentRow--,this.aData.splice(t,1),this.prepDisplay(),this.onDataUpdate.fire(this,{sType:"remrow",sRowId:e,iRowIndex:t}))}appendRow(e){this.aData.push(e),this.sortData()&&(this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId)),this.prepDisplay(),this.onDataUpdate.fire(this,{sType:"newrow",sRowId:e.sRowId})}insertBefore(e,t){var i=this.rowIndexByRowId(e);i<0&&(i=this.aData.length),i<=this.iCurrentRow&&this.iCurrentRow++,this.aData.splice(i,0,t),this.sortData()&&(this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId)),this.prepDisplay(),this.onDataUpdate.fire(this,{sType:"newrow",sRowId:t.sRowId})}insertAfter(e,t){var i=this.rowIndexByRowId(e);i<0||i+1==this.aData.length?this.appendRow(t):this.insertBefore(this.aData[i+1].sRowId,t)}updateCell(e,t){this.iCurrentRow>=0&&(this.onBeforeDataUpdate.fire(this),this.aData[this.iCurrentRow].aCells[e._iColIndex].sValue=t,this.onDataUpdate.fire(this,{sType:"cell",sUpdateRowId:this.sCurrentRowId,oCol:e}))}updateCellByRowId(e,t,i){var s=this.rowIndexByRowId(e);s>=0&&(this.onBeforeDataUpdate.fire(this),this.aData[s].aCells[t._iColIndex].sValue=i,this.onDataUpdate.fire(this,{sType:"cell",sUpdateRowId:e,oCol:t}))}updateSorting(){var e=this.oL;!this.bPaged&&e.piSortColumn>=0&&this.handleData(null,"page","",!0,!0)}updateGrouping(){var e=this.oL;this.bPaged||e.peGrouping==df.grpDisabled||this.handleData(null,"page","",!0,!0)}onSettingChange(e){if("prop"===e.sType)switch(e.sProp){case"piSortColumn":case"pbReverseOrdering":this.updateSorting()}else"sorting"===e.sType?this.updateSorting():"grouping"===e.sType&&this.updateGrouping()}}},1493:(e,t,i)=>{"use strict";i.d(t,{W:()=>o});var s=i(5804);class o extends s.M{constructor(e){super(e),this.bFirst=!1,this.bLast=!1,this.bPaged=!0,this.iPrefCacheOffset=25}handleData(e,t,i,s,o){var n={sType:"",iOffsetChange:0,sUpdateRowId:""};if(e&&(!Array.isArray(e.aRows)||!Array.isArray(e.aGroupHeaders)||!Array.isArray(e.aGroups)))throw new df.Error(999,"Invalid data structure for weblist data.");this.onBeforeDataUpdate.fire(this),"page"===t&&(this.aData=e.aRows,this.bLast=o,this.bFirst=s,this.prepDisplay(),this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId),this.iCurrentRow<0&&o&&s&&this.aData.length>0&&(this.iCurrentRow=0,this.sCurrentRowId=this.aData[0].sRowId),n.sType="full"),"first"===t&&(this.aData=e.aRows,this.bLast=o,this.bFirst=s,this.prepDisplay(),this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId),n.sType="full"),"last"===t&&(e.aRows.reverse(),this.aData=e.aRows,this.bLast=o,this.bFirst=s,this.prepDisplay(),this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId),n.sType="full"),"next"===t&&(this.aData=this.aData.concat(e.aRows),this.bLast=o,n.sType="next",this.prepDisplay()),"prev"===t&&(e.aRows.reverse(),this.aData=e.aRows.concat(this.aData),this.bFirst=s,n.iOffsetChange=e.aRows.length,n.sType="prev",this.prepDisplay(),this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId)),this.onDataUpdate.fire(this,n)}isFirst(e){return this.bFirst&&this.aData[0]==e}isLast(e){return this.bLast&&this.aData[this.aData.length-1]==e}updateSorting(){}sortData(){}}},4074:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});var s=i(5804),o=i(1740);class n extends o.L{heightCache={};constructor(e,t,i){super(e,t,i),this.bScroll=!0,this.bZebraTop=!1,this.bZebraBottom=!1,this.iTableOffset=0,this.iScrollOffsetPx=0,this.iRowDispOffset=0,this.iViewOffset=0,this.iRowsDispOffset=0,this.iRowDispLast=0,this.iPrefViewOffset=8,this.iMaxViewOffsetDiff=this.iPrefViewOffset/2,this.iLastScrollbarSet=0,this.bScrollbarDirty=!1,this.iAvgRowHeight=0,this.iTableHeight=0,this.bNoRender=!1,this.iAutoScroll=0,this.oInitialFullEvent=null,this.bFirstFill=!0,this.aItemHeightProcess=[],this.onHorizontalScroll=new df.events.JSHandler,this.onVerticalScroll=new df.events.JSHandler,this.bDelUpdDim=!1,this.bDelUpdDimForced=!1,e._onResize.on(this.onResize,this),this._oDimUpdConf=null}genHtml(e){e.push('<div class="WebList_BodyWrp">'),e.push('<div class="WebList_Body',this.oL.pbShowSelected?" WebList_ShowSelected":"",'">'),e.push('<div class="WebList_TableWrp',this.oL.pbAutoColumnSizing?" WebList_AutoSize":" WebList_HorizScroll",'">'),e.push('<div class="WebList_Table">'),e.push("</div></div></div>"),e.push('<div class="WebList_Scroll" tabindex="-1"><div class="WebList_Stretcher" style="width: 1px;"></div></div>'),e.push("</div>")}afterRender(e){this.eTableWrp=df.dom.query(e,"div.WebList_TableWrp"),this.eTable=df.dom.query(e,"div.WebList_Table"),this.eScrollbar=df.dom.query(e,"div.WebList_Scroll"),this.eScrollStretch=df.dom.query(e,"div.WebList_Scroll > div.WebList_Stretcher"),super.afterRender(e),df.events.addDomMouseWheelListener(this.eBody,this.onMouseWheelScroll,this),df.dom.on("scroll",this.eScrollbar,this.onScrollbarScroll,this),df.dom.on("scroll",this.eTableWrp,this.onHorizbarScroll,this),df.events.addDomCaptureListener("load",this.eTableWrp,this.onContentLoaded,this)}afterFirstFill(){df.dom.animFrame((function(){this.oL.piSortColumn>0&&this.scrollToCol(this.oL.piSortColumn)}),this)}onDataUpdate(e){var t;if(this.iMaxPX=null,"full"===e.sType){if(!this.eBody)return void(this.oInitialFullEvent=e);this.clearHeightCache(),this.updateScrollbarSize(),this.bNoRender=!0;const i=this.row(this.oM.sCurrentRowId);i?t=i.offsetTop-this.iTableOffset:this.centerCurrentRow(),this.bNoRender=!1,this.updatePosition(!0),this.dimensionUpdate({bUpdateRows:!1,bUpdateScrollbar:!0,bForceRedraw:!1,fFinished:()=>{i?this.smartRepositionCurrentRow(t):this.centerCurrentRow()}}),this.iTableHeight<=0&&df.dom.animFrame((function(){this.iTableHeight>0&&this.centerCurrentRow()}),this),this.bFirstFill&&(this.bFirstFill=!1,this.afterFirstFill())}if("next"===e.sType&&this.updateScrollbarSize(),"prev"===e.sType&&(this.iScrollOffsetPx+=e.iOffsetChange*(this.iAvgRowHeight||20),this.iRowDispOffset+=e.iOffsetChange,this.iRowsDispOffset+=e.iOffsetChange,this.iRowDispLast+=e.iOffsetChange,this.bNoRender=!0,this.updateScrollbarSize(),this.eScrollbar.scrollTop=this.eScrollbar.scrollTop+e.iOffsetChange*(this.iAvgRowHeight||20),this.bNoRender=!1,this.updatePosition()),"row"===e.sType&&this.refreshRow(e.sUpdateRowId,e.sNewRowId),"cell"===e.sType&&this.refreshCell(e.sUpdateRowId,e.oCol),"newrow"===e.sType&&(this.bNoRender=!0,this.updateScrollbarSize(),this.scrollToCurrentRow(),this.bNoRender=!1,this.updatePosition(!0)),"remrow"===e.sType&&(this.bNoRender=!0,this.updateScrollbarSize(),this.scrollToCurrentRow(),this.bNoRender=!1,this.updatePosition(!0)),"display"===e.sType){const t=this.iRowDispOffset,i=this.iTableOffset;this.updatePosition(!0),this.dimensionUpdate({bUpdateRows:!1,bUpdateScrollbar:!0,bForceRedraw:!1,fFinished:()=>{const s=this.combinedRowHeightPx(0,t)+i;this.scrollTo(s,!1,!1,!1),e.iDisplayItem&&this.scrollToDisplayItem(e.iDisplayItem)}})}}onRowChange(e){this.eBody&&(super.onRowChange(e),this._oDimUpdConf?this.dimensionUpdate({fFinished:()=>{this.scrollToCurrentRow()}}):this.scrollToCurrentRow())}onSettingChange(e){"redraw"===e.sType?this.updatePosition(!0):"prop"===e.sType&&"pbAutoColumnSizing"===e.sProp?(df.dom.toggleClass(this.eTableWrp,"WebList_AutoSize",this.oL.pbAutoColumnSizing),df.dom.toggleClass(this.eTableWrp,"WebList_HorizScroll",!this.oL.pbAutoColumnSizing)):super.onSettingChange(e)}scroll(e,t,i){var s;s=this.iScrollOffsetPx,s+=e,this.scrollTo(s,t,i)}scrollTo(e,t,i,s){e!==this.iScrollOffsetPx&&(this.iScrollOffsetPx=e,this.updatePosition(!1,t,!!s),i||this.updateScrollbarPos(this.iScrollOffsetPx),this.onVerticalScroll.fire(this,{iScrollOffsetPx:this.iScrollOffsetPx}),this.updateCache())}updatePosition(e,t,i){const s=this.oM;let o,n,r,a,l,h,d,p,u,f,c=null,g=null,b=0,_=0;if(!this.eBody||this.bNoRender)return;const m=this.tableHeight();for(t=!!t,i=!!i,e=!!e,p=this.getMaxPX(),u=n=i?this.iScrollOffsetPx:Math.min(this.iScrollOffsetPx,p),h=Math.max(n,0)+m,l=0;l<s.aDisplay.length;l++)if(d=this.rowHeightPx(l),t&&null===g&&_+d>n&&d<1.5*this.iAvgRowHeight&&(n=n-_<d/2?_:_+d),_+=d,null===g&&_>=n&&(this.iScrollOffsetPx=i?n:n=Math.max(0,Math.min(n,p)),h=Math.max(n,0)+m,g=l,f=_-d),_>=h){c=l;break}p-u<.5*this.iAvgRowHeight&&(n=p),null===g&&(this.iScrollOffsetPx=i?n:n=Math.max(0,Math.min(n,p)),h=Math.max(n,0)+this.iTableHeight,g=0,f=0),null===c&&(c=Math.max(0,s.aDisplay.length-1)),_<this.iTableHeight&&(b=(this.iTableHeight-_)/(this.iAvgRowHeight||20)+this.iPrefViewOffset),a=Math.max(g-this.iPrefViewOffset,0),r=Math.min(c+this.iPrefViewOffset,s.aDisplay.length-1),e||g<this.iRowDispOffset||c>this.iRowDispLast||this.iCalcEmptyRows!==b?(this.iCalcEmptyRows=b,this.iRowDispLast=r,this.iRowDispOffset=a,this.refreshDisplay()):this.adjustDisplay(a,r),o=n-(f-this.combinedRowHeightPx(this.iRowDispOffset,g)),this.updateScrollOffset(o)}refreshDisplay(){var e=[];const t=this.iRowDispLast-this.iRowDispOffset;if(t>100&&console.warn(`Painting issue, painting ${t} rows`),this.tableHtml(e),df.sys.isIE)for(;this.eTable.lastChild;)this.eTable.removeChild(this.eTable.lastChild);this.eTable.innerHTML=e.join(""),this.onRowsRendered.fire(this),this.dimensionUpdate({bUpdateRows:!0,bUpdateScrollbar:!0,bForceRedraw:!1})}itemHtml(e,t){super.itemHtml(e,t),this.aItemHeightProcess.push(t)}tableHtml(e){var t,i=this.oM;for(t=this.iRowDispOffset;t<=this.iRowDispLast&&t<i.aDisplay.length;t++)this.itemHtml(e,t);for(t=0;t<this.iCalcEmptyRows;t++)this.oR.rowHtml(null,e,(t+this.iRowDispLast+1)%2==0,i.aGroups.length,!1,!1)}adjustDisplay(e,t){this.oM;var i=this.iMaxViewOffsetDiff,s=!1;if(this.iRowDispOffset>e){if(this.iRowDispOffset>e+i)for(;this.iRowDispOffset>e;)this.iRowDispOffset--,this.insertRow(this.iRowDispOffset,!0),s=!0;if(this.iRowDispLast>t+i)for(;this.iRowDispLast>t;)this.removeBottomRow()}else{if(this.iRowDispLast<t-i)for(;this.iRowDispLast<t;)this.iRowDispLast++,this.insertRow(this.iRowDispLast,!1),s=!0;if(this.iRowDispOffset<e-i)for(;this.iRowDispOffset<e;)this.removeTopRow()}s&&this.onRowsRendered.fire(this)}removeTopRow(){if(this.eTable.firstChild){for(;!this.eTable.firstChild.hasAttribute("data-dfitem");)this.eTable.removeChild(this.eTable.firstChild);this.eTable.firstChild&&(this.eTable.removeChild(this.eTable.firstChild),this.iRowDispOffset++,this.bZebraTop=!this.bZebraTop)}}removeBottomRow(){if(this.eTable.lastChild){for(;!this.eTable.firstChild.hasAttribute("data-dfitem");)this.eTable.removeChild(this.eTable.lastChild);this.eTable.lastChild&&(this.eTable.removeChild(this.eTable.lastChild),this.iRowDispLast--,this.bZebraBottom=!this.bZebraBottom)}}updateScrollOffset(e){this.eTable&&(this.iTableOffset=e,df.dom.translateY(this.eTable,-e,!0),this.eTableWrp.scrollTop>0&&(this.eTableWrp.scrollTop=0))}insertRow(e,t){let i=[];this.itemHtml(i,e);const s=df.dom.create(i);t?this.eTable.prepend(s):this.eTable.appendChild(s)}clearHeightCache(){this.oM.aDisplay.forEach((e=>{e._iRowHeight=null})),this.heightCache={}}realHeight(e){return e?.getBoundingClientRect().height||0}realMargin(e){const t=df.sys.gui.getCurrentStyle(e),i=parseFloat(t.marginTop)||0,s=parseFloat(t.marginBottom)||0;return Math.max(i,s)}updateItemHeight(e){const t=this.oM,i=this.item(e);if(!i)return!1;let s=this.realHeight(i);const o=i.className;this.heightCache.hasOwnProperty(o)||(this.heightCache[o]=this.realMargin(i)),s+=this.heightCache[o];const n=t.aDisplay[e]._iRowHeight!==s;return t.aDisplay[e]._iRowHeight=s,n}updateAvgRowHeight(){var e=0,t=0;this.oM.aDisplay.forEach((function(i){i._iRowHeight&&(t++,e+=i._iRowHeight)})),t&&(this.iAvgRowHeight=e/t),this.iMaxPX=0}updateRenderedRowHeights(){this.oM;let e=!1;for(let t=this.iRowDispOffset;t<this.oM.aDisplay.length&&t<=this.iRowDispLast;t++)e|=this.updateItemHeight(t);return this.aItemHeightProcess=[],e&&(this.updateAvgRowHeight(),this.iMaxPX=null),e}processRowHeights(){for(var e,t=!1;e=this.aItemHeightProcess.pop();)t=!0,this.updateItemHeight(e);return t&&(this.iMaxPX=null,this.updateAvgRowHeight()),t}rowHeightPx(e){var t,i=this.oM.aDisplay[e];return t=i._iRowHeight?i._iRowHeight:this.iAvgRowHeight||20,i.eType==s.M.displayTypes.row&&(t+=this.oM.aData[i.iIndex]._iRowHeightExtra||0),t}combinedRowHeightPx(e,t){var i,s=this.oM,o=0;for(i=e;i<s.aDisplay.length&&i<t;i++)o+=this.rowHeightPx(i);return o}snapToRow(e){var t,i,s=this.oM,o=0;for(i=0;i<s.aDisplay.length;i++){if(o+(t=this.rowHeightPx(i))>e)return e-o<t/2?o:o+t;o+=t}return o}getMaxPX(){return this.iMaxPX?this.iMaxPX:this.iMaxPX=Math.max(this.combinedRowHeightPx(0,this.oM.aDisplay.length)-this.iTableHeight,0)}updateScrollbarSize(){var e=this.combinedRowHeightPx(0,this.oM.aDisplay.length);this.eScrollStretch&&this.eScrollStretch.clientHeight!==e&&(this.eScrollStretch.style.height=e+"px")}updateScrollbarPos(e){var t,i=this;this.eScrollbar&&(this.eScrollbar.scrollTop=this.iLastScrollbarSet=e,this.bScrollbarDirty=t=Math.abs(this.eScrollbar.scrollTop-this.iLastScrollbarSet)>5,t&&setTimeout((function(){i.bScrollbarDirty&&i.eScrollbar.scrollTop!==i.iLastScrollbarSet&&(i.eScrollbar.scrollTop=i.iLastScrollbarSet),i.bScrollbarDirty=!1}),300))}onScrollbarScroll(e){var t=this.eScrollbar.scrollTop;Math.abs(t-this.iLastScrollbarSet)>2&&!this.bScrollbarDirty&&(this.iAutoScroll=0,this.iLastScrollbarSet=t,this.scrollTo(t,!0,!0))}onMouseWheelScroll(e){var t=e.getMouseWheelDelta();this.iAutoScroll=0,t>0?this.scroll(-2*(this.iAvgRowHeight||20),!0):t<0&&this.scroll(2*(this.iAvgRowHeight||20),!0),e.stop()}updateCache(){this.oC.triggerCacheUpdate(this.iRowDispOffset,this.iRowDispLast)}centerCurrentRow(){const e=this.oM,t=e.rowIndexToItemIndex(e.iCurrentRow),i=this.tableHeight();if(t>=0&&i>0){let e=this.combinedRowHeightPx(0,t);e=e-i/2+this.rowHeightPx(t)/2,this.scrollTo(e,!0,!1)}}smartRepositionCurrentRow(e){const t=this.oM,i=t.rowIndexToItemIndex(t.iCurrentRow);i>=0&&this.smartRepositionDisplayItem(i,e)}smartRepositionDisplayItem(e,t){let i=this.combinedRowHeightPx(0,e);i-=t,i>0&&i<this.getMaxPX()&&this.scrollTo(i,!0,!1),this.scrollToDisplayItem(e)}scrollToCurrentRow(){this.scrollToRow(this.oM.sCurrentRowId)}scrollToRow(e){const t=this.oM;let i=t.rowIndexByRowId(e),s=t.rowIndexToItemIndex(i);s>=0&&this.scrollToDisplayItem(s)}scrollToDisplayItem(e){let t=this.combinedRowHeightPx(0,e),i=this.rowHeightPx(e);t<this.iScrollOffsetPx?this.scrollTo(t,!0,!1):t+i>this.iScrollOffsetPx+this.iTableHeight&&(t=t+i-this.iTableHeight,this.scrollTo(t,!1,!1))}scrollToCol(e){var t,i=this.oL;i.pbAutoColumnSizing||((t=this.colCellByIndex(e))||(t=this.eBody&&df.dom.query(this.eBody,"td[data-dfcol='"+e+"']")||null),t&&(t.offsetLeft<this.eTableWrp.scrollLeft?i._oBody.scrollToHoriz(t.offsetLeft):t.offsetLeft+t.offsetWidth>this.eTableWrp.clientWidth+this.eTableWrp.scrollLeft&&i._oBody.scrollToHoriz(Math.min(t.offsetLeft,t.offsetLeft+t.offsetWidth-this.eTableWrp.clientWidth))))}scrollToHoriz(e){this.eTableWrp.scrollLeft=e}setHeight(e){e-=df.sys.gui.getVertBoxDiff(this.eBody),e-=df.sys.gui.getVertBoxDiff(this.eBodyWrp),e=Math.max(e,0),this.eBody.style.height=e+"px",this.eScrollbar.style.height=(df.dom.clientHeight(this.eTableWrp)||e||0)+"px"}determineDimensions(){var e=!1;return this.eBody&&(this.iPrevTableHeight=this.iTableHeight,this.iTableHeight=this.eTableWrp.clientHeight||this.iTableHeight,e=e||this.iPrevTableHeight!==this.iTableHeight||this.iTableWidth!==this.eTableWrp.clientWidth,this.iTableWidth=this.eTableWrp.clientWidth),e}tableHeight(){return this.eTableWrp?.clientHeight||this.iTableHeight||0}waitForRepaint(e){window.requestIdleCallback?window.requestIdleCallback(e,{timeout:40}):window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout(e,40)}dimensionUpdate(e){e=e||{},this._oDimUpdConf?(this._oDimUpdConf.bUpdateRows||=e.bUpdateRows,this._oDimUpdConf.bUpdateScrollbar||=e.bUpdateScrollbar,this._oDimUpdConf.bUpdateRows||=e.bUpdateRows,e.fFinished&&this._oDimUpdConf.aFinished.push(e.fFinished)):(e.aFinished=e.fFinished?[e.fFinished]:[],this._oDimUpdConf=e),this.waitForRepaint((()=>{const e=this._oDimUpdConf;if(!e)return;this._oDimUpdConf=null;let t=this.determineDimensions();t||e.bUpdateRows?t|=this.updateRenderedRowHeights():t|=this.processRowHeights(),(t||e.bUpdateScrollbar)&&this.updateScrollbarSize(),(t||e.bForceRedraw)&&this.updatePosition(e.bForceRedraw),this.eTableWrp&&(this.eTableWrp.style.paddingRight=this.scrollbarWidth()+"px"),e.aFinished.forEach((e=>e()))}))}onResize(e){this.oInitialFullEvent?this.dimensionUpdate({bUpdateRows:!0,bUpdateScrollbar:!0,bForceRedraw:!0,fFinished:()=>{this.oInitialFullEvent&&(this.onDataUpdate(this.oInitialFullEvent),this.oInitialFullEvent=null)}}):this.dimensionUpdate({bUpdateRows:!1,bUpdateScrollbar:!1,bForceRedraw:!1})}onContentLoaded(e){for(var t,i=e.getTarget();i&&i!==this.eTableWrp;){if(i.hasAttribute("data-dfrowid"))return t=i.getAttribute("data-dfrowid"),void(this.aItemHeightProcess.indexOf(t)<=0&&(this.aItemHeightProcess.push(t),this.dimensionUpdate({bUpdateRows:!1,bUpdateScrollbar:!1,bForceRedraw:!1})));i=i.parentNode}}scrollbarWidth(){return this.eScrollbar&&this.eScrollbar.offsetWidth||0}getViewSize(){const e=this.tableHeight();return e&&this.iAvgRowHeight?e/this.iAvgRowHeight:10}setExtraRowHeight(e,t){var i,s=this.oM;(i=s.rowIndexByRowId(e))>=0&&(s.aData[i]._iRowHeightExtra=t,this.iMaxPX=null,this.updateScrollbarSize())}getExtraRowHeight(e){var t,i=this.oM;if((t=i.rowIndexByRowId(e))>=0)return i.aData[t]._iRowHeightExtra||0}onHorizbarScroll(e){this.onHorizontalScroll.fire(this,{nScrollX:this.eTableWrp.scrollLeft})}}},1740:(e,t,i)=>{"use strict";i.d(t,{L:()=>o});var s=i(5804);class o{constructor(e,t,i){this.oL=e,this.oM=t,this.oC=i,this.oR=e._oRowRenderer,this.bPreventSubmit=!1,this.bCancelClick=!1,this.bScroll=!1,this.onRowsRendered=new df.events.JSHandler,t.onDataUpdate.on(this.onDataUpdate,this),t.onRowChange.on(this.onRowChange,this),e._onSettingChange.on(this.onSettingChange,this),i.onCellClick.on(this.onCellClick,this),i.onAfterCellClick.on(this.onAfterCellClick,this)}genHtml(e){e.push('<div class="WebList_BodyWrp">'),e.push('<div class="WebList_Body',this.oL.pbShowSelected?" WebList_ShowSelected":"",'">'),this.tableHtml(e),e.push("</div></div>")}afterRender(e){this.eRowContainer=this.eBody=df.dom.query(e,"div.WebList_Body"),this.eBodyWrp=df.dom.query(e,"div.WebList_BodyWrp"),df.dom.addClass(this.oL._eControl,this.bScroll?"WebList_Scrolling":"WebList_NoScrolling"),df.events.addDomListener("click",this.eBody,this.onTableClick,this),df.events.addDomListener("dblclick",this.eBody,this.onTableDblClick,this),this.onRowsRendered.fire(this)}groupHeaderHtml(e,t,i){const s=this.oM;if(t>=0&&s.aGroupHeaders[t]){const o=s.aGroupHeaders[t],n=s.aGroups[o.iGroupIndex];e.push(`<div class="WebList_GroupHeader Web_Level${o.iGroupIndex} ${0==i?"Web_First":""}" data-dfgrphead="${t}" data-dfitem="${i}">`),n.sLabel&&e.push(`<span class=WebList_GroupHeader_Name>${n.sLabel}</span>`),o.sItem&&e.push(`<span class="WebList_GroupHeader_Item">${o.sItem}</span> `),o.sTotal?e.push(`<span class="WebList_GroupHeader_Total">${o.sTotal}</span> `):o.iItems>0&&e.push(`<span class="WebList_GroupHeader_Items">${o.iItems}</span> `),this.oL.pbGroupsCollapsible&&(o.bCollapsed?e.push('<span class="WebList_GroupHeader_ToggleBtn"><i class="WebList_GroupHeader_IconExpand"></i></span>'):e.push('<span class="WebList_GroupHeader_ToggleBtn"><i class="WebList_GroupHeader_IconCollapse"></i></span>')),e.push("</div>")}}itemHtml(e,t){const i=this.oM,o=i.aDisplay[t];if(o)switch(o.eType){case s.M.displayTypes.row:const n=i.aData[o.iIndex];this.oR.rowHtml(n,e,t%2==0,i.aGroups.length,i.isFirst(n),i.isLast(n),t);break;case s.M.displayTypes.header:this.groupHeaderHtml(e,o.iIndex,t)}}tableHtml(e){this.oM.aDisplay.forEach(((t,i)=>{this.itemHtml(e,i)}))}refreshDisplay(){var e=[];this.eRowContainer&&(this.tableHtml(e),this.eRowContainer.innerHTML=e.join(""),this.onRowsRendered.fire(this),this.oL.sizeChanged(!1))}refreshRow(e,t){var i,s,o,n=[];if(i=this.oM.rowIndexByRowId(t),s=this.row(e),i>=0&&s){const e=s.dataset.dfitem;this.itemHtml(n,e),o=df.dom.create(n),s.parentNode.replaceChild(o,s)}}refreshCell(e,t){var i,s,o=this.oM;i=this.cell(e,t._iCol),s=o.rowIndexByRowId(e),i&&s>=0&&(i.innerHTML=this.oR.cellHtml(t,this.oM.aData[s],this.oM.aData[s].aCells[t._iColIndex]))}onDataUpdate(e){"row"===e.sType&&this.refreshRow(e.sUpdateRowId,e.sNewRowId),"cell"===e.sType?this.refreshCell(e.sUpdateRowId,e.oCol):this.refreshDisplay()}onRowChange(e){var t,i;this.eBody&&(this.oL._oGrouping.makeCurrentRowVisible()||(e.sPrevRowId&&(i=this.row(e.sPrevRowId))&&df.dom.removeClass(i,"WebList_Selected"),(t=this.row(e.sGotoRowId))&&df.dom.addClass(t,"WebList_Selected")))}onSettingChange(e){var t=this.oL;if("redraw"===e.sType)this.refreshDisplay();else if("prop"===e.sType&&"pbShowSelected"===e.sProp)this.eBody&&df.dom.toggleClass(this.eBody,"WebList_ShowSelected",t.pbShowSelected)}containerElem(e){const t=this.eRowContainer?.querySelectorAll(e);if(t)for(const e of t)if(e.closest("div.WebList_Body")==this.eRowContainer)return e;return null}row(e){return this.containerElem('table.WebList_Row[data-dfrowid="'+e+'"]')}groupHeader(e){return this.containerElem('div.WebList_GroupHeader[data-dfgrphead="'+e+'"]')}currentRowElem(){return this.row(this.oM.sCurrentRowId)}item(e){return this.containerElem('[data-dfitem="'+e+'"]')}determineCell(e){for(var t={iCol:-1,sRowId:null,iHeaderIndex:-1,eSwipeBtn:null,bHeaderToggle:!1};e&&e.parentNode&&e!==this.eRowContainer&&!t.sRowId;)"TD"===e.tagName&&e.hasAttribute("data-dfcol")?t.iCol=parseInt(e.getAttribute("data-dfcol"),10):"TD"===e.tagName&&e.hasAttribute("data-dfswbtn")?t.eSwipeBtn=e:"TABLE"===e.tagName&&e.hasAttribute("data-dfisrow")?t.sRowId=e.getAttribute("data-dfrowid"):e.matches("div.WebList_GroupHeader[data-dfgrphead]")?t.iHeaderIndex=parseInt(e.dataset.dfgrphead,10):e.matches("span.WebList_GroupHeader_ToggleBtn")&&(t.bHeaderToggle=!0),e=e.parentNode;return t}onTableClick(e){var t,i=this;this.oL.isEnabled()&&!this.bCancelClick&&((t=this.determineCell(e.getTarget())).eSwipeBtn?this.oL._oTouchHandler.swipeBtnClick(e,t.eSwipeBtn):null!==t.sRowId?this.oC.cellClick(e,t.sRowId,t.iCol)&&(this._bPreventSubmit=!0,setTimeout((function(){i.bPreventSubmit=!1}),250),e.stop()):t.iHeaderIndex>=0&&t.bHeaderToggle&&this.oL._oGrouping.toggleGroupHeader(t.iHeaderIndex))}onTableDblClick(e){var t;this.oL.isEnabled()&&(null!==(t=this.determineCell(e.getTarget())).sRowId&&this.oC.cellDblClick(e,t.sRowId,t.iCol)?e.stop():this.bPreventSubmit||this.oL.fireSubmit())}onCellClick(e){var t=this;this.bHitDone=!1,this.eHitElem=this.row(e.sRowId),df.dom.addClass(this.eHitElem,df.CssHit),this.tHitTimer=setTimeout((function(){t.bHitDone&&df.dom.removeClass(t.eHitElem,df.CssHit),t.tHitTimer=null}),df.hitTimeout)}onAfterCellClick(e){this.tHitTimer||df.dom.removeClass(this.eHitElem,df.CssHit),this.bHitDone=!0}setHeight(e){}cell(e,t){return this.eRowContainer&&df.dom.query(this.eRowContainer,"table[data-dfrowid='"+e+"'] td[data-dfcol='"+t+"']")||null}colCell(e){return this.cell(this.oM.sCurrentRowId,e._iCol)}colCellByIndex(e){return this.cell(this.oM.sCurrentRowId,e)}scrollbarWidth(){return 0}getViewSize(){return 10}fullwidth(){return this.eBody&&this.eBody.clientWidth||0}setExtraRowHeight(e,t){}getExtraRowHeight(e){return 0}scrollToRow(e){}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={},oCache,sPrefix,vt;(()=>{const versionInfo=window.df;var df={psVersionId:versionInfo&&versionInfo.psVersionId||"",pnDataFlexVersion:function(){var e;if(versionInfo&&versionInfo.psVersionId)return(e=versionInfo.psVersionId.split(".")).length>1?parseFloat(e[0]+"."+e[1]):0}(),ciTypeText:0,ciTypeBCD:1,ciTypeDate:2,ciTypeDateTime:3,ciTypeTime:4,ciRegionCenter:0,ciRegionLeft:1,ciRegionRight:2,ciRegionTop:3,ciRegionBottom:4,ciLabelLeft:0,ciLabelTop:1,ciLabelRight:2,ciLabelFloat:3,ciAlignLeft:0,ciAlignCenter:1,ciAlignRight:2,ciDirGT:0,ciDirLT:1,ciOpenSameWindow:0,ciOpenNewTab:1,ciOpenNewWindow:2,cwiActual:0,cwiStretch:1,cwiStretchHoriz:2,cwiCenter:3,cwiFit:4,cwiCover:5,csUnsorted:0,csDescription:1,csValue:2,cCrumbHorizontal:0,cCrumbDropDown:1,cCrumbCaption:2,tUnknown:0,tString:1,tInt:2,tNumber:3,tDate:4,tBool:5,tAdv:6,gtAutomatic:0,gtAllData:1,gtManual:2,grpDisabled:0,grpCustom:1,grpAutomatic:2,cCallModeDefault:1,cCallModeWait:2,cCallModeProgress:3,smFind:0,smValidationTable:1,smCustom:2,ctExecDefault:0,ctExecEarly:1,ctExecViewLoad:2,modeDesktop:10,modeTablet:20,modeTabletLandscape:21,modeTabletPortrait:22,modeMobile:30,modeMobileLandscape:31,modeMobilePortrait:32,adActionBar:1,adMenu:2,adBoth:3,wbNone:0,wbWrap:1,wbPre:2,wbPreWrap:3,wbEllipsis:4,dropPositions:{ciDropUnknown:0,ciDropOn:1,ciDropBefore:2,ciDropAfter:3,ciDropOnEmpty:4},dragActions:{WebList:{ciDragRow:111},WebMultiSelectList:{ciDragRowSelection:141},WebTreeView:{ciDragFolder:121,ciDragItem:122},WebTagsForm:{ciDragTag:131}},dropActions:{WebControl:{ciDropOnControl:201},WebList:{ciDropOnRow:211},WebTreeView:{ciDropOnRoot:221,ciDropOnFolder:222,ciDropOnItem:223},WebTagsForm:{ciDropOnInput:231}},WebUIContext:{WebUIContextCustom:0,WebUIContextListHead:1,WebUIContextListRow:2,WebUIContextListFull:3,WebUIContextListSelection:4,WebUIContextTreeviewFolder:5,WebUIContextTreeviewItem:6,WebUIContextTagsFormTag:7,isChildScopeCompatible:function(e){return e!==df.WebUIContext.WebUIContextListHead}},layoutType:{ciLayoutTypeInherit:0,ciLayoutTypeFlow:1,ciLayoutTypeGrid:2},rowColValType:{ciTypeDefault:0,ciTypeFixed:1,ciTypeFraction:2,ciTypeOther:3},CssEnabled:"Web_Enabled",CssDisabled:"Web_Disabled",CssHit:"Web_Hit",hitTimeout:1e3,psIncludeLocation:(aScripts=document.getElementsByTagName("script"))[aScripts.length-1].src,psRootPath:(sPath=Array.from(document.getElementsByTagName("script")).findLast((e=>e.src.indexOf("DfEngine")>0))?.src,sPath?sPath.substr(0,sPath.indexOf("DfEngine")):null),ajax:{},lang:{monthsLong:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysLong:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},gui:{aZReservations:[!0],reserveZIndex:function(){return this.aZReservations.push(!0)-1},freeZIndex:function(e){var t;for(this.aZReservations[e]=!1,t=this.aZReservations.length-1;t>=0&&!this.aZReservations[t];t--)this.aZReservations.pop()},dragMask:function(e){var t;return t=df.dom.create('<div class="WebApp_DragMask"></div>'),(e||document.body).appendChild(t),t}},defineClass:function(constructor,sSuper,oProto){var fConstructor,fSuper,oPrototype,FTemp,sProp;if(fConstructor="string"==typeof constructor?df.sys?df.sys.ref.getNestedProp(constructor):eval(constructor):constructor,arguments.length>2){for(sProp in oPrototype=arguments[arguments.length-1],fSuper="string"==typeof arguments[1]?df.sys?df.sys.ref.getNestedProp(arguments[1]):eval(arguments[1]):arguments[1],"function"!=typeof fSuper&&alert("Super class for '"+constructor+"' must be defined first ('"+arguments[1]+"')"),oPrototype=arguments[2],FTemp=function(){},FTemp.prototype=fSuper.prototype,fConstructor.prototype=new FTemp,oPrototype)oPrototype.hasOwnProperty(sProp)&&(fConstructor.prototype[sProp]=oPrototype[sProp]);fConstructor.base=fSuper.prototype}2===arguments.length&&(oPrototype=arguments[1],fConstructor.prototype=oPrototype),fConstructor.prototype.constructor=fConstructor},mixin:function(e,t){var i,s,o,n,r,a=e;if(i=df.sys.ref.getNestedProp(t),s=df.sys.ref.getNestedProp(e),"function"==typeof i){if("function"==typeof s){for(r in o=function(){s.apply(this,arguments)},(n=function(){}).prototype=i.prototype,o.prototype=new n,s.prototype)s.prototype.hasOwnProperty(r)&&(o.prototype[r]=s.prototype[r]);return o.prototype.getBase=function(e){return e&&e!==a?i.prototype.getBase.call(this,e):i.prototype},o.prototype.constructor=s,o}alert("Mixin class for new mixed base class must be defined first ('"+e+"')")}else alert("Super class for new mixed base class must be defined first ('"+t+"')")},toBool:function(e){return"0"!==e&&"-1"!==e&&"false"!==e&&!!e},fromBool:function(e){return e?"1":"0"},fromDate:function(e){return df.sys.data.dateToString(e,"yyyy/mm/dd","-")},fromNumber:function(e){return e.toString()},toInt:function(e){return parseInt(e,10)},toNumber:function(e){return parseFloat(e)},toDate:function(e){return df.sys.data.stringToDate(e,"yyyy/mm/dd","-")},toDateTime:function(e){return df.sys.data.stringToDate(e,"yyyy/mm/ddThh:mm:ss.fff")},fromDateTime:function(e){return df.sys.data.dateToString(this._tValue,"yyyy/mm/ddThh:mm:ss.fff","-",":")},timeValues:{},timeStart:function(e,t){t=e+":: Timing Start * "+t,df.log(t),this.timeValues[e]=(new Date).getTime()},timeStop:function(e,t){var i=(new Date).getTime();t=this.timeValues[e]?e+":: "+(i=(i-this.timeValues[e])/1e3)+" * Timing Stop * "+t:e+":: <NAV> * Timing Stop * "+t,df.log(t)},log:function(e){"object"==typeof console&&console.log&&console.log(e)},pbDebugging:"boolean"==typeof bDfDebug&&bDfDebug||document.location.href.toLowerCase().indexOf("dfdebug=true")>0,debug:function(e){this.pbDebugging&&df.log(e)},handleError:function(e,t){var i,s=null;if(!(e instanceof df.Error))throw e;(i=t||e.oSource||null)&&i.getWebApp?i=i.getWebApp():e.oSource&&e.oSource.getWebApp&&(i=e.oSource.getWebApp()),i&&i instanceof df.WebApp?s=i:e.oSource&&e.oSource instanceof df.WebApp&&(s=e.oSource),s?s.handleError(e):alert(e.iNumber+": "+e.sText+"\n\r Line: "+e.iLine+"\n\r Target: "+e.sTarget+"\n\r User error: "+e.bUserError)},classWordBreak:function(e){switch(e){case df.wbWrap:return"WebWrp_Wrap";case df.wbPre:return"WebWrp_Pre";case df.wbPreWrap:return"WebWrp_PreWrap";case df.wbEllipsis:return"WebWrp_Ellipsis"}return"WebWrp_None"}},sPath,aScripts;df.Error=function(e,t,i,s,o,n,r,a,l,h){this.iNumber=e,this.sText=t,this.bUserError=!!r,this.sCaption=a||null,this.oSource=i||null,this.oTarget=l||null,this.bServer=!!n,this.iLine=h,this.sDetailHtml=o||null,s&&(this.sText=df.sys.data.format(this.sText,s))},window.df=df})(),df.settings={formKeys:{findGT:{iKeyCode:119,bCtrl:!1,bShift:!1,bAlt:!1},findLT:{iKeyCode:118,bCtrl:!1,bShift:!1,bAlt:!1},findGE:{iKeyCode:120,bCtrl:!1,bShift:!1,bAlt:!1},findFirst:{iKeyCode:36,bCtrl:!0,bShift:!1,bAlt:!1},findLast:{iKeyCode:35,bCtrl:!0,bShift:!1,bAlt:!1},save:{iKeyCode:113,bCtrl:!1,bShift:!1,bAlt:!1},clear:{iKeyCode:116,bCtrl:!1,bShift:!1,bAlt:!1},clearAll:{iKeyCode:116,bCtrl:!0,bShift:!1,bAlt:!1},remove:{iKeyCode:113,bCtrl:!1,bShift:!0,bAlt:!1},prompt:{iKeyCode:115,bCtrl:!1,bShift:!1,bAlt:!1},tabOut:{iKeyCode:9,bCtrl:!1,bShift:!1,bAlt:!1},submit:{iKeyCode:13,bCtrl:!1,bShift:!1,bAlt:!1},escape:{iKeyCode:27,bCtrl:!1,bShift:!1,bAlt:!1}},listKeys:{scrollUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},scrollDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},scrollRangeUp:{iKeyCode:38,bCtrl:!1,bShift:!0,bAlt:!1},scrollRangeDown:{iKeyCode:40,bCtrl:!1,bShift:!0,bAlt:!1},scrollPageUp:{iKeyCode:33,bCtrl:!1,bShift:!1,bAlt:!1},scrollPageDown:{iKeyCode:34,bCtrl:!1,bShift:!1,bAlt:!1},scrollTop:[{iKeyCode:36,bCtrl:!0,bShift:!1,bAlt:!1},{iKeyCode:38,bCtrl:!0,bShift:!1,bAlt:!1}],scrollBottom:[{iKeyCode:35,bCtrl:!0,bShift:!1,bAlt:!1},{iKeyCode:40,bCtrl:!0,bShift:!1,bAlt:!1}],search:{iKeyCode:70,bCtrl:!0,bShift:!1,bAlt:!1},leftSwipeBtns:{iKeyCode:39},rightSwipeBtns:{iKeyCode:37},select:{iKeyCode:32},selectAll:{iKeyCode:65,bCtrl:!0},deSelectAll:{iKeyCode:27,bCtrl:!1,bShift:!1,bAlt:!1},collapseAllGrp:{iKeyCode:109,bCtrl:!0},expandAllGrp:{iKeyCode:107,bCtrl:!0},collapseGrp:{iKeyCode:109,bShift:!0},expandGrp:{iKeyCode:107,bShift:!0}},gridKeys:{nextCol:{iKeyCode:9,bCtrl:!1,bShift:!1,bAlt:!1},prevCol:{iKeyCode:9,bCtrl:!1,bShift:!0,bAlt:!1},newRow:{iKeyCode:121,bCtrl:!1,bShift:!0,bAlt:!1}},tabKeys:{enter:{iKeyCode:13,bCtrl:!1,bShift:!1,bAlt:!1}},calendarKeys:{dayUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},dayDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},dayLeft:{iKeyCode:37,bCtrl:!1,bShift:!1,bAlt:!1},dayRight:{iKeyCode:39,bCtrl:!1,bShift:!1,bAlt:!1},monthUp:{iKeyCode:33,bCtrl:!1,bShift:!1,bAlt:!1},monthDown:{iKeyCode:34,bCtrl:!1,bShift:!1,bAlt:!1},yearUp:{iKeyCode:33,bCtrl:!0,bShift:!1,bAlt:!1},yearDown:{iKeyCode:34,bCtrl:!0,bShift:!1,bAlt:!1},enter:{iKeyCode:13,bCtrl:!1,bShift:!1,bAlt:!1},close:{iKeyCode:27,bCtrl:!1,bShift:!1,bAlt:!1}},treeKeys:{moveUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},moveDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},collapse:{iKeyCode:37,bCtrl:!1,bShift:!1,bAlt:!1},extend:{iKeyCode:39,bCtrl:!1,bShift:!1,bAlt:!1},moveFirst:{iKeyCode:36,bCtrl:!1,bShift:!1,bAlt:!1},moveLast:{iKeyCode:35,bCtrl:!1,bShift:!1,bAlt:!1},enter:{iKeyCode:13,bCtrl:!1,bShift:!1,bAlt:!1}},sliderKeys:{sliderUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},sliderDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},sliderLeft:{iKeyCode:37,bCtrl:!1,bShift:!1,bAlt:!1},sliderRight:{iKeyCode:39,bCtrl:!1,bShift:!1,bAlt:!1}},menuKeys:{moveUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},moveDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},moveLeft:{iKeyCode:37,bCtrl:!1,bShift:!1,bAlt:!1},moveRight:{iKeyCode:39,bCtrl:!1,bShift:!1,bAlt:!1}},spinKeys:{moveUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},moveDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1}},suggestionKeys:{backSpace:{iKeyCode:8,bCtrl:!1,bShift:!1,bAlt:!1},delete:{iKeyCode:46,bCtrl:!1,bShift:!1,bAlt:!1},moveUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},moveDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},select:{iKeyCode:13,bCtrl:!1,bShift:!1,bAlt:!1},escape:[{iKeyCode:27,bCtrl:!1,bShift:!1,bAlt:!1},{iKeyCode:9,bCtrl:!1,bShift:!1,bAlt:!1}],forceDisplay:{iKeyCode:32,bCtrl:!0,bShift:!1,bAlt:!1}}},df.events={keys:{modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","Down","ArrowLeft","Left","ArrowRight","Right","ArrowUp","Up","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","Del","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Esc","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]},allKeys:null,insertInputTypes:["insertText","insertReplacementText","insertLineBreak","insertParagraph","insertOrderedList","insertUnorderedList","insertHorizontalRule","insertFromYank","insertFromDrop","insertFromPaste","insertFromPasteAsQuotation","insertTranspose","insertCompositionText","insertLink"],KEY_CODE_TAB:9,KEY_CODE_NON_EDIT:{37:1,38:1,39:1,40:1,35:1,36:1,9:1},KEY_CODE_SPECIAL:{37:1,38:1,39:1,40:1,35:1,36:1,46:1,8:1,9:1},addDomCaptureListener:function(e,t,i,s){window.addEventListener&&(e="capture_"+e),this.addDomListener(e,t,i,s)},removeDomCaptureListener:function(e,t,i,s){window.addEventListener&&(e="capture_"+e),this.removeDomListener(e,t,i,s)},addDomListener:function(e,t,i,s){(void 0!==t._oDfDomH&&t._oDfDomH[e]?t._oDfDomH[e]:new df.events.DOMHandler(e,t)).addListener(i,s)},removeDomListener:function(e,t,i,s){void 0!==t._oDfDomH&&t._oDfDomH[e]&&t._oDfDomH[e].removeListener(i,s)},addDomKeyListener:function(e,t,i){df.events.addDomListener("keydown",e,t,i)},removeDomKeyListener:function(e,t,i){df.events.removeDomListener("keydown",e,t,i)},addDomMouseWheelListener:function(e,t,i){df.sys.isMoz?df.events.addDomListener("DOMMouseScroll",e,t,i):df.events.addDomListener("mousewheel",e,t,i)},removeDomMouseWheelListener:function(e,t,i){df.sys.isMoz?df.events.removeDomListener("DOMMouseScroll",e,t,i):df.events.removeDomListener("mousewheel",e,t,i)},stop:function(e){e.stop()},iDOMHandlers:0,oDOMHandlers:{},clearDomHandlers:function(){var e;for(e in df.events.oDOMHandlers)df.events.oDOMHandlers.hasOwnProperty(e)&&df.events.oDOMHandlers[e].__DOMHandler&&df.events.oDOMHandlers[e].clear()},clearDomListeners:function(e,t){var i;if(e._oDfDomH)for(i in e._oDfDomH)e._oDfDomH.hasOwnProperty(i)&&e._oDfDomH[i].clear();t&&df.dom.visit(e,(function(e){df.events.clearDomListeners(e,!0)}))}},df.events.DOMHandler=function(e,t){this.sEvent=e,this.eElement=t,this.aListeners=[],this.aRemoveListeners=[],this.bFiring=!1,this.fHandler=null,this.__DOMHandler=!0,this.iHandlerId=df.events.iDOMHandlers++,this.attach()},df.defineClass("df.events.DOMHandler",{attach:function(){var e,t;e=this,t=function(t){return e.fire(t)},window.addEventListener?"capture_"===this.sEvent.substr(0,8)?this.eElement.addEventListener(this.sEvent.substr(8),t,!0):this.eElement.addEventListener(this.sEvent,t,!1):this.eElement.attachEvent("on"+this.sEvent,t),this.eElement._oDfDomH||(this.eElement._oDfDomH={}),this.eElement._oDfDomH[this.sEvent]=this,df.events.oDOMHandlers[this.iHandlerId]=this,this.fHandler=t},clear:function(){window.addEventListener?"capture_"===this.sEvent.substr(0,8)?this.eElement.removeEventListener(this.sEvent.substr(8),this.fHandler,!0):this.eElement.removeEventListener(this.sEvent,this.fHandler,!1):this.eElement.detachEvent("on"+this.sEvent,this.fHandler),delete this.eElement._oDfDomH[this.sEvent],delete df.events.oDOMHandlers[this.iHandlerId]},addListener:function(e,t){if("function"!=typeof e)throw new df.Error(5131,"Listener must be a function (event: {{0}})",t||null,[this.sEvent]);t||console.warn("df.events.addListener()/df.dom.on() without an oEnvironment is deprecated, it could cause the wrong listener to be removed."),this.aListeners.push({fListener:e,oEnvironment:t})},removeListener:function(e,t){var i;if(t){for(i=0;i<this.aListeners.length;i++)if(this.aListeners[i].fListener===e&&this.aListeners[i].oEnvironment===t){this.bFiring?this.aRemoveListeners.push(this.aListeners[i]):this.aListeners.length>1?this.aListeners.splice(i,1):this.clear();break}}else for(console.warn("df.events.removeListener()/df.dom.off() without an oEnvironment is deprecated, it could cause the wrong listener to be removed."),i=0;i<this.aListeners.length;i++)if(this.aListeners[i].fListener===e){this.bFiring?this.aRemoveListeners.push(this.aListeners[i]):this.aListeners.length>1?this.aListeners.splice(i,1):this.clear();break}},fire:function(e){var t,i;for(i=new df.events.DOMEvent(e,this.eElement,this.sEvent),this.bFiring=!0,t=0;t<this.aListeners.length&&!i.bCanceled;t++)if("function"==typeof this.aListeners[t].fListener)try{!1===this.aListeners[t].fListener.call(void 0!==this.aListeners[t].oEnvironment?this.aListeners[t].oEnvironment:this.eElement,i)&&i.stop()}catch(e){df.handleError(e)}for(this.bFiring=!1;this.aRemoveListeners.length>0;){let e=this.aRemoveListeners.pop();this.removeListener(e.fListener,e.oEnvironment)}return!i.bCanceled||(e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1)}}),df.events.DOMEvent=function(e,t,i){this.eSource=t,this.e=e||window.event,this.sName=i,this.bCanceled=!1},df.defineClass("df.events.DOMEvent",{getTarget:function(){var e;return this.e.target?e=this.e.target:this.e.srcElement&&(e=this.e.srcElement),3===e.nodeType&&(e=e.parentNode),e},getMouseX:function(){return this.e.clientX},getMouseY:function(){return this.e.clientY},getKeyCode:function(){return this.e.keyCode},isSpecialKey:function(){var e=this.getKeyCode();return(!df.sys.isIE&&!df.sys.isSafari||"keypress"!==this.e.type)&&(this.getAltKey()||this.getCtrlKey()||df.events.KEY_CODE_SPECIAL[e]&&0!==e)},isKeyPrintable:function(){return!this.getCtrlKey()&&!this.getAltKey()&&-1===df.events.allKeys.indexOf(this.e.key)},key:function(){return this.e.key},inputIsInsert:function(){return-1!==df.events.insertInputTypes.indexOf(this.e.inputType)},getCharCode:function(){return this.e.charCode?this.e.charCode:"number"!=typeof this.e.charCode?this.e.keyCode:0},getCtrlKey:function(){return this.e.ctrlKey},getShiftKey:function(){return this.e.shiftKey},getAltKey:function(){return this.e.altKey},getMouseButton:function(){if(!this.e.which)return this.e.button;switch(this.e.which){case 0:return 1;case 1:return 4;case 2:return 2;default:return 0}},getMouseWheelDelta:function(){var e=0;return this.e.detail?e=-this.e.detail/3:this.e.wheelDelta&&(e=this.e.wheelDelta/120),e},stop:function(){this.bCanceled=!0,this.e.returnValue=!1,this.e.cancelBubble=!0,this.e.canceled=!0,this.e.preventDefault&&this.e.preventDefault(),this.e.stopPropagation&&this.e.stopPropagation()},stopPropagation:function(){this.e.stopPropagation?this.e.stopPropagation():void 0!==this.e.cancelBubble&&(this.e.cancelBubble=!0)},matchKey:function(e){var t;if(e){if(!(e instanceof Array))return e.iKeyCode===this.getKeyCode()&&!!e.bCtrl===this.getCtrlKey()&&!!e.bShift===this.getShiftKey()&&!!e.bAlt===this.getAltKey();for(t=0;t<e.length;t++)if(e[t].iKeyCode===this.getKeyCode()&&!!e[t].bCtrl===this.getCtrlKey()&&!!e[t].bShift===this.getShiftKey()&&!!e[t].bAlt===this.getAltKey())return!0}return!1}}),df.events.addDomListener("unload",window,df.events.clearDomHandlers,window),df.events.JSHandler=function(e){this.sServerName=e||null,this.aListeners=[],this.aRemoveListeners=[],this.bFiring=!1},df.defineClass("df.events.JSHandler",{addListener:function(e,t){this.on(e,t)},on:function(e,t){if("function"!=typeof e)throw new df.Error(5131,"Listener must be a function",t||null,[this.sEvent]);this.aListeners.push({fListener:e,oEnvironment:t})},off:function(e,t){var i;for(i=0;i<this.aListeners.length;i++)this.aListeners[i].fListener===e&&this.aListeners[i].oEnvironment===t&&(this.bFiring?this.aRemoveListeners.push(this.aListeners[i]):this.aListeners.splice(i,1))},removeListener:function(e,t){this.off(e,t)},fire:function(e,t){if(this.aListeners.length>0){var i,s;for(s=t instanceof df.events.JSEvent?t:new df.events.JSEvent(e,t),this.bFiring=!0,i=0;i<this.aListeners.length&&!s.bCanceled;i++)if("function"==typeof this.aListeners[i].fListener)try{!1===this.aListeners[i].fListener.call(void 0!==this.aListeners[i].oEnvironment?this.aListeners[i].oEnvironment:this.eElement,s)&&s.stop()}catch(t){df.handleError(t,e)}for(this.bFiring=!1;this.aRemoveListeners.length>0;){let e=this.aRemoveListeners.pop();this.off(e.fListener,e.oEnvironment)}return!s.bCanceled}return!0}}),df.events.JSEvent=function(e,t){var i;if(this.oSource=e,this.bCanceled=!1,"object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(this[i]=t[i])},df.defineClass("df.events.JSEvent",{getTarget:function(){return this.oSource},stop:function(){this.bCanceled=!0}}),df.events.allKeys=Object.keys(df.events.keys).reduce((function(e,t){return e.concat(df.events.keys[t])}),[]),df.dom={cFocusSelector:"a, button, textarea, input, iframe, select, *[tabindex]",piDomCounter:0,on:function(e,t,i,s){t instanceof Array||t instanceof NodeList?t.forEach((function(t){this.on(e,t,i,s)}),this):(e instanceof Array?e:e.split(" ")).forEach((function(e){df.events.addDomListener(e,t,i,s)}))},off:function(e,t,i,s){t instanceof Array?t.forEach((function(t){this.off(t,e,i,s)}),this):(e instanceof Array?e:e.split(" ")).forEach((function(e){df.events.removeDomListener(e,t,i,s)}))},clear:function(e,t){e instanceof Array?e.forEach((function(e){this.clear(e,t)}),this):df.events.clearDomListeners(e,t)},genDomId:function(){return"_df_"+this.piDomCounter++},addClass:function(e,t){var i,s,o,n=!1;if(e)if(e.className){for(i=(t||"").split(/\s+/),s=" "+e.className+" ",o=0;o<i.length;o++)s.indexOf(" "+i[o]+" ")<0&&(s+=" "+i[o],n=!0);n&&(e.className=s.trim())}else e.className=t},removeClass:function(e,t){var i,s,o,n=!1;if(e&&e.className){for(t=" "+t+" ",i=e.className.split(/\s+/),s="",o=0;o<i.length;o++)t.indexOf(" "+i[o]+" ")<0&&(s+=" "+i[o],n=!0);n&&(e.className=s.trim())}},toggleClass:function(e,t,i){i?this.addClass(e,t):this.removeClass(e,t)},createCSSElem:function(e){var t=document.createElement("link");return t.rel="stylesheet",t.type="text/css",t.href=e,t},isBefore:function(e,t){if(t.parentNode===e.parentNode)for(let i=e.previousSibling;i;i=i.previousSibling)if(i===t)return!0;return!1},setText:function(e,t){" "===t?e.innerHTML="&nbsp;":(t=t.toString().replace(/\\n\\r/gi,"\n"),"innerText"in e?e.innerText=t:e.textContent=t)},getText:function(e){return void 0!==e.innerText?e.innerText:e.textContent},getOuterHTML:function(e){var t,i,s;return e.outerHTML?e.outerHTML:e.parentNode?(t=e.parentNode,(i=document.createElement(t.tagName)).appendChild(e),s=i.innerHTML,t.appendChild(e),s):null},deepClone:function(e){var t,i;return t=e.cloneNode(!0),i=function(e,t){var s;for("SELECT"!==e.tagName&&"TEXTAREA"!==e.tagName||(e.value=t.value),s=0;s<e.childNodes.length;s++)3!==e.childNodes[s].nodeType&&8!==e.childNodes[s].nodeType&&i(e.childNodes[s],t.childNodes[s])},i(t,e),t},swapNodes:function(e,t){e&&t&&(void 0!==e.replaceNode?e.replaceNode(t):e.parentNode.replaceChild(t,e))},insertAfter:function(e,t){null!==t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)},isParent:function(e,t){return null!==e&&(e===t||void 0!==e.parentNode&&this.isParent(e.parentNode,t))},searchParent:function(e,t){return t=t.toUpperCase(),e.tagName===t?e:void 0!==e.parentNode&&e!==document?this.searchParent(e.parentNode,t):null},focus:function(e,t){try{e.focus(),t&&e.select&&e.select(),"function"==typeof e.setActive&&e.setActive()}catch(e){}},getCaretPosition:function(e){return this.getSelection(e).start},getSelectionLength:function(e){return this.getSelection(e).length},getSelection:function(e){var t,i,s,o,n,r=0,a=0;if("selectionStart"in e&&/text|password|search|tel|url/.test(e.type))r=e.selectionStart,a=e.selectionEnd;else if(document.selection)try{(s=document.selection.createRange())&&s.parentElement()===e&&(t=e.value.length,i=e.value.replace(/\r\n/g,"\n"),(o=e.createTextRange()).moveToBookmark(s.getBookmark()),(n=e.createTextRange()).collapse(!1),o.compareEndPoints("StartToEnd",n)>-1?r=a=t:(r=-o.moveStart("character",-t),r+=i.slice(0,r).split("\n").length-1,o.compareEndPoints("EndToEnd",n)>-1?a=t:(a=-o.moveEnd("character",-t),a+=i.slice(0,a).split("\n").length-1)))}catch(e){}return{start:r,end:a,length:a-r}},setCaretPosition:function(e,t){try{if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),i.moveEnd("character",-e.value.length),i.moveStart("character",t),i.select()}else(/text|password|search|tel|url/.test(e.type)&&e.selectionStart||0===e.selectionStart)&&(e.selectionStart=t,e.selectionEnd=t,e.focus())}catch(e){}},getFirstFocusChild:function(e){var t,i;for(t=df.dom.query(e,df.dom.cFocusSelector,!0),i=0;i<t.length;i++)if(t[i].tabIndex>=0&&"hidden"!==t[i].type)return t[i];return null},visit:function(e,t,i){var s;if(e.childNodes)for(s=0;s<e.childNodes.length;s++)if(3!==e.childNodes[s].nodeType&&8!==e.childNodes[s].nodeType&&!1===t.call(i||this,e.childNodes[s]))return!1;return!0},disableTextSelection:function(e){e.unselectable="on",e.style.MozUserSelect="none",e.style.webkitUserSelect="none"},enableTextSelection:function(e){e.unselectable="off",e.style.MozUserSelect="text",e.style.webkitUserSelect="text"},ready:function(e,t){function i(){e.call(t),window.addEventListener?window.removeEventListener("load",i,!1):window.detachEvent("onload",i)}"complete"===document.readyState?i():window.addEventListener?window.addEventListener("load",i,!1):window.attachEvent("onload",i)},create:function(e){var t=document.createElement("div");return t.innerHTML=Array.isArray(e)?e.join(""):e,t.firstChild},query:function(e,t,i){if(!i&&e.querySelector)return e.querySelector(t);if(e.querySelectorAll){var s=e.querySelectorAll(t);return i?s:s.length>0?s[0]:null}throw new df.Error(999,"This browser doesn't support querySelectorAll")},translateY:function(e,t,i){var s=df.sys.gui.getTransformProp();return s?(e.style[s]="translateY("+t+"px)",!0):!!i&&(e.style.top=t+"px",!0)},translateX:function(e,t,i){var s=df.sys.gui.getTransformProp();return s?(e.style[s]=null!==t?"translateX("+t+"px)":"",!0):!!i&&(e.style.left=null!==t?t+"px":"",!0)},transition:function(e,t,i,s){df.dom.on("transitionend",e,(function t(o){df.dom.off("transitionend",e,t,this),e.style.transition="",i&&i.call(s||this)}),this),e.style.transition=t},encodeHtml:function(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")},encodeAttr:function(e){return(e||"").replace(/\"/g,"&quot;")},windowWidth:function(){return Math.max(document.body&&Math.max(document.body.scrollWidth,document.body.offsetWidth)||0,document.documentElement&&Math.max(document.documentElement.scrollWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)||0)},windowHeight:function(){return Math.max(document.body&&Math.max(document.body.scrollHeight,document.body.offsetHeight)||0,document.documentElement&&Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)||0)},animFrame:function(e,t){window.requestAnimationFrame?window.requestAnimationFrame((function(){e.call(t||this)})):setTimeout((function(){e.call(t||this)}),40)},offsetHeight:function(e){return e?.getBoundingClientRect().height||0},clientHeight:function(e){return df.dom.offsetHeight(e)-((e?.offsetHeight||0)-(e?.clientHeight||0))},offsetWidth:function(e){return e?.getBoundingClientRect().width||0},clientWidth:function(e){return df.dom.offsetWidth(e)-((e?.offsetWidth||0)-(e?.clientWidth||0))},setTabIndex:function(e,t){e.hasAttribute("data-dfOrigTabIndex")&&parseInt(e.getAttribute("data-dfTabIndexCount"),10)>0?e.setAttribute("data-dfOrigTabIndex",t):e.tabIndex=t}},df.sys={isSafari:!1,isChrome:!1,isOpera:!1,isMoz:!1,isIE:!1,isEdge:!1,isWebkit:!1,isMobile:!1,isIOS:!1,iVersion:0,ref:{getType:function(e){var t=typeof e;return"object"===t&&(t=null==e?"null":e.constructor===Array?"array":e.constructor===Date?"date":this.getConstructorName(e)),t},getConstructorName:function(e){var t=this.getMethodName(e.constructor);return""===t&&(t="object"),t},getMethodName:function(e){var t;try{return(t=e.toString()).substring(t.indexOf("function")+8,t.indexOf("(")).replace(/ /g,"")}catch(e){return""}},getGlobalObj:function(){return window},getNestedProp:function(e){var t,i,s;for(t=e.split("."),i=df.sys.ref.getGlobalObj(),s=0;s<t.length;s++){if("object"!=typeof i||null===i)return null;i=i[t[s]]}return i}},math:{padZero:function(e,t){for(var i=e.toString();i.length<t;)i="0"+i;return i},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},data:{stringToNum:function(e,t,i){return e&&parseFloat(e.replace(i||"","").replace(t,"."))},numToString:function(e,t,i){var s,o;return o=(e=e||0).toString().replace(".",t),i>0&&((s=o.split(t)).length<2&&(s[1]=""),s[1]=(s[1]+"0000000000000000000").substr(0,i),o=s[0]+t+s[1]),o},applyDateMask:function(e,t,i,s){var o=!1;return t.replace(/(m{1,4}|d{1,4}|yyyy|yy|\/|hh|ss|fff|f|\:)/gi,(function(t,n){switch(t.toLowerCase()){case"m":return o=!0,e.getMonth()+1;case"mm":return o?(o=!1,df.sys.math.padZero(e.getMinutes(),2)):(o=!0,df.sys.math.padZero(e.getMonth()+1,2));case"mmm":return o=!0,df.sys.string.copyCase(df.lang.monthsShort[e.getMonth()],t);case"mmmm":return o=!0,df.sys.string.copyCase(df.lang.monthsLong[e.getMonth()],t);case"d":return o=!1,e.getDate();case"dd":return o=!1,df.sys.math.padZero(e.getDate(),2);case"ddd":return o=!1,df.sys.string.copyCase(df.lang.daysShort[e.getDay()],t);case"dddd":return o=!1,df.sys.string.copyCase(df.lang.daysLong[e.getDay()],t);case"yy":return o=!1,df.sys.math.padZero(e.getFullYear()%100,2);case"yyyy":return o=!1,df.sys.math.padZero(e.getFullYear(),4);case"/":return o=!1,i;case"hh":return o=!0,df.sys.math.padZero(e.getHours(),2);case"ss":return o=!0,df.sys.math.padZero(e.getSeconds(),2);case"f":return o=!0,e.getMilliseconds();case"fff":return o=!0,df.sys.math.padZero(e.getMilliseconds(),3);case":":return o=!0,s||":"}return t}))},applyNumMask:function(e,t,i,s,o){var n,r,a,l,h,d,p,u,f,c=[],g=null,b=0,_=0,m=!1,C=!0;if("Z"===(t=t.replace(/&curren;/g,o)).charAt(0)){if(0===e)return"";t=t.substr(1)}for(n=t.split(";"),f=(n=(t=e<0?n.length>1?n[1]:"-"+n[0]:n[0]).split("."))[0],n.length>1&&(g=n[1]),l=0;l<t.length;l++)switch(t.charAt(l)){case"\\":l++;break;case"#":case"0":C?b>=0&&b++:_>=0&&_++;break;case"*":C?b=-1:_=-1;break;case",":m=!0;break;case".":C=!1}for(_>=0&&(e=e.toFixed(_)),p=(n=(0===e?"":String(e)).split("."))[0],u=n.length>1?n[1]:"","-"===p.charAt(0)&&(p=p.substr(1)),l=f.length-1,h=p.length-1,d=0;l>=0;){if(r=f.charAt(l),(a=l>0&&"\\"===f.charAt(l-1))||"#"!==r&&"*"!==r&&"0"!==r)(","!==r&&"\\"!==r||a)&&c.unshift(r);else for(;(h>=0||"0"===r)&&(d>=3&&(d=0,m&&c.unshift(s)),c.unshift(h>=0?p.charAt(h):"0"),h--,d++,"#"!==r&&"0"!==r););l--}if(null!==g){let e=[];for(h=0,l=0;l<g.length;l++)if(r=g.charAt(l),(a=l>0&&"\\"===f.charAt(l-1))||"#"!==r&&"*"!==r&&"0"!==r)("\\"!==r||a)&&e.push(r);else for(;(h<u.length||"0"===r)&&(e.push(h>=0?u.charAt(h):"0"),h++,"#"!==r&&"0"!==r););e.length&&c.push(i,e.join(""))}return c.join("")},applyWinMask:function(e,t){var i,s,o=0,n=0,r=[];if(""===e)return"";if(""===t)return e;for(;o<t.length;){if("\\"===(s=t.charAt(o))&&t.length>o+1)r.push(t.charAt(o+1));else if("#"===s||"@"===s||"!"===s||"*"===s){for(i=!1;n<e.length&&!i;)this.acceptWinMaskChar(e.charAt(n),s)&&(r.push(e.charAt(n)),i=!0),n++;if(!i)break}else r.push(s);o++}return r.join("")},acceptWinMaskChar:function(e,t){return"#"===t&&e.match(/[0-9]/)||"@"===t&&e.match(/[a-zA-Z]/)||"!"===t&&e.match(/[^a-zA-Z0-9]/)||"*"===t},stringToDate:function(e,t){var i,s,o,n,r,a=!1,l=0,h=0,d=0,p=0,u=0,f=0,c=0,g=new Date;if(""===e.trim())return null;for(i=e.split(/[^0-9]+/gi),s=t.split(/[^mdyhmsf]+/gi),o=0;o<i.length;o++)switch(n=i[o],s[o]){case"d":case"dd":l=parseInt(n,10),a=!1;break;case"m":h=parseInt(n,10),a=!0;break;case"mm":a?f=parseInt(n,10):h=parseInt(n,10);break;case"yy":case"yyyy":d=parseInt(n,10),2===n.length?d=d>50?d+1900:d+2e3:0===n.length&&(d=g.getFullYear()),a=!1;break;case"hh":p=parseInt(n,10),a=!0;break;case"ss":u=parseInt(n,10),a=!0;break;case"f":case"fff":c=parseInt(n,10)}for(d=d?d>0?d<9999?d:9999:0:g.getFullYear(),h=h?h>0?h<=12?h-1:11:0:g.getMonth(),l=l?l>0?l<=32?l:31:1:g.getDate(),p=p>0?p<=23?p:24===p?0:23:0,f=f>0?f<60?f:59:0,u=u>0?u<60?u:59:0,c=c>0?c<999?c:999:0,r=new Date(d,h,l,p,f,u,c);r.getMonth()!==h;)l--,r=new Date(d,h,l,p,f,u,c);return r},dateToString:function(e,t,i){return this.applyDateMask(e,t,i||"/")},dateToWeek:function(e){var t,i;return(i=new Date(e.getTime())).setHours(0,0,0,0),i.setDate(i.getDate()+3-(i.getDay()+6)%7),t=new Date(i.getFullYear(),0,4),1+Math.round(((i.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},removeFromArray:function(e,t){var i;for(i=0;i<e.length;i++)e[i]===t&&e.splice(i,1)},formatRegExp:/\{\{([0-9a-zA-Z]+)\}\}/gi,format:function(e,t){var i=t||{};return e.replace(this.formatRegExp,(function(e,t,s,o){return i.hasOwnProperty(t)?i[t]:e}))},markupDataSize:function(e){var t;return e<1024?e+" B":(t=e/1024)<2048?Math.round(t)+" kB":(t/=1024)<2048?t<100?10*Math.round(t)/10+" MB":Math.round(t)+" MB":(t/=1024)<2048?t<100?10*Math.round(t)/10+" GB":Math.round(t)+" GB":(t/=1024)<2048?t<100?10*Math.round(t)/10+" TB":Math.round(t)+" TB":(t/=1024)<100?10*Math.round(t)/10+" PB":Math.round(t)+" PB"},escapeRegExp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},compareText:function(e,t){return e.localeCompare(t)},compareRevText:function(e,t){return-e.localeCompare(t)},compareBCD:function(e,t){return parseFloat(e)-parseFloat(t)},compareRevBCD:function(e,t){return-(parseFloat(e)-parseFloat(t))},compareDate:function(e,t){return e==t?0:df.sys.data.stringToDate(e,"yyyy/mm/dd","-")<df.sys.data.stringToDate(t,"yyyy/mm/dd","-")?-1:1},compareRevDate:function(e,t){return e==t?0:df.sys.data.stringToDate(e,"yyyy/mm/dd","-")<df.sys.data.stringToDate(t,"yyyy/mm/dd","-")?1:-1},compareDateTime:function(e,t){return e==t?0:df.sys.data.stringToDate(e,"yyyy/mm/ddThh:mm:ss.fff","-")<df.sys.data.stringToDate(t,"yyyy/mm/ddThh:mm:ss.fff","-")?-1:1},compareRevDateTime:function(e,t){return e==t?0:df.sys.data.stringToDate(e,"yyyy/mm/ddThh:mm:ss.fff","-")<df.sys.data.stringToDate(t,"yyyy/mm/ddThh:mm:ss.fff","-")?1:-1},compareTime:function(e,t){return e==t?0:df.sys.data.stringToDate(e,"hh:mm:ss","-")<df.sys.data.stringToDate(t,"hh:mm:ss","-")?-1:1},compareRevTime:function(e,t){return e==t?0:df.sys.data.stringToDate(e,"hh:mm:ss","-")<df.sys.data.stringToDate(t,"hh:mm:ss","-")?1:-1},compareFunction:function(e,t){switch(e){case df.ciTypeBCD:return t?this.compareRevBCD:this.compareBCD;case df.ciTypeDate:return t?this.compareRevDate:this.compareDate;case df.ciTypeDateTime:return t?this.compareRevDateTime:this.compareDateTime;case df.ciTypeTime:return t?this.compareRevTime:this.compareTime;default:return t?this.compareRevText:this.compareText}},serverToType:function(e,t){var i=e;return t===df.ciTypeBCD?i=df.sys.data.stringToNum(e,"."):t===df.ciTypeDate?i=df.sys.data.stringToDate(e,"yyyy/mm/dd","-"):t===df.ciTypeDateTime?i=df.sys.data.stringToDate(e,"yyyy/mm/ddThh:mm:ss.fff"):t===df.ciTypeTime&&(i=df.sys.data.stringToDate(e,"hh:mm:ss")),i},typeToDisplay:function(e,t,i,s,o,n){var r=e;return!s&&o&&t!==df.ciTypeText?t===df.ciTypeDate||t===df.ciTypeDateTime||t===df.ciTypeTime?r=e&&df.sys.data.applyDateMask(e,o,i.psDateSeparator,i.psTimeSeparator)||"":t===df.ciTypeBCD&&(r=null!==e&&df.sys.data.applyNumMask(e||0,o,i.psDecimalSeparator,i.psThousandsSeparator,i.psCurrencySymbol)||""):o&&t===df.ciTypeText?r=df.sys.data.applyWinMask(r,o):""!==e&&(t===df.ciTypeBCD?r=null!==e&&df.sys.data.numToString(e,i.psDecimalSeparator,n):t===df.ciTypeDate?r=e&&df.sys.data.dateToString(e,i.psDateFormat,i.psDateSeparator,i.psTimeSeparator)||"":t===df.ciTypeDateTime?r=e&&df.sys.data.dateToString(e,i.psDateTimeFormat,i.psDateSeparator,i.psTimeSeparator)||"":t===df.ciTypeTime&&(r=e&&df.sys.data.dateToString(e,i.psTimeFormat,i.psDateSeparator,i.psTimeSeparator)||"")),r}},cookie:{set:function(e,t,i,s){var o=new Date,n="";i&&(o.setHours(o.getHours()+i),n+="; expires="+o.toGMTString()),s&&(n+="; path="+s),document.cookie=e+"="+t+n},del:function(e){var t=new Date;t.setTime(t.getTime()-1),document.cookie=e+"=; expires="+t.toGMTString()},get:function(e,t){var i,s,o,n=null;if(document.cookie)for(i=document.cookie.split(";"),o=0;o<i.length&&null===n;o++)(s=i[o].split("=")).length>1&&s[0].trim()===e.trim()&&(n=s[1]);return null!==n?n:t}},gui:{disableTabIndexes:function(e){var t,i,s;for(i=df.dom.query(e,df.dom.cFocusSelector,!0),t=0;t<i.length;t++)null===(s=i[t]).getAttribute("data-dfOrigTabIndex")?(s.setAttribute("data-dfTabIndexCount",1),s.setAttribute("data-dfOrigTabIndex",s.tabIndex),s.tabIndex="-1"):s.setAttribute("data-dfTabIndexCount",parseInt(s.getAttribute("data-dfTabIndexCount"),10)+1)},restoreTabIndexes:function(e){var t,i,s;for(i=df.dom.query(e,df.dom.cFocusSelector,!0),t=0;t<i.length;t++)s=i[t],null!==parseInt(s.getAttribute("data-dfTabIndexCount"),10)&&(s.getAttribute("data-dfTabIndexCount")<=1?(s.tabIndex=s.getAttribute("data-dfOrigTabIndex"),s.removeAttribute("data-dfOrigTabIndex"),s.removeAttribute("data-dfTabIndexCount")):s.setAttribute("data-dfTabIndexCount",parseInt(s.getAttribute("data-dfTabIndexCount"),10)-1))},hidePlugins:function(e){var t,i,s=[];if(df.sys.isIE)for(t=df.dom.query(e,"iframe, object, embed",!0),i=0;i<t.length;i++)"yes"!==(e=t[i]).getAttribute("data-df-hiddenplugin")&&(s.push(e),e.style.display="none",e.setAttribute("data-df-hiddenplugin","yes"));return s},restorePlugins:function(e){var t;for(t=0;t<e.length;t++)e[t].style.display="",e[t].removeAttribute("data-df-hiddenplugin")},getAbsoluteOffset:function(e){var t={left:0,top:0},i=!0;if(e.offsetParent)for(;e&&(i||"absolute"!==df.sys.gui.getCurrentStyle(e).position)&&"fixed"!==df.sys.gui.getCurrentStyle(e).position&&"relative"!==df.sys.gui.getCurrentStyle(e).position;)i=!1,t.top+=e.offsetTop,t.left+=e.offsetLeft,e=e.offsetParent;else e.y&&(t.left+=e.x,t.top+=e.y);return t},getViewportHeight:function(){return void 0!==window.innerHeight?window.innerHeight:"CSS1Compat"===document.compatMode?document.documentElement.clientHeight:document.body?document.body.clientHeight:null},getViewportWidth:function(){return"CSS1Compat"===document.compatMode?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0!==window.innerWidth?window.innerWidth:null},getSize:function(e){if(df.sys.isIE||df.sys.isWebkit)return{width:e.offsetWidth,height:e.offsetHeight};var t=df.sys.gui.getCurrentStyle(e);return{width:parseInt(t.getPropertyValue("width"),10),height:parseInt(t.getPropertyValue("height"),10)}},getCurrentStyle:function(e){return"function"==typeof window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle},getVertBoxDiff:function(e,t){var i=0,s=df.sys.gui.getCurrentStyle(e);return 0!==(t=t||0)&&1!==t&&3!==t||(i+=parseFloat(s.marginTop)||0),0!==t&&1!==t||(i+=parseFloat(s.borderTopWidth)||0),0!==t&&2!==t||(i+=parseFloat(s.paddingTop)||0),0!==t&&1!==t&&3!==t||(i+=parseFloat(s.marginBottom)||0),0!==t&&1!==t||(i+=parseFloat(s.borderBottomWidth)||0),0!==t&&2!==t||(i+=parseFloat(s.paddingBottom)||0),i},getHorizBoxDiff:function(e,t){var i=0,s=df.sys.gui.getCurrentStyle(e);return 0!==(t=t||0)&&1!==t&&3!==t||(i+=parseFloat(s.marginLeft)||0),0!==t&&1!==t||(i+=parseFloat(s.borderLeftWidth)||0),0!==t&&2!==t||(i+=parseFloat(s.paddingLeft)||0),0!==t&&1!==t&&3!==t||(i+=parseFloat(s.marginRight)||0),0!==t&&1!==t||(i+=parseFloat(s.borderRightWidth)||0),0!==t&&2!==t||(i+=parseFloat(s.paddingRight)||0),i},isSizedByContent:function(e){var t,i;return t=e.clientHeight,e.appendChild(df.dom.create('<div style="width: 100%; height: 20px;">&nbsp</div>')),i=t!==e.clientHeight,e.removeChild(e.lastChild),i},getBoundRect:function(e){var t=e.getBoundingClientRect();return"number"!=typeof t.width?{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}:t},rectToObj:function(e){return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},getTransformProp:(sPrefix=null,function(){return null===sPrefix&&(sPrefix=function(){var e,t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"];for(e=0;e<t.length;e++)if(void 0!==document.createElement("div").style[t[e]])return t[e];return!1}()),sPrefix}),initCSS:function(){var e,t=document.body.className;e=t?(t=t.replace(/\bdf-ie*|df-safari|df-chrome|df-opera|df-mozilla|df-webkit|df-mobile\b/g,"").trim()).split(" "):[],df.sys.isIE?(e.push("df-ie"),e.push(df.sys.iVersion<=6?" df-ie6":" df-ie"+df.sys.iVersion)):df.sys.isSafari?e.push("df-safari"):df.sys.isChrome?e.push("df-chrome"):df.sys.isOpera?e.push("df-opera"):df.sys.isMoz&&e.push("df-mozilla"),df.sys.isWebkit&&e.push("df-webkit"),df.sys.isMobile&&e.push("df-mobile"),document.body.className=e.join(" ")},isOnScreen:function(e){var t=e.getBoundingClientRect(),i=t.top,s=t.height,o=t.left,n=t.width;for(e=e.offsetParent;e&&e!=document.body;){if(i>(t=e.getBoundingClientRect()).bottom)return!1;if(o>t.right)return!1;if(i+s<=t.top)return!1;if(o+n<=t.left)return!1;e=e.offsetParent}return i<=document.documentElement.clientHeight},addScrollListeners:function(e,t,i){for(var s=[];e;)s.push(e),df.dom.on("scroll",e,t,i),e=e.offsetParent;return s},removeScrollListeners:function(e,t,i){for(var s;s=e.shift();)df.dom.off("scroll",s,t,i)},cssTextAlign:function(e){switch(e){case df.ciAlignLeft:return"left";case df.ciAlignCenter:return"center";case df.ciAlignRight:return"right"}return""}},string:{trim:function(e){return e.trim()},ltrim:function(e){return e.replace(/^\s+/,"")},rtrim:function(e){return e.replace(/\s+$/,"")},copyCase:function(e,t){var i,s,o="";for(s=0;s<e.length;s++)o+=(i=s<t.length?t.charAt(s)===t.charAt(s).toUpperCase():i)?e.charAt(s).toUpperCase():e.charAt(s).toLowerCase();return o},encodeHtml:df.dom.encodeHtml},supportHtml5Input:(oCache={},function(e){var t;return"boolean"==typeof oCache[e]||((t=document.createElement("input")).setAttribute("type",e),oCache[e]=t.type===e),oCache[e]}),detectDevice:function(){this._sPrevUA!==navigator.userAgent&&(this._sPrevUA=navigator.userAgent,this.isSafari=!1,this.isChrome=!1,this.isOpera=!1,this.isMoz=!1,this.isIE=!1,this.isEdge=!1,this.isWebkit=!1,this.isMobile=!1,this.isIOS=!1,navigator.userAgent.indexOf("Trident")>=0?(df.sys.isIE=!0,document.documentMode?df.sys.iVersion=document.documentMode:navigator.appVersion.indexOf("MSIE")>=0?df.sys.iVersion=parseInt(navigator.appVersion.substr(navigator.appVersion.indexOf("MSIE")+4),10):df.sys.iVersion=parseInt(navigator.appVersion.substr(navigator.appVersion.indexOf("rv:")+3),10)):navigator.userAgent.indexOf("Edge/")>=0?(df.sys.isEdge=!0,df.sys.iVersion=parseFloat(navigator.appVersion.substr(navigator.appVersion.indexOf("Edge/")+5))):navigator.userAgent.indexOf("Chrome")>=0?(df.sys.isChrome=!0,df.sys.iVersion=parseFloat(navigator.appVersion.substr(navigator.appVersion.indexOf("Chrome/")+7))):navigator.userAgent.indexOf("Safari")>=0?(df.sys.isSafari=!0,df.sys.iVersion=parseFloat(navigator.appVersion.substr(navigator.appVersion.indexOf("Version/")+8))):"Gecko"===navigator.product?(df.sys.isMoz=!0,df.sys.iVersion=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Firefox/")+8))):navigator.userAgent.indexOf("Opera")>=0?(df.sys.isOpera=!0,df.sys.iVersion=parseFloat(navigator.appVersion)):(df.sys.isIE=!0,df.sys.iVersion=parseInt(navigator.appVersion.substr(navigator.appVersion.indexOf("MSIE")+4),10),document.documentMode&&(df.sys.iVersion=document.documentMode)),/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/i.test(navigator.userAgent)&&(df.sys.isMobile=!0),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(df.sys.isIOS=!0),navigator.userAgent.indexOf("AppleWebKit")>=0&&(df.sys.isWebkit=!0),df.dom.ready(df.sys.gui.initCSS,window))}},df.sys.detectDevice(),Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("callback must be a function");for(var t=Object(this),i=t.length>>>0,s=arguments[1],o=0;o<i;o++){var n=t[o];if(e.call(s,n,o,t))return n}}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var i=0;i<this.length;i++)e.call(t,this[i],i,this)}),Object.values||(Object.values=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&e.propertyIsEnumerable(i)&&t.push(e[i]);return t}),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.split(e).join(t)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),(()=>{df.sys.json={parse:function(sString){if("object"==typeof JSON&&"function"==typeof JSON.parse)return JSON.parse(sString);if(this.oDecodeRegex.lastIndex=0,this.oDecodeRegex.test(sString)&&(sString=sString.replace(this.oDecodeRegex,(function(e,t){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),this.validate(sString))return eval("("+sString+")");throw new SyntaxError("JSON.parse")},validate:function(e){return/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))},stringify:function(e){if("object"==typeof JSON&&"function"==typeof JSON.stringify&&(!df.sys.isIE||df.sys.iVersion>8))return JSON.stringify(e,(function(e,t){return"string"==typeof e&&"__"===e.substr(0,2)?void 0:t}));var t=[];return this.switchToJson(e,t),t.join("")},switchToJson:function(e,t){switch(df.sys.ref.getType(e)){case"array":this.arrayToJson(e,t);break;case"string":this.stringToJson(e,t);break;case"number":this.numberToJson(e,t);break;case"boolean":this.booleanToJson(e,t);break;case"date":this.dateToJson(e,t);break;case"null":t.push("null");break;default:this.objectToJson(e,t)}},objectToJson:function(e,t){var i,s=!0;if(null!=e){for(i in t.push("{"),e)"function"!=typeof e[i]&&"__"!==i.substr(0,2)&&(s||t.push(","),t.push('"'),t.push(i),t.push('":'),this.switchToJson(e[i],t),s=!1);t.push("}")}},arrayToJson:function(e,t){var i,s=!0;for(t.push("["),i=0;i<e.length;i++)s||t.push(","),this.switchToJson(e[i],t),s=!1;t.push("]")},oEncodeChars:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},stringToJson:function(e,t){t.push('"'),this.oEncodeRegex.lastIndex=0,this.oEncodeRegex.test(e)&&(e=e.replace(this.oEncodeRegex,(function(e,t){var i=df.sys.json.oEncodeChars[e];return"string"==typeof i?i:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),t.push(e),t.push('"')},booleanToJson:function(e,t){t.push(String(e))},numberToJson:function(e,t){t.push(isFinite(e)?String(e):e)},dateToJson:function(e,t){t.push('"'),t.push(e.getUTCFullYear()),t.push("-"),t.push(df.sys.math.padZero(e.getUTCMonth()+1,2)),t.push("-"),t.push(df.sys.math.padZero(e.getUTCDate(),2)),t.push("T"),t.push(df.sys.math.padZero(e.getUTCHours(),2)),t.push(":"),t.push(df.sys.math.padZero(e.getUTCMinutes(),2)),t.push(":"),t.push(df.sys.math.padZero(e.getUTCSeconds(),2)),t.push("Z"),t.push('"')}},df.sys.json.oEncodeRegex=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,df.sys.json.oDecodeRegex=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g})(),df.sys.vt={generateDeserializer:function(e){var t=[],i=0,s=[];function o(e,n){return"number"==typeof n?function(e,t){switch(t){case df.tBool:return"df.toBool("+e+".v)";case df.tInt:return"df.toInt("+e+".v)";case df.tNumber:return"df.toNumber("+e+".v)";case df.tDate:return"df.toDate("+e+".v)";default:return e+".v"}}(e,n):n instanceof Array?function(e,s){var n=i++,r=[];return r.push("function p",n,"(tVT){","var a = [], i; ","for(i = 0; i < tVT.c.length; i++){"),r.push("a.push(",o("tVT.c[i]",s[0]),");"),r.push("}","return a;","}"),t.push(r.join("")),"p"+n+"("+e+")"}(e,n):function(e,n){var r,a,l=0,h=[];if((a=s.indexOf(n))<0){for(r in a=i++,s[a]=n,h.push("function p",a,"(tVT){","return {"),n)n.hasOwnProperty(r)&&(l>0&&h.push(","),h.push(r,":",o("tVT.c["+l+"]",n[r])),l++);h.push("};","}"),t.push(h.join(""))}return"p"+a+"("+e+")"}(e,n)}return t.push("try{","return ",o("tVT",e),";","}catch(oErr){",'throw new df.Error(999, "Unable to deserialize valuetree, invalid data format!\\n\\r\\n\\rMSG: {{0}}", this, [ oErr.message ]);',"}"),new Function("tVT",t.join(""))},generateSerializer:function(e){var t=[],i=0;function s(e,o){return"number"==typeof o?function(e,t){switch(t){case df.tBool:return"{ v : df.fromBool("+e+"), c : [] }";case df.tDate:return"{ v : df.fromDate("+e+"), c : [] }";default:return"{ v : "+e+".toString(), c : [] }"}}(e,o):o instanceof Array?function(e,o){var n=i++,r=[];return r.push("function p",n,"(aArray){",'var tVT = { v : "", c : [] }, i;',"for(i = 0; i < aArray.length; i++){"),r.push("tVT.c.push(",s("aArray[i]",o[0]),");"),r.push("}","return tVT;","}"),t.push(r.join("")),"p"+n+"("+e+")"}(e,o):function(e,o){var n,r=0,a=i++,l=[];for(n in l.push("function p",a,"(oObj){","return {",'v : "",',"c : ["),o)o.hasOwnProperty(n)&&(r>0&&l.push(","),l.push(s('oObj["'+n+'"]',o[n])),r++);return l.push("]","};","}"),t.push(l.join("")),"p"+a+"("+e+")"}(e,o)}return t.push("try{","return ",s("tStruct",e),";","}catch(oErr){",'throw new df.Error(999, "Unable to serialize valuetree, invalid data format!\\n\\r\\n\\rMSG: {{0}}", this, [ oErr.message ]);',"}"),new Function("tStruct",t.join(""))},deserialize:function(e,t){function i(e,t){return"number"==typeof t?function(e,t){switch(t){case df.tBool:return df.toBool(e.v);case df.tInt:return df.toInt(e.v);case df.tNumber:return df.toNumber(e.v);case df.tDate:return df.toDate(e.v);default:return e.v}}(e,t):t instanceof Array?function(e,t){var s,o=[];for(s=0;s<e.c.length;s++)o.push(i(e.c[s],t[0]));return o}(e,t):function(e,t){var s,o=0,n={};for(s in t)t.hasOwnProperty(s)&&(n[s]=i(e.c[o],t[s]),o++);return n}(e,t)}try{return i(e,t)}catch(e){throw new df.Error(999,"Unable to deserialize valuetree, invalid data format!\\n\\r\\n\\rMSG: {{0}}",this,[e.message])}},serialize:function(e){function t(e){return"boolean"==typeof e?{v:df.fromBool(e),c:[]}:e instanceof Date?{v:df.fromDate(e),c:[]}:{v:e.toString(),c:[]}}function i(e){return"object"==typeof e?e instanceof Array?function(e){var t,s={v:"",c:[]};for(t=0;t<e.length;t++)s.c.push(i(e[t]));return s}(e):e instanceof Date?t(e):function(e){var t,s={v:"",c:[]};for(t in e)e.hasOwnProperty(t)&&s.c.push(i(e[t]));return s}(e):t(e)}try{return i(e)}catch(e){throw new df.Error(999,"Unable to serialize valuetree, invalid data format!\\n\\r\\n\\rMSG: {{0}}",this,[e.message])}}},df.ajax.REQUEST_STATE_UNITIALIZED=0,df.ajax.REQUEST_STATE_LOADING=1,df.ajax.REQUEST_STATE_LOADED=2,df.ajax.REQUEST_STATE_INTERACTIVE=3,df.ajax.REQUEST_STATE_COMPLETE=4,df.ajax.HttpRequest=function(e,t,i){void 0===t&&(t=null),this.sUrl=e,this.pbWithCredentials=!1,this.sData=t,this.bAsynchronous=!0,this.sExpectedContentType=null,this.onFinished=new df.events.JSHandler,this.onError=new df.events.JSHandler,this.onClose=new df.events.JSHandler,this.oLoader=null,this.oSource=i||null,this.bSilent=!1},df.defineClass("df.ajax.HttpRequest",{send:function(e){var t,i=this;"boolean"==typeof e&&(this.bAsynchronous=e),this.oLoader=new XMLHttpRequest,t=this.getData(),this.bAsynchronous&&(this.oLoader.onreadystatechange=function(){i.onReadyStateChange()});try{this.oLoader.open(t?"POST":"GET",this.getRequestUrl(),this.bAsynchronous),this.oLoader.withCredentials=this.pbWithCredentials,this.setHeaders(this.oLoader),this.oLoader.send(t)}catch(e){throw new df.Error(5121,"The application was unable to communicate with the server.",this)}this.bAsynchronous||this.onReadyStateChange()},onReadyStateChange:function(){try{if(this.oLoader.readyState===df.ajax.REQUEST_STATE_COMPLETE){if(!(this.oLoader.status>0))throw new df.Error(5121,"The application was unable to communicate with the server.",this);this.onClose.fire(this),this.checkErrors(),this.onFinished.fire(this,this.getFinishedDetails())}}catch(e){this.bSilent||df.handleError(e,this),this.onError.fire(this,{oError:e})}},getFinishedDetails:function(){return{oResponseXml:this.getResponseXml(),sResponseText:this.getResponseText()}},checkErrors:function(e){if(this.oLoader.status>=300&&(!e||500!==this.oLoader.status)){var t=this.oLoader.responseText;throw new df.Error(5120,"Received HTTP error '{{0}} {{1}}' while loading URL '{{2}}'.",this,[this.oLoader.status,this.oLoader.statusText,this.getRequestUrl()],t)}if(200==this.oLoader.status&&this.sExpectedContentType){let e=this.oLoader.getResponseHeader("Content-Type")||"";if(e.indexOf(";")&&(e=e.substring(0,e.indexOf(";"))),e.trim().toLowerCase()!=this.sExpectedContentType.toLowerCase())throw new df.Error(5124,"Invalid response for HTTP request, content-type mismatch.",this,[],`Received content-type header '${e}' while expecting '${this.sExpectedContentType}'.`)}},setHeaders:function(e){},getRequestUrl:function(){return this.sUrl},getResponseXml:function(){return this.oLoader.responseXML},getResponseText:function(){return this.oLoader.responseText},getData:function(){return this.sData},cancel:function(){null!==this.oLoader?(this.onClose.fire(this),this.oLoader.onreadystatechange=function(){},this.oLoader.abort(),this.oLoader=null):df.ajax.oDefaultQueue&&this.bAsynchronous&&df.ajax.oDefaultQueue.removeCall(this),this.onFinished.aListener=[]},destroy:function(){try{this.bAsynchronous&&this.oLoader&&this.oLoader.onreadystatechange&&(this.oLoader.onreadstatechange=null)}catch(e){}this.oLoader=null},getWebApp:function(){return this.oSource&&this.oSource.getWebApp?this.oSource.getWebApp():null}}),df.ajax.JSONCall=function(e,t,i,s){null==i&&(i="WebService.wso"),df.ajax.JSONCall.base.constructor.call(this,i,null,s),this.sFunction=e,this.oParams=t||{},this.bUsePOST=!0,this.bExtendURL=!0,this.sExpectedContentType="application/json",this._oJSON=null},df.defineClass("df.ajax.JSONCall","df.ajax.HttpRequest",{addParam:function(e,t){this.oParams[e]=t},setHeaders:function(e){df.ajax.JSONCall.base.setHeaders.call(this,e),this.bUsePOST&&e.setRequestHeader("Content-Type","application/json")},getData:function(){return this.bUsePOST?df.sys.json.stringify(this.oParams):null},getRequestUrl:function(){var e,t,i=[];if(e=(e=df.ajax.JSONCall.base.getRequestUrl.call(this)).indexOf("/JSON")>=0?e.replace("/JSON","/"+this.sFunction+"/JSON"):e.indexOf("?")>=0?e.replace("?","/"+this.sFunction+"/JSON"):e+("/"!==e.charAt(e.length-1)?"/":"")+this.sFunction+"/JSON",!this.bUsePOST){for(t in this.oParams)this.oParams.hasOwnProperty(t)&&(i.push(i.length<=0&&e.indexOf("?")<0?"?":"&"),i.push(encodeURIComponent(t)),i.push("="),i.push(encodeURIComponent(String(this.oParams[t]))));return e+i.join("")}return e},getResponseXml:function(){return null},checkErrors:function(){var e;if(this.oLoader.status>=400&&this.oLoader.status<600){try{e=df.sys.json.parse(this.getResponseText())}catch(e){}if(e&&e.errorCode)throw new df.Error(5122,e.errorDescription,this,[],null,!1,!1,"Server returned HTTP error 500");if(e&&e.error)throw new df.Error(5122,e.error.message,this,[],null,!1,!1,"HTTP Status "+this.oLoader.status+": "+(e.error.reason||this.oLoader.statusText||""))}df.ajax.JSONCall.base.checkErrors.call(this)},getResponseValue:function(){var e=this.getResponseText();try{return df.sys.json.parse(e)}catch(e){throw new df.Error(5123,"Received invalid JSON from the server.",this,[],e.message)}}}),df.ServerAction=function(){this.oWO=null,this.sAction="",this.aParams=[],this.tData={v:"",c:[]},this.aViews=[],this.eCallMode=df.cCallModeDefault,this.sProcessMessage="",this.fHandler=null,this.oHandlerEnv=null,this.sReturnValue=null},df.ServerCall=function(){this.aActions=[],this.eCallMode=df.cCallModeDefault,this.sProcessMessage="",this.sFocus="",this.aWaiters=[],this.bSending=!1},df.InfoBalloon=function(e,t,i){this.psMessage=i,this.piHideDelay=6e3,this.pbShowOnHover=!0,this.psCSSClass=t,this.poTarget=e,this._eElem=null,this._eEventElem=null,this._eParentRef=null,this._bFirstPos=!0,this._bTopTooltip=!1,this._tHideTimeout=null,this._tPositionInterval=null},df.defineClass("df.InfoBalloon",{update:function(){this._eElem&&(this._eElem.innerHTML=this.psMessage,this._eElem.className="WebInfoBalloon "+this.psCSSClass,this._eElem.style.bottom="",this._eElem.style.top="",this._eElem.style.left="",this._bTopTooltip=!1,this._bFirstPos=!0,this.position())},init:function(){var e=this.getTargetElem();!this._eElem&&e&&(this._eElem=df.dom.create('<div class="WebInfoBalloon WebInfoBalloonHidden '+this.psCSSClass+'"></div>'),this._eElem.innerHTML=this.psMessage,(this.poTarget?.topLayer()||document.body).appendChild(this._eElem),this._bTopTooltip=!1,this._bFirstPos=!0,this.position(),this.pbShowOnHover&&(df.dom.on("mouseover",e,this.onMouseOver,this),df.dom.on("mouseout",e,this.onMouseOut,this),this._eEventElem=e))},destroy:function(){this._eElem&&this._eElem.parentNode&&this._eElem.parentNode.removeChild(this._eElem),this._eElem=null},show:function(){this._eElem?this._eElem.parentNode.lastChild!==this._eElem&&this._eElem.parentNode.appendChild(this._eElem):this.init(),this._show(),this.setTimeout()},_show:function(){var e=this;this._eElem&&(df.dom.addClass(this._eElem,"WebInfoBalloonVisible"),df.dom.removeClass(this._eElem,"WebInfoBalloonHidden"),this._tPositionInterval||(this._tPositionInterval=setInterval((function(){e.position()}),300)))},getTargetElem:function(){var e=this.poTarget._eElem;return this.poTarget.getTooltipElem&&(e=this.poTarget.getTooltipElem()||e),e},hide:function(){var e=this._eElem;this._eElem&&(this._hide(),this._eEventElem&&(df.dom.off("mouseover",this._eEventElem,this.onMouseOver,this),df.dom.off("mouseout",this._eEventElem,this.onMouseOut,this),this._eEventElem=null),this._tHideTimeout&&(clearTimeout(this._tHideTimeout),this._tHideTimeout=null),setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e)}),3e3),this._eElem=null)},_hide:function(){this._eElem&&(df.dom.addClass(this._eElem,"WebInfoBalloonHidden"),df.dom.removeClass(this._eElem,"WebInfoBalloonVisible")),this._tPositionInterval&&(clearInterval(this._tPositionInterval),this._tPositionInterval=null)},position:function(){var e,t,i,s,o,n,r=0,a=0;if(s=this.getTargetElem(),(o=this._eElem)&&s){const l=df.dom.windowWidth();if(!df.sys.gui.isOnScreen(s))return void(o.style.display="none");o.style.display="",r=(n=df.sys.gui.getBoundRect(s)).top+n.height,a=n.left+Math.max(Math.round((n.width-70)/2),0),e=o.clientHeight+df.sys.gui.getVertBoxDiff(o),i=o.clientWidth+df.sys.gui.getHorizBoxDiff(o),t=r+s.offsetHeight,this._bFirstPos&&(screen.height<r+e&&screen.height>t+e&&(this._bTopTooltip=!0,df.dom.addClass(this._eElem,"WebInfoBalloon_Top")),this._bFirstPos=!1),l<a+i&&(a=Math.max(n.left-10,0)),this._bTopTooltip?o.style.bottom=t+"px":o.style.top=r+"px",o.style.left=a+"px"}},setTimeout:function(){var e=this;this.piHideDelay>0&&(this._tHideTimeout&&clearTimeout(this._tHideTimeout),this._tHideTimeout=setTimeout((function(){e._hide()}),this.piHideDelay))},onMouseOver:function(e){this._show(),this._tHideTimeout&&(clearTimeout(this._tHideTimeout),this._tHideTimeout=null)},onMouseOut:function(e){this.setTimeout()},resize:function(){this.position()}}),df.MobRuleController=function(e){this._oWebApp=e,this.peMode=-1,this.pbActive=!0,this._aWOs=[],this._aModes=[{eM:df.modeDesktop,sCSS:"df-ModeDesktop"},{eM:df.modeTablet,sCSS:"df-ModeTablet"},{eM:df.modeTabletLandscape,sCSS:"df-ModeTabletLandscape"},{eM:df.modeTabletPortrait,sCSS:"df-ModeTabletPortrait"},{eM:df.modeMobile,sCSS:"df-ModeMobile"},{eM:df.modeMobileLandscape,sCSS:"df-ModeMobileLandscape "},{eM:df.modeMobilePortrait,sCSS:"df-ModeMobilePortrait"}],this.init()},df.defineClass("df.MobRuleController",{init:function(){this.detectMode(),df.dom.ready((function(){df.dom.on("resize",window,this.onWindowResize,this),df.dom.on("orientationchange",document,this.onWindowResize,this),this.detectMode()}),this)},destroy:function(){df.dom.off("resize",window,this.onWindowResize,this),df.dom.off("orientationchange",document,this.onWindowResize,this)},regWO:function(e){this._aWOs.push(e)},remWO:function(e){var t=this._aWOs.indexOf(e);t>=0&&this._aWOs.splice(t,1)},enforceMode:function(e){var t,i,s,o=this;for(this.peMode=e,df.dom.ready((function(){var e,t=o.pbActive?o.peMode:0;for(e=0;e<o._aModes.length;e++)df.dom.toggleClass(document.body,o._aModes[e].sCSS,o._aModes[e].eM<=t);o._oWebApp.sizeChanged()}),this),t=0;t<this._aWOs.length;t++)for(s in(i=this._aWOs[t])._oPropRuleStore)i._oPropRuleStore.hasOwnProperty(s)&&this.enforceRule(i,s)},enforceRule:function(e,t){var i,s,o=this.pbActive?this.peMode:0;if(o>=0&&(s=e._oPropRuleStore[t],!e._oSynced[t])){for(null===s.sDefault&&(s.sDefault=e.get(t)),i=0;i<s.aRules.length;i++)if(s.aRules[i].eM<=o)return e._set(t,s.aRules[i].sV,!0,!1),void(s.bActive=!0);s.bActive&&(e.set(t,s.sDefault,!0),s.bActive=!1)}},detectMode:function(){var e,t,i,s=df.modeDesktop;df.sys.detectDevice(),df.sys.isMobile?(i=(s=this.detectOrientation())==df.modeMobileLandscape,e=window.screen.width,t=window.screen.height):i=(e=df.dom.windowWidth())>(t=df.dom.windowHeight()),e<580||i&&t<420?s=i?df.modeMobileLandscape:df.modeMobilePortrait:(e<1100||df.sys.isMobile)&&(s=i?df.modeTabletLandscape:df.modeTabletPortrait),s!==this.peMode&&this.pbActive&&this.enforceMode(s)},detectOrientation:function(){var e=df.modeMobilePortrait;return window.screen.orientation?window.screen.orientation.type.indexOf("portrait")>=0?e=df.modeMobilePortrait:window.screen.orientation.type.indexOf("landscape")>=0&&(e=df.modeMobileLandscape):window.orientation&&(90!=window.orientation&&-90!=window.orientation||(e=df.modeMobileLandscape)),e},onWindowResize:function(e){this.detectMode()},activate:function(){this.pbActive||(this.pbActive=!0,this.enforceMode(this.peMode))},deactivate:function(){this.pbActive&&(this.pbActive=!1,this.enforceMode(this.peMode))}}),df.GroupHub=function(){this._oGroups={}},df.defineClass("df.GroupHub",{addListener:function(e,t){var i;e=e.toLowerCase(),this._oGroups[e]||(this._oGroups[e]={aListeners:[],aProviders:[]}),this._oGroups[e].aListeners.push(t),i=this.collectGroup(e),t.groupUpdate(i)},remListener:function(e,t){if(e=e.toLowerCase(),this._oGroups[e]){var i=this._oGroups[e].aListeners.indexOf(t);i>=0&&this._oGroups[e].aListeners.splice(i,1)}},addProvider:function(e,t){e=e.toLowerCase(),this._oGroups[e]||(this._oGroups[e]={aListeners:[],aProviders:[]}),this._oGroups[e].aProviders.push(t),this.updateGroup(e)},remProvider:function(e,t){var i;e=e.toLowerCase(),this._oGroups[e]&&(i=this._oGroups[e].aProviders.indexOf(t))>=0&&(this._oGroups[e].aProviders.splice(i,1),this.updateGroup(e))},updateGroup:function(e){var t,i,s;if(e=e.toLowerCase(),this._oGroups[e]&&this._oGroups[e].aListeners.length>0)for(s=this.collectGroup(e),t=this._oGroups[e].aListeners,i=0;i<t.length;i++)t[i].groupUpdate(s)},collectGroup:function(e){var t,i,s=[];for(e=e.toLowerCase(),t=this._oGroups[e].aProviders,i=0;i<t.length;i++)t[i].groupCollect(s);return s},getListeners:function(e){return this._oGroups[e]?this._oGroups[e].aListeners.slice():[]}}),df.WebObject=function(e,t){this._sName=e,this._oParent=t||null,this._oTypes={},this._oSynced={},this._aChildren=[],this._oServerActionModes={},this._oServerWaitMsg={},this._tActionData=null,this._oPropRuleStore=null,this._bStandalone=!e,this._oWebApp=null,this._oView=null,this._bIsWO=!0},df.defineClass("df.WebObject",{create:function(e){},destroy:function(){var e;for(this._oPropRuleStore&&this.getWebApp()._oModeControl.remWO(this);e=this._aChildren.pop();)e.destroy();this._oWebApp=null,this._oView=null,this._oParent&&delete this._oParent[this._sName],this._oParent=null},addChild:function(e){this._aChildren.push(e)},prop:function(e,t,i){this[t]=i,this._oTypes[t]=e},toLocalType:function(e,t){switch(t){case df.tString:return e;case df.tBool:return df.toBool(e);case df.tInt:return df.toInt(e);case df.tNumber:return df.toNumber(e);case df.tAdv:default:return e}},toServerType:function(e,t){switch(t){case df.tString:return"string"==typeof e?e:e?e.toString():"";case df.tBool:return df.fromBool(e);case df.tNumber:return df.fromNumber(e);case df.tAdv:return e;default:return null!==e?e.toString():e}},get:function(e){return this["get_"+e]?this["get_"+e]():this[e]},set:function(e,t,i){var s;this["set_"+e]&&(s=this["set_"+e](t)),void 0!==this[e]&&!1!==s&&(this[e]=t),!0!==i&&this.addSync(e)},_set:function(e,t,i,s){this._oTypes[e]&&(t=this.toLocalType(t,this._oTypes[e])),i&&this["set_"+e]&&this["set_"+e](t,!0),this[e]=t,s&&this.addSync(e)},addSync:function(e){this._oSynced.hasOwnProperty(e)||(this._oSynced[e]=!0)},unSync:function(e){this._oSynced.hasOwnProperty(e)&&delete this._oSynced[e]},getSynced:function(e,t){var i,s,o,n=[],r=this.getLongName();for(s in this._oSynced)this._oSynced.hasOwnProperty(s)&&(o=this.get(s),this._oTypes[s]&&(o=this.toServerType(o,this._oTypes[s])),void 0===o&&(o=null),this._oTypes[s]===df.tAdv?t.push({sO:r,sP:s,tV:o}):n.push({sN:s,sV:o}));for(n.length>0&&e.push({sO:r,aP:n}),i=0;i<this._aChildren.length;i++)this._aChildren[i]._bStandalone||this._aChildren[i].getSynced(e,t)},getLongName:function(){return this._oParent?this._oParent.getLongNamePrnt()+this._sName:this._sName},getLongNamePrnt:function(){return this.getLongName()+"."},getWebApp:function(){return this._oWebApp||(this._oWebApp=this instanceof df.BaseApp&&this||this._oParent&&this._oParent.getWebApp&&this._oParent.getWebApp()||null),this._oWebApp},getView:function(){return this._oView||(this._oView=this instanceof df.WebBaseView&&this||this._oParent&&this._oParent.getView&&this._oParent.getView()||null),this._oView},getObjectLevel:function(){for(var e=this,t=this.getView(),i=0;e!==t;)e=e._oParent,i++;return i},serverAction:function(e,t,i,s,o){this.serverActionEx({sMethod:e,aParams:t||[],tData:i||null,fHandler:s,oHandlerEnv:o})},serverActionEx:function(e){var t,i,s=new df.ServerAction;s.oWO=this,s.sAction=i=e.sMethod,s.aParams=e.aParams||[],s.tData=e.tData||null,s.fHandler=e.fHandler||null,s.oHandlerEnv=e.oHandlerEnv||this,s.aViews=e.aViews||[],s.oPlatformSpecific=e.oPlatformSpecific||{},(t=this.getView())&&s.aViews.push(t),e.eCallMode?s.eCallMode=e.eCallMode:(s.eCallMode=this._oServerActionModes[i.toLowerCase()]||df.cCallModeDefault,s.eCallMode===df.cCallModeProgress&&this._oServerWaitMsg[i.toLowerCase()]&&(s.sProcessMessage=this._oServerWaitMsg[i.toLowerCase()])),this.getWebApp().handleAction(s)},cancelServerAction:function(e){this.getWebApp().cancelAction(this,e)},hasPendingServerAction:function(e){return this.getWebApp().hasPendingAction(this,e)},callBack:function(e){var t,i=[];for(t=1;t<arguments.length;t++)i.push(arguments[t]);this.serverAction(e,i,this._tActionData)},setActionMode:function(e,t,i){if(!t)throw new df.Error(999,"Assertion: Invalid server-action mode '{{0}}' for message '{{1}}'",this,[t,e]);this._oServerActionModes[e.toLowerCase()]=df.toInt(t),i&&(this._oServerWaitMsg[e.toLowerCase()]=i)},getActionMode:function(e){return this._oServerActionModes[e.toLowerCase()]||df.cCallModeDefault},event:function(e,t,i){this.setActionMode(e,arguments.length>1?t:df.cCallModeDefault),this[e]=new df.events.JSHandler(i||e),this.prop(df.tBool,"pbServer"+e,!1),this.prop(df.tString,"psClient"+e,"")},fire:function(e,t,i,s){return this.fireEx({sEvent:e,aParams:t,fHandler:i,oEnv:s})},fireEx:function(e){var t,i,s,o=!1,n=!1,r=null;if(!(s=e.sEvent))throw new df.Error(999,"Event name missing in fireEx.",this);if(e.aParams&&e.aParams instanceof Array||(e.aParams=[]),t=new df.events.JSEvent(this,{aParams:e.aParams,oConf:e,bClient:!1,bServer:!1,sReturnVal:null,aViews:e.aView||[]}),this["psClient"+s]&&!e.bSkipClient)if("function"==typeof(i=this.findFunc(this["psClient"+s])).fFunc){t.bClient=o=!0;try{!1===i.fFunc.call(i.oEnv,t)&&t.stop()}catch(e){this.getWebApp().handleError(e)}}else this.getWebApp().handleError(new df.Error(999,"Event handler function '{{0}}' set as 'psClient{{1}}' not found.",this,[this["psClient"+s],s]));if(t.bCanceled||this[s]instanceof df.events.JSHandler&&(r=this[s],t.bClient=o=o||r.aListeners.length>0,r.fire(this,t)),!t.bCanceled){var a=e.sAltServerName||r&&r.sServerName||s;this["pbServer"+s]&&df.toBool(this["pbServer"+s])&&!e.bSkipServer&&(o=!0,n=!0,this.serverAction(a,e.aParams,e.tActionData||null,(function(i){t.sReturnValue=i.sReturnValue,t.bServer=!0,e.fHandler&&e.fHandler.call(e.oEnv||this,t)}),this))}return n||e.fHandler&&e.fHandler.call(e.oEnv||this,t),o},insertChild:function(e,t){this._aChildren.splice(t,0,e)},renderChild:function(e,t){},removeChild:function(e){var t=this._aChildren.indexOf(e);-1!==t&&this._aChildren.splice(t,1)},unrenderChild:function(e){},propRule:function(e,t,i){var s,o=this.getWebApp(),n=!1;if(t=df.toInt(t),!this._oPropRuleStore){if(this._oPropRuleStore={},!o._oModeControl)throw new df.Error(999,"Mobile mode controller not available!",this);o._oModeControl.regWO(this)}if(this._oPropRuleStore[e])for(s=0;s<this._oPropRuleStore[e].aRules.length;s++)this._oPropRuleStore[e].aRules[s].eM===t&&(n=!0,this._oPropRuleStore[e].aRules[s].sV=i);else this._oPropRuleStore[e]={sDefault:null,aRules:[],bActive:!1};n||(this._oPropRuleStore[e].aRules.push({eM:t,sV:i}),this._oPropRuleStore[e].aRules.sort((function(e,t){return t.eM-e.eM}))),o._oModeControl.enforceRule(this,e)},findFunc:function(e){var t,i,s,o=null,n=null;if(e){for(t=e.split(".");t.length>1;)i=t.shift(),n?n=n[i]:"window"===i?n=window:"this"===i?n=this:"object"==typeof this[i]?n=this[i]:"object"==typeof(s=df.sys.ref.getGlobalObj())[i]&&(n=s[i]);i=t[0],n?o=n[i]:"function"==typeof this[i]?(o=this[i],n=this):"function"==typeof(s=df.sys.ref.getGlobalObj())[i]&&(o=s[i],n=s)}return{fFunc:o,oEnv:n}},isParent:function(e){for(var t=this;t;){if(t==e)return!0;t=t._oParent}return!1}}),df.WebDragDrop_Mixin=function(e,t){this.getBase("df.WebDragDrop_Mixin").constructor.call(this,e,t),this.prop(df.tBool,"pbDragDropEnabled",!1),this._sRawDragData="",this._aDragDropHelpers=new Set,this._aDropZones=[],this._aDragActions=new Set,this._aDropActions=new Set,this.event("OnDragStart",df.cCallModeWait),this.event("OnDrop",df.cCallModeDefault)},df.defineClass("df.WebDragDrop_Mixin",{addDragDropEventListeners:function(){this._eElem&&(df.dom.off("dragstart",this._eElem,this.onDragStart,this),df.dom.off("dragend",this._eElem,this.onDragEnd,this),this._aDragActions.size>0&&(df.dom.on("dragstart",this._eElem,this.onDragStart,this),df.dom.on("dragend",this._eElem,this.onDragEnd,this)))},registerDragSource:function(e,t){this._aDragDropHelpers.add(e),this._aDragActions.add(t),this.resize(),this._eElem&&this.addDragDropEventListeners()},registerDropTarget:function(e,t){if(this._aDropActions.size>0&&(t==df.dropActions.WebControl.ciDropOnControl||this._aDropActions.has(df.dropActions.WebControl.ciDropOnControl)))throw new df.Error(999,'Drop Action "DropOnControl" cannot be used in conjunction with other Drop Actions. Ensure only "DropOnControl" or any of the other actions are registered exclusively.',this);this._aDragDropHelpers.add(e),this._aDropActions.add(t),this._eElem&&this.initDropZones()},initDropZones:function(){},addDropZone:function(e){var t=new df.WebDropZone(e,this);this._aDropZones.push(t)},removeDropZone:function(e){this._aDropZones=this._aDropZones.filter((t=>t!==e))},removeDropZoneByElem:function(e){this._aDropZones=this._aDropZones.filter((t=>t._eZone!==e))},initDraggableElements:function(){},dragDropInit:function(){this._aDropZones=[],this.addDragDropEventListeners(),this.initDropZones()},dragDropCleanup:function(){},onDragStart:function(e){var[t,i]=this.getDragData(e,e.e.target);t&&i&&(e.e.stopPropagation(),this._aDragDropHelpers.forEach((s=>{s.onDragStart(e,this,e.e.target,t,i)})))},onDragEnd:function(e){this._aDragDropHelpers.forEach((t=>{t.onDragEnd(e)}))},onDrop:function(e,t,i){this._aDragDropHelpers.forEach((s=>{s.onDrop(e,this,t,i)}))},onControlDragOver:function(e,t,i){},getDragData:function(e,t){return[void 0,void 0]},getDropData:function(e){return[]},highlightDropZones:function(e){this._aDropZones.forEach((t=>{t.highlight(e)}))},cleanupDropZones:function(){this._aDropZones.forEach((e=>{e.unhighlight(),e.removeDropElemInteractions()}))},hasData:function(){return!1},determineDropCandidate:function(e,t){return[void 0,void 0]},determineDropPosition:function(e,t){return df.dropPositions.ciDropUnknown},interactWithDropElem:function(e,t){e.highlightElement(t)},doEmptyInteraction:function(e){},isSupportedDragAction:function(e){return this._aDragActions.has(e)},isSupportedDropAction:function(e){return this._aDropActions.has(e)}}),df.WebBaseUIObjectBase=df.mixin("df.WebDragDrop_Mixin","df.WebObject"),df.WebBaseUIObject=function(e,t){df.WebBaseUIObject.base.constructor.call(this,e,t),this.prop(df.tString,"psCSSClass",""),this.prop(df.tString,"psHtmlId",""),this.prop(df.tString,"psTextColor",""),this.prop(df.tString,"psBackgroundColor",""),this.prop(df.tBool,"pbRender",!0),this.prop(df.tBool,"pbVisible",!0),this.prop(df.tBool,"pbEnabled",!0),this.event("OnRender",df.cCallModeDefault),this.OnAfterRender=new df.events.JSHandler,this.OnAfterShow=new df.events.JSHandler,this.OnAfterHide=new df.events.JSHandler,this._eElem=null,this._bWrapDiv=!1,this._bRenderChildren=!1,this._bFocusAble=!1,this._sControlClass="",this._sBaseClass="WebUIObj",this._aKeyHandlers=[],this._bShown=!1},df.defineClass("df.WebBaseUIObject","df.WebBaseUIObjectBase",{openHtml:function(e){this._bWrapDiv&&(e.push('<div class="',this.genClass(),'"'),this.psHtmlId&&e.push(' id="',this.psHtmlId,'"'),e.push(' data-dfobj="',this.getLongName(),'"'),e.push(' tabindex="-1" style=" ',this.pbRender?"":"display: none;",this.pbVisible?"":"visibility: hidden;",'"'),e.push(">"))},closeHtml:function(e){this._bWrapDiv&&e.push("</div>")},render:function(){var e=[];return this.openHtml(e),this.closeHtml(e),this._eElem=df.dom.create(e.join("")),this.getRef(),this._bRenderChildren&&this.renderChildren(),this._eElem},getRef:function(){},afterRender:function(){this._bRenderChildren&&this.afterRenderChildren(),this._aKeyHandlers.length>0&&df.dom.on("keydown",this._eElem,this.onKeyDownHandler,this),this.fire("OnRender"),this.attachFocusEvents(),this.set_psTextColor(this.psTextColor),this.psBackgroundColor&&this.set_psBackgroundColor(this.psBackgroundColor),this.dragDropInit(),this.OnAfterRender.fire(this)},destroy:function(){df.WebBaseUIObject.base.destroy.call(this),this._eElem&&(df.dom.clear(this._eElem,!0),this._eElem.parentNode&&this._eElem.parentNode.removeChild(this._eElem)),this._eElem=null},afterShow:function(){var e;if(this._bShown=!0,this.OnAfterShow.fire(this),this._bRenderChildren)for(e=0;e<this._aChildren.length;e++)this._aChildren[e]instanceof df.WebBaseUIObject&&this._aChildren[e].pbRender&&this._aChildren[e].afterShow()},afterHide:function(){var e;if(this._bShown=!1,this.OnAfterHide.fire(this),this._bRenderChildren)for(e=0;e<this._aChildren.length;e++)this._aChildren[e]instanceof df.WebBaseUIObject&&this._aChildren[e].pbRender&&this._aChildren[e].afterHide()},attachFocusEvents:function(){},renderChildren:function(e){var t,i,s;for(e=e||this._eElem,t=0;t<this._aChildren.length;t++)(s=this._aChildren[t])instanceof df.WebBaseUIObject&&(i=s.render())&&e.appendChild(i)},afterRenderChildren:function(){var e;for(e=0;e<this._aChildren.length;e++)this._aChildren[e]instanceof df.WebBaseUIObject&&this._aChildren[e].afterRender()},isActive:function(){return this.pbRender&&this.pbVisible&&this.isEnabled()},isEnabled:function(){return!!this.pbEnabled&&(!(this._oParent instanceof df.WebBaseUIObject)||this._oParent.isEnabled())},updateEnabled:function(){var e;if(this.applyEnabled(this.isEnabled()),this._bRenderChildren)for(e=0;e<this._aChildren.length;e++)this._aChildren[e]instanceof df.WebBaseUIObject&&this._aChildren[e].updateEnabled()},applyEnabled:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,df.CssDisabled,!e),df.dom.toggleClass(this._eElem,df.CssEnabled,e))},genClass:function(){return this._sBaseClass+" "+this._sControlClass+" "+(this.isEnabled()?df.CssEnabled:df.CssDisabled)+(this.psCSSClass?" "+this.psCSSClass:"")},set_psTextColor:function(e){this._eElem&&(this._eElem.style.color=e||"")},set_psBackgroundColor:function(e){this._eElem&&(this._eElem.style.background=e||"")},set_pbVisible:function(e){this._eElem&&(this._eElem.style.visibility=e?"":"hidden")},set_pbRender:function(e){this._eElem&&(this._eElem.style.display=e?"":"none",this.pbRender!==e&&(this.pbRender=e,this.pbRender?this.afterShow():this.afterHide(),this.sizeChanged(!0)))},set_pbEnabled:function(e){e!==this.pbEnabled&&(this.pbEnabled=e,this.updateEnabled())},set_psCSSClass:function(e){this.psCSSClass=e,this._eElem&&(this._eElem.className=this.genClass())},set_psHtmlId:function(e){this._eElem&&(this._eElem.id=e)},addKeyHandler:function(e,t,i,s,o){var n,r;if(t=df.toInt(t),i=df.toBool(i),s=df.toBool(s),o=df.toBool(o),r=this.findKeyHandler(t,i,s,o)){for(n=0;n<r.aMsg.length;n++)if(r.aMsg[n]===e)return;r.aMsg.push(e)}else 0===this._aKeyHandlers.length&&this._eElem&&df.dom.on("keydown",this._eElem,this.onKeyDownHandler,this),this._aKeyHandlers.push({iKey:t,aMsg:[e],bShift:i,bAlt:s,bCtrl:o})},removeKeyHandler:function(e,t,i,s,o){var n,r;if(t=df.toInt(t),i=df.toBool(i),s=df.toBool(s),o=df.toBool(o),r=this.findKeyHandler(t,i,s,o)){for(n=0;n<r.aMsg.length;n++)r.aMsg[n]===e&&(r.aMsg.splice(n,1),n--);r.aMsg.length||this._aKeyHandlers.slice(r.iIndex,1)}0===this._aKeyHandlers.length&&this._eElem&&df.dom.off("keydown",this._eElem,this.onKeyDownHandler,this)},findKeyHandler:function(e,t,i,s,o){var n,r;for(n=0;n<this._aKeyHandlers.length;n++)if((r=this._aKeyHandlers[n]).iKey===e&&r.bShift===t&&r.bAlt===i&&r.bCtrl===s)return r.iIndex=n,r;return null},onKeyDownHandler:function(e){var t,i;if(t=this.findKeyHandler(e.getKeyCode(),e.getShiftKey(),e.getAltKey(),e.getCtrlKey())){for(this.getWebApp()._oCurrentObj&&this.getWebApp()._oCurrentObj!=this&&this.getWebApp()._oCurrentObj.validate&&this.getWebApp()._oCurrentObj.validate(),i=0;i<t.aMsg.length;i++)this.serverAction(t.aMsg[i],[t.iKey,df.fromBool(t.bShift),df.fromBool(t.bAlt),df.fromBool(t.bCtrl)]);e.stop()}},svrFocus:function(){this.focus()},updateFocus:function(e){e?this.objFocus():this.getWebApp()?.objBlur(this)},onFocus:function(e){this.updateFocus(!0)},onBlur:function(e){this.updateFocus(!1)},objFocus:function(){var e=this.getView(),t=this.getWebApp();e&&e.objFocus(this),t&&t.objFocus(this)},focus:function(e){return!!(this._bFocusAble&&this.isEnabled()&&this._eElem&&this._eElem.focus)&&(this._eElem.focus(),this.objFocus(),!0)},conditionalFocus:function(e){return df.sys.isMobile?!(!this._bFocusAble||!this.isEnabled()||(this.objFocus(),0)):this.focus(e)},scrollIntoView:function(e){this._eElem&&this._eElem.scrollIntoView(df.toBool(e))},focusNext:function(e){for(var t,i,s=this;t=s._oParent;){for(i=t._aChildren.indexOf(s)+1;i>0&&i<t._aChildren.length;i++)if(t._aChildren[i].focus(e))return!0;s=t}},sizeChanged:function(e){var t=this.getWebApp(),i=this;if(e&&(this._oParent&&this._oParent._bIsContainer&&(this._oParent._bPositionChanged=!0),this._bIsContainer&&(this._bPositionChanged=!0)),t)t.objSizeChanged(this),t.notifyLayoutChange(this);else{for(;i._oParent&&!(i instanceof df.WebBaseView||i instanceof df.WebApp);)i=i._oParent;i&&i.resize&&i.resize()}},fireSubmit:function(){return this._oParent&&this._oParent.fireSubmit&&this._oParent.fireSubmit()},makeVisible:function(){for(var e=this;e;)e instanceof df.WebCard&&e.show(),e=e._oParent},determineSelectorForWebUIContext:function(e){return null},verifyElementForWebUIContext:function(e,t){return!0},retrieveValueFromWebUIContext:function(e,t){return null},getDropData:function(e,t){return e&&e._eDropElem?{data:this.getControlValue&&this.getControlValue()||"",action:df.dropActions.WebTagsForm.ciDropOnControl}:null},initDropZones:function(){this.isSupportedDropAction(df.dropActions.WebControl.ciDropOnControl)&&this.addDropZone(this._eElem)},determineDropCandidate:function(e,t){return t.find((e=>e.supportsDropAction(this,df.dropActions.WebControl.ciDropOnControl)))?[this._eElem,df.dropActions.WebControl.ciDropOnControl]:[null,null]},determineDropPosition:function(e,t){return df.dropPositions.ciDropOn},interactWithDropElem:function(e,t){e.highlightElement()},doEmptyInteraction:function(e){return e.highlightElement(),df.dropActions.WebTagsForm.ciDropOnControl},hasData:function(){return!0},topLayer:function(){return this._oParent?.topLayer?.()||null},layoutType:function(){return this._oParent?.layoutType?.()||df.layoutType.ciLayoutTypeFlow}}),df.WebBaseContainer_mixin=function(e,t){this.getBase("df.WebBaseContainer_mixin").constructor.call(this,e,t),this.prop(df.tInt,"piColumnCount",1),this.prop(df.tInt,"piWidth",0),this.prop(df.tInt,"piMinWidth",0),this.prop(df.tInt,"piHeight",0),this.prop(df.tInt,"piMinHeight",0),this.prop(df.tBool,"pbScroll",!1),this.prop(df.tInt,"peLayoutType",df.layoutType.ciLayoutTypeFlow),this.prop(df.tInt,"piRowCount",0),this.prop(df.tString,"psRowHeights",""),this.prop(df.tInt,"piDefaultRowHeight",-1),this.prop(df.tString,"psColumnWidths",""),this.prop(df.tString,"psDefaultColumnWidth","1fr"),this._oRegionTop=null,this._oRegionLeft=null,this._oRegionCenter=null,this._oRegionRight=null,this._oRegionBottom=null,this._eRegionTop=null,this._eMainArea=null,this._eRegionLeft=null,this._eRegionCenter=null,this._eContent=null,this._eRegionRight=null,this._eRegionBottom=null,this._eContainer=null,this._aUIObjects=[],this._aPanels=[],this._aFloats=[],this._bHasFill=!1,this._iContentHeight=null,this._bRendered=!1,this._bPanels=!1,this._bPositionChanged=!0,this._bIsContainer=!0,this._iWantedHeight=null,this._bWantedChanged=!1,this._iWhiteSpaceHeight=0,this._aRowsTemplate=[],this._aColsTemplate=[],this._iTotalRowHeight=0,this._bRenderChildren=!0,this._sBaseClass="WebContainer"},df.defineClass("df.WebBaseContainer_mixin",{openHtml:function(e){this.getBase("df.WebBaseContainer_mixin").openHtml.call(this,e),this.wrpOpenHtml(e),e.push('<div class="WebCon_Sizer">')},closeHtml:function(e){this._bPanels?e.push('<div class="WebCon_Main">'):e.push('<div class="WebCon_Content'+(this.isGridLayout()?" WebCon_GridLayout":"")+'">'),e.push("</div></div>"),this.wrpCloseHtml(e),this.getBase("df.WebBaseContainer_mixin").closeHtml.call(this,e)},wrpOpenHtml:function(e){},wrpCloseHtml:function(e){},afterRender:function(){this.getBase("df.WebBaseContainer_mixin").afterRender.call(this),this._bRendered=!0,df.events.addDomListener("scroll",this._eElem,this.onScroll,this)},render:function(){var e;return this._bRenderChildren=!1,e=this.getBase("df.WebBaseContainer_mixin").render.call(this),this._bRenderChildren=!0,this._eSizer=df.dom.query(this._eElem,"div.WebCon_Sizer"),this._iLastInnerHeight=-1,this._bPanels?this._eMainArea=df.dom.query(this._eElem,"div.WebCon_Main"):this._eContent=df.dom.query(this._eElem,"div.WebCon_Content"),this._eContainer=df.dom.query(this._eElem,"div.WebContainer")||this._eElem,this.renderChildren(),this.position(),e},renderChildren:function(){var e,t;for(e=0;e<this._aFloats.length;e++)(t=this._aFloats[e].render())&&this._eSizer.appendChild(t);if(this._bPanels){if(this._aUIObjects.length>0)throw new df.Error(999,"Web controls and panels cannot be siblings within the same container object '{{0}}'. Consider placing them within a panel.",this,[this.getLongName()||"oWebApp"]);for(this._eMainArea.style.position="relative",this._eMainArea.appendChild(df.dom.create('<div style="clear: both;"></div>')),e=0;e<this._aPanels.length;e++)t=this._aPanels[e].render();this.placePanels(),this._bPositionChanged=!1}else{for(e=0;e<this._aUIObjects.length;e++)(t=this._aUIObjects[e].render())&&this._eContent.appendChild(t);this.isFlowLayout()&&this._eContent.appendChild(df.dom.create('<div style="clear: both;"></div>'))}},addChild:function(e){e instanceof df.WebBaseUIObject&&(e._bFloating?this._aFloats.push(e):void 0!==e.peRegion?(this._bPanels=!0,this._aPanels.push(e)):this._aUIObjects.push(e)),this.getBase("df.WebBaseContainer_mixin").addChild.call(this,e)},insertChild:function(e,t){e instanceof df.WebBaseUIObject&&(e._bFloating?this._aFloats.push(e):void 0!==e.peRegion?(this._bPanels=!0,this._aPanels.push(e)):this._aUIObjects.splice(t,0,e)),this.getBase("df.WebBaseContainer_mixin").insertChild.call(this,e,t)},renderChild:function(e,t){var i,s,o,n,r;if(t&&(r=!0),s=(n=this._aUIObjects.indexOf(e))>=1?this._aUIObjects[n-1]:null,i=t||e.render(),e instanceof df.WebPanel){switch(e.peRegion){case df.ciRegionBottom:this._eRegionBottom=i,this._oRegionBottom=e;break;case df.ciRegionCenter:this._eRegionCenter=i,this._oRegionCenter=e;break;case df.ciRegionLeft:this._eRegionLeft=i,this._oRegionLeft=e;break;case df.ciRegionRight:this._eRegionRight=i,this._oRegionRight=e;break;case df.ciRegionTop:this._eRegionTop=i,this._oRegionTop=e}this.placePanels()}else if(this._eContent&&i){if(null!==s)o=s._eElem.nextElementSibling;else if(o=this._eContent.firstElementChild)for(;!o.hasAttribute("data-dfobj")&&o.nextElementSibling;)o=o.nextElementSibling;this._eContent.insertBefore(i,o)}r||e.afterRender(),this.position(),this.getBase("df.WebBaseContainer_mixin").renderChild.call(this,e,t)},removeChild:function(e){var t;e instanceof df.WebBaseUIObject&&(e._bFloating?(t=this._aFloats.indexOf(e),this._aFloats.splice(t,1)):void 0!==e.peRegion?(t=this._aPanels.indexOf(e),0===this._aPanels.length&&(this._bPanels=!1),this._aPanels.splice(t,1)):(t=this._aUIObjects.indexOf(e),this._aUIObjects.splice(t,1))),this.getBase("df.WebBaseContainer_mixin").removeChild.call(this,e)},unrenderChild:function(e){var t;if(t=e._eElem,e instanceof df.WebPanel)switch(e.peRegion){case df.ciRegionBottom:this._eRegionBottom=null,this._oRegionBottom=null;break;case df.ciRegionCenter:this._eRegionCenter=null,this._oRegionCenter=null;break;case df.ciRegionLeft:this._eRegionLeft=null,this._oRegionLeft=null;break;case df.ciRegionRight:this._eRegionRight=null,this._oRegionRight=null;break;case df.ciRegionTop:this._eRegionTop=null,this._oRegionTop=null}else this._eContent.removeChild(t);this.position(),this.getBase("df.WebBaseContainer_mixin").unrenderChild.call(this,e)},placePanels:function(){var e,t,i;for(this._oRegionTop=null,this._oRegionLeft=null,this._oRegionCenter=null,this._oRegionRight=null,this._oRegionBottom=null,this._eRegionTop=null,this._eRegionLeft=null,this._eRegionCenter=null,this._eRegionRight=null,this._eRegionBottom=null,e=0;e<this._aPanels.length;e++)if((t=this._aPanels[e]).peRegion===df.ciRegionCenter){if(this._oRegionCenter)throw new df.Error(999,"The region setting (peRegion) in panel '{{0}}' is already used by panel '{{1}}'. Sibling panels may not share the same region setting.",this,[t._sName,this._oRegionCenter._sName]);this._oRegionCenter=t,this._eRegionCenter=i=t._eElem,i.parentNode!=this._eMainArea&&this._eMainArea.appendChild(i),i.style.position="absolute",i.style.top="0px",i.style.right="0px",i.style.left="0px",i.style.bottom="0px"}else if(t.peRegion===df.ciRegionTop){if(this._oRegionTop)throw new df.Error(999,"The region setting (peRegion) in panel '{{0}}' is already used by panel '{{1}}'. Sibling panels may not share the same region setting.",this,[t._sName,this._oRegionTop._sName]);this._oRegionTop=t,this._eRegionTop=i=t._eElem,i.parentNode==this._eMainArea.parentNode&&i.nextElementSibling==this._eMainArea||this._eMainArea.parentNode.insertBefore(i,this._eMainArea),i.style.position="",i.style.top="",i.style.left="",i.style.right="",i.style.bottom=""}else if(t.peRegion===df.ciRegionLeft){if(this._oRegionLeft)throw new df.Error(999,"The region setting (peRegion) in panel '{{0}}' is already used by panel '{{1}}'. Sibling panels may not share the same region setting.",this,[t._sName,this._oRegionLeft._sName]);this._oRegionLeft=t,this._eRegionLeft=i=t._eElem,i.parentNode!=this._eMainArea&&this._eMainArea.appendChild(i),i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.right="",i.style.bottom="0px"}else if(t.peRegion===df.ciRegionRight){if(this._oRegionRight)throw new df.Error(999,"The region setting (peRegion) in panel '{{0}}' is already used by panel '{{1}}'. Sibling panels may not share the same region setting.",this,[t._sName,this._oRegionRight._sName]);this._oRegionRight=t,this._eRegionRight=i=t._eElem,i.parentNode!=this._eMainArea&&this._eMainArea.appendChild(i),i.style.position="absolute",i.style.top="0px",i.style.left="",i.style.right="0px",i.style.bottom="0px"}else{if(t.peRegion!==df.ciRegionBottom)throw new df.Error(999,"Invalid value for peRegion of '{{0}}'",this,[t._sName]);if(this._oRegionBottom)throw new df.Error(999,"The region setting (peRegion) in panel '{{0}}' is already used by panel '{{1}}'. Sibling panels may not share the same region setting.",this,[t._sName,this._oRegionBottom._sName]);this._oRegionBottom=t,this._eRegionBottom=i=t._eElem,i.parentNode==this._eMainArea.parentNode&&i.previousElementSibling==this._eMainArea||this._eMainArea.parentNode.appendChild(i),i.style.position="",i.style.top="",i.style.left="",i.style.right="",i.style.bottom=""}},genClass:function(){var e=this.getBase("df.WebBaseContainer_mixin").genClass.apply(this,arguments);return this.pbScroll&&(e+=" WebScroll"),e},prepareSize:function(){var e,t,i=0,s=0,o=this._iWantedHeight;for(this._bStretch=!1,t=0;t<this._aFloats.length;t++)this._aFloats[t].prepareSize&&this._aFloats[t].prepareSize();if(this._bPanels)this._bPositionChanged&&(this.placePanels(),this._bPositionChanged=!1),this._oRegionTop&&this._oRegionTop.pbRender&&(i+=this._oRegionTop.prepareSize()),this._oRegionCenter&&this._oRegionCenter.pbRender&&(s=this._oRegionCenter.prepareSize(),this._bStretch=this._oRegionCenter._bStretch||this._bStretch),this._oRegionLeft&&this._oRegionLeft.pbRender&&(s=(e=this._oRegionLeft.prepareSize())>s?e:s,this._bStretch=this._oRegionLeft._bStretch||this._bStretch),this._oRegionRight&&this._oRegionRight.pbRender&&(s=(e=this._oRegionRight.prepareSize())>s?e:s,this._bStretch=this._oRegionRight._bStretch||this._bStretch),i+=s,this._oRegionBottom&&this._oRegionBottom.pbRender&&(i+=this._oRegionBottom.prepareSize()),i+=this.getHeightDiff(!0,!0,!0,!0);else{for(this._bPositionChanged&&(this.position(),this._iContentHeight=null,this._bPositionChanged=!1),t=0;t<this._aChildren.length;t++)!this._aChildren[t].prepareSize||this._aChildren[t]instanceof df.WebBaseView||this._aChildren[t].prepareSize();this._bHasFill?this.isGridLayout()?i=1:(this._iContentHeight||this.resizeColumnLayout(),i+=this._iContentHeight+this.getHeightDiff(!0,!0,!0,!0)):i+=df.dom.clientHeight(this._eContent)+this.getHeightDiff(!0,!0,!0,!1)}return this._iMinHeight=i,this instanceof df.WebPanel&&this.piHeight>0&&(this.peRegion==df.ciRegionBottom||this.peRegion==df.ciRegionTop)?this._iWantedHeight=this.piHeight:this._iWantedHeight=i>this.piMinHeight?i:this.piMinHeight,this._bWantedChanged=o!==this._iWantedHeight,this.peRegion!==df.ciRegionTop&&this.peRegion!==df.ciRegionBottom&&(this.piHeight<=0&&this._bHasFill||this instanceof df.WebBaseView&&this.pbFillHeight)&&(this._bStretch=!0),this._bSizePrep=!0,this._iWantedHeight},resizeHorizontal:function(){var e,t=0;if(this._eElem)for(this._bPanels?(this._oRegionLeft&&(t=this._oRegionLeft.piWidth>0?this._oRegionLeft.piWidth:this._oRegionRight&&this._oRegionRight.pbRender?(this._eMainArea.clientWidth-(this._oRegionRight.piWidth||this._eMainArea.clientWidth/3))/2:this._eMainArea.clientWidth/2,this._oRegionLeft.setOuterWidth(t),this._eRegionCenter&&(this._eRegionCenter.style.left=this._oRegionLeft.pbRender?t+"px":"0px")),this._oRegionRight&&(t=this._oRegionRight.piWidth>0?this._oRegionRight.piWidth:this._oRegionLeft&&this._oRegionLeft.pbRender?(this._eMainArea.clientWidth-(this._oRegionLeft.piWidth||this._eMainArea.clientWidth/3))/2:this._eMainArea.clientWidth/2,this._oRegionRight.setOuterWidth(t),this._eRegionCenter&&(this._eRegionCenter.style.right=this._oRegionRight.pbRender?t+"px":"0px"))):this.updateMinWidth(),e=0;e<this._aChildren.length;e++)this._aChildren[e]instanceof df.WebBaseUIObject&&!(this._aChildren[e]instanceof df.WebBaseView)&&this._aChildren[e].pbRender&&this._aChildren[e].resizeHorizontal&&this._aChildren[e].resizeHorizontal()},resizeVertical:function(){var e,t,i,s,o,n=0,r=0,a=0,l=0,h=0,d=!1;if(this._eElem){for(this._bSizePrep||this.prepareSize(),this._bStretch||this instanceof df.WebPanel&&(this.peRegion===df.ciRegionLeft||this.peRegion===df.ciRegionCenter||this.peRegion===df.ciRegionRight)?(d=!0,(e=df.dom.clientHeight(this._eContainer)+this.getHeightDiff(!0,!1,!1,!1))<this._iMinHeight&&(e=this._iMinHeight)):e=this._iWantedHeight,e<this.piMinHeight&&(e=this.piMinHeight,d=!0),this._bPanels?(i=e,this._oRegionTop&&this._oRegionTop.pbRender&&((s=this._oRegionTop._iWantedHeight)>i&&(e=e+this._oRegionTop._iWantedHeight-i,i=s),i-=s,this._oRegionTop.setOuterHeight(s)),this._oRegionBottom&&this._oRegionBottom.pbRender&&((s=this._oRegionBottom._iWantedHeight)>i&&(e=e+s-i,i=s),i-=s,this._oRegionBottom.setOuterHeight(s)),n=i-this.getHeightDiff(!0,!0,!0,!0),this._oRegionLeft&&this._oRegionLeft.pbRender&&(l=this._oRegionLeft._iWantedHeight),this._oRegionCenter&&this._oRegionCenter.pbRender&&(a=this._oRegionCenter._iWantedHeight),this instanceof df.WebApp&&(a=this._oCurrentView&&this._oCurrentView._iWantedHeight||0),this._oRegionRight&&this._oRegionRight.pbRender&&(h=this._oRegionRight._iWantedHeight),r=Math.max(l,a,h),(t=d||this._oRegionLeft&&this._oRegionLeft._bStretch||this._oRegionCenter||this._oRegionRight&&this._oRegionRight._bStretch?n:r)>0&&(this._eMainArea.style.height=t+"px"),this._iMiddleHeight=t):(this.isFlowLayout()&&this.resizeColumnLayout(),this.setInnerHeight(e)),o=0;o<this._aChildren.length;o++)this._aChildren[o]instanceof df.WebBaseUIObject&&!(this._aChildren[o]instanceof df.WebBaseView)&&this._aChildren[o].pbRender&&(this._aChildren[o].resizeVertical?this._aChildren[o].resizeVertical():this._aChildren[o].resize&&this._aChildren[o].resize());this._bSizePrep=!1}},setOuterHeight:function(e){e-=this.getHeightDiff(!0,!1,!1,!1),this._eElem.style.height=e>0?e+"px":""},setInnerHeight:function(e){e>0?e!==this._iLastInnerHeight&&(this._iLastInnerHeight=e,e-=this.getHeightDiff(!0,!0,!1,!1),this._eSizer.style.minHeight=e>0?e+"px":""):this._iLastInnerHeight>0&&(this._iLastInnerHeight=e,this._eSizer.style.minHeight="")},setOuterWidth:function(e){e-=df.sys.gui.getHorizBoxDiff(this._eElem,1),this._eElem.style.width=e>0?e+"px":""},setInnerWidth:function(e){e-=df.sys.gui.getHorizBoxDiff(this._eElem,0),e-=df.sys.gui.getHorizBoxDiff(this._eSizer,1),this._eSizer.style.width=e>0?e+"px":""},updateMinWidth:function(){let e=this.piMinWidth;e-=df.sys.gui.getHorizBoxDiff(this._eElem,0),e-=df.sys.gui.getHorizBoxDiff(this._eSizer,1),this._eSizer.style.minWidth=e>0?e+"px":""},resizeColumnLayout:function(){var e,t,i,s,o,n,r,a,l,h=0,d=0,p=0,u=[],f=this.piColumnCount;if(df.sys.isIE&&df.sys.iVersion<=8&&(h=3),this._bHasFill){for(t=0;t<this._aUIObjects.length;t++)if((e=this._aUIObjects[t]).pbRender){const t=-1==e.piColumnIndex?0:e.piColumnIndex;if(l=(a=t+e.piColumnSpan<=f?t:0)+e.piColumnSpan>f||e.piColumnSpan<=0?f-a:e.piColumnSpan,(d>a||d+l>f)&&(r?(r.iHeight=p,u.push(r),r=null):h+=p,p=0,d=0),e.pbFillHeight)r?r.aItems.push(e):r={aItems:[e],iHeight:0},p<(s=e.getMinHeight?e.getMinHeight():e.piMinHeight)&&(p=s);else{const t=df.dom.offsetHeight(e._eElem);t>p&&(p=t)}d=a+(l||1)}for(r?(r.iHeight=p,u.push(r)):h+=p,this._iContentHeight=h,(o=df.dom.clientHeight(this._eContainer))<this.piMinHeight&&(o=this.piMinHeight),o-=this.getHeightDiff(!1,!0,!0,!0),o-=h,o-=this._iWhiteSpaceHeight,t=0;t<u.length;t++){for(r=u[t],n=o/(u.length-t),n--,this._iContentHeight=this._iContentHeight+r.iHeight,n<r.iHeight&&(n=r.iHeight),i=0;i<r.aItems.length;i++)r.aItems[i].sizeHeight(n);o-=n}}},layoutType:function(){return this.peLayoutType==df.layoutType.ciLayoutTypeInherit?this._oParent?.layoutType?.()||df.layoutType.ciLayoutTypeFlow:this.peLayoutType},isFlowLayout:function(){return this.layoutType()==df.layoutType.ciLayoutTypeFlow},isGridLayout:function(){return this.layoutType()==df.layoutType.ciLayoutTypeGrid},position:function(){this.isFlowLayout()||this._bPanels?this.positionFlow():this.positionGrid()},positionGrid:function(){let e,t,i,s,o,n=this.piColumnCount,r=[],a=[],l=df.dom.query(this._eElem,".WebCon_Content");if(!l)return;l.style.display="grid";let h=this.parsePsColumnWidths();for(let e=0;e<n;e++){let t={iIndex:e,sWidth:-1,eType:df.rowColValType.ciTypeDefault},i=h.find((t=>t.iIndex==e));if(i){let e=i.sWidth;t.sWidth=e,t.eType=i.eType}a.push(t)}let d=this.getDefaultColumnWidth();0==h.length?l.style.gridTemplateColumns="repeat("+n+", "+d+")":l.style.gridTemplateColumns=a.map((e=>{switch(e.eType){case df.rowColValType.ciTypeDefault:return d;case df.rowColValType.ciTypeFixed:return e.sWidth+"px";case df.rowColValType.ciTypeFraction:case df.rowColValType.ciTypeOther:return e.sWidth;default:return d}})).join(" ");let p="minmax("+this.getDefaultRowHeight()+"px, max-content)";l.style.gridAutoRows=p;let[u,f]=this.sortChildren(this._aUIObjects);f<this.piRowCount&&(f=this.piRowCount);let c=[];if(this.psRowHeights&&""!=this.psRowHeights){let e;[c,e]=this.parsePsRowHeights(),f<=e&&(f=e+1)}for(let e=0;e<f;e++){let t={iIndex:e,sHeight:-1,eType:df.rowColValType.ciTypeDefault},i=c.find((t=>t.iIndex==e));i&&(t.sHeight=i.sHeight,t.eType=i.eType),r.push(t)}this._aRowsTemplate=r,this._aColsTemplate=a,this._bHasFill=!1,l.style.gridTemplateRows=r.map((e=>{switch(e.eType){case df.rowColValType.ciTypeDefault:return p;case df.rowColValType.ciTypeFixed:return e.sHeight+"px";case df.rowColValType.ciTypeFraction:return this._bHasFill=!0,e.sHeight;case df.rowColValType.ciTypeOther:return e.sHeight;default:return p}})).join(" "),u.forEach((r=>{r._eElem&&r.pbRender&&r instanceof df.WebBaseControl&&(e=r.piColumnIndex+r.piColumnSpan<=n?r.piColumnIndex:0,i=e+r.piColumnSpan>n||r.piColumnSpan<=0?n-void 0:r.piColumnSpan,t=e>-1?r.piColumnIndex+1:"auto",s=r.piRowIndex>-1?r.piRowIndex+1:"auto",i=r.piColumnSpan>0?r.piColumnSpan:1,o=r.piRowSpan>0?r.piRowSpan:1,r._eElem.style.gridColumn=t+" / span "+i,r._eElem.style.gridRow=s+" / span "+o)}))},determineRowHeights:function(){let e=[],t=df.dom.query(this._eElem,".WebCon_Content");if(!t)return;let i=window.getComputedStyle(t).gridTemplateRows.split(" ");for(let t=0;t<i.length;t++)e.push(parseFloat(i[t]));return e},determineColumnWidths:function(){let e=[],t=df.dom.query(this._eElem,".WebCon_Content");if(!t)return;let i=window.getComputedStyle(t).gridTemplateColumns.split(" ");for(let t=0;t<i.length;t++)e.push(parseFloat(i[t]));return e},parsePsColumnWidths:function(){let e=[];try{if(this.psColumnWidths&&""!=this.psColumnWidths){let t=this.psColumnWidths.split(" ");for(let i=0;i<t.length;i++){let s=t[i].split("/"),o=df.rowColValType.ciTypeOther;s[1].includes("fr")?o=df.rowColValType.ciTypeFraction:df.sys.math.isNumeric(s[1])&&(o=df.rowColValType.ciTypeFixed),e.push({iIndex:parseInt(s[0]),sWidth:s[1],eType:o})}}}catch(e){throw new df.Error(999,"Unable to parse psColumnWidths, check the documentation for more info on the correct format",this,[])}return e},parsePsRowHeights:function(){let e=0,t=[];try{let i=this.psRowHeights.split(" ");for(let s=0;s<i.length;s++){let o=i[s].split("/");if(o.length>=2){let i=parseInt(o[0]),s=df.rowColValType.ciTypeOther;o[1].includes("fr")?s=df.rowColValType.ciTypeFraction:df.sys.math.isNumeric(o[1])&&(s=df.rowColValType.ciTypeFixed),t.push({iIndex:i,sHeight:o[1],eType:s}),i>e&&(e=i)}}}catch(e){throw new df.Error(999,"Unable to parse psRowHeights, check the documentation for more info on the correct format",this,[])}return[t,e]},sortChildren:function(e){return[e.sort(((e,t)=>e.piRowIndex>t.piRowIndex?1:e.piRowIndex<t.piRowIndex?-1:0)),1]},getDefaultRowHeight:function(){return this.piDefaultRowHeight>-1?this.piDefaultRowHeight:20},getDefaultColumnWidth:function(){return""!=this.psDefaultColumnWidth.trim()?this.psDefaultColumnWidth:"1fr"},positionFlow:function(){var e,t,i,s,o=0,n=this.piColumnCount;if(n<=0)throw new df.Error(999,"Invalid column count on '{{0}}'",this,[this.getLongName()||"oWebApp"]);for(this._bHasFill=!1,e=0;e<this._aUIObjects.length;e++){if((t=this._aUIObjects[e])._eElem&&t.pbRender&&t instanceof df.WebBaseControl){const e=-1==t.piColumnIndex?0:t.piColumnIndex;s=(i=e+(t.piColumnSpan||1)<=n?e:0)+t.piColumnSpan>n||t.piColumnSpan<=0?n-i:t.piColumnSpan,t._eElem.style.styleFloat="left",t._eElem.style.cssFloat="left",o>i||o+s>n?(t._eElem.style.clear="left",o=0):t._eElem.style.clear="none",t._eElem.style.marginLeft=Math.floor(1e4/n)/100*(i-o)+"%",o=i+(s||1),t._eElem.style.width=s===n?"100%":Math.floor(1e4/n)/100*s+"%"}this._bHasFill=this._bHasFill||t.pbFillHeight}},getRequiredHeight:function(){return this._bSizePrep||this.prepareSize(),this._bSizePrep=!1,this._iWantedHeight},getHeightDiff:function(e,t,i,s){var o=0;return e&&this._eContainer&&(o+=df.sys.gui.getVertBoxDiff(this._eContainer,3)),t&&(this._eContainer&&(o+=df.sys.gui.getVertBoxDiff(this._eContainer,2),o+=this._eContainer.offsetHeight-this._eContainer.clientHeight),this._eSizer&&(o+=df.sys.gui.getVertBoxDiff(this._eSizer,1))),i&&(this._eSizer&&(o+=df.sys.gui.getVertBoxDiff(this._eSizer,2)),this._eMainArea&&(o+=df.sys.gui.getVertBoxDiff(this._eMainArea,2)),this._eContent&&(o+=df.sys.gui.getVertBoxDiff(this._eContent,1))),s&&this._eContent&&(o+=df.sys.gui.getVertBoxDiff(this._eContent,2),o+=1),o},getWidthDiff:function(e,t,i,s){var o=0;return e&&this._eElem&&(o+=df.sys.gui.getHorizBoxDiff(this._eElem,0)),(e||t)&&this._eContainer&&(o+=df.sys.gui.getHorizBoxDiff(this._eContainer,e&&t?0:e?1:2)),(t||i)&&this._eSizer&&(o+=df.sys.gui.getHorizBoxDiff(this._eSizer,t&&i?0:t?1:2)),i&&this._eMainArea&&(o+=df.sys.gui.getHorizBoxDiff(this._eMainArea,2)),(i||s)&&this._eContent&&(o+=df.sys.gui.getHorizBoxDiff(this._eContent,i&&s?0:i?1:2)),o},getContentWidthDiff:function(){var e=0;return this._eContent&&(e+=df.sys.gui.getHorizBoxDiff(this._eContent)),e},onScroll:function(e){var t=this.getWebApp();t&&t.notifyScroll(this)},focus:function(e){var t;for(t=0;t<this._aChildren.length;t++)if(this._aChildren[t].focus&&this._aChildren[t].focus(e))return!0;return!1},conditionalFocus:function(e){var t;for(t=0;t<this._aChildren.length;t++)if(this._aChildren[t].conditionalFocus&&this._aChildren[t].conditionalFocus(e))return!0;return!1},set_piWidth:function(e){this.piWidth=e,this._eElem&&this.sizeChanged()},set_piHeight:function(e){this.piHeight=e,this._eElem&&this.sizeChanged()},set_piMinHeight:function(e){this.piMinHeight=e,this._eElem&&this.sizeChanged()},set_piMinWidth:function(e){this.piMinWidth=e,this._eElem&&this.sizeChanged()},set_piColumnCount:function(e){this.piColumnCount=e,this._eElem&&this.sizeChanged(!0)},set_psRowHeights:function(e){this.psRowHeights=e,this._eElem&&this.sizeChanged(!0)},set_psColumnWidths:function(e){this.psColumnWidths=e,this._eElem&&this.sizeChanged(!0)},set_psBackgroundColor:function(e){this._eContainer&&(this._eContainer.style.background=e||"")},set_pbScroll:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,"WebScroll",e),this.sizeChanged())}}),df.WebBaseContainer=df.mixin("df.WebBaseContainer_mixin","df.WebBaseUIObject"),df.WebBaseControl=function(e,t){df.WebBaseControl.base.constructor.call(this,e,t),this.prop(df.tInt,"piColumnIndex",0),this.prop(df.tInt,"piColumnSpan",1),this.prop(df.tInt,"piRowSpan",1),this.prop(df.tInt,"piRowIndex",0),this.prop(df.tBool,"pbShowLabel",!0),this.prop(df.tString,"psLabel",""),this.prop(df.tInt,"peLabelPosition",0),this.prop(df.tInt,"peLabelAlign",-1),this.prop(df.tInt,"piLabelOffset",-1),this.prop(df.tString,"psLabelColor",""),this.prop(df.tString,"psToolTip",""),this.prop(df.tBool,"pbFillHeight",!1),this.prop(df.tInt,"piHeight",-1),this.prop(df.tInt,"piMinHeight",0),this.event("OnFocus",df.cCallModeDefault),this.event("OnBlur",df.cCallModeDefault),this._eInner=null,this._eLbl=null,this._eControlWrp=null,this._eControl=null,this._oInfoBalloon=null,this._oObserver=null,this._sControlId=df.dom.genDomId(),this._bFocusAble=!0,this._bHasFocus=!1,this._sBaseClass="WebControl",this._bJSSizing=!0},df.defineClass("df.WebBaseControl","df.WebBaseUIObject",{openHtml:function(e){e.push('<div class="',this.genClass(),'"'),this.psHtmlId&&e.push(' id="',this.psHtmlId,'"'),e.push(' data-dfobj="',this.getLongName(),'"'),e.push(' style=" ',this.pbRender?"":"display: none;",this.pbVisible?"":"visibility: hidden;",'"'),e.push(">"),this.pbShowLabel?(e.push('<div class="WebCon_Inner ',this.pbFillHeight?"WebCon_FillRow":"",'">'),this.peLabelPosition!=df.ciLabelRight&&e.push(this.genLabelHtml())):e.push('<div class="WebCon_Inner ',this.pbFillHeight?"WebCon_FillRow":"",'">'),e.push("<div>")},genClass:function(){return df.WebBaseControl.base.genClass.call(this)+(this.pbFillHeight?" Web_FillHeight":"")+(this._bJSSizing?" Web_JS_Sizing":"")},closeHtml:function(e){e.push("</div>"),this.pbShowLabel&&this.peLabelPosition==df.ciLabelRight&&e.push(this.genLabelHtml()),e.push("</div></div>")},genLabelHtml:function(){let e=[];return df.sys.isMobile?e.push("<label>",df.dom.encodeHtml(this.psLabel),"</label>"):e.push('<label for="',this._sControlId,'" class="',this.peLabelPosition==df.ciLabelFloat&&""==this.psValue?"WebCon_Unfloat":"WebCon_Float",'" >',df.dom.encodeHtml(this.psLabel),"</label>"),e.join("")},afterRender:function(){this._eInner=df.dom.query(this._eElem,"div.WebCon_Inner"),this._eControlWrp=df.dom.query(this._eElem,"div.WebCon_Inner > div"),this.pbShowLabel&&(this._eLbl=df.dom.query(this._eElem,"div > label")),df.WebBaseControl.base.afterRender.call(this),this._eLbl&&df.dom.on("click",this._eLbl,this.onLblClick,this),this.posLabel(!0),this.set_psLabelColor(this.psLabelColor),this.set_peLabelAlign(this.peLabelAlign),this.set_psToolTip(this.psToolTip),(this._bJSSizing||this.piHeight>0)&&this.sizeHeight(-1),this._oInfoBalloon&&(this._oInfoBalloon.init(),this._bShowInfoBallon&&this._oInfoBalloon.show()),this.initObserver()},afterShow:function(){df.WebBaseControl.base.afterShow.call(this),this.initObserver()},afterHide:function(){df.WebBaseControl.base.afterHide.call(this),this.destroyObserver()},destroy:function(){df.WebBaseControl.base.destroy.call(this),this._eLbl=null,this._eControlWrp=null,this._eInner=null,this._eControl=null,this._oInfoBalloon&&(this._oInfoBalloon.destroy(),this._oInfoBalloon=null),this.destroyObserver()},onLblClick:function(e){df.sys.isMobile||this.focus()},set_psLabel:function(e){this._eLbl&&(e||(e=" "),df.dom.setText(this._eLbl,e))},set_pbShowLabel:function(e){this.pbShowLabel=e,this.posLabel(!1),this.sizeChanged()},set_psLabelColor:function(e){this._eLbl&&(this._eLbl.style.color=e)},set_peLabelAlign:function(e){this._eLbl&&(this._eLbl.style.textAlign=e===df.ciAlignLeft?"left":e===df.ciAlignCenter?"center":e===df.ciAlignRight?"right":"")},set_piLabelOffset:function(e){this.piLabelOffset=e,this.posLabel(!1),this.sizeChanged()},set_peLabelPosition:function(e){this.peLabelPosition=e,this.posLabel(!1),this.sizeChanged()},set_psToolTip:function(e){this._eControl&&(this._eControl.title=e)},set_piColumnIndex:function(e){this.piColumnIndex!==e&&(this.piColumnIndex=e,this.sizeChanged(!0))},set_piColumnSpan:function(e){this.piColumnSpan!==e&&(this.piColumnSpan=e,this.sizeChanged(!0))},set_psTextColor:function(e){this._eControl&&(this._eControl.style.color=e||"")},set_psBackgroundColor:function(e){this._eControl&&(this._eControl.style.background=e||"")},set_piMinHeight:function(e){this._eControl&&this.piMinHeight!==e&&(this.piMinHeight=e,this.sizeChanged())},set_piHeight:function(e){this._eControl&&this.piHeight!==e&&(this.piHeight=e,this.sizeChanged())},set_pbFillHeight:function(e){this._eControl&&(df.dom.toggleClass(this._eElem,"Web_FillHeight",e),this.pbFillHeight!==e&&(this.pbFillHeight=e,this.sizeChanged(!0)),this.initObserver())},initObserver:function(){this._bJSSizing&&this.isInGridContainer()&&this.pbFillHeight?this.createObserver():this.destroyObserver()},createObserver:function(){this._eElem&&!this._oObserver&&(this._oObserver=new ResizeObserver((e=>{let t=e[0]?.contentRect.height;t||(t=this._eElem.getBoundingClientRect()?.height||0),this.sizeHeight(t)})),this._oObserver.observe(this._eElem))},destroyObserver:function(){this._oObserver&&(this._oObserver.disconnect(),this._oObserver=null)},sizeChanged:function(e){this._eControl&&!this.pbFillHeight&&this.sizeHeight(-1),df.WebBaseControl.base.sizeChanged.call(this,e)},sizeHeight:function(e){var t=-1,i=!1;if(this.pbFillHeight?(t=e,i=e>0):this.piHeight>0&&(t=this.piHeight,i=!0),t<this.piMinHeight&&(t=this.piMinHeight,i=i||!this.pbFillHeight),this.setHeight(t,i),t>0)return t},setHeight:function(e,t){this._eControl&&(e>0?(e=(e-=this.getVertHeightDiff())<0?0:e,this._eControl.style.height=e+"px"):this._eControl.style.height="")},getVertHeightDiff:function(){var e=0;return this.peLabelPosition!==df.ciLabelTop&&this.peLabelPosition!==df.ciLabelFloat||!this._eLbl||(e+=this._eLbl.offsetHeight),e+=df.sys.gui.getVertBoxDiff(this._eInner),e+=df.sys.gui.getVertBoxDiff(this._eControlWrp),e+=df.sys.gui.getVertBoxDiff(this._eControl)},posLabel:function(e){var t,i=this.peLabelPosition,s=this.piLabelOffset,o="",n="";if(this._eElem){if(e||df.dom.removeClass(this._eInner,"WebCon_HasLabel WebCon_TopLabel WebCon_RightLabel WebCon_LeftLabel"),this.pbShowLabel){switch(this._eLbl||(df.sys.isMobile?this._eLbl=df.dom.create("<label>&nbsp;</label>"):this._eLbl=df.dom.create('<label for="'+this._sControlId+'" class="'+(this.peLabelPosition==df.ciLabelFloat&&""==this.psValue?"unfloat":"float")+'">&nbsp;</label>'),this.set_psLabel(this.psLabel),this.set_psLabelColor(this.psLabelColor),this.set_peLabelAlign(this.peLabelAlign),this._eInner.insertBefore(this._eLbl,this._eInner.firstChild),df.dom.on("click",this._eLbl,this.onLblClick,this)),e||df.dom.addClass(this._eInner,"WebCon_HasLabel"),i){case df.ciLabelLeft:t="WebCon_LeftLabel",s>0&&(o=`${s}px minmax(0, 1fr)`);break;case df.ciLabelTop:s>0&&(n=`${s}px minmax(0, 1fr)`),t="WebCon_TopLabel";break;case df.ciLabelFloat:t="WebCon_TopLabel WebCon_FloatEnabled";break;case df.ciLabelRight:t="WebCon_RightLabel",s>0&&(o=`minmax(0, 1fr) ${s}px`)}df.dom.addClass(this._eInner,t)}else this._eLbl&&(df.dom.off("click",this._eLbl,this.onLblClick,this),this._eLbl.parentNode.removeChild(this._eLbl),this._eLbl=null);this._eInner.style.gridTemplateColumns=o,this._eInner.style.gridTemplateRows=n}},getTooltipElem:function(){return this._eControlWrp},showInfoBalloon:function(e,t,i){i=df.toBool(i),this._oInfoBalloon?(this._oInfoBalloon.psCssClass=e,this._oInfoBalloon.psMessage=t,this._oInfoBalloon.update()):this._oInfoBalloon=new df.InfoBalloon(this,e,t),this._eElem?(this._oInfoBalloon.init(),i&&this._oInfoBalloon.show()):this._bShowInfoBallon=i},hideInfoBalloon:function(){this._oInfoBalloon&&this._oInfoBalloon.hide()},resize:function(){this._oInfoBalloon&&this._oInfoBalloon.resize(),this._aChildren.forEach((function(e){e.resize&&e.resize()}))},isInGridContainer:function(){return this._oParent?.isGridLayout?.()},focus:function(){if(this._bFocusAble&&this.isEnabled()&&this._eControl&&this._eControl.focus){try{this._eControl.focus()}catch(e){}return this.objFocus(),!0}return!1},attachFocusEvents:function(){df.dom.on("focusin",this._eElem,this.onFocus,this),df.dom.on("focusout",this._eElem,this.onBlur,this)},updateFocus:function(e){df.WebBaseControl.base.updateFocus.call(this,e),df.dom.toggleClass(this._eElem,"WebCon_Focus",e),e?this.fire("OnFocus"):this.fire("OnBlur"),this._bHasFocus=e}}),df.WebBaseDEO=function(e,t){df.WebBaseDEO.base.constructor.call(this,e,t),this.prop(df.tString,"psValue",""),this.prop(df.tBool,"pbChanged",!1),this.prop(df.tInt,"peDataType",df.ciTypeText),this.prop(df.tInt,"piPrecision",0),this.prop(df.tInt,"piMaxLength",0),this.prop(df.tBool,"pbCapslock",!1),this.prop(df.tBool,"pbRequired",!1),this.prop(df.tBool,"pbLimitDateRange",!0),this.prop(df.tInt,"peAlign",-1),this.prop(df.tString,"psMask",""),this.event("OnAutoFind",df.cCallModeDefault),this.event("OnChange",df.cCallModeDefault),this.event("OnValidate",df.cCallModeDefault),this._tValue=null,this._sOrigValue="",this._sPrevChangeVal=null,this._bValueInvalid=!1,this._bMasks=!0,this._oMask=null,this._bAutoFind=!1,this._bReplaceDecSepp=!1,this._oErrorBalloon=null,this._aErrors=[],this.addSync("psValue"),this.addSync("pbChanged")},df.defineClass("df.WebBaseDEO","df.WebBaseControl",{afterRender:function(){this._bRendering=!0,df.WebBaseDEO.base.afterRender.call(this);var e=this.psValue;this.set_peDataType(this.peDataType),this.set_psValue(e),this.set_pbCapslock(this.pbCapslock),this.set_peAlign(this.peAlign),df.dom.enableTextSelection(this._eControlWrp),this._eControl&&(df.dom.on("change",this._eControl,this.onChange,this),df.events.addDomKeyListener(this._eControl,this.onKey,this),df.dom.enableTextSelection(this._eControl)),this.updateErrorDisp(),this._bRendering=!1},destroy:function(){this._oErrorBalloon&&(this._oErrorBalloon.destroy(),this._oErrorBalloon=null),this._oMask&&(this._oMask.detach(),this._oMask=null),df.WebBaseDEO.base.destroy.call(this)},attachFocusEvents:function(){this._eControl&&(df.dom.on("focus",this._eControl,this.onFocus,this),df.dom.on("blur",this._eControl,this.onBlur,this))},applyEnabled:function(e){df.WebBaseDEO.base.applyEnabled.call(this,e),this._eControl&&(this._eControl.disabled=!e,df.dom.setTabIndex(this._eControl,e?0:-1))},get_pbChanged:function(){return!this.pbChanged&&this._eElem&&this.updateTypeVal(),this.pbChanged||this._sOrigValue!==this.getServerVal()},set_psValue:function(e){this._tValue=df.sys.data.serverToType(e,this.peDataType),this.psValue=e,this._sPrevChangeVal=this._sOrigValue=this.getServerVal(),this.refreshDisplay(this._tValue),this._bRendering||this.hideAllControlErrors()},get_psValue:function(){return this._eElem&&this.updateTypeVal(),this._bValueInvalid?this._sOrigValue:this.getServerVal()},set_peDataType:function(e,t){var i;this._eControl&&(t&&(i=this.get_psValue()),this.peDataType=e,this.initMask(),t&&this.set_psValue(i),df.dom.removeClass(this._eControl,"dfData_BCD dfData_Date dfDate_Text"),e===df.ciTypeBCD?df.dom.addClass(this._eControl,"dfData_BCD"):e===df.ciTypeDate?df.dom.addClass(this._eControl,"dfData_Date"):df.dom.addClass(this._eControl,"dfData_Text"))},set_psMask:function(e){this.updateTypeVal(),this.psMask=e,this.initMask(),this.refreshDisplay(this._tValue)},set_pbCapslock:function(e){this._eControl&&df.dom.toggleClass(this._eControl,"Web_Uppercase",e)},set_peAlign:function(e){this._eControl&&(this._eControl.style.textAlign=df.sys.gui.cssTextAlign(e))},refreshDisplay:function(e){var t;this._eElem&&(t=this.typeToDisplay(e),this.setControlValue(t))},serverToType:function(e){return df.sys.data.serverToType(e,this.peDataType)},typeToDisplay:function(e){return df.sys.data.typeToDisplay(e,this.peDataType,this.getWebApp(),this._bHasFocus,this.psMask,this.piPrecision)},dateFormat:function(){return this.getWebApp().psDateFormat},dateTimeFormat:function(){return this.getWebApp().psDateTimeFormat},timeFormat:function(){return this.getWebApp().psTimeFormat},dateSep:function(){return this.getWebApp().psDateSeparator},decSep:function(){return this.getWebApp().psDecimalSeparator},thousSep:function(){return this.getWebApp().psThousandsSeparator},timeSep:function(){return this.getWebApp().psTimeSeparator},updateTypeVal:function(){var e=this.getControlValue();this.pbCapslock&&(e=e.toUpperCase()),this._bValueInvalid=!1,this.peDataType===df.ciTypeText&&this.psMask?this.psValue=this._tValue=this.clearWinMask(e):!this._bHasFocus&&this.psMask||(this.psValue=e,this.peDataType===df.ciTypeBCD?(this._tValue=df.sys.data.stringToNum(e,this.decSep(),this.thousSep()),isNaN(this._tValue)&&(this._tValue=0)):this.peDataType===df.ciTypeDate?(this._tValue=df.sys.data.stringToDate(e,this.dateFormat(),this.dateSep()),this._bValueInvalid=!this.validateDateRange(this._tValue)):this.peDataType===df.ciTypeDateTime?this._tValue=df.sys.data.stringToDate(e,this.dateTimeFormat(),this.dateSep(),this.timeSep()):this.peDataType===df.ciTypeTime?this._tValue=df.sys.data.stringToDate(e,this.timeFormat(),this.dateSep(),this.timeSep()):this._tValue=e)},validateDateRange:function(e){return!e||!this.pbLimitDateRange||e.getFullYear()<=2500&&e.getFullYear()>=1},getServerVal:function(){if(null!==this._tValue){if(this.peDataType===df.ciTypeBCD)return this._tValue.toString();if(this.peDataType===df.ciTypeDate)return this._tValue instanceof Date&&df.sys.data.dateToString(this._tValue,"yyyy/mm/dd","-")||"";if(this.peDataType===df.ciTypeDateTime)return this._tValue instanceof Date&&df.sys.data.dateToString(this._tValue,"yyyy/mm/ddThh:mm:ss.fff","-",":")||"";if(this.peDataType===df.ciTypeTime)return this._tValue instanceof Date&&df.sys.data.dateToString(this._tValue,"hh:mm:ss","-",":")||""}return this.psValue},getControlValue:function(){return this._eControl?this._eControl.value:this.psValue},setControlValue:function(e){this._eControl&&this._eControl.value!==e&&(this._eControl.value=e)},initMask:function(){this._bMasks&&this._eControl&&(this._oMask&&(this._oMask.detach(),this._oMask=null),this.peDataType===df.ciTypeBCD?this._oMask=this.genNumMask():this.peDataType===df.ciTypeDate||this.peDataType===df.ciTypeDateTime||this.peDataType===df.ciTypeTime?this._oMask=this.genDateMask(this.peDataType):this.peDataType===df.ciTypeText&&this.psMask&&(this._oMask=this.genWinMask(this.psMask)))},genWinMask:function(e){let t=[];const i=this;for(let i=0;i<e.length;i++){const s=e.charAt(i);"\\"===s&&i+1<this.sMask.length&&("#"===e.charAt(i+1)||"@"===e.charAt(i+1)||"!"===e.charAt(i+1)||"*"===e.charAt(i+1))?(i++,t.push({bEnter:!1,bNumeric:!1,bAlpha:!1,bPunct:!1,sChar:e.charAt(i+1)})):t.push({bEnter:"#"===s||"@"===s||"!"===s||"*"===s,bNumeric:"#"===s||"*"===s,bAlpha:"@"===s||"*"===s,bPunct:"!"===s||"*"===s,sChar:s})}function s(e){var i,s,o,n,r,a;if(e.isKeyPrintable()){for(a=n=this._eControl.value,i=(r=df.dom.getSelection(this._eControl)).start,o=e.key(),r.length>0&&(n=n.substr(0,r.start)+n.substr(r.end)),s=i;s<t.length&&!t[s].bEnter;)n.length<=s&&(n+=t[s].sChar),s++;n!==a&&(this._eControl.value=n),i!==s&&s<t.length&&(df.dom.setCaretPosition(this._eControl,s),i=s),(i>=t.length||!df.sys.data.acceptWinMaskChar(o,t[i].sChar))&&e.stop()}}function o(e){let i=0,s="",o=0;const n=this._eControl.value;for(let e=0;e<n.length&&i<t.length;e++){const o=n.charAt(e);t[i].bEnter?df.sys.data.acceptWinMaskChar(o,t[i].sChar)&&(s+=o,i++):(s+=t[i].sChar,i++)}if(e.inputIsInsert())for(;i<t.length&&!t[i].bEnter;)s+=t[i].sChar,i++,o++;if(s!==this._eControl.value){const e=df.dom.getCaretPosition(this._eControl);this._eControl.value=s,df.dom.setCaretPosition(this._eControl,e+o)}}return df.dom.on("keydown",this._eControl,s,this),df.dom.on("input",this._eControl,o,this),{clearVal:function(e){let i=0,s="";for(;i<e.length&&i<t.length;)(t[i].bEnter||e.charAt(i)!==t[i].sChar)&&(s+=e.charAt(i)),i++;return s},detach:function(){i._eControl&&(df.dom.off("keydown",i._eControl,s,i),df.dom.off("input",i._eControl,o,i))}}},clearWinMask:function(e){return this._oMask?this._oMask.clearVal(e):e},genDateMask:function(e){let t,i=null;const s=this;function o(){let s;s=e===df.ciTypeDateTime?this.dateTimeFormat():e===df.ciTypeTime?this.timeFormat():this.dateFormat();const o=this.dateSep(),n=this.timeSep(),r=s.match(/([^mdyhsf]+)|([mdyhsf]+)/gi)||[];let a="";t=[],r.forEach((function(e){let i={oNext:null,bVal:!0};switch(e.toLowerCase()){case"yyyy":i.iMax=4,a+="(\\d{1,4})?";break;case"dd":case"mm":case"yy":case"hh":case"ss":i.iMax=2,a+="(\\d{1,2})?";break;case"fff":i.iMax=3,a+="(\\d{1,3})?";break;default:i.bVal=!1,i.sText=e.replace("/",o).replace(":",n),i.iMax=i.sText.length,a+="(\\D{1"+(i.iMax>1?","+i.iMax:"")+"})?"}t.length&&(t[t.length-1].oNext=i),t.push(i)})),i=new RegExp(a,"")}function n(e){const s=i.exec(e);let o=0,n=!1;t.forEach((function(e,t){e.iStart=o,e.sVal=s[t+1]||"",e.sVal?(o+=e.sVal.length,e.bFound=!0):(n=!0,e.bFound=!1),e.bDirty=n,e.iEnd=o,e.bAdd=!1}))}function r(e){if(e.isKeyPrintable()){let i=!1,s=0;const o=e.key(),r=df.dom.getSelection(this._eControl),a=r.start,l=-1!=="0123456789".indexOf(o);let h=this._eControl.value;r.length>0&&(h=h.substr(0,r.start)+h.substr(r.end));const d=a==h.length;n(h);let p=t[0];for(;p.oNext&&p.iEnd<a;)p=p.oNext;if(d)if(l)if(p.bVal&&p.sVal.length<p.iMax)i=!0;else{for(p=p.oNext;p&&!p.bVal;)p.bAdd=!p.bFound,p=p.oNext;i=p&&p.bVal}else p.bVal&&p.sVal.length>0&&p.oNext&&(p=p.oNext,p.bVal||p.sText.charAt(0)!=o||(i=!0));else if(l)p.bVal?p.sVal.length<p.iMax&&(i=!0):p.iEnd==a&&p.oNext?(p=p.oNext,i=p.bVal&&p.sVal.length<p.iMax):p.bDirty&&(i=!0);else if(p.bVal&&p.sVal.length>0&&a-p.iStart>0&&a-p.iStart<=p.iMax&&p.oNext&&(p=p.oNext,!p.bVal&&p.sText.charAt(0)==o))if(p.bFound){let e=p.oNext;for(;e;)e.bVal||e.bFound||e.sText!=p.sText||(i=!0),e=e.oNext}else i=!0;if(t.reduce((function(e,t){return e||t.bAdd}),!1)){let e="";t.forEach((function(t){t.bVal?e+=t.sVal:(t.bFound||t.bAdd)&&(e+=t.sText,s+=t.sText.length-t.sVal.length)})),this._eControl.value=e}s&&df.dom.setCaretPosition(this._eControl,a+s),i||e.stop()}}function a(e){if(e.inputIsInsert()){let e=0;const i=df.dom.getSelection(this._eControl).start,s=this._eControl.value;n(s);let o="";t.forEach((function(t){t.bVal?o+=t.sVal:(t.bFound||t.oNext&&t.oNext.bFound)&&(o+=t.sText,e+=t.sText.length-t.sVal.length)})),o!==s&&(this._eControl.value=o,df.dom.setCaretPosition(this._eControl,i+e))}}return o.call(this),df.dom.on("focus",this._eControl,o,this),df.dom.on("keydown",this._eControl,r,this),df.dom.on("input",this._eControl,a,this),{detach:function(){s._eControl&&(df.dom.off("keydown",s._eControl,r,s),df.dom.off("input",s._eControl,a,s),df.dom.off("focus",s._eControl,o,s))}}},genNumMask:function(){let e,t,i,s;const o=this;function n(){e=this.decSep(),t=e+".,",s=this.piPrecision,i=this.piMaxLength-this.piPrecision}let r,a,l,h,d;function p(e){r=!1,a="",l=!1,h=0,d="";for(let o=0;o<e.length;o++){const n=e.charAt(o);-1!=="0123456789".indexOf(n)?!l&&a.length<i?a+=n:s>0&&d.length<s&&(d+=n):"-"==n?r=!0:-1!=t.indexOf(n)&&s>0&&(l=!0,h=o)}}function u(o){if(o.isKeyPrintable()){let n=!1,u=!1,f=0;const c=o.key(),g=df.dom.getSelection(this._eControl),b=g.start,_=-1!=="0123456789".indexOf(c),m=this._eControl.value;let C=m;g.length>0&&(C=C.substr(0,g.start)+C.substr(g.end));const w=b==C.length;p(C),_?!l||b<=h?a.length<i?(r&&0==b&&(f+=1),n=!0):w&&!l&&s>0&&(l=!0,u=!0,f+=1,n=!0):d.length<s&&(n=!0):"-"==c?0==b&&(r?f+=1:n=!0):-1!=t.indexOf(c)&&!l&&s>0&&(n=!0),u&&(C=(r?"-":"")+a+(l?e:"")+d,m!=C&&(this._eControl.value=C)),(f||u)&&df.dom.setCaretPosition(this._eControl,b+f),n||o.stop()}}function f(t){const i=df.dom.getSelection(this._eControl).start,s=this._eControl.value;p(s);let o=(r?"-":"")+a+(l?e:"")+d;o!==s&&(this._eControl.value=o,df.dom.setCaretPosition(this._eControl,i))}return n.call(this),df.dom.on("focus",this._eControl,n,this),df.dom.on("keydown",this._eControl,u,this),df.dom.on("input",this._eControl,f,this),{detach:function(){o._eControl&&(df.dom.off("keydown",o._eControl,u,o),df.dom.off("input",o._eControl,f,o),df.dom.off("focus",o._eControl,n,o))}}},validate:function(){var e,t=!0;return this.pbRequired&&(e=this.get_psValue(),this.peDataType===df.ciTypeBCD&&0===parseFloat(e)||""===e?(t=!1,this.showControlError(13,this.getWebApp().getTrans("err_entry_required"))):this.hideControlError(13)),this.peDataType===df.ciTypeDate&&(this.updateTypeVal(),this.validateDateRange(this._tValue)?this.hideControlError(16):(t=!1,this.showControlError(16,this.getWebApp().getTrans("err_enter_valid_date")))),t&&(this.fireChange(),this.fireAutoFind(),this.fire("OnValidate",[],(function(e){e.bServer?"0"===e.sReturnValue?this.selectAndFocus?this.selectAndFocus():this.focus():this.hideAllControlErrors():e.bCanceled&&(t=!1)}))),t},onKey:function(e){e.matchKey(df.settings.formKeys.tabOut)&&(this.validate()||e.stop())},updateFocus:function(e){df.WebBaseDEO.base.updateFocus.call(this,e),e||(this.updateTypeVal(),this.fireAutoFind()),this.refreshDisplay(this._tValue)},fireChange:function(){var e;this.updateTypeVal(),e=this.getServerVal(),this._sPrevChangeVal!==e&&(this.pbChanged=!0,this.fire("OnChange",[e,this._sPrevChangeVal]),this._bAutoFind=!0,this._sPrevChangeVal=e)},fireAutoFind:function(){this._bAutoFind&&(this.fire("OnAutoFind"),this._bAutoFind=!1)},onChange:function(e){this.fireChange()},showControlError:function(e,t){var i;for(e=parseInt(e,10),i=0;i<this._aErrors.length;i++)if(this._aErrors[i].iNumber===e)return this._aErrors[i].sText=t,void this.updateErrorDisp();this._aErrors.push({iNumber:e,sText:t}),this.updateErrorDisp()},hideControlError:function(e){var t;for(e=df.toInt(e),t=0;t<this._aErrors.length;t++)if(this._aErrors[t].iNumber===e){this._aErrors.splice(t,1),this.updateErrorDisp();break}},hideAllControlErrors:function(){this._aErrors=[],this.updateErrorDisp()},updateErrorDisp:function(){var e,t=[];if(this._aErrors.length>0){for(this.makeVisible(),e=0;e<this._aErrors.length;e++)e>0&&t.push("<br>"),t.push(this._aErrors[e].sText);this._oErrorBalloon?(this._oErrorBalloon.psMessage=t.join(""),this._oErrorBalloon.update()):this._oErrorBalloon=new df.InfoBalloon(this,"WebErrorTooltip",t.join("")),this._oErrorBalloon.show(),this.getErrorElem()&&df.dom.addClass(this.getErrorElem(),"WebError"),this.focus()}else this._oErrorBalloon&&(this._oErrorBalloon.hide(),df.dom.removeClass(this.getErrorElem(),"WebError"))},getErrorElem:function(){return this._eElem},resize:function(){df.WebBaseDEO.base.resize.call(this),this._oErrorBalloon&&this._oErrorBalloon.resize()}}),df.WebBaseForm=function(e,t){df.WebBaseForm.base.constructor.call(this,e,t),this.prop(df.tBool,"pbReadOnly",!1),this.prop(df.tString,"psAutoComplete","off"),this.event("OnKey",df.cCallModeDefault),this.event("OnInput",df.cCallModeDefault)},df.defineClass("df.WebBaseForm","df.WebBaseDEO",{afterRender:function(){df.WebBaseForm.base.afterRender.apply(this,arguments),this.set_pbReadOnly(this.pbReadOnly),df.dom.on("keydown",this._eControl,this.onKeyDownSrv,this),df.dom.on("input",this._eControl,this.onInputSrv,this),this._eLbl&&this.peLabelPosition===df.ciLabelFloat&&(this.floatLabel(!1),df.dom.on("click",this._eLbl,this.onFocus,this),this.checkAutoFill())},initMask:function(){df.WebBaseForm.base.initMask.call(this),this._eControl&&(this.peDataType!==df.ciTypeText||this.psMask?this._eControl.maxLength=1048576:this._eControl.maxLength=this.piMaxLength>0?this.piMaxLength:0)},set_pbReadOnly:function(e){this._eControl&&(this._eControl.readOnly=e,df.dom.toggleClass(this._eElem,"Web_ReadOnly",e))},set_piMaxLength:function(e){this.piMaxLength=e,this.initMask()},set_psAutoComplete:function(e){this._eControl&&(this._eControl.autocomplete=e)},set_peLabelPosition:function(e){this.peLabelPosition=e,this.posLabel(!1),this._eLbl&&(df.dom.off("click",this._eLbl,this.onFocus,this),e===df.ciLabelFloat&&(df.dom.on("click",this._eLbl,this.onFocus,this),this.floatLabel(!1)))},onKeyDownSrv:function(e){this.fire("OnKey",[df.fromBool(e.isKeyPrintable()),e.key()])},onInputSrv:function(e){this.fire("OnInput",[e.inputIsInsert(),e.e.inputType||"Undefined"])},updateFocus:function(e){df.WebBaseForm.base.updateFocus.call(this,e),this.peLabelPosition===df.ciLabelFloat&&this.floatLabel(e)},floatLabel:function(e){""!=this.getControlValue()||e&this.isEnabled()||this.matchSelector(this._eControl,":-webkit-autofill")?null!=this._eLbl&&(df.dom.addClass(this._eLbl,"WebCon_Float"),df.dom.removeClass(this._eLbl,"WebCon_Unfloat")):null!=this._eLbl&&(df.dom.addClass(this._eLbl,"WebCon_Unfloat"),df.dom.removeClass(this._eLbl,"WebCon_Float"))},setControlValue:function(e){df.WebBaseForm.base.setControlValue.call(this,e),this._eControl&&this.peLabelPosition===df.ciLabelFloat&&this.floatLabel(this._bHasFocus)},checkAutoFill:function(){var e=this,t=20;!function i(){t--,e._eControl&&e.matchSelector(e._eControl,":-webkit-autofill")?e.floatLabel(!1):t>0&&setTimeout(i,100)}()},matchSelector:function(e,t){return!!df.sys.isChrome&&(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)}}),df.dragdrop=function(){var e,t=[],i=[],s=!1,o=0,n=new Set;function r(){i.forEach((function(e){var t=e.oDetails=e.oObj.getDropDetails();e.eZone.style.width=t.oRect.width+"px",e.eZone.style.height=t.oRect.height+"px",e.eZone.style.left=t.oRect.left+"px",e.eZone.style.top=t.oRect.top+"px"}))}function a(){s&&(i.forEach((function(e){e.eZone.parentNode.removeChild(e.eZone),e.eZone=null})),n.forEach((function(e){e.cleanupHelper()})),i=[],s=!1,o=0,clearInterval(e))}function l(a){o++,s||u(a.e)&&(s||(t.forEach((function(e){var t,s=e.getDropDetails();s&&((t=df.dom.create('<div data-dropzone="yes" class="WebDropZone '+s.sDropClass+'"><div>'+s.sDropContent+"</div></div>")).style.width=s.oRect.width+"px",t.style.height=s.oRect.height+"px",t.style.left=s.oRect.left+"px",t.style.top=s.oRect.top+"px",document.body.appendChild(t),i.push({oObj:e,oDetails:s,eZone:t}))})),e=setInterval(r,300),s=!0),n.forEach((e=>{e.onFileDrag(a)}))),s=!0,a.stop()}function h(e){for(var t=e.getTarget();t&&t!==document.body;){if(t.hasAttribute("data-dropzone"))return e.e.dataTransfer.dropEffect="copy",void e.stop();t=t.parentNode}e.e.dataTransfer.dropEffect="none",e.stop()}function d(e){for(var t=e.getTarget();t&&t!==document.body&&!t.hasAttribute("data-dropzone");)t=t.parentNode;t&&i.forEach((function(i){if(i.eZone===t)return i.oObj.handleDrop(e),a(),e.stop(),!1}))}function p(e){--o<=0&&(a(),o=0)}function u(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1}return df.dom.ready((function(){df.dom.on("dragenter",document,l,window),df.dom.on("dragover",document,h,window),df.dom.on("drop",document,d,window),df.dom.on("dragleave",document,p,window)}),window),{addHandler:function(e){t.push(e)},remHandler:function(e){for(var i;(i=t.indexOf(e))>=0;)t.splice(i,1)},registerHelper:function(e){n.add(e)},removeHelper:function(e){n.remove(e)},containsFiles:u,stopDropZones:a}}(),df.uploadFiles=function(e){var t,i,s,o,n,r,a=[];function l(){var t,i,a=!0,h=null;if(!n){for(t=0;t<s.length;t++)if(!s[t].bFinished){if(h){a=!1;break}h=s[t],i=t}!function(t,i,a){if(e.displayProgress.call(o,i,s.length,0,t.oFile.size,e.iLoaded,e.iTotal),o.getWebApp()instanceof df.LocalApp&&window.chrome?.webview?.postMessageWithAdditionalObjects)o.serverActionEx({sMethod:"DoHandleLocalFileUpload",aParams:[t.sResourceId],tData:null,fHandler:()=>{e.iLoaded+=t.oFile.size,e.displayProgress.call(o,i,s.length,t.oFile.size,t.oFile.size,e.iLoaded,e.iTotal),t.bFinished=!0,a(!0)},oHandlerEnv:null,oPlatformSpecific:{aAdditionalObjects:[t.oFile]}});else{let l,h;r=h=new XMLHttpRequest,h.upload.addEventListener("progress",(function(t){var n=e.iLoaded+t.loaded;n=n<e.iTotal?n:e.iTotal,e.displayProgress.call(o,i,s.length,t.loaded,t.total,n,e.iTotal)}),!1),h.onreadystatechange=function(i){try{if(h.readyState===df.ajax.REQUEST_STATE_COMPLETE){if(!n){if(201!==h.status)throw new df.Error(999,"Received HTTP error '{{0}} {{1}}' while uploading file.",this,[h.status,h.statusText],h.responseText);t.bFinished=!0,e.iLoaded+=t.oFile.size,a(!0),h.onreadystatechange=null}h=null}}catch(e){a(!1),o.getWebApp().handleError(e),h=null}},h.open("POST",o.psUploadUrl,!0),l=new FormData,l.append("hash",t.sResourceId),l.append("v","html5"),l.append("file",t.oFile),h.send(l)}}(h,i,(function(t){var i;if(t){if(a&&e.displayFinishWorking.call(o),o.pbNotifyIndividualFile)o.serverAction("DoFileFinished",[h.oFile.name,h.sResourceId],null,(function(e){h.sFinishedResult=e.sReturnValue,a||l()}),o);else if(a)for(i=0;i<s.length;i++)o.serverAction("DoFileFinished",[s[i].oFile.name,s[i].sResourceId],null,(function(e){h.sFinishedResult=e.sReturnValue}));else l();a&&(o.fire("OnUploadFinished",[],(function(t){e.displayFinished.call(o,!0),e.finished&&e.finished.call(o,!0,s)})),o.processUpload=null)}else o._eControl&&(o._eControl.value=""),e.displayFinished.call(o,!1)}))}}if(s=e.aFiles,o=e.oWO,e.iTotal=0,e.iLoaded=0,i=function(){},e.displayStartWorking=e.displayStartWorking||i,e.displayProgress=e.displayProgress||i,e.displayFinishWorking=e.displayFinishWorking||i,e.displayFinished=e.displayFinished||i,e.cancel=function(){n=!0,s=[],r&&r.abort(),e.displayFinished.call(o,!1)},!(s&&s.length>0))throw new df.Error(999,"No file details found to start upload.",this);for(t=0;t<s.length;t++){const i=s[t].oFile;a.push([t,i.name||"Unknown",i.size||0,i.type||"Unknown"]),e.iTotal+=i.size||0}e.displayStartWorking.call(o),o.doStartUpload((function(t){var i,r=JSON.parse(t.sReturnValue);for(i=0;i<r.length;i++){if(!(r[i].length>=2&&s[r[i][0]]))throw new df.Error(999,"Received invalid resource id from the server.",this);s[r[i][0]].sResourceId=r[i][1]}for(e.iTotal=0,e.iLoaded=0,i=0;i<s.length;i++)s[i].sResourceId?e.iTotal+=s[i].oFile.size:(s.splice(i,1),i--);s.length>0?(n=!1,l()):e.displayFinished.call(o,!1)}),a)},df.uploadFilesProgressDialog=function(e){var t,i,s,o,n,r,a,l,h,d,p;let u=(p=e.oWO).getWebApp().getTrans("files"),f=p.getWebApp().getTrans("file");function c(t){e.cancel()}e.displayStartWorking=function(){var g=df.dom.windowWidth();(t=new df.WebModalDialog(null,p)).psCaption=p.getWebApp().getTrans("file_cap_uploading"),t.pbShowClose=this.pbAllowCancel,t.piMinWidth=g>520?500:g-20,t.OnEscape.addListener(c,this),(i=new df.WebPanel(null,t)).peRegion=df.ciRegionCenter,i.piColumnCount=10,t.addChild(i),(s=new df.WebLabel(null,i)).psCaption=f+":",s.piColumnSpan=2,s.peAlign=df.ciAlignRight,i.addChild(s),(o=new df.WebLabel(null,i)).psCaption="...",o.piColumnSpan=0,o.piColumnIndex=2,i.addChild(o),(s=new df.WebLabel(null,i)).psCaption=p.getWebApp().getTrans("file_remain")+":",s.piColumnSpan=2,s.peAlign=df.ciAlignRight,i.addChild(s),(n=new df.WebLabel(null,i)).psCaption=e.aFiles.length+" "+u+" ("+df.sys.data.markupDataSize(e.iTotal)+")",n.piColumnSpan=0,n.piColumnIndex=2,i.addChild(n),r=new df.WebSpacer(null,i),i.addChild(r),p.pbMultiFile&&((a=new df.WebProgressBar(null,i)).piMaxValue=e.iTotal>0?e.iTotal:e.aFiles.length,i.addChild(a)),l=new df.WebProgressBar(null,i),i.addChild(l),p.pbAllowCancel&&((h=new df.WebPanel(null,t)).peRegion=df.ciRegionBottom,h.piColumnCount=12,t.addChild(h),(d=new df.WebButton(null,h)).psCaption=p.getWebApp().getTrans("cancel"),d.piColumnIndex=9,d.piColumnSpan=3,d.OnClick.addListener(c,this),h.addChild(d)),t.show(),p.getWebApp().ready((function(){t.resize(),d&&d.focus()}))},e.displayProgress=function(t,i,s,r,h,d){o.set("psCaption",e.aFiles[t]&&e.aFiles[t].oFile&&e.aFiles[t].oFile.name||"");let f=i-(t+1),c=d-h;n.set("psCaption",f>0?f.toString()+" "+u+" ("+df.sys.data.markupDataSize(c)+")":df.sys.data.markupDataSize(c)),p.pbMultiFile&&(a.set("piMaxValue",d),a.set("piValue",h)),l.set("piMaxValue",r),l.set("piValue",s)},e.displayFinishWorking=function(){l.set("piValue",l.get("piMaxValue")),p.pbMultiFile&&a.set("piValue",a.get("piMaxValue")),n.set("psCaption","0 KB")},e.displayFinished=function(e){t&&(t.hide(),t.destroy(),t.OnEscape.removeListener(c,this),d&&d.OnClick.removeListener(c,this),t=null)},df.uploadFiles(e)},df.WebFileUpload_Mixin=function(e,t){this.getBase("df.WebFileUpload_Mixin").constructor.call(this,e,t),this.prop(df.tBool,"pbShowDialog",!0),this.prop(df.tBool,"pbCapture",!1),this.prop(df.tString,"psAccept",""),this.event("OnUploadFinished",df.cCallModeWait)},df.defineClass("df.WebFileUpload_Mixin",{initFiles:function(e){var t;if(!this._bUploading){for(this._aFiles=[],t=0;t<e.length&&(this.pbMultiFile||this._aFiles.length<1);t++)this.validate(e[t])&&this._aFiles.push({bFinished:!1,sResourceId:null,oFile:e[t]});this._aFiles.length>0&&(this.displaySelectedFileDetails(),this.pbAutoStart&&this.startUpload())}},validate:function(e){var t,i,s,o,n,r=!1;if(this.psAccept){for(t=this.psAccept.toLowerCase().split(","),i=0;i<t.length;i++)if("."===(s=t[i].trim()).charAt(0)){if(e.name.substr(e.name.lastIndexOf("."),s.length).toLowerCase()===s)return!0;r=!0}else if(e.type&&(o=s.split("/"),n=e.type.split("/"),o.length>1&&n.length>1&&(o[0]===n[0]||"*"===o[0])&&(o[1]===n[1]||"*"===o[1])))return!0;return!e.type&&!r}return!0},startUpload:function(){var e={oWO:this,aFiles:this._aFiles,finished:function(e,t){this._eInput&&(this._eInput.value="")},displayStartWorking:this.displayStartWorking,displayProgress:this.displayProgress,displayFinishWorking:this.displayFinishWorking,displayFinished:this.displayFinished};this.pbShowDialog?df.uploadFilesProgressDialog(e):df.uploadFiles(e)},doStartUpload:function(e,t){this.serverAction("DoStartUpload",[],df.sys.vt.serialize(t),e)},processUpload:function(){},displaySelectedFileDetails:function(){},displayStartWorking:function(){},displayProgress:function(e,t,i,s,o,n){},displayFinishWorking:function(){},displayFinished:function(e){},set_psAccept:function(e){this._eInput&&(this._eInput.accept=e)},set_pbCapture:function(e){this._eInput&&(this._eInput.capture=e)}}),df.WebFileUploadBase=df.mixin("df.WebFileUpload_Mixin","df.WebBaseControl"),df.WebBaseFileUpload=function(e,t){df.WebBaseFileUpload.base.constructor.call(this,e,t),this.prop(df.tBool,"pbMultiFile",!1),this.prop(df.tBool,"pbAutoStart",!0),this.prop(df.tBool,"pbAllowCancel",!0),this.prop(df.tBool,"pbNotifyIndividualFile",!1),this.prop(df.tString,"psDropZoneObjName",""),this._oDragArea=null,this._eDragArea=null},df.defineClass("df.WebBaseFileUpload","df.WebFileUploadBase",{fileHtml:function(e){e.push('<div style="display: none">'),e.push('<input type="file" name="',this._sName,'" id="',this._sControlId,'"',this.pbMultiFile?" multiple":"",' accept="',this.psAccept,'"',this.pbCapture?" capture":"",">"),e.push("</div>")},afterRender:function(){this._eInput=df.dom.query(this._eElem,'input[type="file"]'),df.WebBaseFileUpload.base.afterRender.call(this),df.dom.on("change",this._eInput,this.onFileChange,this)},selectFiles:function(){if(!(window.File&&window.FileList&&window.FileReader))throw new df.Error(999,"HTML5 Upload is not supported by this browser.",this);this._eInput.click()},afterShow:function(){df.WebBaseFileUpload.base.afterShow.call(this),df.dragdrop.addHandler(this)},afterHide:function(){df.WebBaseFileUpload.base.afterHide.call(this),df.dragdrop.remHandler(this)},getDropDetails:function(){var e,t,i=this.getWebApp();return this.isEnabled()&&(e=i.findObj(this.psDropZoneObjName))instanceof df.WebBaseUIObject&&(t=e===i?document.body:e._eElem)?{sDropContent:this.getWebApp().getTrans("file_drop"),sDropClass:"",oRect:t.getBoundingClientRect()}:null},handleDrop:function(e){var t;(t=e.e.dataTransfer&&e.e.dataTransfer.files||null)&&t.length>0&&(e.stop(),this.initFiles(t))},onFileChange:function(e){this._eInput.files.length>0&&this.initFiles(this._eInput.files),e.stop()}}),df.tWebMenuItem={sId:df.tString,sCaption:df.tString,sTooltip:df.tString,sGroupCaption:df.tString,bEnabled:df.tBool,sCSSClass:df.tString,sHtmlId:df.tString,bBeginGroup:df.tBool,sImage:df.tString,eCheckbox:df.tInt,sTextColor:df.tString,sBackgroundColor:df.tString,eActionDisplay:df.tString,aChildren:[]},df.tWebMenuItem.aChildren.push(df.tWebMenuItem),df.WebMenuProvider_mixin=function(e,t){this.getBase("df.WebMenuProvider_mixin").constructor.apply(this,arguments),this.prop(df.tBool,"pbAllowHtml"),this.prop(df.tString,"psGroupName"),this.OnUiUpdate=new df.events.JSHandler,this._aMenu=null,this._aDynamicMenu=null,this._bIsMenuProv=!0,this._bIsMenuListener=!1},df.defineClass("df.WebMenuProvider_mixin",{create:function(){this.getBase("df.WebMenuProvider_mixin").create.apply(this,arguments),this.psGroupName&&(this.getHub().addProvider(this.psGroupName,this),this._bIsMenuListener&&this.getHub().addListener(this.psGroupName,this))},destroy:function(){this.psGroupName&&(this._bIsMenuListener&&this.getHub().remListener(this.psGroupName,this),this.getHub().remProvider(this.psGroupName,this)),this.getBase("df.WebMenuProvider_mixin").destroy.call(this)},groupCollect:function(e){return this.genMenuData(e)},groupUpdate:function(e){this._aMenu=e,this.updatePaths(),this.refreshMenu()},genMenuData:function(e){var t,i;if(this._aDynamicMenu)for(t=this._aDynamicMenu,i=0;i<t.length;i++)t[i]._oHandler=this,e.push(t[i]);!function e(t,i){var s,o,n;for(n=0;n<t._aChildren.length;n++)(s=t._aChildren[n])instanceof df.WebMenuItem&&s.visible()&&(o={sId:"",hRef:s,sCaption:s.psCaption,sTooltip:s.psToolTip,sGroupCaption:s.psGroupCaption,bEnabled:s.isEnabled(),sCSSClass:s.cssClass(),sHtmlId:s.psHtmlId,bBeginGroup:s.pbBeginGroup,sImage:s.psImage,eCheckbox:s instanceof df.WebMenuItemCheckbox?s.isChecked()?1:-1:0,sTextColor:s.psTextColor,sBackgroundColor:s.psBackgroundColor,eActionDisplay:s.peActionDisplay,aChildren:[],_bCustomRender:s.customRender(),_oHandler:s},i.push(o),e(s,o.aChildren))}(this,e)},set_psGroupName:function(e){this.psGroupName&&this.getHub().remProvider(this.psGroupName,this),this.getHub().addProvider(this.psGroupName,this)},set_pbAllowHtml:function(e){this.pbAllowHtml=e,this.refreshMenu()},deserializeVT:df.sys.vt.generateDeserializer([df.tWebMenuItem]),refresh:function(){var e,t=this.deserializeVT(this._tActionData);for(e=0;e<t.length;e++)this.initDynamic(t[e]);this._aDynamicMenu=t,this.notifyChange()},itemClick:function(e,t,i){return e.aChildren.length>0?(t.call(i,!1),!1):this.fire("OnItemClick",[e.sId,e.sCaption],(function(e){t.call(i,e.bClient||e.bServer)}))},updateItem:function(e,t){var i,s;s=df.sys.vt.deserialize(this._tActionData,df.tWebMenuItem),(i=this.getItemById(e))&&(i.sId=s.sId,i.sCaption=s.sCaption,i.sTooltip=s.sToolTip,i.sGroupCaption=s.sGroupCaption,i.bEnabled=s.bEnabled,i.sCSSClass=s.sCSSClass,i.sHtmlId=s.sHtmlId,i.bBeginGroup=s.bBeginGroup,i.sImage=s.sImage,i.eCheckbox=s.eCheckbox,i.sTextColor=s.sTextColor,i.sBackgroundColor=s.sBackgroundColor,i.eActionDisplay=s.eActionDisplay,df.toBool(t)&&(i.aChildren=s.aChildren,this.initDynamic(i)),this.notifyChange())},insertItem:function(e){var t,i;i=df.sys.vt.deserialize(this._tActionData,df.tWebMenuItem),(t=this.getItemById(e))&&(this.initDynamic(i),t.aChildren.push(i),this.notifyChange())},removeItem:function(e){(function t(i){for(var s=0;s<i.length;s++){if(i[s].sId===e)return i.splice(s,1),!0;if(t(i[s].aChildren))return!0}return!1})(this._aDynamicMenu)&&this.notifyChange()},initDynamic:function(e){var t;for(e._oHandler=this,t=0;t<e.aChildren.length;t++)this.initDynamic(e.aChildren[t])},notifyChange:function(){this.getWebApp().waitForCall(this.performUpdate,this)},updateEnabled:function(){this.getBase("df.WebMenuProvider_mixin").updateEnabled.call(this),this.notifyChange()},performUpdate:function(){this._aMenu=null,this.psGroupName?this.getHub().updateGroup(this.psGroupName):this.refreshMenu(),this.OnUiUpdate.fire(this,{bUiDriven:!1})},getMenu:function(){return this._aMenu||(this._aMenu=[],this.psGroupName&&this._bIsMenuListener||(this.genMenuData(this._aMenu),this.updatePaths())),this._aMenu},getItemByPath:function(e){var t,i,s,o=null;for(t=e.split("."),i=this.getMenu(),s=0;s<t.length;s++)i[t[s]]?i=(o=i[t[s]]).aChildren:o=null;return o},getItemById:function(e){return function t(i){for(let s=0;s<i.length;s++){if(i[s].sId===e)return i[s];const o=t(i[s].aChildren);if(o)return o}return null}(this.getMenu())},getItemByHandler:function(e){return function t(i){var s,o=null;for(s=0;s<i.length;s++){if(i[s]._oHandler===e)return i[s];if(o=t(i[s].aChildren))return o}return null}(this.getMenu())},getItemElemByPath:function(e){return this._eControl&&df.dom.query(this._eControl,'li[data-df-path="'+e+'"]')||null},getItemElemByHandler:function(e){var t=this.getItemByHandler(e);return t?this.getItemElemByPath(t._sPath):null},genItemHtml:function(e,t,i){var s,o,n;if(s=["WebMenuItem",t.sCSSClass,t.bEnabled?df.CssEnabled:df.CssDisabled],t.aChildren.length>0&&s.push("WebItm_HasSub"),t.bBeginGroup&&s.push("WebItm_BgnGroup"),t.sImage&&s.push("WebItm_HasIcon"),(t.eCheckbox<0||t.eCheckbox>0)&&s.push("WebItm_HasCheckbox"),e.push('<li class="',df.dom.encodeAttr(s.join(" ")),'" data-df-path="',t._sPath,'"'),t.sHtmlId&&e.push(' id="',df.dom.encodeAttr(t.sHtmlId),'"'),(t.sBackgroundColor||t.sTextColor)&&(e.push(' style="'),t.sTextColor&&e.push("color: ",df.dom.encodeAttr(t.sTextColor),";"),t.sBackgroundColor&&e.push("background-color: ",df.dom.encodeAttr(t.sBackgroundColor),";"),e.push('"')),e.push(">"),t._bCustomRender)t._oHandler.itemHtml(e);else if(t.sCaption=t.sCaption.replace("&",""),n=!this.pbShowLabel&&t._sPath.indexOf(".")<0?t.sTooltip||df.dom.encodeHtml(t.sCaption):t.sTooltip,e.push('<div title="',df.dom.encodeAttr(n),'">'),t.sImage?e.push('<span class="WebItm_Icon" style="background-image: url(\''+df.dom.encodeAttr(t.sImage)+"');\">&nbsp;</span>"):e.push('<span class="WebItm_Icon">&nbsp;</span>'),t.eCheckbox<0?e.push('<input class="WebItm_CheckBox" type="checkbox"></input>'):t.eCheckbox>0&&e.push('<input class="WebItm_CheckBox" type="checkbox" checked></input>'),e.push('<a tabindex="-1" href="javascript: void(0);" target="_self">',this.pbAllowHtml?t.sCaption:df.dom.encodeHtml(t.sCaption),"</a></div>"),i&&t.aChildren.length>0){for(e.push("<ul>"),o=0;o<t.aChildren.length;o++)this.genItemHtml(e,t.aChildren[o],i);e.push("</ul>")}e.push("</li>")},updatePaths:function(){var e;function t(e,i){var s;for(e._sPath=i,s=0;s<e.aChildren.length;s++)t(e.aChildren[s],i+"."+s.toString())}for(e=0;e<this._aMenu.length;e++)t(this._aMenu[e],e.toString())},refreshMenu:function(){},expandItem:function(e){},showItem:function(e){this.expandItem(e)},getHub:function(){var e=this.getWebApp();return e?(e._oMenuHub||(e._oMenuHub=new df.GroupHub),e._oMenuHub):null},isInCommandBar:function(){for(var e=this;e instanceof df.WebBaseMenu;)if((e=e._oParent)instanceof df.WebCommandBar)return!0;return!1},notifyMenuRendered:function(e,t){e.forEach((e=>{e._bCustomRender&&e._oHandler.itemRendered(this.getItemElemByPath(e._sPath))}))}}),df.WebBaseMenu=df.mixin("df.WebMenuProvider_mixin","df.WebBaseControl"),df.WebPanel=function(e,t){df.WebPanel.base.constructor.call(this,e,t),this.prop(df.tInt,"peRegion",0),this.prop(df.tBool,"pbResizable",!1),this._eDivider=null,this._bWrapDiv=!0,this._sControlClass="WebPanel"},df.defineClass("df.WebPanel","df.WebBaseContainer",{afterRender:function(){df.WebPanel.base.afterRender.call(this),this.set_pbResizable(this.pbResizable)},set_pbResizable:function(e){this._eElem&&(e&&this.peRegion!==df.ciRegionCenter?(this._eDivider||(this._eDivider=df.dom.create("<div></div>"),this._eElem.appendChild(this._eDivider),df.dom.on("mousedown",this._eDivider,this.onResize,this)),this._eDivider.className=this.peRegion===df.ciRegionLeft||this.peRegion===df.ciRegionRight?"WebPanel_DividerVertical":"WebPanel_DividerHorizontal",this._eDivider.style.right="",this._eDivider.style.left="",this._eDivider.style.top="",this._eDivider.style.bottom="",this.peRegion===df.ciRegionLeft?this._eDivider.style.right="0px":this.peRegion===df.ciRegionRight?this._eDivider.style.left="0px":this.peRegion===df.ciRegionBottom?this._eDivider.style.top="0px":this.peRegion===df.ciRegionTop&&(this._eDivider.style.bottom="0px")):this._eDivider&&(df.dom.off("mousedown",this._eDivider,this.onResize,this),this._eElem.removeChild(this._eDivider),this._eDivider=null))},set_peRegion:function(e){this._eElem&&this.peRegion!==e&&(this.peRegion=e,this.setOuterWidth(0),this.setOuterHeight(0),this.sizeChanged(!0),this.set_pbResizable(this.pbResizable))},onResize:function(e){var t,i,s,o,n,r,a,l,h=0,d=0;function p(e){this.peRegion===df.ciRegionTop||this.peRegion===df.ciRegionBottom?(n=(n=r-(a-e.getMouseY()))<d?n>h?n:h:d,i.style.top=n+"px"):(s=(s=o-(l-e.getMouseX()))<d?s>h?s:h:d,i.style.left=s+"px")}function u(e){df.dom.off("mouseup",t,u,this),df.dom.off("mouseup",window,u,this),df.dom.off("mousemove",t,p,this),t.parentNode.removeChild(t),i&&i.parentNode.removeChild(i),this.peRegion===df.ciRegionTop?(this.piHeight=n,this._eElem.style.height=this.piHeight+"px"):this.peRegion===df.ciRegionBottom?(this.piHeight=this._eElem.clientHeight+(r-n),this._eElem.style.height=this.piHeight+"px"):this.peRegion===df.ciRegionLeft?(this.piWidth=s,this._eElem.style.width=this.piWidth+"px"):this.peRegion===df.ciRegionRight&&(this.piWidth=this._eElem.clientWidth+(o-s),this._eElem.style.width=this.piWidth+"px"),this.sizeChanged()}this.isEnabled()&&(i=df.dom.create('<div class="'+(this.peRegion===df.ciRegionLeft||this.peRegion===df.ciRegionRight?"WebPanel_DividerVertical_Ghost":"WebPanel_DividerHorizontal_Ghost")+'"></div>'),t=df.gui.dragMask(this.topLayer()||document.body),this.peRegion===df.ciRegionTop||this.peRegion===df.ciRegionBottom?(t.style.cursor="n-resize",this.peRegion===df.ciRegionTop?(n=this._eElem.clientHeight,h=this.piMinHeight>2?this.piMinHeight:2,d=n+this._oParent._eMainArea.clientHeight,this._oParent._oRegionCenter&&this._oParent._oRegionCenter.piMinHeight>0&&(d-=this._oParent._oRegionCenter.piMinHeight)):(n=this._oParent._eMainArea.clientHeight,this._oParent._eRegionTop&&(n+=this._oParent._eRegionTop.clientHeight,h=this._oParent._eRegionTop.clientHeight),this._oParent._oRegionCenter&&this._oParent._oRegionCenter.piMinHeight>0&&(h+=this._oParent._oRegionCenter.piMinHeight),d=n+this._eElem.clientHeight-(this.piMinHeight>0?this.piMinHeight:0)-10),i.style.top=n+"px",this._oParent._eMainArea.parentNode.appendChild(i)):(t.style.cursor="e-resize",this.peRegion===df.ciRegionLeft?(s=this._eElem.clientWidth,h=this.piMinWidth>2?this.piMinWidth:2,d=s+this._oParent._eRegionCenter.clientWidth,this._oParent._oRegionCenter&&this._oParent._oRegionCenter.piMinWidth>0?d-=this._oParent._oRegionCenter.piMinWidth:d-=4):(s=this._oParent._eMainArea.clientWidth-this._eElem.clientWidth,this._oParent._eRegionLeft&&(h=this._oParent._eRegionLeft.clientWidth),this._oParent._oRegionCenter&&this._oParent._oRegionCenter.piMinWidth>0&&(h+=this._oParent._oRegionCenter.piMinWidth),d=s+this._eElem.clientWidth-(this.piMinWidth>0?this.piMinWidth:0)-10),i.style.left=s+"px",this._oParent._eMainArea.appendChild(i)),o=s,r=n,l=e.getMouseX(),a=e.getMouseY(),df.dom.on("mousemove",t,p,this),df.dom.on("mouseup",window,u,this),df.dom.on("mouseup",t,u,this),e.stop())}}),df.BaseApp=function(){df.BaseApp.base.constructor.call(this,"oWebApp",null),this.pbViewApp=!1,this.prop(df.tString,"psTheme","string"==typeof sDfPreloadTheme&&sDfPreloadTheme||"Df_Web_Creme"),this.prop(df.tString,"psVersionID",""),this.prop(df.tString,"psDecimalSeparator",","),this.prop(df.tString,"psThousandsSeparator","."),this.prop(df.tString,"psDateFormat","dd/mm/yyyy"),this.prop(df.tString,"psDateSeparator","-"),this.prop(df.tString,"psDateTimeFormat","dd/mm/yyyy hh:mm:ss"),this.prop(df.tString,"psTimeFormat","hh:mm:ss"),this.prop(df.tString,"psTimeSeparator",":"),this.prop(df.tString,"psCurrencySymbol","$"),this.prop(df.tInt,"peAlignView",df.ciAlignCenter),this.prop(df.tInt,"piScreenWidth",screen.width),this.prop(df.tInt,"piScreenHeight",screen.height),this.prop(df.tInt,"piWindowWidth",0),this.prop(df.tInt,"piWindowHeight",0),this.prop(df.tInt,"peMode",0),this.prop(df.tBool,"pbResponsive",!0),this.prop(df.tBool,"pbIsMobile",!0),this.prop(df.tString,"psLocationHash",""),this.prop(df.tAdv,"pasBrowserLanguages",null),this.prop(df.tInt,"piBrowserTimezoneOffset",0),this.prop(df.tBool,"pbUpdateApplicationTitle",!0),this.prop(df.tString,"psApplicationTitle",""),this.event("OnOrientationChange",df.cCallModeWait),this.event("OnResizeWindow",df.cCallModeDefault),this.OnError=new df.events.JSHandler,this.OnShowProgress=new df.events.JSHandler,this.OnShowWindow=new df.events.JSHandler,this.OnHideWindow=new df.events.JSHandler,this.OnHideProgress=new df.events.JSHandler,this._oPreLoaded={},this._oModeControl=new df.MobRuleController(this),this._oMenuHub=null,this._aSyncPropCache=[],this._aAdvSyncPropCache=[],this._oCurrentWindow=null,this._oCurrentView=null,this._oCurrentObj=null,this._aViews=[],this._aFocussed=[],this._bReady=!1,this._aLoadQueue=[],this._oLoadViewQueue={},this._aPreLoadViewActions=[],this._bInitStarted=!1,this._bCallTimeout=!1,this._oPendingCall=null,this._oSendingCall=null,this._eLocked=-1,this._aLockwaiters=[],this._eStyleSystem=null,this._eStyleTheme=null,this._eStyleApplication=null,this._sRootPath=df.psRootPath||"",this._oTranslations={},this._aModalQueue=[],this._tResizeTimer=null,this._bSizeChanged=!1,this._bContainerStretch=!1,this._aResponseAttachments=null,this._bWrapDiv=!0,this._sControlClass="WebApp",this._eViewPort=null,this.addSync("peMode"),this.addSync("pbIsMobile"),this.addSync("piScreenWidth"),this.addSync("piScreenHeight"),this.addSync("piWindowWidth"),this.addSync("piWindowHeight"),this.addSync("psLocationHash"),this.addSync("pasBrowserLanguages"),this.addSync("piBrowserTimezoneOffset"),this.setActionMode("loadView",df.cCallModeWait),this.ready(this.attachGlobalHandlers),df.log("DataFlex Web Application Framework "+df.psVersionId),df.log("Copyright 2005-2024 Data Access Corporation. All rights reserved.")},df.defineClass("df.BaseApp","df.WebBaseContainer",{create:function(){df.BaseApp.base.create.apply(this,arguments),this.set_pbResponsive(this.pbResponsive)},attachGlobalHandlers:function(){df.dom.on("resize",window,this.onWindowResize,this),df.dom.on("scroll",window,this.onScroll,this),df.dom.on("orientationchange",window,this.onOrientationChange,this),df.dom.on("popstate",window,this.onPopState,this),df.dom.on("hashchange",window,this.onHashChange,this),this.piScreenHeight=screen.height,this.piScreenWidth=screen.width},destroy:function(){df.dom.off("resize",window,this.onWindowResize,this),df.dom.off("scroll",window,this.onScroll,this),df.dom.off("orientationchange",window,this.onOrientationChange,this),df.BaseApp.base.destroy.call(this),this._oModeControl&&(this._oModeControl.destroy(),this._oModeControl=null)},addChild:function(e){if(e instanceof df.WebBaseView)this._aViews.push(e);else{if(e.peRegion===df.ciRegionCenter)throw new df.Error(999,"The 'oWebApp' object should not have panels set to the center region, this space is reserved for the WebView.",this,[e.getLongName()]);df.BaseApp.base.addChild.call(this,e)}},updateEnabled:function(){var e;for(df.BaseApp.base.updateEnabled.call(this),e=0;e<this._aViews.length;e++)this._aViews[e]instanceof df.WebBaseUIObject&&this._aViews[e].updateEnabled()},placePanels:function(){df.BaseApp.base.placePanels.call(this),this.pbViewApp&&(this._eViewRegion||(this._eViewRegion=df.dom.create('<div class="BaseApp_ViewRegion" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px"></div>')),this._eRegionCenter=this._eViewRegion,this._eRegionCenter.parentNode==this._eMainArea&&this._eRegionCenter.nextElementSibling==this._eMainArea.lastChild||this._eMainArea.insertBefore(this._eRegionCenter,this._eMainArea.lastChild))},initialize:function(e){this._bInitStarted=!0;try{this.checkBrowser()&&this.serverAction("LoadWebApp",[df.fromBool(!!e)],null,(function(e){this.updateCSS(!1),df.dom.ready((function(){this.testCSS((function(){var e;this._bCallTimeout=!0;try{for(this._bReady=!0,e=0;e<this._aLoadQueue.length;e++)this._aLoadQueue[e].fHandler.call(this._aLoadQueue[e].oEnv||this)}catch(e){this.handleError(e)}}))}),this)}))}catch(e){this.handleError(e)}},checkBrowser:function(){return!(df.sys.isIE&&df.sys.iVersion<11&&(alert("Unfortunately the browser you are using is not supported by this framework. Please upgrade to a more modern browser.\n\r\n\rThe minimal version required is Internet Explorer 11. We advise to use the latest version of Microsoft Edge, Google Chrome or Mozilla FireFox."),1))},ready:function(e,t,i){"string"==typeof e?this.ready((function(){this[e]instanceof df.WebBaseView?t.call(i||this):(this._oLoadViewQueue[e]||(this._oLoadViewQueue[e]={aWaiters:[],bLoading:!1}),this._oLoadViewQueue[e].aWaiters.push({fHandler:t,oEnv:i}))})):(i=t,t=e,this._bReady?t.call(i||this):this._aLoadQueue.push({fHandler:t,oEnv:i}))},displayApp:function(e){this._bInitStarted||this.initialize(!0),this.ready((function(){var t,i;try{if(!(i="string"==typeof e?df.dom.query(document.body,e):e))throw new df.Error(999,"No proper element passed",this);this._eViewPort=i,this._bContainerStretch=!df.sys.gui.isSizedByContent(i),t=this.render(),this.afterRender(),t.style.visibility="hidden",i.appendChild(t),this.afterShow(),this.forceResize(),t.style.visibility=""}catch(e){this.handleError(e)}}))},displayView:function(e,t){this._bInitStarted||this.initialize(!1),this.ready((function(){var i;try{if(!(i="string"==typeof t?df.dom.query(document.body,t):t))throw new df.Error(999,"No proper element passed",this);this._eViewPort=i,this.serverActionEx({sMethod:"ShowView_FromClient",aParams:[e,df.fromBool(!0)],aViews:[e],fHandler:function(t){var s;(s=this[e])&&s instanceof df.WebBaseView&&s._show(i)},oHandlerEnv:this})}catch(e){this.handleError(e)}}))},renderView:function(e){this.ready((function(){var t=this[e];if(!t)throw new df.Error(999,"Cannot render view '{{0}}' as it is not initialized.",this,[e]);t._bRendered||(t instanceof df.WebModalDialog?(t.psInvokingView=this._oCurrentWindow&&this._oCurrentWindow._sName||"",t.psInvokingView&&t.addSync("psInvokingView"),this.queueModal((function(){t._show(this._eRegionCenter),this.forceResize()}),this)):(this.hideView(this._oCurrentView,t===this._oCurrentView),t._show(this._eRegionCenter),this.forceResize(),this._oCurrentView=t),this._oCurrentWindow=t)}))},showView:function(e,t,i){var s=[e,df.fromBool(!1)];t&&(s.push(t),s.push(i)),this.serverActionEx({sMethod:"ShowView_FromClient",aParams:s,aViews:[e]})},hideView:function(e,t){var i,s;(i="string"==typeof e?this[e]:e)instanceof df.WebBaseView&&(s=i.getInvoking(),i._hide(df.toBool(t)),this._oCurrentWindow===i&&(this._oCurrentWindow=null),this._oCurrentView===i&&(this._oCurrentView=null),i instanceof df.WebModalDialog&&s&&(this._oCurrentWindow=s))},loadView:function(e,t,i,s,o){t&&(this._oPreLoaded[e]=[]),this.ready((function(){if(this[e]&&this[e]instanceof df.WebBaseView)s&&s.call(o||this,this[e]);else{if(this._oLoadViewQueue[e]||(this._oLoadViewQueue[e]={aWaiters:[],bLoading:!1}),this._oLoadViewQueue[e].bLoading)return;this._oLoadViewQueue[e].bLoading=!0,s&&this._oLoadViewQueue[e].aWaiters.push({fHandler:s,oEnv:o});var n=new df.ServerAction;n.oWO=this,n.sAction="loadView",n.aParams=[e,i||"",df.fromBool(t)],n.eCallMode=df.cCallModeWait,n.fHandler=function(i){var s,o,n,r=this[e];if(df.toBool(i.sReturnValue))try{if(!(r instanceof df.WebBaseView))throw this._oLoadViewQueue[e].bLoading=!1,new df.Error(999,"No view definition received for '{{0}}'",this,[e]);if(t&&this._oPreLoaded[e]){for(;s=this._oPreLoaded[e].shift();)this.execClientAction(s);delete this._oPreLoaded[e]}for(o=this._oLoadViewQueue[e].aWaiters,n=0;n<o.length;n++)o[n].fHandler.call(o[n].oEnv||this,r);this._oLoadViewQueue[e]=null}catch(e){this.handleError(e)}},n.oHandlerEnv=this,n.aViews.push(i||null),n.aViews.push(e),this.handleAction(n)}}),this)},unloadView:function(e,t){var i,s;t=df.toBool(t),this[e]&&this[e]instanceof df.WebBaseView&&((i=this[e])._bRendered&&this.hideView(e,!0),this._oCurrentObj&&this._oCurrentObj.getView()===i&&(this._oCurrentObj=null),i.destroy(),(s=this._aChildren.indexOf(i))>=0&&this._aChildren.splice(s,1)),t&&this._oWODefStore[e]&&delete this._oWODefStore[e]},objFocus:function(e){var t=e.getView();t&&!t._bStandalone&&t._bRendered&&(this._oCurrentWindow=t),t&&!t._bRendered||(this._oCurrentObj=e)},objBlur:function(e){},returnFocus:function(){this._oCurrentObj&&this._oCurrentObj.conditionalFocus()},getFocusObjName:function(){return this._oCurrentObj instanceof df.WebBaseUIObject&&!this._oCurrentObj._bStandalone?this._oCurrentObj.getLongName():""},set_pbMDI:function(e){this._eRegionCenter&&(this._eRegionCenter.style.position=e?"relative":"")},notifyScroll:function(e){this.notifyPosChange(e)},notifyLayoutChange:function(e){this.notifyPosChange(e)},notifyPosChange:function(e){},initJSON:function(e){return function e(t,i){var s,o,n,r;if("df.WebApp"===t.sType)n=this;else{if(i[t.sName])throw new df.Error(999,"Naming conflict with child object '{{0}}'",this,[t.sName]);if("function"!=typeof(r=this.getConstructor(t.sType,t)))throw new df.Error(999,"Could not find class '{{0}}'",this,[t.sType]);i[t.sName]=n=new r(t.sName,i)}for(s=0;s<t.aProps.length;s++){if("_"===(o=t.aProps[s].sN).charAt(0))throw new df.Error(999,"Published property '{{0}}' of object '{{1}}' properties should not start with an '_'",this,[t.aProps[s].sV,t.sName]);if(n[o]&&("object"==typeof n[o]||"function"==typeof n[o]))throw new df.Error(999,"Naming conflict with property '{{0}}' of object '{{1}}'",this,[o,t.sName]);n._set(o,t.aProps[s].sV,!1,!1)}if(t.aAdvP)for(s=0;s<t.aAdvP.length;s++){if("_"===(o=t.aAdvP[s].sN).charAt(0))throw new df.Error(999,"Published property '{{0}}' of object '{{1}}' properties should not start with an '_'",this,[t.aAdvP[s].sV,t.sName]);if(n[o]&&("object"==typeof n[o]||"function"==typeof n[o]))throw new df.Error(999,"Naming conflict with property '{{0}}' of object '{{1}}'",this,[o,t.sName]);n._oTypes[o]||(n._oTypes[o]=df.tAdv),n._set(o,t.aAdvP[s].tV,!1,!1)}for(this.newWebObject(n,i,t),s=0;s<t.aObjs.length;s++)e.call(this,t.aObjs[s],n);return n.create(t),n}.call(this,e,this)},newWebObject:function(e,t,i){t.addChild&&t!==e&&t.addChild(e)},getConstructor:function(e){return df.sys.ref.getNestedProp(e)},findObj:function(e){var t,i,s;if(""===e)return this;for(i=e.split(/[\. | \$]/),s=this,t=0;t<i.length&&s;t++)s=s[i[t]];return"object"==typeof s&&s||null},waitForCall:function(e,t){var i;if(this._eLocked>=df.cCallModeDefault){for(i=0;i<this._aLockwaiters.length;i++)if(this._aLockwaiters[i].fFunc===e&&this._aLockwaiters[i].oEnv===t)return;this._aLockwaiters.push({fFunc:e,oEnv:t})}else e.call(t)},lock:function(e,t){var i,s,o=this;this._eLocked=e,document&&document.body&&(e>=df.cCallModeWait&&(this._eLockMask||(this._eLockMask=df.gui.dragMask(this._oCurrentWindow?.topLayer()||document.body),this._tLockCursor=setTimeout((function(){o._eLockMask&&(o._eLockMask.style.cursor="wait"),o._tLockCursor=null}),140)),df.events.addDomCaptureListener("keydown",document.body,this.onBlockKey,this)),e>=df.cCallModeProgress&&!this._bLockWait&&(this._bLockWait=!0,this.OnShowProgress.fire(this,{sMessage:t})&&(this._aModalQueue.push(this._oLockModalBlock={fFunc:null,bFinished:!1,bDisplayed:!0}),this._oLockDialog=i=new df.WebModalDialog(null,this),i.psCaption="",i.pbResizable=!1,i.pbShowClose=!1,i.psCSSClass="WebMsgBox WebMsgBoxProgress",(s=new df.WebLabel(null,i)).psCaption=t||this.getTrans("loading")+"..",s.psCSSClass="WebMsgBoxProgress",i.addChild(s),i.show(),i._oPrevFocus=null)))},unlock:function(){var e;for(this._eLocked=-1,this._eLockMask&&(this._eLockMask.style.cursor="",this._eLockMask.parentNode.removeChild(this._eLockMask),this._eLockMask=null,this._tLockCursor&&(clearTimeout(this._tLockCursor),this._tLockCursor=null)),document&&document.body&&df.events.removeDomCaptureListener("keydown",document.body,this.onBlockKey,this),this._bLockWait&&(this._bLockWait=!1,this.OnHideProgress.fire(this,{}),this._oLockDialog&&(this._oLockDialog.hide(),this._oLockDialog=null,this._oLockModalBlock.bFinished=!0,this.processModal()));e=this._aLockwaiters.pop();)e.fFunc.call(e.oEnv)},onBlockKey:function(e){if(this._eLocked>=df.cCallModeWait)return e.stop(),!1},handleAction:function(e){this.lock(e.eCallMode,e.sProcessMessage),e.aViews.push(this._oCurrentWindow),this._oPendingCall?(this._oPendingCall.aActions.push(e),this._oPendingCall.eCallMode<e.eCallMode&&(this._oPendingCall.eCallMode=e.eCallMode)):(this._oPendingCall=new df.ServerCall,this._oPendingCall.aActions.push(e),this._oPendingCall.sFocus=this.getFocusObjName(),this._oPendingCall.eCallMode=e.eCallMode),this.processCall()},cancelAction:function(e,t){var i,s;if(this._oPendingCall)for(i=this._oPendingCall.aActions,s=0;s<i.length;s++)if(i[s].oWO===e&&i[s].sAction===t&&(i.splice(s,1),s--),0===i.length){this._oPendingCall=null;break}},hasPendingAction:function(e,t){var i,s;if(this._oPendingCall)for(i=this._oPendingCall.aActions,s=0;s<i.length;s++)if(i[s].oWO===e&&i[s].sAction===t)return!0;return!1},processResponse:function(e,t){if(!(e&&e.r&&e.r.Header&&e.r.asReturnValues))throw new df.Error(5123,"Unexpected response format.",this);{const i=e.r;if(this._aResponseAttachments=e.a||[],this.handleHeader(i.Header),t&&t.aActions.length===i.asReturnValues.length){const e=new df.events.JSEvent(this);for(let s=0;s<t.aActions.length;s++)e.sReturnValue=i.asReturnValues[s],t.aActions[s].fHandler&&t.aActions[s].fHandler.call(t.aActions[s].oHandlerEnv||null,e)}this._aResponseAttachments=null}},processCall:function(){const e=()=>{try{const e=this._oPendingCall;e&&(this._oSendingCall||(this._oSendingCall=e,this.sendCall(e).then((t=>{this.processResponse(t,e)})).catch((e=>{this.handleError(e)})).finally((()=>{this._oPendingCall||this.unlock(),this._oSendingCall=null,this.processCall()})),this._oPendingCall=null))}catch(e){this.unlock(),this._oPendingCall=null,this._oSendingCall=null,this.handleError(e)}};this._bCallTimeout?window.requestIdleCallback?window.requestIdleCallback(e,{timeout:30}):window.setTimeout(e,10):e()},assembleRequest:function(e){let t=[],i=[],s=[];return e.aActions.forEach((e=>{i.push({sTarget:e.oWO.getLongName(),sAction:e.sAction,aParams:e.aParams,iAttached:e.tData&&s.push(e.tData)||0}),t=t.concat(e.aViews)})),{v:df.psVersionId,r:{Header:this.getHeader(t,e.sFocus),aActions:i},a:s}},sendCall:function(e){return new Promise(((e,t)=>{t(new df.Error(99,"Not implemented"))}))},getHeader:function(e,t){var i,s,o={};function n(e){var t,s,r;"string"==typeof e?(t=this.findObj(e),r=e):r=(t=e)._sName,o[r]||(o[r]=!0,t instanceof df.WebBaseView?((s=t.getInvoking())&&n.call(this,s),t.getSynced(i.aSyncProps,i.aAdvSyncP),i.aDDOViews.push(r)):(this.getCachedSyncProps(e,i.aSyncProps,i.aAdvSyncP),i.aDDOViews.push(r)))}if(i={sFocus:t,aDDOViews:[],aSyncProps:[],aAdvSyncP:[]},this.getSynced(i.aSyncProps,i.aAdvSyncP),e instanceof Array)for(s=0;s<e.length;s++)e[s]&&n.call(this,e[s]);else e&&n.call(this,e);return i},handleHeader:function(e){var t;for(t=0;t<e.aActions.length;t++)e.aActions[t].eType===df.ctExecEarly&&this.execClientAction(e.aActions[t]);for(t=0;t<e.aObjectDefs.length;t++)this.initJSON(e.aObjectDefs[t]);for(this.handleSyncProps(e.aSyncProps),this.handleAdvSyncProps(e.aAdvSyncP),t=0;t<e.aActions.length;t++)e.aActions[t].eType!==df.ctExecEarly&&this.execClientAction(e.aActions[t])},handleSyncProps:function(e){var t,i,s,o;for(t=0;t<e.length;t++)if(s=e[t],i=this.findObj(s.sO))for(o=0;o<s.aP.length;o++)i._set(s.aP[o].sN,s.aP[o].sV,!0,!0);else this.cacheSyncProps(s)},handleAdvSyncProps:function(e){var t,i,s;for(t=0;t<e.length;t++)i=e[t],(s=this.findObj(i.sO))?s._set(i.sP,i.tV,!0,!0):this.cacheAdvProp(i)},execClientAction:function(e){var t,i,s=this.findObj(e.sTarget);if(s)if("function"==typeof(t=s.findFunc(e.sName)).fFunc){e.iAttached>0&&(e._tActionData?s._tActionData=e._tActionData:s._tActionData=this.responseAttachment(e.iAttached));try{t.fFunc.apply(t.oEnv,e.aParams)}catch(e){this.handleError(e)}s._tActionData=null}else this.handleError(new df.Error(999,"Action method not found '{{0}}' on object '{{1}}'",this,[e.sName,e.sTarget]));else(i=e.sTarget).indexOf(".")>0&&(i=i.substr(0,i.indexOf("."))),this._oPreLoaded[i]?(e.iAttached&&(e._tActionData=this.responseAttachment(e.iAttached)),this._oPreLoaded[i].push(e)):this.handleError(new df.Error(999,"Could not find object '{{0}}'",this,[e.sTarget]))},responseAttachment:function(e){if(this._aResponseAttachments&&this._aResponseAttachments.length>e-1)return this._aResponseAttachments[e-1];throw new df.Error(999,"Invalid response attachment index.",this)},cacheSyncProps:function(e){var t,i,s,o,n;for(t=0;t<this._aSyncPropCache.length;t++)if(this._aSyncPropCache[t].sO===e.sO){for(o=this._aSyncPropCache[t],i=0;i<e.aP.length;i++){for(n=!1,s=0;s<o.aP.length&&!n;s++)o.aP[s].sN===e.aP[i].sN&&(o.aP[s].sV=e.aP[i].sV,n=!0);n||o.aP.push(e.aP[i])}return}this._aSyncPropCache.push(e)},cacheAdvProp:function(e){var t;for(t=0;t<this._aAdvSyncPropCache.length;t++)if(this._aAdvSyncPropCache[t].sO===e.sO&&this._aAdvSyncPropCache[t].sP===e.sP)return void(this._aAdvSyncPropCache[t].tV=e.tV);this._aAdvSyncPropCache.push(e)},getCachedSyncProps:function(e,t,i){var s,o,n;for(n=(o=e+".").length,s=0;s<this._aSyncPropCache.length;s++)this._aSyncPropCache[s].sO!==e&&this._aSyncPropCache[s].sO.substr(0,n)!==o||(t.push(this._aSyncPropCache[s]),this._aSyncPropCache.splice(s,1),s--);for(s=0;s<this._aAdvSyncPropCache.length;s++)this._aAdvSyncPropCache[s].sO!==e&&this._aAdvSyncPropCache[s].sO.substr(0,n)!==o||(i.push(this._aAdvSyncPropCache[s]),this._aAdvSyncPropCache.splice(s,1),s--)},set_psTheme:function(e){this.psTheme!==e&&(document.body&&df.dom.removeClass(document.body,this.psTheme),this.psTheme=e,this.updateCSS(!0))},set_pbResponsive:function(e){this._oModeControl&&(e?this._oModeControl.activate():this._oModeControl.deactivate())},set_peAlignView:function(e){this.peAlignView=e,this.sizeChanged()},updateCSS:function(e){var t,i,s,o,n=this,r=this.psTheme.trim();if(!this._eStyleSystem||!this._eStyleTheme||!this._eStyleApplication){for(o="?v="+df.psVersionId,"string"==typeof sDfBuildNr&&sDfBuildNr&&(o+="."+sDfBuildNr),t=df.dom.query(document,"link",!0),i=0;i<t.length;i++)t[i].href.indexOf("DfEngine/system.css")>0&&(this._eStyleSystem=t[i]),t[i].href.indexOf("CssThemes/")>0&&t[i].href.indexOf("theme.css")>0&&(this._eStyleTheme=t[i]),t[i].href.indexOf("CssStyle/application.css")>0&&(this._eStyleApplication=t[i]);this._eStyleSystem||(this._eStyleSystem=df.dom.createCSSElem(this._sRootPath+"DfEngine/system.css"+o),(s=document.head||document.getElementsByTagName("head")[0]).firstChild?s.insertBefore(this._eStyleSystem,s.firstChild):s.appendChild(this._eStyleSystem)),this._eStyleTheme||(this._eStyleTheme=df.dom.createCSSElem(this._sRootPath+"CssThemes/"+r+"/theme.css"+o),df.dom.insertAfter(this._eStyleTheme,this._eStyleSystem)),this._eStyleApplication||(this._eStyleApplication=df.dom.createCSSElem(this._sRootPath+"CssStyle/application.css"+o),df.dom.insertAfter(this._eStyleApplication,this._eStyleTheme)),document.body&&(document.body.id="OWEBAPP")}document.body&&df.dom.addClass(document.body,this.psTheme),this._eStyleTheme.href.indexOf(this._sRootPath+"CssThemes/"+r+"/theme.css")<0&&(this._eStyleTheme.href=this._sRootPath+"CssThemes/"+r+"/theme.css"),e&&this.testCSS((function(){this.resize(),setTimeout((function(){try{n.resize()}catch(e){n.handleError(e)}}),200)}))},testCSS:function(e,t){let i,s,o=0,n=!1;s=df.dom.create('<div id="df_load_test" style="position: absolute"></div>');const r=()=>(!n&&s.clientHeight>=1&&(i.disconnect(),s.parentNode.removeChild(s),n=!0,e.call(this)),n);i=new ResizeObserver((e=>{r()})),i.observe(s),document.body.appendChild(s);const a=()=>{r()||(t?t.call(this):o<50?(o++,setTimeout(a,50)):e.call(this))};setTimeout(a,500)},onWindowResize:function(e){var t=this;this._tResizeTimeout&&(clearTimeout(this._tResizeTimeout),this._tResizeTimeout=null),this._tResizeTimeout=setTimeout((function(){try{t._tResizeTimeout=null,t.resize(),t.windowResize()}catch(e){t.handleError(e)}}),50),this.piScreenHeight===screen.width&&this.piScreenWidth===screen.height&&df.sys.isIE&&this.onOrientationChange(e)},windowResize:function(){var e;for(this.fire("OnResizeWindow",[this.get_piWindowWidth(),this.get_piWindowHeight()]),e=0;e<this._aViews.length;e++)this._aViews[e].windowResize(this.get_piWindowWidth(),this.get_piWindowHeight())},onScroll:function(e){this.notifyScroll(this)},prepareSize:function(){var e=df.BaseApp.base.prepareSize.call(this);return this._bStretch=this._bContainerStretch,e},resize:function(){var e,t,i;if(this.resizeHorizontal(),this.resizeVertical(),this.pbViewApp)for(this._eElem&&(e=this._iMiddleHeight-df.sys.gui.getVertBoxDiff(this._eRegionCenter,0)),t=0;t<this._aViews.length;t++)i=this._aViews[t],!this._eElem&&i._eRenderTo&&(e=df.dom.clientHeight(i._eRenderTo)-df.sys.gui.getVertBoxDiff(i._eRenderTo,2)),i._bRendered&&i.viewResize(e);this.notifyPosChange(this),this._bSizeChanged=!1},objSizeChanged:function(e){var t=this;this._bSizeChanged=!0,this._tResizeTimer||(t._tResizeTimer=setTimeout((function(){try{t.resize(),t._tResizeTimer=null}catch(e){t.handleError(e)}}),30))},forceResize:function(){var e=this;this.sizeChanged(!0),setTimeout((function(){e.sizeChanged(!0)}),60)},onOrientationChange:function(e){var t;this.piScreenHeight=screen.height,this.piScreenWidth=screen.width,t="number"==typeof window.orientation?window.orientation:screen.height>screen.width?90:0,this.fire("OnOrientationChange",[t])},showInfoBox:function(e,t){this._aModalQueue.push({fFunc:function(i){var s,o,n,r,a,l=this,h=this.get_piWindowWidth();(s=new df.WebModalDialog(null,this)).psCaption=t,s.piMinWidth=h>420?400:h-20,s.piMinHeight=80,s.psCSSClass="WebMsgBox WebMsgBoxInfo",s.pbScroll=!0;const d=this._aViews.length;l._aViews.push(s),s.OnSubmit.addListener((function(e){s.hide()}),this),s.OnHide.addListener((function(e){i.bFinished=!0,setTimeout((function(){try{l.processModal(),s.destroy(),l._aViews.splice(d,1)}catch(e){l.handleError(e)}}),20)}),this),(r=new df.WebPanel(null,s)).peRegion=df.ciRegionCenter,s.addChild(r),(o=new df.WebLabel(null,s)).psCaption=e,o.psCSSClass="WebMsgBox_Text",r.addChild(o),(a=new df.WebPanel(null,s)).peRegion=df.ciRegionBottom,a.piColumnCount=3,a.psCSSClass="WebMsgBoxOneBtn",s.addChild(a),(n=new df.WebButton(null,s)).psCaption=this.getTrans("ok"),n.piColumnIndex=2,n.pbShowLabel=!1,n.OnClick.addListener((function(e){s.hide()}),this),a.addChild(n),s.show(),this.ready((function(){s.resize(),n.focus()}))},bFinished:!1,bDisplayed:!1}),this.processModal()},showMessageBox:function(e,t,i,s,o,n){var r,a;if(!(r=this.findObj(e)))throw new df.Error(999,"Return WebObject not found '{{0}}'",this,[e]);if(!(a=this._tActionData))throw new df.Error(999,"No buttons specified",this);this.showMsgBox(i,s,o,a,n,(function(e,i){r.getActionMode(t)<df.cCallModeWait&&r.setActionMode(t,df.cCallModeWait),r.serverAction(t,[e],null,(function(){i.hide()}))}))},showMsgBox:function(e,t,i,s,o,n){this._aModalQueue.push({fFunc:function(r){var a,l,h,d,p,u,f=this,c=null,g=this.get_piWindowWidth();(a=new df.WebModalDialog(null,this)).psCaption=t,a.piMinWidth=g>500?480:g-20,a.piMinHeight=100,a.pbShowClose=!1,a.psCSSClass="WebMsgBox "+i,a.pbScroll=!0;const b=this._aViews.length;function _(e){n.call(this,e.oSource._iConfirmId,a)}for(f._aViews.push(a),a.OnHide.addListener((function(e){r.bFinished=!0,setTimeout((function(){try{f.processModal(),a.destroy(),f._aViews.splice(b,1)}catch(e){f.handleError(e)}}),20)}),this),(d=new df.WebPanel(null,a)).peRegion=df.ciRegionCenter,a.addChild(d),(l=new df.WebLabel(null,a)).psCaption=e,l.psCSSClass="WebMsgBox_Text",d.addChild(l),(p=new df.WebPanel(null,a)).peRegion=df.ciRegionBottom,p.piColumnCount=2*s.length+2,df.sys.isMobile&&(2===s.length?p.piColumnCount=2*s.length:s.length>2&&(p.piColumnCount=1)),1===s.length?p.psCSSClass="WebMsgBoxOneBtn":2===s.length?p.psCSSClass="WebMsgBoxTwoButtons":p.psCSSClass="WebMsgBoxButtons",a.addChild(p),o=parseInt(o,10),u=0;u<s.length;u++)(h=new df.WebButton(null,a)).psCaption=s[u],h.piColumnIndex=2*u+1,h.piColumnSpan=2,h.pbShowLabel=!1,h._iConfirmId=u+1,h.OnClick.addListener(_),df.sys.isMobile?2===s.length?h.piColumnIndex=2*u:s.length>2&&(h.piColumnIndex=0,h.piColumnSpan=0):0===u?h.psCSSClass="WebMsgBoxFirstBtn":u===s.length-1&&(h.psCSSClass="WebMsgBoxLastBtn"),p.addChild(h),h._iConfirmId===o&&(c=h);a.show(),this.ready((function(){a.resize(),c&&c.focus()}))},bFinished:!1,bDisplayed:!1}),this.processModal()},showYesNo:function(e,t,i){this.showMsgBox(e,this.getTrans("confirm"),"WebMsgBoxConfirm",[this.getTrans("yes"),this.getTrans("no")],0,(function(e,s){try{t&&t.call(i||this,1===e)}catch(e){this.handleError(e)}s.hide()}))},processModal:function(){if(this._aModalQueue.length>0){for(;this._aModalQueue[0]&&this._aModalQueue[0].bFinished;)this._aModalQueue.shift();this._aModalQueue.length>0&&!this._aModalQueue[0].bDisplayed&&(this._aModalQueue[0].bDisplayed=!0,this._aModalQueue[0].fFunc.call(this,this._aModalQueue[0]))}},queueModal:function(e,t){this._aModalQueue.push({fFunc:function(i){e.call(t||null),i.bFinished=!0,this.processModal()},bFinished:!1,bDisplayed:!1}),this.processModal()},log:function(e){df.log(e)},getTrans:function(e,t){return this._oTranslations[e]?this._oTranslations[e]:t?null:"{{"+e+"}}"},getLongName:function(){return""},getLongNamePrnt:function(){return""},initTranslations:function(){this.initTrans(this._tActionData)},initTrans:function(e){var t;for(t=0;t<e.length;t++)this._oTranslations[e[t].sN]=e[t].sV;df.lang={monthsLong:[this.getTrans("january"),this.getTrans("february"),this.getTrans("march"),this.getTrans("april"),this.getTrans("may"),this.getTrans("june"),this.getTrans("july"),this.getTrans("august"),this.getTrans("september"),this.getTrans("october"),this.getTrans("november"),this.getTrans("december")],monthsShort:[this.getTrans("jan"),this.getTrans("feb"),this.getTrans("mar"),this.getTrans("apr"),this.getTrans("mayShort"),this.getTrans("jun"),this.getTrans("jul"),this.getTrans("aug"),this.getTrans("sep"),this.getTrans("oct"),this.getTrans("nov"),this.getTrans("dec")],daysShort:[this.getTrans("sun"),this.getTrans("mon"),this.getTrans("tue"),this.getTrans("wed"),this.getTrans("thu"),this.getTrans("fri"),this.getTrans("sat")],daysLong:[this.getTrans("sunday"),this.getTrans("monday"),this.getTrans("tuesday"),this.getTrans("wednesday"),this.getTrans("thursday"),this.getTrans("friday"),this.getTrans("saturday")]}},showError:function(e,t,i,s,o){this.handleError(new df.Error(df.toInt(e),i,this,null,null,!0,df.toBool(o),s,null,df.toInt(t)))},handleError:function(e){if(!(e instanceof df.Error))throw e;this.OnError.fire(this,{oError:e})&&(e.oTarget&&e.oTarget.displayError&&e.oTarget.pbRender&&e.oTarget.pbVisible?e.oTarget.displayError(e.iNumber,e.sText):(this._aModalQueue.push({fFunc:function(t){var i,s,o,n,r,a,l,h=this,d=[],p=this.get_piWindowWidth();l=e.bServer?e.sCaption||this.getTrans("error_title_server"):e.sCaption||this.getTrans("error_title_client",!0)||"Unhandled Program Error on the client",(s=new df.WebModalDialog(null,this)).psCaption=l,s.piMinWidth=p>520?500:p-20,s.piMinHeight=e.bUserError?80:180,s.psCSSClass=e.bUserError?"WebMsgBox WebMsgBoxWarning":"WebMsgBox WebMsgBoxError";const u=this._aViews.length;h._aViews.push(s),s.OnSubmit.addListener((function(e){try{s.hide()}catch(e){h.handleError(e)}}),this),s.OnHide.addListener((function(e){t.bFinished=!0,setTimeout((function(){try{h.processModal(),s.destroy(),h._aViews.splice(u,1)}catch(e){h.handleError(e)}}),20)}),this),(n=new df.WebPanel(null,s)).peRegion=df.ciRegionCenter,s.addChild(n),(i=new df.WebLabel(null,n)).psCaption=e.sText,i.psCSSClass="WebMsgBox_Text",n.addChild(i),e.bUserError||(i=new df.WebLabel(null,n),d.push("Error: ",e.iNumber),e.bServer?e.iLine&&d.push("\nLine:",e.iLine):e.oSource&&e.oSource instanceof df.WebObject&&d.push("\nObject:",e.oSource.getLongName()),i.psCaption=d.join(""),n.addChild(i),e.sDetailHtml&&(s.piMinHeight=300,s.piHeight=400,e.sDetailHtml.match(/<body*>|<html*>/gi)?((a=new df.WebIFrame(null,n)).pbFillHeight=!0,a.pbShowLabel=!1,a.psCSSClass="WebErrorDetails",a.setHtmlContent(e.sDetailHtml),n.addChild(a)):((a=new df.WebHtmlBox(null,n)).pbFillHeight=!0,a.pbShowBox=!0,a.pbScroll=!0,a.pbShowLabel=!1,a.psCSSClass="WebErrorDetails",a.psHtml=e.sDetailHtml,n.addChild(a)))),(r=new df.WebPanel(null,s)).peRegion=df.ciRegionBottom,r.piColumnCount=3,r.psCSSClass="WebMsgBoxOneBtn",s.addChild(r),(o=new df.WebButton(null,s)).psCaption=this.getTrans("ok",!0)||"OK",o.piColumnIndex=2,o.pbShowLabel=!1,o.OnClick.addListener((function(e){s.hide()}),this),r.addChild(o),s.show(),this.ready((function(){s.resize(),o.focus()}))},bFinished:!1,bDisplayed:!1}),this.processModal()))},setPageTitle:function(e){document.title=e},navigateToPage:function(e,t){this.queueModal((function(){(t=parseInt(t,10))===df.ciOpenSameWindow?window.location.href=e:t===df.ciOpenNewWindow?window.open(e,"_blank_"+df.dom.piDomCounter++,"width=700, height=500, resizable=yes"):window.open(e,"_blank")}),this)},navigateNewWindow:function(e,t,i){this.queueModal((function(){window.open(e,"_blank_"+df.dom.piDomCounter++,"width="+t+", height="+i+", resizable=yes, location=yes")}))},navigateRefresh:function(){this.queueModal((function(){window.location.reload()}))},historyPushState:function(e,t){var i={df:!0,vt:this._tActionData};history&&history.pushState&&history.pushState(i,t||null,e||null)},historyReplaceState:function(e,t){var i={df:!0,vt:this._tActionData};history&&history.replaceState&&history.replaceState(i,t||null,e||null)},onPopState:function(e){var t=e.e.state,i=null;t&&t.df&&t.vt&&void 0!==t.vt.v&&t.vt.c&&(i=t.vt),this.serverAction("HistoryPopState",[document.title,document.location.href],i),e.stop()},onHashChange:function(e){this.cancelServerAction("HistoryPopState"),this.serverAction("LocationHashChange",[document.location.hash])},get_piWindowWidth:function(){return df.dom.windowWidth()},get_piWindowHeight:function(){return df.dom.windowHeight()},get_peMode:function(){if(this._oModeControl)return this._oModeControl.peMode},get_pbIsMobile:function(){return df.sys.isMobile},get_psLocationHash:function(){return window.location.hash},get_piBrowserTimezoneOffset:function(){return(new Date).getTimezoneOffset()},get_pasBrowserLanguages:(vt=df.sys.vt.serialize(navigator.languages||navigator.language&&[navigator.language]||["en-US"]),function(){return vt}),topLayer:function(){return document.body}}),df.WebApp=function(e){df.WebApp.base.constructor.call(this),this.psWebService=e||"WebServiceDispatcher.wso",this.pbXHRWithCredentials=!1,this._bPanels=!0,this.pbViewApp=!0},df.defineClass("df.WebApp","df.BaseApp",{sendCall:function(e){return new Promise(((t,i)=>{let s=new df.ajax.JSONCall("CallAction",this.assembleRequest(e),this.psWebService,this);s.pbWithCredentials=this.pbXHRWithCredentials,s.bSilent=!0,s.onFinished.addListener((function(e){try{let i=e.oSource.getResponseValue();t(i)}catch(e){i(e)}}),this),s.onError.addListener((function(e){i(e.oError)}),this);try{s.send(!0)}catch(e){i(e)}}))},position:function(){}}),df.LocalApp=function(e){if(df.LocalApp.base.constructor.call(this),!window.chrome.webview)throw new df.Error(999,"LocalApp requires chromium webview message API to function!");df.dom.on("message",window.chrome.webview,this.onWebMessageReceived,this),this._bPanels=e,this.pbViewApp=e},df.defineClass("df.LocalApp","df.BaseApp",{afterRender:function(){df.LocalApp.base.afterRender.apply(this,arguments),this.syncObserver()},syncObserver:function(){let e=!1;const t=()=>{e=!1,this._bCallTimeout=!1,this.serverAction("SynchronizeProps"),this._bCallTimeout=!0};new MutationObserver((function(){e||(e=!0,window.requestIdleCallback(t))})).observe(this._eElem,{subtree:!0,childList:!0,attributes:!0}),df.dom.on("input",this._eElem,(function(i){e||(e=!0,window.requestIdleCallback(t))}),this)},sendCall:function(e){return e.oPromise=new Promise(((t,i)=>{let s=[];e.aActions.forEach((e=>{e.oPlatformSpecific.aAdditionalObjects&&(s=s.concat(e.oPlatformSpecific.aAdditionalObjects))}));const o=this.assembleRequest(e);e._resolve=t,e._reject=i,df.debug("Sending call.."),df.debug(o),s.length>0?window.chrome.webview.postMessageWithAdditionalObjects(o,s):window.chrome.webview.postMessage(o)}))},onWebMessageReceived:function(e,t){const i=e.e.data;this._oSendingCall?(df.debug("Received response:"),df.debug(i),this._oSendingCall._resolve(i)):(df.debug("Received host message.."),df.debug(i),this.processResponse(i,null))}}),df.WebBaseView=function(e,t){df.WebBaseView.base.constructor.call(this,e,t),this.prop(df.tInt,"piMaxWidth",0),this.prop(df.tInt,"piMinWidth",0),this.prop(df.tInt,"piMinHeight",0),this.prop(df.tString,"psCaption",""),this.prop(df.tBool,"pbShowCaption",!0),this.prop(df.tBool,"pbFocusFirstOnShow",!0),this.event("OnSubmit",df.cCallModeWait),this.event("OnShow",df.cCallModeWait),this.event("OnHide",df.cCallModeDefault),this.event("OnResizeWindow",df.cCallModeDefault),this.setActionMode("HandleDeleteKey",df.cCallModeWait),this.setActionMode("HandleSaveKey",df.cCallModeWait),this._oCurrentObj=null,this._eRenderTo=null,this._bRendered=!1,this.pbScroll=!0},df.defineClass("df.WebBaseView","df.WebBaseContainer",{show:function(){this._bStandalone?this._show():this.getWebApp().showView(this._sName,!1)},hide:function(){this._bStandalone?this._hide(!1):this.getWebApp().hideView(this._sName)},windowResize:function(e,t){this._bRendered?this.fire("OnResizeWindow",[e,t],(function(){this.centerWindow()})):this._bFireOnResize=!0},centerWindow:function(){},setOuterWidth:function(e){},getInvoking:function(){var e;return this.psInvokingView&&(e=this.getWebApp())[this.psInvokingView]instanceof df.WebBaseView?e[this.psInvokingView]:null},returnFocus:function(){this._oCurrentObj?this._oCurrentObj.conditionalFocus():this.conditionalFocus()},objFocus:function(e){this._oCurrentObj=e},set_piHeight:function(e){this.piHeight=e,(e=e>this.piMinHeight?e:this.piMinHeight)>0&&this._eElem&&this.setInnerHeight(e),this.sizeChanged()},set_psCaption:function(e){this.psCaption=e,this.updateCaption()},set_pbShowCaption:function(e){this.pbShowCaption=e,this.updateCaption()},updateCaption:function(){this._eElem&&(this._eLbl.style.display=this.pbShowCaption?"":"none",df.dom.setText(this._eLbl,this.psCaption))},fireSubmit:function(){return this.getWebApp()._oCurrentObj&&this.getWebApp()._oCurrentObj.validate&&this.getWebApp()._oCurrentObj.validate(),this.fire("OnSubmit")},onKey:function(e){e.matchKey(df.settings.formKeys.submit)&&this.fireSubmit()&&e.stop()}}),df.WebView=function(e,t){df.WebView.base.constructor.call(this,e,t),this.prop(df.tBool,"pbFillHeight",!1),this._sControlClass="WebView",this._sBaseClass="WebInlineView",this._bWrapDiv=!0},df.defineClass("df.WebView","df.WebBaseView",{wrpOpenHtml:function(e){e.push('<div class="WebContainer">')},wrpCloseHtml:function(e){e.push("</div>")},openHtml:function(e){df.WebView.base.openHtml.call(this,e),e.push('<div class="WebCon_Inner">'),e.push('<label class="WebWin_title"',this.pbShowCaption?"":'style="display: none"',">",df.dom.encodeHtml(this.psCaption),"</label>"),e.push('<div class="WebCon_ContentWrp">')},closeHtml:function(e){df.WebView.base.closeHtml.call(this,e),e.push("</div></div></div></div>")},afterRender:function(){this._eInner=df.dom.query(this._eElem,"div.WebCon_Inner"),this._eContentWrap=df.dom.query(this._eElem,"div.WebCon_ContentWrp"),this._eLbl=df.dom.query(this._eElem,"label.WebWin_title"),df.WebView.base.afterRender.call(this),this.set_piHeight(this.piHeight),this.set_piWidth(this.piWidth),this.set_piMaxWidth(this.piMaxWidth),this.set_piMinWidth(this.piMinWidth),df.events.addDomKeyListener(this._eElem,this.onKey,this)},_show:function(e){const t=this.getWebApp(),i=!this._eElem;if(this.fireEx({sEvent:"OnShow"}),i){const e=this.render();df.dom.addClass(e,"WebWin_Hidden")}this._eElem.parentNode!==e&&(e.appendChild(this._eElem),this._eRenderTo=e),df.dom.removeClass(this._eElem,"WebWin_Hidden"),i&&this.afterRender(),this._bRendered=!0,this.afterShow(),this._oCurrentObj=null,t&&t.objFocus(this),setTimeout((()=>{t&&this._bRendered&&(this.pbFocusFirstOnShow&&!this._oCurrentObj&&this.conditionalFocus(!0),df.dom.addClass(this._eElem,"WebWin_Visible"),t.OnShowWindow.fire(t,{oWindow:this,eElem:this._eElem,bModal:!1}))}),20)},_hide:function(e){const t=this.getWebApp();let i=!1;this._bRendered&&(this._bRendered&&!e&&this.fire("OnHide",[]),df.dom.addClass(this._eElem,"WebWin_Hidden"),df.dom.removeClass(this._eElem,"WebWin_Visible"),t&&(i=!t.OnHideWindow.fire(t,{oWindow:this,eElem:this._eElem,bModal:!1}))),this._bRendered=!1,this.afterHide(),this._bStandalone&&(i?setTimeout((function(){that._eElem&&that._eElem.parentNode&&that._eElem.parentNode.removeChild(that._eElem)}),5e3):this._eElem&&this._eElem.parentNode&&this._eElem.parentNode.removeChild(this._eElem))},viewResize:function(e){var t=this.getWebApp();this.prepareSize(),this.piHeight>0&&this.piHeight<e?this.setOuterHeight(this.piHeight):(this._bStretch||this.pbScroll&&t._eElem)&&this.setOuterHeight(e),this.resize()},getHeightDiff:function(e,t,i,s){var o=df.WebView.base.getHeightDiff.call(this,e,t,i,s);return this._eLbl&&i&&(o+=df.sys.gui.getVertBoxDiff(this._eInner,0),o+=this._eLbl.offsetHeight,o+=df.sys.gui.getVertBoxDiff(this._eLbl,1),o+=df.sys.gui.getVertBoxDiff(this._eContentWrap,0)),o},navigateBackToHere:function(e,t,i){this.serverAction("NavigateBackToHere_Callback",[e,t,i],this._tActionData)},destroy:function(){var e,t=this.getWebApp();t&&(e=t._aViews.indexOf(this))>=0&&t._aViews.splice(e,1),df.WebView.base.destroy.call(this)},closePanel:function(){this.close()},set_pbFillHeight:function(e){this.pbFillHeight=e,this.sizeChanged()},set_piMinWidth:function(e){this.pbFloating||(this._eSizer&&(e>0?(e-=this.getWidthDiff(!0,!0,!1,!1),this._eSizer.style.minWidth=e+"px"):this._eSizer.style.minWidth=""),this.sizeChanged()),this.piMinWidth=e,this.set_piWidth(this.piWidth)},set_piWidth:function(e){this._eSizer&&(e-=this.getWidthDiff(!0,!0,!1,!1),this._eSizer.style.width=e>0?e+"px":""),this.sizeChanged()},set_piMaxWidth:function(e){this._eSizer&&(e>0?(e-=this.getWidthDiff(!0,!0,!1,!1),this._eSizer.style.maxWidth=e+"px"):this._eSizer.style.maxWidth=""),this.sizeChanged()},resizeHorizontal:function(){this.setOuterWidth(this.piWidth),df.WebView.base.resizeHorizontal.call(this)},setOuterHeight:function(e){this._eContainer&&(e-=this.getHeightDiff(!0,!1,!1,!1),this._eContainer.style.height=e>0?e+"px":"")},resize:function(){this._bRendered&&(this.updateAlign(),this.resizeHorizontal(),this.resizeVertical())},updateAlign:function(){var e;this._eSizer&&(e=this.getWebApp().peAlignView,this._eSizer.style.marginLeft=e===df.ciAlignCenter||e===df.ciAlignRight?"auto":"",this._eSizer.style.marginRight=e===df.ciAlignCenter?"auto":"")}}),df.WebWindow=function(e,t){df.WebWindow.base.constructor.call(this,e,t),this.prop(df.tBool,"pbResizable",!0),this.prop(df.tBool,"pbShowClose",!0),this.prop(df.tInt,"piLeft",0),this.prop(df.tInt,"piTop",0),this._bHasLeft=!1,this._bHasTop=!1,this._eMask=null,this._oPrevFocus=null,this.pbModal=!1,this._bWrapDiv=!1,this._sBaseClass="WebWindow"},df.defineClass("df.WebWindow","df.WebBaseView",{create:function(){this._bHasLeft=this.piLeft>0,this._bHasTop=this.piTop>0},genClass:function(){return this._sBaseClass="WebWindow"+(this.pbResizable?" WebWin_Resizable":""),df.WebWindow.base.genClass.call(this)},openHtml:function(e){e.push('<dialog class="',this.genClass(),'"'),this.psHtmlId&&e.push(' id="',this.psHtmlId,'"'),e.push(' data-dfobj="',this.getLongName(),'"'),e.push(' style=" ',this.pbRender?"":"display: none;",this.pbVisible?"":"visibility: hidden;",'top:10px;"'),e.push(">"),e.push('<div class="WebWin_top_l">','<div class="WebWin_top_r">','<div class="WebWin_top_c">',"</div>","</div>","</div>",'<div class="WebWin_main_l">','<div class="WebWin_main_r">','<div class="WebWin_header">','<div class="WebWin_header_r">','<div class="WebWin_header_c">'),e.push('             <label class="WebWin_title"',this.pbShowCaption?"":'style="display: none"',">",df.dom.encodeHtml(this.psCaption),"</label>"),e.push('<div class="WebWin_controls">'),e.push('<div class="WebWin_close" tabindex="0"',this.pbShowClose?"":' style="display:none"',"></div>"),e.push("</div>",'<div style="clear: both;"></div>',"</div>","</div>","</div>",'<div class="WebWin_main_c">','<div class="WebContainer">'),df.WebWindow.base.openHtml.call(this,e)},closeHtml:function(e){df.WebWindow.base.closeHtml.call(this,e),e.push("</div>","</div>","</div>","</div>",'<div class="WebWin_bottom_l">','<div class="WebWin_bottom_r">','<div class="WebWin_bottom_c">',"</div>",'<div class="WebWin_resizer">',"</div>","</div>","</dialog>")},afterRender:function(){this._eLbl=df.dom.query(this._eElem,"label.WebWin_title"),this._eHeader=df.dom.query(this._eElem,"div.WebWin_header"),this._eHeaderContent=df.dom.query(this._eElem,"div.WebWin_header_c"),this._eControlWrap=df.dom.query(this._eElem,"div.WebWin_main_c"),this._eMainRight=df.dom.query(this._eElem,"div.WebWin_main_r"),this._eMainLeft=df.dom.query(this._eElem,"div.WebWin_main_l"),this._eTopLeft=df.dom.query(this._eElem,"div.WebWin_top_l"),this._eTopRight=df.dom.query(this._eElem,"div.WebWin_top_r"),this._eTopContent=df.dom.query(this._eElem,"div.WebWin_top_c"),this._eBottomLeft=df.dom.query(this._eElem,"div.WebWin_bottom_l"),this._eBottomRight=df.dom.query(this._eElem,"div.WebWin_bottom_r"),this._eResizer=df.dom.query(this._eElem,"div.WebWin_resizer"),this._eBottomContent=df.dom.query(this._eElem,"div.WebWin_bottom_c"),this._eCloseBtn=df.dom.query(this._eElem,"div.WebWin_close"),df.WebWindow.base.afterRender.call(this),this.set_piHeight(this.piHeight),this.set_piWidth(this.piWidth),df.dom.on("mousedown",this._eHeader,this.onStartDrag,this),df.dom.on("mousedown",this._eMainRight,this.onStartResize,this),df.dom.on("mousedown",this._eMainLeft,this.onStartResize,this),df.dom.on("mousedown",this._eTopLeft,this.onStartResize,this),df.dom.on("mousedown",this._eBottomLeft,this.onStartResize,this),df.dom.on("mousedown",this._eCloseBtn,(function(e){e.stop()}),this),df.dom.on("click",this._eCloseBtn,this.onCloseClick,this),this._bStandalone&&df.dom.on("resize",window,this.onWindowResize,this),df.events.addDomKeyListener(this._eElem,this.onKey,this)},_show:function(e){const t=!this._eElem,i=this.getWebApp();if(this.fireEx({sEvent:"OnShow"}),t){const e=this.render();df.dom.addClass(e,"WebWin_Hidden")}this._oPrevFocus=i._oCurrentObj,this._eElem.parentNode&&this._eElem.parentNode.removeChild(this._eElem),this._eRenderTo=e=e||i?._eViewPort||document.body,e.appendChild(this._eElem),df.dom.removeClass(this._eElem,"WebWin_Hidden"),this.pbModal?this._eElem.showModal():this._eElem.show(),t&&this.afterRender(),this._bRendered=!0,this.pbFloating&&(this.resize(),this.centerWindow()),this.afterShow(),this._oCurrentObj=null,i&&i.objFocus(this),setTimeout((()=>{if(i&&this._bRendered){df.dom.addClass(this._eElem,"WebWin_Visible"),this.pbFocusFirstOnShow&&!this._oCurrentObj&&this.conditionalFocus(!0);const e=document.activeElement.closest("[data-dfobj]");if(e){const t=this.getWebApp().findObj(e.dataset.dfobj);t instanceof df.WebBaseControl&&t.updateFocus(!0)}i.OnShowWindow.fire(i,{oWindow:this,eElem:this._eElem,bModal:this.pbModal})}}),20)},_hide:function(e){const t=this.getWebApp();let i=!1;if(this._bRendered){e||this.fire("OnHide",[]);const s=this.getInvoking()||t._oCurrentWindow;s?s.returnFocus():this._oPrevFocus&&this._oPrevFocus.conditionalFocus(),this._eRenderTo=null,this._eElem.close(),df.dom.addClass(this._eElem,"WebWin_Hidden"),df.dom.removeClass(this._eElem,"WebWin_Visible"),t&&(i=!t.OnHideWindow.fire(t,{oWindow:this,eElem:this._eElem,bModal:this.pbModal}))}this._bRendered=!1,this.afterHide(),this._bStandalone&&(i?setTimeout((function(){that._eElem&&that._eElem.parentNode&&that._eElem.parentNode.removeChild(that._eElem)}),5e3):this._eElem&&this._eElem.parentNode&&this._eElem.parentNode.removeChild(this._eElem))},set_pbResizable:function(e){this._eElem&&df.dom.toggleClass(this._eElem,"WebWin_Resizable",e)},set_pbShowClose:function(e){this._eCloseBtn&&(this._eCloseBtn.style.display=e?"":"none")},set_piWidth:function(e){var t;e=e>this.piMinWidth?e:this.piMinWidth,this.piWidth=e,t=e>0?parseInt(e,10)+"px":"",this._eControlWrap&&(this._eControlWrap.style.width=t,this._eHeader.style.width=t,this._eElem&&e>0&&this.setOuterWidth(e))},set_piHeight:function(e){df.WebWindow.base.set_piHeight.call(this,e),this._eElem&&e>0&&this.setOuterHeight(e)},set_piTop:function(e){this._bHasTop=!0,this._eElem&&(this._eElem.style.top=parseInt(e,10)+"px")},set_piLeft:function(e){this._bHasLeft=!0,this._eElem&&(this._eElem.style.left=parseInt(e,10)+"px")},createGhost:function(){var e,t,i,s,o,n=[];return o=this.psHtmlId,this.psHtmlId="",this._bWrapDiv=!1,this.openHtml(n),this.closeHtml(n),this._bWrapDiv=!0,this.psHtmlId=o,(e=df.dom.create(n.join(""))).className=this.genClass()+" WebWin_ghost",this._eElem.parentNode.appendChild(e),df.dom.disableTextSelection(e),t=df.dom.query(e,".WebWin_main_c"),i=df.dom.query(e,".WebWin_header"),s=df.sys.gui.getSize(this._eControlWrap),i.style.width=s.width+"px",t.style.width=s.width+"px",t.style.height=s.height+"px",e.style.top=this.piTop+"px",e.style.left=this.piLeft+"px",e.showModal(),e},onStartDrag:function(e){var t,i,s,o,n,r,a;function l(e){this.piTop=e.getMouseY()-r,this.piLeft=e.getMouseX()-a,this.piTop=this.piTop<=0?1:this.piTop>=o?o:this.piTop,this.piLeft=this.piLeft<=0?1:this.piLeft>=n?n:this.piLeft,i.style.top=this.piTop+"px",i.style.left=this.piLeft+"px"}function h(e){df.dom.off("mouseup",t,h,this),df.dom.off("mouseup",window,h,this),df.dom.off("mousemove",t,l,this),t.parentNode.removeChild(t),i&&this._eElem.parentNode.removeChild(i),this._eElem.style.top=this.piTop+"px",this._eElem.style.left=this.piLeft+"px",this._eElem.classList.remove("Web_Moving"),this.resize()}this.isEnabled()&&(r=e.getMouseY()-this.piTop,a=e.getMouseX()-this.piLeft,s=df.sys.gui.getSize(this._eElem),this._eCloseBtn&&this._eCloseBtn.offsetLeft+this._eCloseBtn.offsetWidth>s.width&&(s.width=this._eCloseBtn.offsetLeft+this._eCloseBtn.offsetWidth),n=this.getViewportWidth()-s.width-1,o=this.getViewportHeight()-s.height-1,i=this.createGhost(),this._eElem.classList.add("Web_Moving"),t=df.gui.dragMask(),i.appendChild(t),t.style.cursor="move",df.dom.on("mouseup",t,h,this),df.dom.on("mouseup",window,h,this),df.dom.on("mousemove",t,l,this))},onStartResize:function(e){if(this.pbResizable&&this.isEnabled()){var t=e.getTarget();t===this._eMainRight?(this.resizeDrag(e,!0,!1,!1,!1,"e-resize"),e.stop()):t===this._eMainLeft?(this.resizeDrag(e,!0,!0,!1,!1,"e-resize"),e.stop()):t===this._eTopRight?(this.resizeDrag(e,!0,!1,!0,!0,"ne-resize"),e.stop()):t===this._eTopLeft?(this.resizeDrag(e,!0,!0,!0,!0,"nw-resize"),e.stop()):t===this._eTopContent?(this.resizeDrag(e,!1,!1,!0,!0,"n-resize"),e.stop()):t===this._eBottomRight||t===this._eResizer?(this.resizeDrag(e,!0,!1,!0,!1,"nw-resize"),e.stop()):t===this._eBottomLeft?(this.resizeDrag(e,!0,!0,!0,!1,"ne-resize"),e.stop()):t===this._eBottomContent&&(this.resizeDrag(e,!1,!1,!0,!1,"n-resize"),e.stop())}},resizeDrag:function(e,t,i,s,o,n){var r,a,l,h,d,p,u,f,c,g,b,_,m=0;function C(e){t&&(i?(this.piWidth=p-(e.getMouseX()-f),this.piWidth=this.piWidth>this.piMinWidth?this.piWidth:this.piMinWidth,this.piLeft=u-(this.piWidth-p)):(this.piWidth=p+(e.getMouseX()-f),this.piWidth=this.piWidth>this.piMinWidth?this.piWidth:this.piMinWidth,this.piWidth+this.piLeft>this.getViewportWidth()-m&&(this.piWidth=this.getViewportWidth()-m-this.piLeft)),a.style.left=this.piLeft+"px",l.style.width=this.piWidth+"px",h.style.width=this.piWidth+"px"),s&&(o?(this.piHeight=c-(e.getMouseY()-g),this.piHeight=this.piHeight>this.piMinHeight?this.piHeight:this.piMinHeight,this.piTop=b-(this.piHeight-c)):(this.piHeight=c+(e.getMouseY()-g),this.piHeight=this.piHeight>this.piMinHeight?this.piHeight:this.piMinHeight),a.style.top=this.piTop+"px",l.style.height=this.piHeight+"px")}function w(e){df.dom.off("mouseup",r,w,this),df.dom.off("mouseup",window,w,this),df.dom.off("mousemove",r,C,this),r.parentNode.removeChild(r),a&&this._eElem.parentNode.removeChild(a),_&&df.sys.gui.restorePlugins(_),this._eControlWrap.style.width=this.piWidth+"px",this._eHeader.style.width=this.piWidth+"px",this._eElem.style.left=this.piLeft+"px",this._eElem.style.top=this.piTop+"px",this._eElem.classList.remove("Web_Resizing"),this.setOuterHeight(this.piHeight),this.resize()}d=df.sys.gui.getSize(this._eControlWrap),p=d.width,f=e.getMouseX(),u=this.piLeft,c=d.height,g=e.getMouseY(),b=this.piTop,this.piHeight=this.piHeight>0?this.piHeight:this._eControlWrap.clientHeight,this._eCloseBtn&&this._eCloseBtn.offsetLeft+this._eCloseBtn.offsetWidth>d.width&&(m=this._eCloseBtn.offsetLeft+this._eCloseBtn.offsetWidth-d.width),a=this.createGhost(),l=df.dom.query(a,".WebWin_main_c"),h=df.dom.query(a,".WebWin_header"),this._eElem.classList.add("Web_Resizing"),r=df.gui.dragMask(),a.appendChild(r),r.style.cursor=n,df.dom.on("mousemove",r,C,this),df.dom.on("mouseup",window,w,this),df.dom.on("mouseup",r,w,this)},getViewportElem:function(){return this.pbFloating&&this.pbModal?document.body:this._eRenderTo},blur:function(){},doClose:function(){this.pbShowClose&&this.hide()},resize:function(){this._bRendered&&(!this._eControlWrap||this.piHeight||this.piWidth||(this.piHeight=df.dom.clientHeight(this._eControlWrap),this.piWidth=df.dom.clientWidth(this._eControlWrap),this._eControlWrap.style.width=this.piWidth+"px",this._eHeader.style.width=this.piWidth+"px",this._eControlWrap.style.height=this.piHeight+"px"),this.resizeHorizontal(),this.resizeVertical())},setOuterHeight:function(e){e>0?(this._eControlWrap.style.height=e+"px",e-=this.getHeightDiff(!0,!0,!1,!1),this._eContainer.style.height=e+"px"):(this._eControlWrap.style.height="",this._eContainer.style.height="")},viewResize:function(e){var t,i;this.prepareSize(),t=df.dom.offsetHeight(this._eHeader)+df.dom.offsetHeight(this._eBottomLeft),e=df.dom.windowHeight()-20,(i=this.piHeight<=0?this._iWantedHeight:this.piHeight)>0&&i+t<e?this.setOuterHeight(i):this.setOuterHeight(e-t),this.resize()},getViewportWidth:function(){return df.sys.gui.getViewportWidth()},getViewportHeight:function(){return df.sys.gui.getViewportHeight()},onCloseClick:function(e){this.isEnabled()&&this.doClose()},onKey:function(e){e.matchKey(df.settings.formKeys.escape)?this.doClose():df.WebWindow.base.onKey.call(this,e)},onWindowResize:function(e){this.centerWindow()},centerWindow:function(){this._bRendered&&this._eElem&&(this._bHasTop||(this.piTop=this.getViewportHeight()/2-(this._eElem.clientHeight||this.piHeight)/2,df.sys.isMobile&&(this.piTop=.65*this.piTop),this.piTop=this.piTop>0?this.piTop:0),this._bHasLeft||(this.piLeft=this.getViewportWidth()/2-(this._eElem.clientWidth||this.piWidth)/2,this.piLeft=this.piLeft>0?this.piLeft:0),this._eElem.style.top=parseInt(this.piTop,10)+"px",this._eElem.style.left=parseInt(this.piLeft,10)+"px")}}),df.WebModalDialog=function(e,t){df.WebModalDialog.base.constructor.call(this,e,t),this.event("OnEscape",df.cCallModeWait),this.pbFloating=!0,this.pbModal=!0,this.pbScroll=!1},df.defineClass("df.WebModalDialog","df.WebWindow",{doClose:function(){this.fire("OnEscape")||df.WebModalDialog.base.doClose.call(this)},topLayer:function(){return this._eElem}}),df.WebButton=function(e,t){df.WebButton.base.constructor.call(this,e,t),this.prop(df.tString,"psCaption",""),this.prop(df.tString,"psTextColor",""),this.prop(df.tString,"psWaitMessage",""),this.prop(df.tBool,"pbShowWaitDialog",!1),this.prop(df.tInt,"peAlign",-1),this.event("OnClick",df.cCallModeWait),this.pbShowLabel=!1,this._sControlClass="WebButton",this._bJSSizing=!1},df.defineClass("df.WebButton","df.WebBaseControl",{create:function(){df.WebButton.base.create.apply(this,arguments),this.set_pbShowWaitDialog(this.pbShowWaitDialog)},openHtml:function(e){df.WebButton.base.openHtml.call(this,e),e.push('<button id="',this._sControlId,'"',this.isEnabled()?"":' disabled="disabled"'),this.peAlign>=0&&e.push(' style="text-align: ',df.sys.gui.cssTextAlign(this.peAlign),'"'),e.push(">",df.dom.encodeHtml(this.psCaption),"</button>")},afterRender:function(){this._eControl=df.dom.query(this._eElem,"button"),df.WebButton.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onBtnClick,this),df.events.addDomKeyListener(this._eElem,this.onKey,this)},onBtnClick:function(e){var t=null,i=!1,s=this._eElem;this.isEnabled()&&(df.dom.addClass(s,df.CssHit),t=setTimeout((function(){i&&df.dom.removeClass(s,df.CssHit),t=null}),df.hitTimeout),this.fire("OnClick",[],(function(e){e.bCanceled||this.psLoadViewOnClick&&this.getWebApp().showView(this.psLoadViewOnClick,!1),t||df.dom.removeClass(s,df.CssHit),i=!0})),e.stop())},applyEnabled:function(e){df.WebButton.base.applyEnabled.call(this,e),this._eControl&&(this._eControl.disabled=!e)},set_psCaption:function(e){this._eControl&&(df.dom.setText(this._eControl,e),this.sizeChanged())},set_pbShowWaitDialog:function(e){this.setActionMode("OnClick",e?df.cCallModeProgress:df.cCallModeWait,this.psWaitMessage)},set_psWaitMessage:function(e){this.setActionMode("OnClick",this.pbShowWaitDialog?df.cCallModeProgress:df.cCallModeWait,e)},onKey:function(e){e.matchKey(df.settings.formKeys.submit)&&e.stopPropagation()},set_peAlign:function(e){this._eControl&&(this._eControl.style.textAlign=df.sys.gui.cssTextAlign(e))}}),df.WebLabel=function(e,t){df.WebLabel.base.constructor.call(this,e,t),this.prop(df.tString,"psCaption",""),this.prop(df.tInt,"peAlign",0),this.prop(df.tBool,"pbShowBorder",!1),this.prop(df.tInt,"peWordBreak",df.wbPreWrap),this.pbShowLabel=!1,this._bFocusAble=!1,this._sControlClass="WebLabel"},df.defineClass("df.WebLabel","df.WebBaseControl",{openHtml:function(e){df.WebLabel.base.openHtml.call(this,e),e.push('<div class="WebLabel_content ',df.classWordBreak(this.peWordBreak),'">&nbsp;</div>')},closeHtml:function(e){df.WebLabel.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebLabel_content"),df.WebLabel.base.afterRender.call(this),this.set_peAlign(this.peAlign),this.set_psCaption(this.psCaption),this.set_pbShowBorder(this.pbShowBorder)},set_psCaption:function(e){this._eControl&&(df.dom.setText(this._eControl,e),e!==this.psCaption&&this.sizeChanged())},set_peWordBreak:function(e){this._eControl&&(df._eControl.className="WebLabel_content "+df.classWordBreak(e))},set_pbShowBorder:function(e){this._eControl&&(df.dom.toggleClass(this._eControl,"WebLabel_border",e),this.pbShowBorder!==e&&this.sizeChanged())},set_peAlign:function(e){this._eControl&&(this._eControl.style.textAlign=e===df.ciAlignLeft?"left":e===df.ciAlignCenter?"center":e===df.ciAlignRight?"right":"")}}),df.WebForm=function(e,t){df.WebForm.base.constructor.call(this,e,t),this.prop(df.tBool,"pbPromptButton",!1),this.prop(df.tBool,"pbPassword",!1),this.prop(df.tString,"psPlaceHolder",""),this.prop(df.tBool,"pbAutoTab",!1),this.prop(df.tString,"psInputMode",""),this.event("OnPrompt",df.cCallModeWait),this._eWrap=null,this._ePrompt=null,this._bAutoTabOnUp=!1,this._sControlClass="WebForm",this._bJSSizing=!1},df.defineClass("df.WebForm","df.WebBaseForm",{openHtml:function(e){df.WebForm.base.openHtml.call(this,e),e.push('<div class="WebFrm_Wrapper"><span class="WebFrm_Prompt"></span><div class="WebFrm_PromptSpacer">','<input type="',this.pbPassword?"password":"text",'"',' name="',this._sName,'"',' value="" id="',this._sControlId,'"'),this.psInputMode&&e.push(' inputmode="',this.psInputMode,'"'),e.push(this.peLabelPosition!=df.ciLabelFloat?' placeholder="'+df.dom.encodeAttr(this.psPlaceHolder)+'"':"",' autocomplete="',df.dom.encodeAttr(this.psAutoComplete),'"',this.isEnabled()?"":' disabled="disabled" tabindex="-1"',">")},closeHtml:function(e){e.push("</div></div>"),df.WebForm.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebFrm_Wrapper input"),this._ePrompt=df.dom.query(this._eElem,"div.WebFrm_Wrapper span.WebFrm_Prompt"),this._eWrap=df.dom.query(this._eElem,"div.WebFrm_Wrapper"),df.WebForm.base.afterRender.call(this),df.dom.on("click",this._ePrompt,this.onPromptClick,this),this.set_pbPromptButton(this.pbPromptButton)},set_pbPassword:function(e){if(this._eControl)if(df.sys.isIE&&df.sys.iVersion<9){var t=this._eControl.cloneNode(!1);t.type=e?"password":"text",this._eControl.parentNode.replaceChild(t,this._eControl),this._eControl=t}else this._eControl.type=e?"password":"text"},set_psBackgroundColor:function(e){this._eWrap&&(this._eWrap.style.background=e||"")},set_pbPromptButton:function(e){this._eWrap&&this._ePrompt&&df.dom.toggleClass(this._eWrap,"WebFrm_HasPrompt",e)},set_psPlaceHolder:function(e){this._eControl&&this.peLabelPosition!=df.ciLabelFloat&&(this._eControl.placeholder=e)},set_psInputMode:function(e){this._eControl&&(this._eControl.inputMode=e)},onPromptClick:function(e){this.isEnabled()&&(this.objFocus(),this.firePrompt()?e.stopPropagation():this.focus())},getVertHeightDiff:function(){var e=df.WebForm.base.getVertHeightDiff.call(this);return e+=df.sys.gui.getVertBoxDiff(this._eWrap)},onKey:function(e){df.WebForm.base.onKey.call(this,e),e.matchKey(df.settings.formKeys.prompt)&&this.firePrompt()&&e.stop()},firePrompt:function(){if(this.pbPromptButton)return this.fire("OnPrompt")},focus:function(e){if(this._bFocusAble&&this.isEnabled()&&this._eControl&&this._eControl.focus){try{this._eControl.focus(),e&&this._eControl.select()}catch(e){}return this.objFocus(),!0}return!1},onFocus:function(e){var t,i,s;t=df.dom.getCaretPosition(this._eControl),i=this._eControl.value.length-t,s=df.dom.getSelectionLength(this._eControl)>=this._eControl.value.length,df.WebForm.base.onFocus.call(this,e),t!==df.dom.getCaretPosition(this._eControl)&&(this.peDataType===df.ciTypeBCD&&(t=this._eControl.value.length-i),df.dom.setCaretPosition(this._eControl,t)),s&&this._eControl.select()},autoTab:function(){var e=this.maxLength();if(this._eControl.value.length==e){var t=df.dom.getSelection(this._eControl);if(0==t.length&&t.start==e)return this.focusNext(!0),!0}return!1},onKeyPressAutoTab:function(e){this._bAutoTabOnUp=!this.autoTab()},onKeyUpAutoTab:function(e){this._bAutoTabOnUp&&(this.autoTab(),this._bAutoTabOnUp=!1)},maxLength:function(){return this.peDataType===df.ciTypeBCD?this.piMaxLength+(this.piPrecision?this.decSep().length:0):this.peDataType===df.ciTypeDate?df.sys.data.dateToString(new Date(2020,10,10,10,10,10,10),this.dateFormat(),this.dateSep(),this.timeSep()).length:this.peDataType===df.ciTypeDateTime?df.sys.data.dateToString(new Date(2020,10,10,10,10,10,10),this.dateTimeFormat(),this.dateSep(),this.timeSep()).length:this.peDataType===df.ciTypeTime?df.sys.data.dateToString(new Date(2020,10,10,10,10,10,10),this.timeFormat(),this.dateSep(),this.timeSep()).length:this.psMask?this.psMask.length:this.piMaxLength},initMask:function(){this._eControl&&(df.dom.off("keypress",this._eControl,this.onKeyPressAutoTab,this),df.dom.off("keyup",this._eControl,this.onKeyUpAutoTab,this)),df.WebForm.base.initMask.call(this),this._eControl&&this.pbAutoTab&&(df.dom.on("keypress",this._eControl,this.onKeyPressAutoTab,this),df.dom.on("keyup",this._eControl,this.onKeyUpAutoTab,this))},set_pbAutoTab:function(e){this._eControl&&(this.pbAutoTab=e,this.initMask())}}),df.WebDateForm=function(e,t){df.WebDateForm.base.constructor.call(this,e,t),this.prop(df.tBool,"pbShowWeekNr",!0),this.prop(df.tBool,"pbShowToday",!0),this.prop(df.tInt,"piStartWeekAt",1),this.prop(df.tBool,"pbAutoShow",!1),this.prop(df.tBool,"pbHtml5NativeOnMobile",!0),this.pbPromptButton=!0,this._ePickerWrp=null,this._eFocus=null,this._bPickerVisible=!1,this._bSkipAutoShow=!1,this._bShowWait=!1,this._iWidth=0,this._iHeight=0,this._tOnChange=null,this._sControlClass="WebForm WebDateForm",this._eParentRef=null},df.defineClass("df.WebDateForm","df.WebForm",{afterRender:function(){df.WebDateForm.base.afterRender.call(this),this.pbHtml5NativeOnMobile&&df.sys.isMobile&&df.sys.supportHtml5Input("date")&&(this._ePrompt.innerHTML='<div class="WebDF_HiddenDate"><input type="date"></div>',this._eHtml5HiddenDate=df.dom.query(this._ePrompt,"input"),df.dom.on("change",this._eHtml5HiddenDate,this.html5OnChange,this),df.dom.on("input",this._eHtml5HiddenDate,this.html5OnChange,this))},destroy:function(){this._oFloatingPanel&&(this._oFloatingPanel.destroy(),this._oFloatingPanel=null,this._oPicker=null),df.WebDateForm.base.destroy.call(this)},set_pbShowWeekNr:function(e){this._oPicker&&this._oPicker.set("pbShowWeekNr",e)},set_pbShowToday:function(e){this._oPicker&&this._oPicker.set("pbShowToday",e)},set_piStartWeekAt:function(e){this._oPicker&&this._oPicker.set("piStartWeekAt",e)},setControlValue:function(e){df.WebDateForm.base.setControlValue.call(this,e),this._eHtml5HiddenDate&&(this._eHtml5HiddenDate.value=this._tValue&&df.sys.data.dateToString(this._tValue,"yyyy/mm/dd","-")||"")},html5OnChange:function(e){var t=this;this._tValue=df.sys.data.stringToDate(this._eHtml5HiddenDate.value,"yyyy-mm-dd","-"),this.refreshDisplay(this._tValue),this._tOnChange&&clearTimeout(this._tOnChange),this._tOnChange=setTimeout((function(){t.fireChange(),t._tOnChange=null}),150)},initPicker:function(){var e,t;e=this._oFloatingPanel=this.createPanel(),this.configurePanel(e),e.create(),this._oPicker=t=this.createDatePicker(),this.configureDatePicker(t),t.create(),e.addChild(t)},createPanel:function(){return new df.WebFloatingPanel(null,this)},configurePanel:function(e){e.psFloatByControl=this.getLongName(),e.piColumnCount=1,e.pbHideOnBlur=!0,e.pbFocusOnShow=!0,e.pbHideOnEscape=!0,e.pbNaturalWidth=!0,e.psCSSClass="NoWhitespace Shadow WebDateForm_FlPnl",e.OnHide.addListener(this.onPanelClose,this)},createDatePicker:function(){return new df.WebDatePicker(null,this)},configureDatePicker:function(e){e.pbShowLabel=!1,e.psValue=this.getServerVal(),e.piColumnSpan=0,e.pbShowWeekNr=this.pbShowWeekNr,e.pbShowToday=this.pbShowToday,e.piStartWeekAt=this.piStartWeekAt,e.psMask=this.getWebApp().psDateFormat,e.psCSSClass="WebDatePicker_Form NoWhitespace",e.OnRealtimeChange.addListener(this.onPickerChange,this),e.OnEnter.addListener(this.onPickerEnter,this)},renderPicker:function(){var e,t=this._oFloatingPanel;(e=t.render())&&this._eElem.parentNode.insertBefore(e,this._eElem),t.afterRender(),t.resizeHorizontal(),t.resizeVertical()},showPicker:function(){this._oFloatingPanel||this.initPicker(),this._oFloatingPanel._eElem||this.renderPicker(),this._oPicker._bBuddyActive=!0,this._oPicker.set("psValue",this.getServerVal()),this._oFloatingPanel.show(),this._bPickerVisible=!0},hideDatePicker:function(e){this._bPickerVisible=!1,this._oFloatingPanel&&(this._oPicker._bBuddyActive=!1,this._oFloatingPanel.hide())},firePrompt:function(){if(this.isEnabled()&&!this.pbReadOnly)return this._eHtml5HiddenDate?(this.updateTypeVal(),this._tValue?this._eHtml5HiddenDate.value=df.sys.data.dateToString(this._tValue,"yyyy/mm/dd","-"):this._eHtml5HiddenDate.value="",!0):(this.showPicker(),!0)},onPickerChange:function(e){this._tValue=e.dValue,this.refreshDisplay(e.dValue)},onPickerEnter:function(e){this.peDataType!==df.ciTypeDate&&this.peDataType!==df.ciTypeDateTime||(this._tValue=e.dValue,this.refreshDisplay(this._tValue)),this.hideDatePicker(),this.focus(),this.fireChange()},onPanelClose:function(e){var t=e.aParams[0];this.fireChange(),"auto_blur"!==t&&(this._bSkipAutoShow=!0,this.focus())},onFocus:function(e){df.WebDateForm.base.onFocus.call(this,e),this.pbAutoShow&&this.isEnabled()&&!this.pbReadOnly&&!this._bSkipAutoShow&&this.showPicker(),this._bSkipAutoShow=!1}}),df.tQueuedSyncProp={sO:df.tString,sP:df.tString,bA:df.tBool,sV:df.tString,tVT:{}},df.tSyncPropsWrapper={bReset:df.tBool,aSyncProps:[{sO:df.tString,aP:[{sN:df.tString,sV:df.tString}]}]},df.tAdvSyncPropsWrapper={bReset:df.tBool,aAdvSyncProps:[{sO:df.tString,sP:df.tString,tV:{}}]},df.WebDynamicObjectContainerBase=df.mixin("df.WebBaseContainer_mixin","df.WebBaseControl"),df.WebDynamicObjectContainer=function(e,t){df.WebDynamicObjectContainer.base.constructor.call(this,e,t),this.prop(df.tAdv,"ptSyncPropsWrapper",null),this.prop(df.tAdv,"ptAdvSyncPropsWrapper",null),this.addSync("ptSyncPropsWrapper"),this.addSync("ptAdvSyncPropsWrapper"),this._aSyncPropQueue=[],this._bReset=!1,this._aSyncPropCache=[],this._aAdvSyncPropCache=[],this._sBaseClass="WebControl",this._sControlClass="WebDynCon"},df.defineClass("df.WebDynamicObjectContainer","df.WebDynamicObjectContainerBase",{getRef:function(){df.WebDynamicObjectContainer.base.getRef.call(this),this._eControl=df.dom.query(this._eElem,"div.WebCon_Inner > div")},getMinHeight:function(){var e=0;return this.resize(),e=this.pbScroll?this.pbFillHeight?this.piMinHeight:Math.max(this.piHeight,this.piMinHeight):this.getRequiredHeight(),this._eControl&&(e+=df.sys.gui.getVertBoxDiff(this._eControl),e+=df.sys.gui.getVertBoxDiff(this._eInner),e+=df.sys.gui.getVertBoxDiff(this._eControlWrp)),e<this.piMinHeight&&(e=this.piMinHeight),e},setHeight:function(e,t){this._eControl&&(e>0?(e=(e-=this.getVertHeightDiff())<0?0:e,this._eContainer.style.height=e+"px"):this._eContainer.style.height="")},wrpOpenHtml:function(e){e.push('<div class="WebContainer">')},wrpCloseHtml:function(e){e.push("</div>")},loadQueuedSyncProps:function(){for(var e,t=this._tActionData,i=0;i<t.length;i++)(e=t[i]).bA&&(e.tV=this.deserializeVT(sVal.c[4])),this._aSyncPropQueue.push(e)},loadDynamicObjects:function(){for(var e,t=this._tActionData,i=0;i<t.length;i++)e=t[i],this.initDynamicObject(e,this,!1)._oOwner=this;this._eElem&&(this.renderChildren(),this.afterRender(),this.position(),this.getWebApp().resize()),this.emptyPropCache()},insertDynamicObject:function(e,t){var i,s,o,n,r=this._tActionData;o=(s=this.getWebApp().findObj(e)||this)[t]||null,i=this.initDynamicObject(r,s,!0),this._eElem&&(n=null!==o?s._aChildren.indexOf(o)+1:0,s.insertChild(i,n),s.renderChild(i),this.getWebApp().resize())},insertDynamicObjectAtIndex:function(e,t){var i,s,o=this._tActionData;s=this.getWebApp().findObj(e)||this,i=this.initDynamicObject(o,s,!0),this._eElem&&(s.insertChild(i,t),s.renderChild(i),this.getWebApp().resize())},prependDynamicObject:function(e){var t,i,s=this._tActionData;i=this.getWebApp().findObj(e)||this,t=this.initDynamicObject(s,i,!0),this._eElem&&(i.insertChild(t,0),i.renderChild(t),this.getWebApp().resize())},appendDynamicObject:function(e){var t,i,s,o=this._tActionData;i=this.getWebApp().findObj(e)||this,t=this.initDynamicObject(o,i,!0),this._eElem&&(s=i._aUIObjects.length,i.insertChild(t,s),i.renderChild(t),this.getWebApp().resize())},moveDynamicObject:function(e,t){var i,s,o,n,r,a,l,h=this.getWebApp();i=h.findObj(e),r=(n=h.findObj(t))._oParent,o=i._oParent,s=i._eElem,i._oParent=r,o.removeChild(i),l=null!==n?r._aChildren.indexOf(n)+1:0,r.insertChild(i,l,n),r.renderChild(i,s),a=i.getObjectLevel();for(var d=0;d<a;d++)h.resize()},moveDynamicObjectToIndex:function(e,t,i){var s,o,n,r,a,l=this.getWebApp();s=l.findObj(e),r=l.findObj(t),n=s._oParent,o=s._eElem,s._oParent=r,n.removeChild(s),r.insertChild(s,i),r.renderChild(s,o),a=s.getObjectLevel();for(var h=0;h<a;h++)l.resize()},destroyDynamicObject:function(e){var t,i,s;(i=(t=this.getWebApp().findObj(e))._oParent).removeChild(t),i.unrenderChild(t),t.destroy(),s=i.getObjectLevel();for(var o=0;o<s;o++)this.getWebApp().resize()},initDynamicObject:function(e,t,i){var s,o,n,r,a=this.getWebApp();if(t[e.sName])throw new df.Error(999,"Naming conflict with child object '{{0}}'",this,[e.sName]);if("function"!=typeof(r=a.getConstructor(e.sType,e)))throw new df.Error(999,"Could not find class '{{0}}'",this,[e.sType]);for(t[e.sName]=n=new r(e.sName,t),s=0;s<e.aProps.length;s++){if("_"===(o=e.aProps[s].sN).charAt(0))throw new df.Error(999,"Published property '{{0}}' of object '{{1}}' properties should not start with an '_'",this,[e.aProps[s].sV,e.sName]);if(n[o]&&("object"==typeof n[o]||"function"==typeof n[o]))throw new df.Error(999,"Naming conflict with property '{{0}}' of object '{{1}}'",this,[o,e.sName]);n._set(o,e.aProps[s].sV,!1,!1)}if(e.aAdvP)for(s=0;s<e.aAdvP.length;s++){if("_"===(o=e.aAdvP[s].sN).charAt(0))throw new df.Error(999,"Published property '{{0}}' of object '{{1}}' properties should not start with an '_'",this,[e.aAdvP[s].sV,e.sName]);if(n[o]&&("object"==typeof n[o]||"function"==typeof n[o]))throw new df.Error(999,"Naming conflict with property '{{0}}' of object '{{1}}'",this,[o,e.sName]);n._oTypes[o]||(n._oTypes[o]=df.tAdv),n._set(o,e.aAdvP[s].tV,!1,!1)}for(this.applyQueuedSyncProps(n),n._oOwner=this,i||a.newWebObject(n,t),s=0;s<e.aObjs.length;s++)this.initDynamicObject.call(this,e.aObjs[s],n,!1);return n.create(e),n},resetContainer:function(){for(var e=0;e<this._aChildren.length;e++)this._aChildren[e].destroy();this._aChildren=[],this._aFloats=[],this._aUIObjects=[],this._aPanels=[],this._aSyncPropQueue=[],this._bReset=!1,this.getWebApp().resize()},applyQueuedSyncProps:function(e){var t,i,s;i=this._aSyncPropQueue.filter((function(t){return t.sO===e.getLongName()})),this._aSyncPropQueue=this._aSyncPropQueue.filter((function(t){return t.sO!==e._sName}));for(var o=0;o<i.length;o++)t=(s=i[o]).bA?s.tVT:s.sV,e.addSync(s.sP),e.set(s.sP,t)},emptyPropCache:function(){this.handleSyncProps(this._aSyncPropCache),this.handleAdvSyncProps(this._aAdvSyncPropCache),this._aSyncPropCache=[],this._aAdvSyncPropCache=[]},getSynced:function(e,t){var i,s,o=[],n=this.getLongName();for(i in this._oSynced)this._oSynced.hasOwnProperty(i)&&(s=this.get(i),this._oTypes[i]&&(s=this.toServerType(s,this._oTypes[i])),void 0===s&&(s=null),this._oTypes[i]===df.tAdv?t.push({sO:n,sP:i,tV:s}):o.push({sN:i,sV:s}));o.length>0&&e.push({sO:n,aP:o})},handleSyncProps:function(e){var t,i,s,o,n=this.getWebApp();for(t=0;t<e.length;t++)if(s=e[t],i=n.findObj(s.sO))for(o=0;o<s.aP.length;o++)i._set(s.aP[o].sN,s.aP[o].sV,!0,!0)},handleAdvSyncProps:function(e){var t,i,s,o=this.getWebApp();for(t=0;t<e.length;t++)i=e[t],(s=o.findObj(i.sO))&&s._set(i.sP,i.tV,!0,!0)},set_ptSyncPropsWrapper:function(e){var t;(t=df.sys.vt.deserialize(e,df.tSyncPropsWrapper)).bReset?(this._bReset=!0,this._aSyncPropCache=this._aSyncPropCache.concat(t.aSyncProps)):this.handleSyncProps(t.aSyncProps)},get_ptSyncPropsWrapper:function(){for(var e,t=[],i=[],s=0;s<this._aChildren.length;s++)this._aChildren[s].getSynced(t,i);for(var o=0;o<t.length;o++)t[o].aP.sort((function(e,t){return e.sN>t.sN?1:t.sN>e.sN?-1:0}));return e={bReset:this._bReset,aSyncProps:t},df.sys.vt.serialize(e,df.tSyncPropsWrapper)},set_ptAdvSyncPropsWrapper:function(e){var t;t=df.sys.vt.deserialize(e,df.tAdvSyncPropsWrapper);for(var i=0;i<e.c[1].c.length;i++)t.aAdvSyncProps[i].tV=e.c[1].c[i].c[2];t.bReset?(this._bReset=!0,this._aAdvSyncPropCache=this._aAdvSyncPropCache.concat(t.aAdvSyncProps)):this.handleAdvSyncProps(t.aAdvSyncProps)},get_ptAdvSyncPropsWrapper:function(){for(var e,t=[],i=[],s=0;s<this._aChildren.length;s++)this._aChildren[s].getSynced(t,i);for(var o=0;o<i.length;o++)i[o].aP.sort((function(e,t){return e.sN>t.sN?1:t.sN>e.sN?-1:0}));return e={bReset:this._bReset,aAdvSyncProps:i},df.sys.vt.serialize(e,df.tAdvSyncPropsWrapper)},getLongNamePrnt:function(){return this.getLongName()+"$"},onFocus:function(e){},onBlur:function(e){},serializeAdvSyncProps:function(e){function t(e){return{v:"",c:[{v:e.sO.toString(),c:[]},{v:e.sP.toString(),c:[]},this.serializeVT(e.tV)]}}function i(e){var i,s={v:"",c:[]};for(i=0;i<e.length;i++)s.c.push(t(e[i]));return s}try{return function(e){var t,s,o={v:"",c:[]};for(t=0;t<e.length;t++)o.c.push({v:"",c:[{v:(s=e[t]).sO.toString(),c:[]},i(s.aP)]});return o}(e)}catch(e){throw new df.Error(999,"Unable to serialize AdvSyncProps array, invalid data format!\n\r\n\rMSG: {{0}}",this,[e.message])}}}),df.WebCheckbox=function(e,t){df.WebCheckbox.base.constructor.call(this,e,t),this.prop(df.tString,"psChecked","1"),this.prop(df.tString,"psUnchecked","0"),this.prop(df.tString,"psCaption",""),this.pbServerOnChange=!1,this.psClientOnChange="",this._eCaption=null,this._sControlClass="WebCheckbox"},df.defineClass("df.WebCheckbox","df.WebBaseDEO",{openHtml:function(e){df.WebCheckbox.base.openHtml.call(this,e),e.push('<input type="checkbox" id="',this._sControlId,'"',this.isEnabled()?"":' disabled="disabled" tabindex="-1"','><span class="WebCB_Fake"></span><label class="WebCheckbox_Caption" for="',this._sControlId,'"></label>'),this._oParent?._bIsContainer&&this._oParent?.isFlowLayout()&&e.push('<div style="clear: both"></div>')},afterRender:function(){this._eControl=df.dom.query(this._eElem,"input"),this._eCaption=df.dom.query(this._eElem,"label.WebCheckbox_Caption"),this._eFakeBox=df.dom.query(this._eElem,".WebCB_Fake"),this.set_psCaption(this.psCaption),df.WebCheckbox.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onClick,this),df.dom.on("click",this._eFakeBox,this.onFakeClick,this)},getControlValue:function(){return this._eControl?this._eControl.checked?this.psChecked:this.psUnchecked:this.psValue},setControlValue:function(e){this._eControl&&(this._eControl.checked=e===this.psChecked)},set_psValue:function(e){df.WebCheckbox.base.set_psValue.call(this,e),this._sPrevChangeVal=this.get_psValue()},set_psCaption:function(e){this._eCaption&&(df.dom.setText(this._eCaption,e),this.psCaption!==e&&this.sizeChanged())},set_psTextColor:function(e){this._eCaption&&(this._eCaption.style.color=e||"")},set_psToolTip:function(e){df.WebCheckbox.base.set_psToolTip.call(this,e),this._eFakeBox&&(this._eFakeBox.title=e),this._eCaption&&(this._eCaption.title=e)},tick:function(){this._eControl&&this.isEnabled()&&(this._eControl.checked=!this._eControl.checked,this.fireChange())},onClick:function(e){this.fireChange()},onFakeClick:function(e){this.isEnabled()&&(this.tick(),this.focus(),this.fireChange())}}),df.WebEdit=function(e,t){df.WebEdit.base.constructor.call(this,e,t),this.prop(df.tBool,"pbStopOnSubmit",!0),this.prop(df.tString,"psPlaceHolder",""),this._eWrap=null,this._ePrompt=null,this._sControlClass="WebEdit",this._bJSSizing=!1},df.defineClass("df.WebEdit","df.WebBaseForm",{openHtml:function(e){df.WebEdit.base.openHtml.call(this,e),e.push('<div class="WebFrm_Wrapper"><textarea name="',this._sName,'"',' autocomplete="',df.dom.encodeAttr(this.psAutoComplete),'"',this.peLabelPosition!=df.ciLabelFloat?' placeholder="'+df.dom.encodeAttr(this.psPlaceHolder)+'" ':"",this.isEnabled()?"":' disabled="disabled" tabindex="-1"',"></textarea></div>")},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebFrm_Wrapper textarea"),this._eWrap=df.dom.query(this._eElem,"div.WebFrm_Wrapper"),df.WebEdit.base.afterRender.call(this),df.events.addDomKeyListener(this._eElem,this.onKey,this)},set_psBackgroundColor:function(e){this._eWrap&&(this._eWrap.style.background=e||"")},set_psPlaceHolder:function(e){this._eControl&&this.peLabelPosition!=df.ciLabelFloat&&(this._eControl.placeholder=e)},get_pbChanged:function(){var e=this._sOrigValue;return!!this.pbChanged||(this._eElem&&(this.updateTypeVal(),e=e.replace(/\r\n|\r/g,"\n")),e!==this.getServerVal())},getVertHeightDiff:function(){var e=df.WebEdit.base.getVertHeightDiff.call(this);return e+=df.sys.gui.getVertBoxDiff(this._eWrap),df.sys.isChrome&&(e++,e++),e},onKey:function(e){e.matchKey(df.settings.formKeys.submit)&&this.pbStopOnSubmit?e.stopPropagation():df.WebEdit.base.onKey.apply(this,arguments)}}),df.tWebComboItem={sValue:df.tString,sDescription:df.tString},df.WebCombo=function(e,t){df.WebCombo.base.constructor.call(this,e,t),this.prop(df.tInt,"peSortItems",df.csUnsorted),this._bFilled=!1,this._sControlClass="WebCombo",this._aValues=null,this._bDeferedSet=!1},df.defineClass("df.WebCombo","df.WebBaseDEO",{openHtml:function(e){df.WebCombo.base.openHtml.call(this,e),e.push('<div class="WebFrm_Wrapper"><select name="',this._sName,'" id="',this._sControlId,'"',this.isEnabled()?"":' disabled="disabled" tabindex="-1"',"></select></div>")},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebFrm_Wrapper > select"),this._eWrap=df.dom.query(this._eElem,"div.WebFrm_Wrapper"),df.WebCombo.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onClick,this),this.updateList(this.psValue)},deserializeVT:df.sys.vt.generateDeserializer([df.tWebComboItem]),fill:function(){var e=this._tActionData;this._aValues=this.deserializeVT(e),this.sortList(),this.updateList(this._sPrevChangeVal)},sortList:function(){var e;this.peSortItems===df.csValue?(e=df.sys.data.compareFunction(this.peDataType),this._aValues.sort((function(t,i){return e(t.sValue,i.sValue)}))):this.peSortItems===df.csDescription&&this._aValues.sort((function(e,t){return df.sys.data.compareText(e.sDescription,t.sDescription)}))},updateList:function(e){var t,i,s=this._aValues;if(this._eControl&&s){for(;this._eControl.options.length>0;)this._eControl.remove(0);for(i=0;i<s.length;i++)t=new Option(s[i].sDescription,s[i].sValue),this._eControl.options[this._eControl.options.length]=t,s[i].sValue===e&&(t.selected=!0);this._bFilled=!0}},getControlValue:function(){return this._eControl&&this._bFilled?this._eControl.value:this.psValue},setControlValue:function(e){this._eControl&&this._bFilled?(this._eControl.value=e,this._bDeferedSet=this._eControl.value!==e):this._bDeferedSet=!0},fireChange:function(){this._bDeferedSet=!1,df.WebCombo.base.fireChange.call(this)},set_pbCapslock:function(e){},set_psBackgroundColor:function(e){this._eWrap&&(this._eWrap.style.background=e||"")},onClick:function(e){this.fireChange()},onKey:function(e){var t=this;df.WebCombo.base.onKey.call(this,e),setTimeout((function(){t.fireChange()}),10)}}),df.WebBaseSelectionForm=function(e,t){df.WebBaseSelectionForm.base.constructor.call(this,e,t),this.prop(df.tBool,"pbCaseSensitive",!1),this.prop(df.tBool,"pbFullText",!1),this.prop(df.tInt,"piPageSize",15),this.prop(df.tInt,"piStartAtChar",2),this.prop(df.tInt,"piPopupWidth",0),this.prop(df.tString,"psShowMoreText","Show more..."),this.prop(df.tString,"psCreateNewItemText","Create new item"),this.prop(df.tBool,"pbSourceIsValidationTable",!1),this.prop(df.tInt,"piMinimumItemLength",2),this.prop(df.tBool,"pbAllowCreate",!1),this.prop(df.tInt,"piTypeTimeout",20),this.prop(df.tBool,"pbAllData",!1),this.prop(df.tBool,"pbSuggestions",!1),this.prop(df.tBool,"pbPaged",!1),this._eSuggestions=null,this._bForceDisplay=!1,this._tRepos=null,this._aSuggestRows=[],this._aShownSuggestions=[],this._oSelectedSuggestion=null,this._iMaxCells=1,this._bFirstFetch=!0,this._TotalOfControlRows=0,this._ShowNextHandle=!1,this._iPage=0,this._iAdditionalItems=0,this._oPrevItem=null},df.defineClass("df.WebBaseSelectionForm","df.WebForm",{afterRender:function(){this._eSuggestions=df.dom.create('<div class="WebBaseSelectionForm WebSuggestions'+(this.psCSSClass.length>0?" "+this.psCSSClass:"")+' WebSug_Hidden"><div class="WebSug_Content"></div></div>'),this._eSugContent=df.dom.query(this._eSuggestions,"div.WebSug_Content"),this._eSugSuggestions=df.dom.create('<div class="WebSug_Suggestions"></div>'),this._eSugControls=df.dom.create('<div class="WebSug_Controls"></div>'),this._eSugContent.appendChild(this._eSugSuggestions),this._eSugContent.appendChild(this._eSugControls),this._eInputBox=df.dom.query(this._eElem,".WebFrm_PromptSpacer"),this._eControl=df.dom.query(this._eInputBox,"input"),df.WebBaseSelectionForm.base.afterRender.call(this),df.dom.addClass(this._eElem,"WebSelectionForm"),(this.topLayer()||document.body).appendChild(this._eSuggestions),df.dom.on("keyup",this._eControl,this.onSuggestKey,this),df.dom.on("click",this._eSuggestions,this.onSuggestClick,this),df.dom.on("click",this._eInputBox,this.inputBoxOnClick,this),df.dom.on("resize",window,this.onWindowResize,this),this.set_pbReadOnly(this.pbReadOnly),this.set_pbEnabled(this.isEnabled())},getSearchValue:function(){return this.pbReadOnly?"":this.pbCapslock?this.getServerVal().toUpperCase():this.getServerVal()},applyEnabled:function(e){df.WebBaseSelectionForm.base.applyEnabled.call(this,e),!this._eControl||this.pbReadOnly&&e||(this._eControl.contentEditable=e)},set_pbReadOnly:function(e){this.pbReadOnly=e,this._eControl&&(this.pbReadOnly||this.isEnabled())&&(this._eControl.contentEditable=!this.pbReadOnly),this.set_pbPromptButton(this.pbPromptButton&&!e)},inputBoxOnClick:function(e){"Range"!=window.getSelection().type&&this.isEnabled()&&(this._eControl.focus(),e.stop())},suggestSelect:function(){let e=this.getSearchValue().trim();if(this._oSelectedSuggestion&&this._oSelectedSuggestion.control)switch(this._oSelectedSuggestion.sRowId){case"more":return this.handleMoreButton(),void this.suggestMove(-1);case"create":if(!(this.isEnabled()&&this.pbAllowCreate&&e.length>=this.piMinimumItemLength))return;this.serverAction("CreateNewByValue",[e],null,null)}else this.isEnabled()&&1==this.pbAllowCreate&&e.length>=this.piMinimumItemLength&&this.serverAction("CreateNewByValue",[e],null,null);this._eControl.value="",this.suggestHide()},handleMoreButton:function(){this._bLastItemOnServer||this._bMoreRequested||(this._bMoreRequested=!0,this.pbPaged&&this._iPage++,this.suggestLoad())},onSuggestClick:function(e){let t=e.getTarget();for(;"TR"!==t.tagName&&t.parentNode&&t!==this._eSugContent;)t=t.parentNode;if(t.hasAttribute("data-dfrowid")){let e=this._aShownSuggestions[parseInt(t.getAttribute("data-dfrowid"))];e&&(this.suggestHightlight(e),this.suggestSelect(),this.focus())}},suggestUpdate:function(){this.updateTypeVal();let e=this.getSearchValue().trim();if(e!==this._sSuggestPrevVal||this._bForceDisplay)if(this._sSuggestPrevVal=e,e.length>=this.piStartAtChar||this._bForceDisplay){if(this._bSuggestVisible&&this._sSuggestBaseVal&&e.substr(0,this._sSuggestBaseVal.length)==this._sSuggestBaseVal)return void this.suggestRefine(e);this.suggestDisplay(),this.suggestLoad()}else this._bSuggestVisible&&this.suggestHide()},clientFilter:function(e,t){let i=[],s=this.getSearchValue();const o=new RegExp(df.sys.data.escapeRegExp(s),this.pbCaseSensitive||this.pbCapslock?"":"i");for(let n=0;n<e.length;n++)if(e[n].control)i.push(e[n]);else for(let r=0;r<e[n].aValues.length;r++)if(this.pbFullText){if(o.test(e[n].aValues[r])){i.push(e[n]),t&&t(e[n]);break}}else if(this.pbCaseSensitive||this.pbCapslock){if(0==e[n].aValues[r].indexOf(s)){i.push(e[n]),t&&t(e[n]);break}}else if(0==e[n].aValues[r].toLowerCase().indexOf(s.toLowerCase())){i.push(e[n]),t&&t(e[n]);break}return this.extraFilterOnHandle?this.extraFilterOnHandle(i):i},suggestHandle:function(e,t){var i=this;let s,o,n;if(this._bFirstFetch=!1,this._bMoreRequested=!1,this._bLastItemOnServer=1==t,s=this._tActionData,this.updateTypeVal(),this._eControl&&(o=this.getSearchValue()),o!==e){if(o.substr(0,e)!=e)return;n=!0}this._iMaxCells=0;for(let e=0;e<s.length;e++)s[e].aValues.length>this._iMaxCells&&this._iMaxCells++;var r;this._sSuggestBaseVal=e,this._iPage>0&&this.pbPaged?this._aSuggestRows=this._aSuggestRows.concat(s):this._aSuggestRows=s,this._oPrevItem=this._aSuggestRows[this._aSuggestRows.length-1];let a=this.clientFilter(this._aSuggestRows,(function(e){r=r||i._oSelectedSuggestion&&e.aValues[0]==i._oSelectedSuggestion.aValues[0]}));r||(this._oSelectedSuggestion=this._aShownSuggestions.length>0?this._aShownSuggestions[0]:null),this._TotalOfControlRows=this.AddControlSuggestions(a);let l=-1;this._oSelectedSuggestion&&(l=this.findIndexByValue(this._oSelectedSuggestion.aValues[0],a)),this._oSelectedSuggestion=l<0?a.length>0?a[0]:null:a[l],n?this.suggestRefine(o):this.suggestRender(e),this._ShowNextHandle&&(this._ShowNextHandle=!1,this.showSuggestions())},AddControlSuggestions:function(e){let t=e.length,i=this.getSearchValue().trim();!this._bLastItemOnServer&&this.pbPaged&&e.length>0&&!this.pbAllData&&e.push({control:!0,sRowId:"more",aValues:["("+this.psShowMoreText+")"],sCssClassName:"Sugg_ControlSuggestion"});let s=!0;return this._aShownSuggestions&&(s=!(this._aShownSuggestions.length>0&&this._aShownSuggestions[0].aValues[0]==i)),s&&this.pbAllowCreate&&i.length>0&&e.push({control:!0,sRowId:"create",aValues:["("+this.psCreateNewItemText+(i.length>0?' "'+df.dom.encodeAttr(df.dom.encodeHtml(i))+'"':"")+")"],sCssClassName:"Sugg_ControlSuggestion"}),e.length-t},suggestRender:function(e){if(!this._eSuggestions)return;var t,i,s,o;this.pbFullText?o=new RegExp(df.sys.data.escapeRegExp(e),this.pbCaseSensitive||this.pbCapslock?"g":"gi"):(t=e.toLowerCase(),i=e.length);var n=this;function r(e,r,a){function l(e){return"<b>"+e+"</b>"}let h=0;for(a.push('<tr data-dfrowid="',e,'" class="WebSug_Suggestion ',r.sCssClassName,n._oSelectedSuggestion&&r.aValues[0]==n._oSelectedSuggestion.aValues[0]?" WebSug_Selected":"",'">'),h=0;h<r.aValues.length;h++)s=df.dom.encodeHtml(r.aValues[h]),a.push("<td>"),r.control||n.pbSourceIsValidationTable&&0!=h?a.push(s):n.pbFullText?a.push(s.replace(o,l)):s.length>0&&s.substr(0,i).toLowerCase()==t?a.push("<b>",s.substr(0,i),"</b>",s.substr(i)):a.push(s),a.push("</td>");for(;h++<n._iMaxCells;)a.push("<td></td>");a.push("</tr>")}let a=[];this._aShownSuggestions=this.clientFilter(this._aSuggestRows),this._TotalOfControlRows=this.AddControlSuggestions(this._aShownSuggestions);var l=[];l.push("<table>");let h=this.pbSuggestions?this._aShownSuggestions.length<this.piPageSize?this._aShownSuggestions.length:this.piPageSize:this._aShownSuggestions.length;for(let e=0;e<h;e++)this._aShownSuggestions[e].control?a.push({iIndex:e,oObj:this._aShownSuggestions[e]}):r(e,this._aShownSuggestions[e],l);l.push("</table>");var d=[];d.push("<table>");for(let e=0;e<this._TotalOfControlRows;e++)r(a[e].iIndex,a[e].oObj,d);d.push("</table>"),this._eSugSuggestions.innerHTML=l.join(""),this._eSugControls.innerHTML=d.join(""),this.suggestPosition()},suggestRefine:function(e){var t=this,i=!1;this._aShownSuggestions=this.clientFilter(this._aSuggestRows,(function(e){i=i||t._oSelectedSuggestion&&e.aValues[0]==t._oSelectedSuggestion.aValues[0]})),i||(this._oSelectedSuggestion=this._aShownSuggestions.length>0?this._aShownSuggestions[0]:null),this.suggestRender(e),this._bSuggestVisible&&this.suggestDisplay(),this.afterSuggestRefine()},afterSuggestRefine:function(e){this._aShownSuggestions.length-this._TotalOfControlRows<this.piPageSize&&!this._bLastItemOnServer&&this.pbPaged&&this.handleMoreButton()},suggestMove:function(e){var t,i=this._aShownSuggestions=this.clientFilter(this._aSuggestRows);this._TotalOfControlRows=this.AddControlSuggestions(i),this._oSelectedSuggestion?((t=this.findIndexByValue(this._oSelectedSuggestion.aValues[0],i)+e)>=i.length?t=0:t<0&&(t=i.length-1),this.suggestHightlight(i[t])):this.suggestHightlight(i.length>0?i[0]:null)},suggestHightlight:function(e){var t,i,s,o;this._oSelectedSuggestion=e,this._aShownSuggestions=this.clientFilter(this._aSuggestRows),this._TotalOfControlRows=this.AddControlSuggestions(this._aShownSuggestions);for(let e=0;e<this._aShownSuggestions.length&&!(o=this._oSelectedSuggestion&&this._aShownSuggestions[e].aValues[0]==this._oSelectedSuggestion.aValues[0]);e++);o||(this._oSelectedSuggestion=this._aShownSuggestions.length>0?this._aShownSuggestions[0]:null),this.updateTypeVal(),this.suggestRender(this.getSearchValue()),(t=df.dom.query(this._eSugSuggestions,"tr.WebSug_Selected"))&&(s=(i=df.sys.gui.getAbsoluteOffset(t).top)+t.offsetHeight,i-this._eSugSuggestions.scrollTop<0?this._eSugSuggestions.scrollTop=i:s>this._eSugSuggestions.clientHeight+this._eSugSuggestions.scrollTop&&(this._eSugSuggestions.scrollTop=s-this._eSugSuggestions.clientHeight))},findSuggestionByValue:function(e){let t=this.findIndexByValue(e,this._aSuggestRows);return-1!=t?this._aSuggestRows[t]:null},findIndexByValue:function(e,t){for(let i=0;i<t.length;i++)if(t[i].aValues[0]==e)return i;return-1},onSuggestKey:function(e){var t=df.settings.suggestionKeys,i=e.getKeyCode();this.isEnabled()&&!this.pbReadOnly?(e.matchKey(t.forceDisplay)&&(this._bForceDisplay=!0,this._bSuggestVisible||this.suggestDisplay(),e.stop()),(this._bSuggestVisible||this.getSearchValue().length>0||!e.isSpecialKey()&&(i<112||i>127))&&this.suggestUpdate(),this._bForceDisplay=!1):e.stop()},suggestLoad:function(e){var t=this;e&&(this._overrideDoLoad=e,this.invalidateCache()),df.dom.addClass(this._eSuggestions,"WebSug_Loading"),this._eElem&&df.dom.addClass(this._eElem,"WebSug_Loading"),this._tSuggestUpdate||(this._tSuggestUpdate=setTimeout((function(){t._tSuggestUpdate=null,t.updateTypeVal(),t.suggestDoLoad(t.getSearchValue()),t._bSuggestVisible&&t.suggestDisplay()}),this.piTypeTimeout))},suggestDoLoad:function(e){this.pbAllData&&(e=""),!this.pbAllData||0===this._aSuggestRows.length||this._overrideDoLoad?(this._overrideDoLoad=!1,!this._bSuggestLoading&&this.isEnabled()?(this._bSuggestLoading=!0,this.serverAction("FindSuggestions",[e,this._iPage,this._iAdditionalItems],this._oPrevItem,(function(){this._bSuggestLoading=!1,this._sSuggestNextLoad?(this.suggestDoLoad(this._sSuggestNextLoad),this._sSuggestNextLoad=null):(this._eSuggestions&&df.dom.removeClass(this._eSuggestions,"WebSug_Loading"),this._eElem&&df.dom.removeClass(this._eElem,"WebSug_Loading"),this._bSuggestVisible&&this.suggestDisplay())}),this)):this._sSuggestNextLoad=e):this.suggestHightlight(this._oSelectedSuggestion)},suggestDisplay:function(){let e=df.dom.query(this._eSugSuggestions,"tbody"),t=df.dom.query(this._eSugControls,"tbody");if(e){if(0==e.childNodes.length&&0==t.childNodes.length)return void this.suggestHide()}else if(!this._bFirstFetch){let e=!0;if(t&&t.childNodes.length>0&&(e=!1),e)return this.suggestHide(),void(this._ShowNextHandle=!0)}if(this.isEnabled()){df.dom.addClass(this._eSuggestions,"WebSug_Visible"),df.dom.removeClass(this._eSuggestions,"WebSug_Hidden");let i=0;if(e){let s=e.childNodes.length>this.piPageSize?this.piPageSize:e.childNodes.length;if(s>0)i=df.sys.gui.getBoundRect(e.childNodes[0]).height*s;else{let e=!0;if(t&&t.childNodes.length>0&&(e=!1),e)return void this.suggestHide()}}this._eSugSuggestions.style.height=i+"px",this.suggestPosition(),this.suggestHightlight(this._oSelectedSuggestion),this._bSuggestVisible=!0}},suggestPosition:function(){var e,t,i,s,o;t=this._eSuggestions,i=this._eWrap,t&&i&&(df.sys.gui.isOnScreen(i)?(t.style.display="",s=(e=df.sys.gui.getBoundRect(i)).bottom,o=e.left,e.left+(this.piPopupWidth>0?this.piPopupWidth:e.width)>window.innerWidth&&(o=window.innerWidth-(this.piPopupWidth>0?this.piPopupWidth:e.width)),t.style.top=s+"px",t.style.left=o+"px",t.style.width=(this.piPopupWidth>0?this.piPopupWidth:e.width)+"px",e.bottom+this._eSugSuggestions.clientHeight>window.innerHeight&&(t.style.top=e.top-this._eSuggestions.clientHeight+"px")):t.style.display="none")},suggestHide:function(){this._eSuggestions&&(df.dom.addClass(this._eSuggestions,"WebSug_Hidden"),df.dom.removeClass(this._eSuggestions,"WebSug_Visible"),this._tSuggestDisplay&&(clearTimeout(this._tSuggestDisplay),this._tSuggestDisplay=null),this._tSuggestUpdate&&(clearTimeout(this._tSuggestUpdate),this._tSuggestUpdate=null),this._oSelectedSuggestion=null),this.updateTypeVal(),this._sSuggestPrevVal=this.getSearchValue(),this._bSuggestVisible=!1,this._bForceDisplay=!1},invalidateCache:function(){this.pbAllData||(this._iPage=0,this._bLastItemOnServer=!1)},showSuggestions:function(){this._bForceDisplay=!0,this.suggestDisplay(),this.suggestUpdate(),this.focus()},onKey:function(e){var t=df.settings.suggestionKeys;this.isEnabled()&&!this.pbReadOnly?(e.bCanceled||df.WebBaseSelectionForm.base.onKey.call(this,e),e.bCanceled||(e.matchKey(t.escape)&&this._bSuggestVisible?this.suggestHide():e.matchKey(t.select)?(this.suggestSelect(),e.stop()):e.matchKey(t.moveUp)?(this._bSuggestVisible||this.showSuggestions(),this.suggestMove(-1),e.stop()):e.matchKey(t.moveDown)?(this._bSuggestVisible||this.showSuggestions(),this.suggestMove(1),e.stop()):(this.invalidateCache(),(e.matchKey(t.backSpace)||e.matchKey(t.delete))&&this.getSearchValue().length<=1&&this.suggestLoad()),e.matchKey(t.forceDisplay)&&e.stop())):e.stop()},onWindowResize:function(e){var t=this;this._tRepos||setTimeout((function(){t._bSuggestVisible&&t.suggestPosition(),t._tRepos=null}),40),this._bSuggestVisible&&this.suggestPosition()},onBlur:function(e){var t=this;df.WebBaseSelectionForm.base.onBlur.call(this,e),this._tSugBlurTimeout&&(clearTimeout(this._tSugBlurTimeout),this._tSugBlurTimeout=null),this._tSugBlurTimeout=setTimeout((function(){t._bHasFocus||t.suggestHide(),t.afterBlur&&t.afterBlur()}),500)},onPromptClick:function(e){this.isEnabled()&&!this.pbReadOnly&&(this.objFocus(),this.firePrompt()?e.stopPropagation():(this.focus(),this._bSuggestVisible?this.suggestHide():this.showSuggestions()))}}),df.WebSuggestionForm=function(e,t){df.WebSuggestionForm.base.constructor.call(this,e,t),this.prop(df.tString,"psPopupCSSClass",""),this.prop(df.tInt,"peSuggestionMode",df.smFind),this.prop(df.tBool,"pbCaseSensitive",!1),this.prop(df.tBool,"pbAllowForce",!0),this.prop(df.tBool,"pbFullText",!1),this.prop(df.tBool,"pbHighlight",!0),this.prop(df.tBool,"pbShowResults",!0),this.prop(df.tInt,"piMaxResults",15),this.prop(df.tInt,"piStartAtChar",2),this.prop(df.tInt,"piSuggestionWidth",0),this.prop(df.tBool,"pbClientRefinement",!0),this.prop(df.tInt,"piPopupTimeout",50),this.prop(df.tInt,"piTypeTimeout",20),this.event("OnHideSuggestions",df.cCallModeDefault),this._eSuggestions=null,this._bForceDisplay=!1,this._tRepos=null,this._aScrollListeners=null,this._sSelectedId=null},df.defineClass("df.WebSuggestionForm","df.WebForm",{openHtml:function(e){df.WebSuggestionForm.base.openHtml.call(this,e)},afterRender:function(){df.WebSuggestionForm.base.afterRender.call(this),df.dom.on("keyup",this._eControl,this.onSuggestKey,this)},initDOM:function(){this._eSuggestions=df.dom.create('<div class="WebSuggestions WebSug_Hidden '+this.psPopupCSSClass+'"><div class="WebSug_Content"></div><div>'),this._eSugContent=df.dom.query(this._eSuggestions,"div.WebSug_Content"),(this.topLayer()||document.body).appendChild(this._eSuggestions),df.dom.on("click",this._eSuggestions,this.onSuggestClick,this)},suggestUpdate:function(){var e,t=this;if(this.updateTypeVal(),(e=this.getServerVal())!==this._sSuggestPrevVal||this._bForceDisplay)if(this._sSuggestPrevVal=e,e.length>=this.piStartAtChar||this._bForceDisplay){if(this._bSuggestVisible){if(this.pbClientRefinement&&this._sSuggestBaseVal&&e.substr(0,this._sSuggestBaseVal.length)===this._sSuggestBaseVal)return void this.suggestRefine(e)}else this._tSuggestDisplay||(this._tSuggestDisplay=setTimeout((function(){t._tSuggestDisplay=null,t.suggestDisplay()}),this.piPopupTimeout));this.suggestLoad()}else this._bSuggestVisible&&this.suggestHide()},suggestLoad:function(){var e=this;this.pbShowResults&&(this._eSuggestions||this.initDOM(),df.dom.addClass(this._eSuggestions,"WebSug_Loading")),this._eElem&&df.dom.addClass(this._eElem,"WebSug_Loading"),this._tSuggestUpdate||(this._tSuggestUpdate=setTimeout((function(){e._tSuggestUpdate=null,e.updateTypeVal(),e.suggestDoLoad(e.getServerVal())}),this.piTypeTimeout))},suggestDoLoad:function(e){this._bSuggestLoading?this._sSuggestNextLoad=e:(this._bSuggestLoading=!0,this.serverAction("FindSuggestions",[e],null,(function(){this._bSuggestLoading=!1,this._sSuggestNextLoad?(this.suggestDoLoad(this._sSuggestNextLoad),this._sSuggestNextLoad=null):(this._eSuggestions&&df.dom.removeClass(this._eSuggestions,"WebSug_Loading"),this._eElem&&df.dom.removeClass(this._eElem,"WebSug_Loading"))}),this))},suggestHandle:function(e){var t,i,s,o,n=!1;if(t=this._tActionData,this.updateTypeVal(),(s=this.getServerVal())!==e){if(!this.pbClientRefinement||s.substr(0,e)!==e)return;o=!0}for(this._sSuggestBaseVal=e,this._aSuggestBase=this._aSuggestRows=t,i=0;i<t.length;i++)t[i].sRowId===this._sSelectedId&&(n=!0);n||(this._sSelectedId=t.length>0?t[0].sRowId:null),o?this.suggestRefine(s):this.suggestRender(e)},suggestDisplay:function(){this.isEnabled()&&(this.pbShowResults&&(this._eSuggestions||this.initDOM(),this._aSuggestRows||(this._eSugContent.innerHTML=""),this.suggestPosition(),df.dom.addClass(this._eSuggestions,"WebSug_Visible"),df.dom.removeClass(this._eSuggestions,"WebSug_Hidden"),this.suggestPosition(),df.dom.on("resize",window,this.onWindowResize,this),this._aScrollListeners=df.sys.gui.addScrollListeners(this._eWrap,this.onWindowResize,this)),this._bSuggestVisible=!0)},suggestPosition:function(){var e,t,i,s,o;t=this._eSuggestions,i=this._eWrap,t&&i&&(df.sys.gui.isOnScreen(i)?(t.style.display="",s=(e=df.sys.gui.getBoundRect(i)).bottom,o=e.left,e.left+(this.piSuggestionWidth>0?this.piSuggestionWidth:e.width)>window.innerWidth&&(o=window.innerWidth-(this.piSuggestionWidth>0?this.piSuggestionWidth:e.width)),t.style.top=s+"px",t.style.left=o+"px",t.style.width=(this.piSuggestionWidth>0?this.piSuggestionWidth:e.width)+"px",e.bottom+this._eSugContent.clientHeight>window.innerHeight?this._eSuggestions.style.bottom="0px":this._eSuggestions.style.bottom=""):t.style.display="none")},suggestHide:function(){this._eSuggestions&&(df.dom.addClass(this._eSuggestions,"WebSug_Hidden"),df.dom.removeClass(this._eSuggestions,"WebSug_Visible"),this._tSuggestDisplay&&(clearTimeout(this._tSuggestDisplay),this._tSuggestDisplay=null),this._tSuggestUpdate&&(clearTimeout(this._tSuggestUpdate),this._tSuggestUpdate=null),this.updateTypeVal(),this._sSuggestPrevVal=this.getServerVal(),df.dom.off("resize",window,this.onWindowResize,this),this._aScrollListeners&&df.sys.gui.removeScrollListeners(this._aScrollListeners,this),this._aSuggestRows=null,this._sSelectedId=null),this.fire("OnHideSuggestions",[]),this._bSuggestVisible=!1,this._bForceDisplay=!1},suggestRender:function(e){var t,i,s,o,n,r,a=[],l=this._aSuggestRows;function h(e){return"<b>"+e+"</b>"}if(this._eSuggestions){for(this.pbHighlight&&(this.pbFullText?r=new RegExp(df.sys.data.escapeRegExp(e),this.pbCaseSensitive?"g":"gi"):(s=e.toLowerCase(),o=e.length)),a.push("<table>"),t=0;t<l.length;t++){for(a.push('<tr data-suggestnr="',t,'" class="WebSug_Suggestion ',l[t].sRowId===this._sSelectedId?"WebSug_Selected":"",'">'),i=0;i<l[t].aValues.length;i++)n=l[t].aValues[i],a.push("<td>"),!this.pbHighlight||this.peSuggestionMode===df.smValidationTable&&0!==i?a.push(n):this.pbFullText?a.push(n.replace(r,h)):n.substr(0,o).toLowerCase()===s?a.push("<b>",n.substr(0,o),"</b>",n.substr(o)):a.push(n),a.push("</td>");a.push("</tr>")}a.push("</table>"),this._eSugContent.innerHTML=a.join(""),this.suggestPosition()}},suggestRefine:function(e){var t,i,s,o,n,r=[],a=this._aSuggestBase,l=!0,h=!1;if(this.pbFullText){for(n=new RegExp(df.sys.data.escapeRegExp(e),this.pbCaseSensitive?"":"i"),t=0;t<a.length;t++)for(i=0;i<(this.peSuggestionMode!==df.smValidationTable?a[t].aValues.length:1);i++)if(n.test(a[t].aValues[i])){r.push(a[t]),h=h||a[t].sRowId===this._sSelectedId;break}this._aSuggestRows=r,this.suggestRender(e),a.length>=this.piMaxResults&&r.length<this.piMaxResults&&this.suggestLoad()}else{for(s=e.toLowerCase(),o=e.length,t=0;t<a.length;t++)!this.pbCaseSensitive&&a[t].aValues[0].substr(0,o).toLowerCase()===s||this.pbCaseSensitive&&a[t].aValues[0].substr(0,o)===e?(r.push(a[t]),h=h||a[t].sRowId===this._sSelectedId):r.length>0&&(l=this.peDataType===df.ciTypeBCD);this._aSuggestRows=r,h||(this._sSelectedId=r.length>0?r[0].sRowId:null),this.suggestRender(e),a.length>=this.piMaxResults&&l&&e!==this._sSuggestBaseVal&&this.suggestLoad()}},suggestSelect:function(){var e,t=this._aSuggestRows,i=null;if(this._sSelectedId){for(e=0;e<t.length;e++)if(t[e].sRowId===this._sSelectedId){i=t[e];break}i&&(this.updateTypeVal(),this.serverAction("SelectSuggestion",[this.getServerVal()],[i],(function(e){this.suggestHide()})))}},suggestMove:function(e){var t,i=this._aSuggestRows;if(this._sSelectedId){for(t=0;t<i.length&&i[t].sRowId!==this._sSelectedId;t++);t=(t+=e)>=0?t<i.length?t:i.length-1:0,this.suggestHightlight(i[t].sRowId)}else this.suggestHightlight(i.length>0?i[0].sRowId:null)},suggestHightlight:function(e){var t,i,s;this._sSelectedId=e,this.updateTypeVal(),this.suggestRender(this.getServerVal()),(t=df.dom.query(this._eSugContent,"tr.WebSug_Selected"))&&(s=(i=df.sys.gui.getAbsoluteOffset(t).top)+t.offsetHeight,i-this._eSuggestions.scrollTop<0?this._eSuggestions.scrollTop=i:s>this._eSuggestions.clientHeight+this._eSuggestions.scrollTop&&(this._eSuggestions.scrollTop=s-this._eSuggestions.clientHeight))},onSuggestClick:function(e){for(var t,i=e.getTarget();"TR"!==i.tagName&&i.parentNode&&i!==this._eSugContent;)i=i.parentNode;i.hasAttribute("data-suggestnr")&&(t=parseInt(i.getAttribute("data-suggestnr"),10),this._aSuggestRows[t]&&(this.suggestHightlight(this._aSuggestRows[t].sRowId),this.suggestSelect(),this.focus()))},showSuggestions:function(){this._bForceDisplay=!0,this._bSuggestVisible||this.suggestDisplay(),this.suggestUpdate(),this.focus()},onKey:function(e){var t=df.settings.suggestionKeys;df.WebSuggestionForm.base.onKey.call(this,e),e.bCanceled||(this._bSuggestVisible&&this.pbShowResults&&(e.matchKey(t.escape)?this.suggestHide():e.matchKey(t.select)?(this.suggestSelect(),e.stop()):e.matchKey(t.moveUp)?(this.suggestMove(-1),e.stop()):e.matchKey(t.moveDown)&&(this.suggestMove(1),e.stop())),e.matchKey(t.forceDisplay)&&this.pbAllowForce&&e.stop())},onSuggestKey:function(e){var t=df.settings.suggestionKeys,i=e.getKeyCode();e.matchKey(t.forceDisplay)&&this.pbAllowForce&&(this._bForceDisplay=!0,this._bSuggestVisible||this.suggestDisplay(),e.stop()),(this._bSuggestVisible||!e.isSpecialKey()&&(i<112||i>127))&&this.suggestUpdate(),this._bForceDisplay=!1},onWindowResize:function(e){var t=this;this._tRepos||setTimeout((function(){t.suggestPosition(),t._tRepos=null}),40),this.suggestPosition()},onBlur:function(e){var t=this;df.WebSuggestionForm.base.onBlur.call(this,e),this._tSugBlurTimeout&&(clearTimeout(this._tSugBlurTimeout),this._tSugBlurTimeout=null),this._tSugBlurTimeout=setTimeout((function(){t._bHasFocus||t.suggestHide()}),500)},set_psPopupCSSClass:function(e){this._eSuggestions&&(this._eSuggestions.className="WebSuggestions "+(this._bSuggestVisible?"WebSug_Visible":"WebSug_Hidden")+e)}}),df.WebSelectionForm=function(e,t){df.WebSelectionForm.base.constructor.call(this,e,t),this.event("OnSelect",df.cCallModeDefault,"privateOnSelect")},df.defineClass("df.WebSelectionForm","df.WebBaseSelectionForm",{openHtml:function(e){df.WebSelectionForm.base.openHtml.call(this,e)},afterRender:function(){df.WebSelectionForm.base.afterRender.call(this)},suggestSelect:function(){if(this._oSelectedSuggestion&&!this._oSelectedSuggestion.control){let e=this.findSuggestionByValue(this._oSelectedSuggestion.aValues[0]);if(e)return this.set_psValue(e.aValues[0]),this.fireEx({sEvent:"OnSelect",tActionData:[e],oEnv:this}),void this.suggestHide()}df.WebTagsForm.base.suggestSelect.call(this)}}),df.WebTagsForm=function(e,t){df.WebTagsForm.base.constructor.call(this,e,t),this.prop(df.tInt,"piTagTruncateAt",60),this.prop(df.tBool,"pbTagOnSpace",!1),this.prop(df.tBool,"pbAllowTagSelection",!0),this.prop(df.tString,"psSeparator",","),this.event("OnTagClick",df.cCallModeDefault,"privateOnTagClick"),this.event("OnAddTag",df.cCallModeDefault,"privateOnAddTag"),this.event("OnRemoveTag",df.cCallModeDefault,"privateOnRemoveTag"),this._aSelectedSuggestions=[],this._sSelectedTag=null,this._oSelectedTag=null,this._aTagCssClass={}},df.defineClass("df.WebTagsForm","df.WebBaseSelectionForm",{openHtml:function(e){df.WebForm.base.openHtml.call(this,e),e.push('<div class="WebFrm_Wrapper"><div class="WebFrm_PromptSpacer">','<span class="WebDynFrm WebTgf_Placeholder">',this.peLabelPosition!=df.ciLabelFloat?df.dom.encodeAttr(df.dom.encodeHtml(this.psPlaceHolder)):"","</span>",'<span class="WebDynFrm WebTgfInput" name="',this._sName,'" id="',this._sControlId,'" role="textbox" tabindex="0"',' contenteditable="true"></span>')},closeHtml:function(e){e.push('</div><span class="WebFrm_Prompt"></span></div>'),df.WebForm.base.closeHtml.call(this,e)},setPlaceHolderVisibility:function(e){this.setVisibility(this._ePlaceHolder,e)},setInputVisibility:function(e){this.setVisibility(this._eControl,e)},setVisibility:function(e,t){e.style.display=t?"":"none"},getVisibility:function(e){return"none"!=e.style.display},focusInputField:function(){if(!this.pbReadOnly&&this.isEnabled()){(0===this._aSelectedSuggestions.length||this.getVisibility(this._ePlaceHolder))&&this.setPlaceHolderVisibility(!1);var e=this;this._tFocus||(this._tFocus=setTimeout((function(){e._tFocus&&(e._eControl.focus(),e._tFocus=null)}),1))}},blurInputField:function(){this._tFocus=null,(0===this._eControl.value.length&&0===this._aSelectedSuggestions.length||this.getVisibility(this._ePlaceHolder))&&this.setPlaceHolderVisibility(!0)},afterRender:function(){this._eSuggestions=df.dom.create('<div class="WebBaseSelectionForm WebSuggestions'+(this.psCSSClass.length>0?" "+this.psCSSClass:"")+' WebSug_Hidden"><div class="WebSug_Content"></div></div>'),this._eSugContent=df.dom.query(this._eSuggestions,"div.WebSug_Content"),this._eSugSuggestions=df.dom.create('<div class="WebSug_Suggestions"></div>'),this._eSugControls=df.dom.create('<div class="WebSug_Controls"></div>'),this._eSugContent.appendChild(this._eSugSuggestions),this._eSugContent.appendChild(this._eSugControls),this._eInputBox=df.dom.query(this._eElem,".WebFrm_PromptSpacer"),this._ePlaceHolder=df.dom.query(this._eElem,".WebTgf_Placeholder");var e=this;this._eControl=this._eControl=df.dom.query(this._eInputBox,".WebTgfInput"),Object.defineProperty(this._eControl,"value",{get:function(){return e._eControl.innerText},set:function(t){e._eControl.innerText=t}}),Object.defineProperty(this._eControl,"keypress",{get:function(){return e._eControl.keydown},set:function(t){e._eControl.keydown=t}}),this._eControl.select=function(){e._eControl.focus()},df.dom.on("focusin",this._eInputBox,this.focusInputField,this),df.dom.on("click",this._eInputBox,this.focusInputField,this),df.dom.on("blur",this._eControl,this.blurInputField,this),this.blurInputField(),this._ePrompt=df.dom.query(this._eElem,"div.WebFrm_Wrapper span.WebFrm_Prompt"),this._eWrap=df.dom.query(this._eElem,"div.WebFrm_Wrapper"),df.WebForm.base.afterRender.call(this),df.dom.on("click",this._ePrompt,this.onPromptClick,this),this.set_pbPromptButton(this.pbPromptButton),df.dom.addClass(this._eElem,"WebSelectionForm"),(this.topLayer()||document.body).appendChild(this._eSuggestions),df.dom.on("keyup",this._eControl,this.onSuggestKey,this),df.dom.on("click",this._eSuggestions,this.onSuggestClick,this),df.dom.on("click",this._eInputBox,this.inputBoxOnClick,this),df.dom.on("resize",window,this.onWindowResize,this),df.dom.addClass(this._eElem,"WebTagsForm"),this.aSelectionCache&&this.setCachedTags(),df.dom.on("click",this._eInputBox,this.removeTagSelection,this),this.set_pbReadOnly(this.pbReadOnly),this.set_pbEnabled(this.isEnabled()),this.validateAsSeparator(this.psSeparator),this.dragDropInit()},set_pbEnabled:function(e){let t=e!==this.isEnabled();df.WebTagsForm.base.set_pbEnabled.call(this,e),t&&this.setControlValue(this.getControlValue())},validateAsSeparator:function(e){if(1!==e.length)throw new df.Error(871,"Invalid psSeparator; requires length of just one character.");return!0},set_psSeparator:function(e){e!==this.psSeparator&&this.validateAsSeparator(e)&&(this.psSeparator=e)},set_pbReadOnly:function(e){let t=e!==this.pbReadOnly;df.WebTagsForm.base.set_pbReadOnly.call(this,e),t&&this.setControlValue(this.getControlValue())},removeTagSelection:function(){this._sSelectedTag&&this._oSelectedTag&&df.dom.removeClass(this._oSelectedTag,"WebTgf_Focus"),this._sSelectedTag=null,this._oSelectedTag=null},setTagSelection:function(e){this.removeTagSelection(),this._sSelectedTag=e,this._oSelectedTag=df.dom.query(this._eInputBox,".WebTgf_Tag[data-dfrowid='"+this._sSelectedTag.aValues[0].replaceAll("'","\\'")+"']"),df.dom.addClass(this._oSelectedTag,"WebTgf_Focus")},getSearchValue:function(){let e=this._eControl.value;return this.pbCapslock?e.toUpperCase():e},getControlValue:function(){let e=[],t="\\"+this.psSeparator;for(let i=0;i<this._aSelectedSuggestions.length;i++)this._aSelectedSuggestions[i].control||e.push(this._aSelectedSuggestions[i].aValues[0].replaceAll(this.psSeparator,t));return e.join(this.psSeparator)},parseSelectionValues:function(e){let t=[],i=-1,s=-1,o=0;for(;(i=e.indexOf(this.psSeparator,s+1))>=0;){let n=!0,r=i;for(;--r>=0&&"\\"===e.charAt(r);)n=!n;if(n){let s=e.substr(o,i-o);s=s.replaceAll("\\"+this.psSeparator,this.psSeparator).trim(),s.length>0&&(t.push(s),o=i+1)}s=i}let n=e.substr(o,e.length-o);return n=n.replaceAll("\\"+this.psSeparator,this.psSeparator).trim(),n.length>0&&t.push(n),t},setControlValue:function(e){this.aSelectionCache=this.parseSelectionValues(e),this._eInputBox&&this.setCachedTags()},suggestHandle:function(e,t){df.WebTagsForm.base.suggestHandle.call(this,e,t),this._aSuggestRows.length-this._aSelectedSuggestions.length<this.piPageSize&&!this._bLastItemOnServer&&this.pbPaged&&this.handleMoreButton()},AddControlSuggestions:function(e){let t=e.length,i=this.getSearchValue().trim();!this._bLastItemOnServer&&this.pbPaged&&e.length>0&&!this.pbAllData&&e.push({control:!0,sRowId:"more",aValues:["("+this.psShowMoreText+")"],sCssClassName:"Sugg_ControlSuggestion"});let s=!0;return this._aShownSuggestions&&(s=!(this._aShownSuggestions.length>0&&this._aShownSuggestions[0].aValues[0]==i)),s&&(s=this.getSelectedSuggestionId(i)<0),s&&this.pbAllowCreate&&i.length>0&&e.push({control:!0,sRowId:"create",aValues:["("+this.psCreateNewItemText+(i.length>0?" '"+i+"'":"")+")"],sCssClassName:"Sugg_ControlSuggestion"}),e.length-t},afterSuggestRefine:function(e){this._aShownSuggestions.length-this._TotalOfControlRows-this._aSelectedSuggestions.length<this.piPageSize&&!this._bLastItemOnServer&&this.pbPaged&&this.handleMoreButton()},setCachedTags:function(){this.clearTags();for(let e=0;e<this.aSelectionCache.length;e++)this.addTag({sRowId:e.toString(),aValues:[this.aSelectionCache[e]],sCssClassName:""});this.setPlaceHolderVisibility(0===this._eControl.value.length&&0==this.aSelectionCache.length),this.updateTypeVal()},truncate:function(e,t,i){if(e.length<=t)return e;if(0==t)return e;let s=e.substr(0,t);return(i&&-1!=s.lastIndexOf(" ")?s.substr(0,s.lastIndexOf(" ")):s)+"&hellip;"},setTagCssClass:function(e,t){this._aTagCssClass[e]=" "+t.trim(),this.updateTypeVal(),this.refreshDisplay(this._tValue)},suggestSelect:function(){if(this._oSelectedSuggestion&&!this._oSelectedSuggestion.control){let e=this.findSuggestionByValue(this._oSelectedSuggestion.aValues[0]);if(e)return this.fireEx({sEvent:"OnAddTag",tActionData:e,oEnv:this}),this.addTag(e),this.updateTypeVal(),this.focusInputField(),this._eControl.value="",void this.suggestHide()}df.WebTagsForm.base.suggestSelect.call(this),this.focusInputField()},extraFilterOnHandle:function(e){return this._aSelectedSuggestions.forEach((function(t){for(let i=0;i<e.length;i++)e[i].aValues[0]==t.aValues[0]&&e.splice(i--,1)})),e},addTag:function(e){this._aSelectedSuggestions.push(e);let t=!1;this._sSelectedTag&&this.isEnabled()&&this._sSelectedTag.aValues[0]==e.aValues[0]&&(t=!0);var i=df.dom.create('<div class="WebTgf_Tag'+(t?" WebTgf_Focus":"")+(this._aTagCssClass[e.aValues[0]]?this._aTagCssClass[e.aValues[0]]:"")+'" data-dfrowid="'+df.dom.encodeAttr(e.aValues[0])+'"'+(this.pbDragDropEnabled&&this.isSupportedDragAction(df.dragActions.WebTagsForm.ciDragTag)?' draggable="true"':"")+'>                 <span class="WebTgf_Text">'+df.dom.encodeHtml(this.truncate(e.aValues[0],this.piTagTruncateAt,!1))+"</span>"+(this.isEnabled()&&!this.pbReadOnly?'<span class="WebTgf_CloseTag">x</span> ':"")+"</div>");let s=this._eInputBox.insertBefore(i,this._eControl);t&&(this._oSelectedTag=i),df.dom.on("mousedown",s,(function(e){if("Range"==window.getSelection().type)return;let t=e.getTarget();for(;!t.classList.contains("WebTgf_Tag")&&!t.classList.contains("WebTgf_CloseTag");)t=t.parentNode;if(this.isEnabled())if(t.classList.contains("WebTgf_CloseTag")&&!this.pbReadOnly)t=t.parentNode,this.removeTag(t.getAttribute("data-dfrowid")),this.blurInputField(),this.removeTagSelection();else if(t.classList.contains("WebTgf_Tag")){let e=this.getSelectedSuggestionId(t.getAttribute("data-dfrowid"));if(e<0)throw new df.Error(999,"Could not refind the clicked tag.");this.removeTagSelection(),this.pbAllowTagSelection&&(this.setTagSelection(this._aSelectedSuggestions[e]),this.focus()),this.fireEx({sEvent:"OnTagClick",tActionData:this._aSelectedSuggestions[e],oEnv:this})}}),this),this.pbSuggestions&&this._iAdditionalItems++,this.sizeChanged()},clearTags:function(){var e=this;this._aSelectedSuggestions=[],this._eInputBox&&this._eInputBox.querySelectorAll(".WebTgf_Tag").forEach((function(t){e._eInputBox.removeChild(t)})),this._iAdditionalItems=0},removeTag:function(e){let t=df.dom.query(this._eInputBox,".WebTgf_Tag[data-dfrowid='"+e.replaceAll("'","\\'")+"']");if(t){let i=this.getSelectedSuggestionId(e),s=this._aSelectedSuggestions[i];this._aSelectedSuggestions.splice(i,1),t.parentNode.removeChild(t),this.updateTypeVal(),this.fireEx({sEvent:"OnRemoveTag",tActionData:s,oEnv:this}),this.sizeChanged()}this._bSuggestVisible&&this.suggestHide(),this.pbSuggestions&&this._iAdditionalItems--,this.suggestLoad()},getSelectedSuggestionId:function(e){for(let t=0;t<this._aSelectedSuggestions.length;t++)if(this._aSelectedSuggestions[t].aValues[0]==e)return t;return-1},onKey:function(e){function t(e,t){var i=document.createRange(),s=window.getSelection();0!=e.childNodes.length&&(i.setStart(e.childNodes[0],t),i.collapse(!0),s.removeAllRanges(),s.addRange(i))}function i(e){var t,i,s=0;if(window.getSelection)(t=window.getSelection()).rangeCount&&(i=t.getRangeAt(0)).commonAncestorContainer.parentNode==e&&(s=i.endOffset);else if(document.selection&&document.selection.createRange&&(i=document.selection.createRange()).parentElement()==e){var o=document.createElement("span");e.insertBefore(o,e.firstChild);var n=i.duplicate();n.moveToElementText(o),n.setEndPoint("EndToEnd",i),s=n.text.length}return s}if(e.e.ctrlKey)switch(e.e.keyCode){case 66:case 98:case 73:case 105:case 85:case 117:return e.stop(),!1}if(["<",">","'","/"].indexOf(e.e.key)>-1)return e.stop(),this._eControl.value+=e.e.key,void t(this._eControl,this._eControl.value.length);var s=df.settings.suggestionKeys;if(this.isEnabled()&&!this.pbReadOnly)switch(e.e.key){case"Enter":if(!this._bSuggestVisible)return void e.stop();e.e.shiftKey&&(this._oSelectedSuggestion=null),this.suggestSelect(),e.stop();break;case" ":case"Spacebar":if(!this.pbTagOnSpace||e.e.ctrlKey)break;this.suggestSelect(),e.stop()}if(df.WebTagsForm.base.onKey.call(this,e),!e.bCanceled||this.pbReadOnly){if("ArrowLeft"!=e.e.key&&"Left"!=e.e.key||!this.pbAllowTagSelection)if("ArrowRight"!=e.e.key&&"Right"!=e.e.key||!this.pbAllowTagSelection)!this.isEnabled()||this.pbReadOnly||"Backspace"!=e.e.key&&"Delete"!=e.e.key||0!=this.getSearchValue().length&&!this._sSelectedTag||!this.pbAllowTagSelection?this.removeTagSelection():(this._sSelectedTag?(this.removeTag(this._sSelectedTag.aValues[0]),this.removeTagSelection()):this._aSelectedSuggestions.length>0&&this.setTagSelection(this._aSelectedSuggestions[this._aSelectedSuggestions.length-1]),e.stop());else{if(this._aSelectedSuggestions.length<=0)return;if(this._sSelectedTag){let i=this.getSelectedSuggestionId(this._sSelectedTag.aValues[0]);if(this.removeTagSelection(),i>=this._aSelectedSuggestions.length-1)return this.removeTagSelection(),this._eControl.focus(),t(this._eControl,0),void e.stop();i++,this.setTagSelection(this._aSelectedSuggestions[i]),e.stop()}else i(this._eControl)==this.getSearchValue().length&&(this.setTagSelection(this._aSelectedSuggestions[0]),e.stop())}else{if(this._aSelectedSuggestions.length<=0)return;if(this._sSelectedTag){let i=this.getSelectedSuggestionId(this._sSelectedTag.aValues[0]);if(this.removeTagSelection(),!(i>0))return this.removeTagSelection(),this._eControl.focus(),t(this._eControl,this.getSearchValue().length),void e.stop();i--,this.setTagSelection(this._aSelectedSuggestions[i]),e.stop()}else 0==i(this._eControl)&&(this.setTagSelection(this._aSelectedSuggestions[this._aSelectedSuggestions.length-1]),e.stop())}e.matchKey(s.forceDisplay)&&e.stop()}},createTag:function(){let e=this._tActionData;if(-1==e.aValues[0]&&(e.aValues[0]=this._aSelectedSuggestions.length.toString()),-1!=this.getSelectedSuggestionId(e.aValues[0]))throw new df.Error(871,"Id already in use.");this.addTag(e),this.updateTypeVal(),this.suggestDoLoad(this.getSearchValue()),this.suggestHide()},afterBlur:function(){if(this._sSelectedTag){var e=this;this._tUnselectTag||(this._tUnselectTag=setTimeout((function(){e._tUnselectTag=null,e._bHasFocus||(df.dom.removeClass(e._oSelectedTag,"WebTgf_Focus"),e._sSelectedTag=null,e._oSelectedTag=null)}),500))}},determineSelectorForWebUIContext:function(e){return e===df.WebUIContext.WebUIContextTagsFormTag?".WebTgf_Tag[data-dfrowid]":null},retrieveValueFromWebUIContext:function(e,t){switch(t){case df.WebUIContext.WebUIContextTagsFormTag:if(!e.hasAttribute("data-dfrowid"))break;return e.getAttribute("data-dfrowid")}return null},getDragData:function(e,t){try{return[{data:t.getAttribute("data-dfrowid")},df.dragActions.WebTagsForm.ciDragTag]}catch(e){return console.error("Attempt to perform unsupported drag action"),[null,null]}},getDropData:function(e,t){if(e&&e._eDropElem){const t=df.dom.query(e._eDropElem,".WebTgf_Text");let i="";return t&&(i=t.innerText),{data:i,action:df.dropActions.WebTagsForm.ciDropOnInput}}return null},initDraggableElements:function(){},initDropZones:function(){if(this._aDropZones=[],df.WebList.base.initDropZones.call(this),this.isSupportedDropAction(df.dropActions.WebTagsForm.ciDropOnInput)){const e=df.dom.query(this._eElem,".WebFrm_Wrapper");this.addDropZone(e)}},determineDropCandidate:function(e,t){if(t.find((e=>e.supportsDropAction(this,df.dropActions.WebControl.ciDropOnControl))))return[this._eElem,df.dropActions.WebControl.ciDropOnControl];if(!t.find((e=>e.supportsDropAction(this,df.dropActions.WebTagsForm.ciDropOnInput))))return[null,null];let i=document.elementFromPoint(e.e.clientX,e.e.clientY)?.closest(".WebTgf_Tag");if(!i){const e=df.dom.query(this._eElem,".WebTgf_Tag",!0);i=e.length>0&&e[e.length-1]||null}return i&&(i.hasAttribute("data-dfdropplaceholder")&&(i.previousElementSibling?.hasAttribute("data-dfrowid")?i=i.previousElementSibling:i.nextElementSibling?.hasAttribute("data-dfrowid")&&(i=i.nextElementSibling)),i)?[i,df.dropActions.WebTagsForm.ciDropOnInput]:[null,null]},determineDropPosition:function(e,t){const i=df.sys.gui.getBoundRect(t),s=i.right-i.width/2;return e.e.clientX>=s?df.dropPositions.ciDropAfter:df.dropPositions.ciDropBefore},interactWithDropElem:function(e,t){if(e._eDropAction==df.dropActions.WebControl.ciDropOnControl)e.highlightElement();else{let i=document.createElement("div");i.innerHTML='<span class="WebTgf_Text">DROP</span><span class="WebTgf_CloseTag">x</span> ',df.dom.addClass(i,"WebTgf_Tag WebTgf_DropPlaceHolder"),i.setAttribute("data-dfrowid","empty_placeholder"),e.insertElement(i,t)}},doEmptyInteraction:function(e){if(this.isSupportedDropAction(df.dropActions.WebTagsForm.ciDropOnInput)){let t=document.createElement("div");t.innerHTML='<span class="WebTgf_Text">DROP</span><span class="WebTgf_CloseTag">x</span> ',df.dom.addClass(t,"WebTgf_Tag WebTgf_DropPlaceHolder");const i=df.dom.query(this._eElem,".WebFrm_PromptSpacer");return e.insertElement(t,i),df.dropActions.WebTagsForm.ciDropOnInput}return this.isSupportedDropAction(df.dropActions.WebControl.ciDropOnControl)?(e.highlightElement(),df.dropActions.WebControl.ciDropOnControl):null},hasData:function(){return""!=this.get("psValue")}}),(()=>{"use strict";var e=__webpack_require__(1740),t=__webpack_require__(4074),i=__webpack_require__(5804),s=__webpack_require__(1493),o=__webpack_require__(9697);const n="groupConfig";class r{constructor(e,t,i){this.oL=e,this.oM=t,this.oC=i,e._onKeyDown.addListener(this.onKeyDown,this),e._onSettingChange.addListener(this.onSettingsChange,this),this.loadGroupConfig()}registerMenuGroupingSelector(e){e.onGroupsChanged.on(this.onGroupsChanged,this)}applyGrouping(e){const t=this.oL,i=this.oM;if(t.peGrouping!=df.grpAutomatic)throw new df.Error(999,"Set peGrouping to groupAutomatic to use applyGrouping.");if(i instanceof s.W)throw new df.Error(999,"Automatic grouping not supported with paged data loading. Set peDbGridType to gtAllData or gtManual to allow automatic grouping.");if(!Array.isArray(e))throw new df.Error(999,"Received invalid grouping data, expected aray.");e.forEach((e=>{if(!t._aColumns[e.iColumnId])throw new df.Error(999,"Received invalid grouping data, invalid column id.")})),i.aGroups=e,i.aGroupHeaders=[],i.bIsGrouped=e.length>0,t._onSettingChange.fire(this,{sType:"grouping"})}applyGroupConfig(e,t){(e||!this.oL.pbStoreGroupConfig||localStorage.getItem(null==this.oL.getStorageName(n)))&&(this.applyGrouping(t),this.storeGroupConfig())}clearGrouping(){const e=this.oL,t=this.oM;t.aGroups=[],t.aGroupHeaders=[],t.bIsGrouped=!1,e._onSettingChange.fire(this,{sType:"grouping"})}storeGroupConfig(){this.oL.pbStoreGroupConfig&&localStorage.setItem(this.oL.getStorageName(n),JSON.stringify(this.oM.aGroups))}loadGroupConfig(){if(this.oL.pbStoreGroupConfig){const e=localStorage.getItem(this.oL.getStorageName(n));if(e)try{const t=JSON.parse(e);Array.isArray(t)&&this.applyGrouping(t)}catch(e){}}}triggerOnGroupsChanged(){this.oL.fireEx({sEvent:"OnGroupConfigChanged",tActionData:this.oM.aGroups,sAltServerName:"privateOnGroupConfigChanged"})}groupData(){const e=this.oL,t=this.oM,i=t.aGroups;if(e.peGrouping==df.grpAutomatic){let s=[],o=[];i.forEach((t=>{s.push(t.iColumnId),o.push(df.sys.data.compareFunction(e._aColumns[t.iColumnId].peDataType,t.bReverse))})),e.piSortColumn>=0&&-1==s.indexOf(e.piSortColumn)&&(s.push(e.piSortColumn),o.push(df.sys.data.compareFunction(e._aColumns[e.piSortColumn].peDataType,e.pbReverseOrdering))),e._aColumns.forEach(((t,i)=>{-1==s.indexOf(i)&&(s.push(i),o.push(df.sys.data.compareFunction(t.peDataType,e.pbReverseOrdering)))})),t.aGroupHeaders=[],t.customSortData(s,o);let n=[];t.aData.reduce(((r,a,l)=>{let h=null==r;a.iGroupHeaderIndex=-1;for(let l=0;l<i.length;l++)h||(h=0!=o[l](a.aCells[s[l]].sValue,r.aCells[s[l]].sValue)),h?(n[l]=t.aGroupHeaders.length,t.aGroupHeaders.push({iGroupIndex:l,iParentHeaderIndex:a.iGroupHeaderIndex,sItem:a.aCells[s[l]].sValue,iItems:1,sTotal:"",bCollapsed:e.pbGroupsCollapsible&&e.pbGroupsCollapseByDefault,_iLogicalParentGroup:l>0?n[l-1]:-1}),a.iGroupHeaderIndex=n[l]):t.aGroupHeaders[n[l]].iItems++;return a._iLogicalGroup=n[i.length-1],a}),null)}else if(e.peGrouping==df.grpCustom){let s=[];t.aData.forEach((o=>{let n=o.iGroupHeaderIndex;for(;n>=0;){const r=t.aGroupHeaders[n];if(!r)throw new df.Error(999,`Invalid weblist data, invalid group header reference for row ${o.sRowId}`,e);if(r.iParentHeaderIndex==n)throw new df.Error(999,`Invalid weblist data, recursive group header index ${n} `,e);if(!i[r.iGroupIndex])throw new df.Error(999,`Invalid weblist data, group ${r.iGroupIndex} referenced by group header ${n} does not exist.`,e);s[r.iGroupIndex]=n,r._iLogicalParentGroup=r.iGroupIndex>0?s[r.iGroupIndex-1]:-1,n=r.iParentHeaderIndex}o._iLogicalGroup=s[i.length-1]}))}}onGroupsChanged(e){this.applyGrouping(e.aGroups),this.storeGroupConfig(),this.triggerOnGroupsChanged()}toggleGroupHeader(e){const t=this.oM,i=t.aGroupHeaders[e];i&&(i.bCollapsed=!i.bCollapsed,t.prepDisplay(),t.onDataUpdate.fire(this,{sType:"display"}))}collapseAll(){const e=this.oM;e.bIsGrouped&&(e.aGroupHeaders.forEach((e=>e.bCollapsed=!0)),e.prepDisplay(),e.onDataUpdate.fire(this,{sType:"display"}))}expandAll(){const e=this.oM;e.bIsGrouped&&(e.aGroupHeaders.forEach((e=>e.bCollapsed=!1)),e.prepDisplay(),e.onDataUpdate.fire(this,{sType:"display"}))}collapseCurrent(){const e=this.oM;if(e.iCurrentRow&&e.aData[e.iCurrentRow]){let t=e.aData[e.iCurrentRow]._iLogicalGroup;for(;t>=0;){const i=e.aGroupHeaders[t];if(!i.bCollapsed)return i.bCollapsed=!0,e.prepDisplay(),e.onDataUpdate.fire(this,{sType:"display",iDisplayItem:i._iItemIndex}),!0;t=i._iLogicalParentGroup}}return!1}expandCurrent(){const e=this.oM;if(e.iCurrentRow&&e.aData[e.iCurrentRow]){let t=e.aData[e.iCurrentRow]._iLogicalGroup;for(;t>=0;){const i=e.aGroupHeaders[t];if(i.bCollapsed&&(i._iLogicalParentGroup<0||!e.aGroupHeaders[i._iLogicalParentGroup].bCollapsed))return i.bCollapsed=!1,e.prepDisplay(),e.onDataUpdate.fire(this,{sType:"display"}),!0;t=i._iLogicalParentGroup}}return!1}makeCurrentRowVisible(){const e=this.oM;let t=!1;if(e.iCurrentRow>=0&&e.aData[e.iCurrentRow]){let i=e.aData[e.iCurrentRow]._iLogicalGroup;for(;i>=0;){const s=e.aGroupHeaders[i];s.bCollapsed&&(s.bCollapsed=!1,t=!0),i=s._iLogicalParentGroup}}return t&&(e.prepDisplay(),e.onDataUpdate.fire(this,{sType:"display"})),t}onKeyDown(e){const t=e.oDOMEvent;return t.matchKey(df.settings.listKeys.collapseAllGrp)?(this.collapseAll(),t.stop(),!1):t.matchKey(df.settings.listKeys.expandAllGrp)?(this.expandAll(),t.stop(),!1):t.matchKey(df.settings.listKeys.collapseGrp)?(this.collapseCurrent(),t.stop(),!1):t.matchKey(df.settings.listKeys.expandGrp)?(this.expandCurrent(),t.stop(),!1):void 0}onSettingsChange(e){const t=this.oM;if(t.bIsGrouped&&("pbGroupsCollapsible"==e.sProp||"pbGroupsCollapseByDefault"==e.sProp))return this.groupData(),t.prepDisplay(),t.onDataUpdate.fire(this,{sType:"display"}),!1}}df.cHideColumnCSS=' style="visibility:hidden"',df.WebList=function(e,t){df.WebList.base.constructor.call(this,e,t),this.prop(df.tString,"psCurrentRowId",""),this.prop(df.tInt,"piCurrentRowIndex",-1),this.prop(df.tInt,"piRowCount",0),this.prop(df.tBool,"pbShowHeader",!0),this.prop(df.tBool,"pbShowFooter",!1),this.prop(df.tBool,"pbShowSelected",!0),this.prop(df.tBool,"pbDataAware",!0),this.prop(df.tInt,"peDbGridType",df.gtAutomatic),this.prop(df.tInt,"peGrouping",df.grpDisabled),this.prop(df.tBool,"pbOfflineEditing",!1),this.prop(df.tBool,"pbAutoSearch",!0),this.prop(df.tBool,"pbColumnSortable",!0),this.prop(df.tBool,"pbReverseOrdering",!0),this.prop(df.tInt,"piSortColumn",0),this.prop(df.tInt,"piMinHeight",0),this.prop(df.tInt,"piHeight",0),this.prop(df.tBool,"pbColumnsResizable",!0),this.prop(df.tBool,"pbAutoColumnSizing",!0),this.prop(df.tBool,"pbAllowColumnReordering",!0),this.prop(df.tBool,"pbAllowColumnHiding",!0),this.prop(df.tBool,"pbStoreColumnLayout",!0),this.prop(df.tBool,"pbStoreGroupConfig",!0),this.prop(df.tString,"psPlaceHolder",""),this.prop(df.tString,"psKeyBuddy",""),this.prop(df.tBool,"pbScroll",!0),this.prop(df.tBool,"pbGroupsCollapsible",!0),this.prop(df.tBool,"pbGroupsCollapseByDefault",!0),this.event("OnRowClick",df.cCallModeWait),this._aColumns=[],this._aSwipeBtns=[],this._oRowRenderer=null,this._oModel=null,this._oHeader=null,this._oBody=null,this._oFooter=null,this._oTouchHandler=null,this._oGrouping=null,this._iColCount=0,this._tRedraw=null,this._bLozingFocus=!1,this._bScrollQueued=!1,this._onSettingChange=new df.events.JSHandler,this._onResize=new df.events.JSHandler,this._onModulesCreated=new df.events.JSHandler,this._onKeyDown=new df.events.JSHandler,this.addSync("piCurrentRowIndex"),this.addSync("psCurrentRowId"),this.addSync("piRowCount"),this.setActionMode("HandleProcessDataSet",df.cCallModeWait),this.setActionMode("ChangeCurrentRow",df.cCallModeWait),this.event("OnColumnLayoutChanged",df.cCallModeDefault),this.event("OnGroupConfigChanged",df.cCallModeDefault),this._sControlClass="WebList"},df.defineClass("df.WebList","df.WebBaseControl",{addChild:function(e){e._bIsColumn&&(e._iColIndex=this._iColCount++,e._iCol=this._aColumns.length,this._aColumns.push(e)),e._bIsSwipeButton&&(e._iColIndex=this._iColCount++,this._aSwipeBtns.push(e)),df.WebList.base.addChild.call(this,e)},create:function(){this.recordColumnMapperDefaults(),this.loadLayout(!0,!1),this.rebuildColumnMapper(!1),this._oModel=this.createModel(),this._oController=this.createController(),this._oRowRenderer=this.createRowModel(),this._oHeader=this.createHeaderView(),this._oBody=this.createView(),this._oFooter=this.createFooterView(),this._oTouchHandler=this.createTouchHandler(),this._oPlaceHolder=this.createPlaceHolder(),this._oGrouping=this.createGrouping(),this._oRowRenderer.init(),this._onModulesCreated.fire(this)},createGrouping:function(){return new r(this,this._oModel,this._oController)},applyGroupConfig:function(e){this._oGrouping?.applyGroupConfig(df.toBool(e),this._tActionData)},clearGroupConfig:function(){this._oGrouping?.clearGrouping()},getStorageName:function(e){return e&&e.length>0?window.location.host+"."+window.location.pathname+"."+this.getLongName()+"@"+e:window.location.host+"."+window.location.pathname+"."+this.getLongName()},serializeLayout:function(){let e=[];for(let t=0;t<this._aColumns.length;t++){let i={};i.sObjName=this._aColumns[t].getLongName(),i.bFixed=this._aColumns[t].pbFixedWidth,i.iWidth=this._aColumns[t].piWidth,i.iPosition=this._aColumns[t].piPosition,i.bHidden=this._aColumns[t].pbHidden,e.push(i)}return e},loadLayout:function(e,t){"boolean"!=typeof t&&(t=!0);let i=null;if(this.pbStoreColumnLayout&&!df.pbDebugging){const s=localStorage.getItem(this.getStorageName("layout"));if(s)try{if(i=JSON.parse(s),i.length!==this._aColumns.length)return null;for(let e=0;e<i.length;e++)if(i[e].sObjName!==this._aColumns[e].getLongName())return null}catch(e){return s&&localStorage.removeItem(this.getStorageName("layout")),null}i&&e&&this.restoreColumnMapper(t,i)}return i},saveLayout:function(e){if(this.pbStoreColumnLayout&&!df.pbDebugging)try{localStorage.setItem(this.getStorageName("layout"),JSON.stringify(e))}catch(e){}},triggerLayoutChange:function(e){let t=this.serializeLayout();this.saveLayout(t),this.fireEx({sEvent:"OnColumnLayoutChanged",tActionData:t,sAltServerName:"privateOnColumnLayoutChanged"})},recordColumnMapperDefaults:function(){this._defaultLayout=this.serializeLayout()},restoreColumnMapperDefaults:function(){this.restoreColumnMapper(!0,this._defaultLayout)},restoreColumnMapper:function(e,t){if("boolean"!=typeof e&&(e=!0),Array.isArray(this._tActionData)&&!Array.isArray(t)&&(t=this._tActionData),!Array.isArray(t))return;let i=[];for(let e=0;e<this._aColumns.length;e++)i[this._aColumns[e].getLongName()]=this._aColumns[e];try{for(let e=0;e<t.length;e++){const s=i[t[e].sObjName];s&&(s.pbFixedWidth=t[e].bFixed,s.piWidth=t[e].iWidth,s.piPosition=t[e].iPosition,s.pbHidden=t[e].bHidden)}t=this.serializeLayout(),this.saveLayout(t),this.rebuildColumnMapper(!1),e&&this.redraw()}catch(e){}},rebuildColumnMapper:function(e){"boolean"!=typeof e&&(e=!0),this._aColumnMapper=[];let t=[];for(let e=0;e<this._aColumns.length;e++)-1!==this._aColumns[e].piPosition?this._aColumnMapper.push(this._aColumns[e]):t.push(this._aColumns[e]);this._aColumnMapper.sort((function(e,t){const i=e.piPosition,s=t.piPosition;return i<s?-1:i>s?1:0}));let i=0;if(this._aColumnMapper.length>0)do{this._aColumnMapper[i].piPosition!==i&&(t.length>0&&(this._aColumnMapper.splice(i,0,t[0]),t.splice(0,1)),this._aColumnMapper[i].piPosition=i)}while(++i<this._aColumnMapper.length);if(this._aColumnMapper=this._aColumnMapper.concat(t),t.length>0)do{this._aColumnMapper[i].piPosition=i}while(++i<this._aColumnMapper.length);e&&this.redraw()},triggerRebuildHeaderMenu:function(){return this._oHeader.refreshColumnList()},triggerRestoreColumnLayout:function(e){this.restoreColumnMapperDefaults(!0),this.triggerLayoutChange(e)},createView:function(){return this.pbScroll?new t.v(this,this._oModel,this._oController):new e.L(this,this._oModel,this._oController)},createController:function(){return new o.x(this,this._oModel)},createModel:function(){return this.peDbGridType!==df.gtAllData&&this.peDbGridType!==df.gtManual&&this.pbDataAware&&this.pbScroll?new s.W(this):new i.M(this)},createRowModel:function(){return new df.WebListRowModel(this,this._oModel)},createHeaderView:function(){return new df.WebListHeaderView(this,this._oModel,this._oController)},createFooterView:function(){return new df.WebListFooterView(this,this._oModel,this._oController)},createPlaceHolder:function(){return new df.WebListPlaceHolderView(this,this._oModel)},createTouchHandler:function(){return new df.WebListTouchHandler(this,this._oBody,this._oModel,this._oController)},openHtml:function(e){df.WebList.base.openHtml.call(this,e),e.push('<div class="WebList_Focus" tabindex="',this.isEnabled()?"0":"-1",'">'),this._oHeader.genHtml(e),this._oBody.genHtml(e),this._oFooter.genHtml(e),this._oPlaceHolder.genHtml(e)},closeHtml:function(e){e.push("</div>"),df.WebList.base.closeHtml.call(this,e)},afterRender:function(){var e;this._eControl=this._eFocus=df.dom.query(this._eElem,"div.WebList_Focus"),this._oHeader&&this._oHeader.afterRender(this._eElem),this._oBody.afterRender(this._eElem),this._oFooter&&this._oFooter.afterRender(this._eElem),this._oPlaceHolder.afterRender(this._eElem),this._oTouchHandler.afterRender(this._eElem),df.WebList.base.afterRender.call(this),this.updateEnabled(),df.dom.on("keydown",this._eFocus,this.onKeyDown,this),df.dom.on("keypress",this._eFocus,this.onKeyPress,this),df.dom.on("click",this._eElem,this.onListClick,this),this._bRenderChildren=!0,this.psKeyBuddy&&(e=this.getWebApp().findObj(this.psKeyBuddy))&&(e instanceof df.WebBaseControl&&(this._eKeyBuddy=e._eControl),this._eKeyBuddy||(this._eKeyBuddy=e._eElem),df.events.addDomListener("keydown",this._eKeyBuddy,this.onKeyDown,this)),this.dragDropInit()},afterRenderChildren:function(){},setHeight:function(e,t){this._eControl&&(e>0?(e=(e-=this.getVertHeightDiff())<0?0:e,this._oBody.setHeight(e)):this._oBody.setHeight(0))},getVertHeightDiff:function(){var e=df.WebList.base.getVertHeightDiff.call(this);return this._oHeader&&(e+=this._oHeader.offsetHeight()),this._oFooter&&(e+=this._oFooter.offsetHeight()),e},resize:function(){this._onResize.fire(this),df.WebList.base.resize.call(this)},onKeyPress:function(e){if(this.isEnabled())return this._oController.keyPress(e)},onKeyDown:function(e){if(this.isEnabled())return this._onKeyDown.fire(this,{oDOMEvent:e})},applyEnabled:function(e){this._eFocus&&df.dom.setTabIndex(this._eFocus,e?0:-1),df.WebList.base.applyEnabled.call(this,e)},gridRefresh:function(e,t){const i=this._tActionData;this.cancelServerAction("ChangeCurrentRow"),this.cancelServerAction("OnRowClick"),this._oController.handleData(i,"page","",df.toBool(e),df.toBool(t))},handleDataPage:function(e,t,i,s){const o=this._tActionData;this._oController.handleData(o,e,t,df.toBool(i),df.toBool(s))},handleRowChange:function(e){this._oController.handleRowChange(e)},updateRow:function(e,t){var i=this.deserializeRows(this._tActionData);i.length>0&&this._oController.updateRow(e,i[0],df.toBool(t))},dataSetAppendRow:function(){var e=this.deserializeRows(this._tActionData);e.length>0&&this._oController.appendRow(e[0])},dataSetInsertRowBefore:function(e){var t=this.deserializeRows(this._tActionData);t.length>0&&this._oController.insertBefore(e,t[0])},dataSetInsertRowAfter:function(e){var t=this.deserializeRows(this._tActionData);t.length>0&&this._oController.insertAfter(e,t[0])},dataSetRemoveRow:function(e){this._oController.removeRow(e)},dataSetUpdateRow:function(e){var t=this.deserializeRows(this._tActionData);t.length>0&&this._oController.updateRow(t[0].sRowId,t[0])},removeRow:function(e){this._oController.removeRow(e)},processDataSet:function(e){this._oController.processDataSet(e)},moveToFirstRow:function(){this._oController.moveToFirstRow()},moveToLastRow:function(){this._oController.moveToLastRow()},moveDownRow:function(){this._oController.moveDownRow()},moveUpRow:function(){this._oController.moveUpRow()},movePageDown:function(){this._oController.movePageDown()},movePageUp:function(){this._oController.movePageUp()},moveToRow:function(e){this._oController.moveToRow(e)},moveToRowByID:function(e){this._oController.moveToRowByID(e)},scrollToCol:function(e){this.pbScroll&&this._oBody&&this._oBody.scrollToCol(e)},search:function(e){this._oController.search(e)},showSearch:function(e){this._oController.showSearch(e)},expandAllGroups:function(){this._oGrouping?.expandAll()},collapseAllGroups:function(){this._oGrouping?.collapseAll()},set_psCurrentRowId:function(e){this._oController&&this._oController.setCurrentRowId(e)},set_pbAllowColumnReordering:function(e){this.pbAllowColumnReordering!==e&&this._oHeader.setColumnReordering(this.pbAllowColumnReordering=e)},set_pbAllowColumnHiding:function(e){this.pbAllowColumnHiding!==e&&this._oHeader.setColumnHiding(this.pbAllowColumnHiding=e)},get_psCurrentRowId:function(){return this.currentRowId()},get_piRowCount:function(){return this._oModel&&this._oModel.aData.length||0},get_piCurrentRowIndex:function(){return this._oModel&&this._oModel.iCurrentRow},set_piSortColumn:function(e){this.propertyUpdate("piSortColumn",e)},set_pbReverseOrdering:function(e){this.propertyUpdate("pbReverseOrdering",e)},set_psPlaceHolder:function(e){this.propertyUpdate("psPlaceHolder",e)},set_pbShowHeader:function(e){this.propertyUpdate("pbShowHeader",e)},set_pbShowFooter:function(e){this.propertyUpdate("pbShowFooter",e)},set_pbShowSelected:function(e){this.propertyUpdate("pbShowSelected",e)},set_pbColumnsResizable:function(e){this.propertyUpdate("pbColumnsResizable",e)},set_pbAutoColumnSizing:function(e){this.propertyUpdate("pbAutoColumnSizing",e),this.redraw()},set_pbGroupsCollapsible:function(e){this.propertyUpdate("pbGroupsCollapsible",e)},set_pbGroupsCollapseByDefault:function(e){this.propertyUpdate("pbGroupsCollapseByDefault",e)},propertyUpdate:function(e,t){var i;this[e]!==t&&(i=this[e],this[e]=t,this._onSettingChange.fire(this,{sType:"prop",sProp:e,newval:t,prevval:i}))},updateCurrentCell:function(e,t){this._oController.updateCell(e,t)},redraw:function(){var e=this;this._tRedraw&&clearTimeout(this._tRedraw),this._tRedraw=setTimeout((function(){e._onSettingChange.fire(e,{sType:"prepare-redraw"}),e._onSettingChange.fire(e,{sType:"redraw"}),e._tRedraw=null}),10)},insertChild:function(e,t){e._bIsColumn&&(e._iColIndex=this._iColCount++,e._iCol=this._aColumns.length,this._aColumns.splice(t,0,e)),e._bIsSwipeButton&&(e._iColIndex=this._iColCount++,this._aSwipeBtns.splice(t,0,e)),df.WebList.base.insertChild.call(this,e,t)},renderChild:function(e,t){this.redraw(),df.WebList.base.renderChild.call(this,e,t)},removeChild:function(e){var t=this._aChildren.indexOf(e);e._bIsColumn&&(e._iColIndex=this._iColCount--,e._iCol=this._aColumns.length,this._aColumns.splice(t,1)),e._bIsSwipeButton&&(e._iColIndex=this._iColCount--,this._aSwipeBtns.splice(t,1)),df.WebList.base.removeChild.call(this,e)},unrenderChild:function(e){this.redraw(),df.WebList.base.unrenderChild.call(this,e)},getColCell:function(e){return this._oBody.colCell(e)},getColHead:function(e){return this._oHeader.colCell(e)},getCell:function(e,t){var i=this._oModel.rowIdByRowIndex(e);return this._oBody.cell(i,t)},currentRowId:function(){return this._oModel&&this._oModel.sCurrentRowId||""},focus:function(){return!!(this._bFocusAble&&this.isEnabled()&&this._eFocus)&&(this._eFocus.focus(),this.objFocus(),!0)},onListClick:function(e){this.focus()},onFocus:function(e){this._bHasFocus||df.WebList.base.onFocus.call(this,e),this._bLozingFocus=!1},onBlur:function(e){var t=this;this._bLozingFocus=!0,setTimeout((function(){t._bLozingFocus&&(df.WebList.base.onBlur.call(t,e),t._bLozingFocus=!1)}),20)},hasFocus:function(){if(this._bHasFocus){if(this._bLozingFocus){for(var e=this.getWebApp()._oCurrentObj;e!=this&&e._oParent;)e=e._oParent;return e==this}return!0}return!1},bindHandlerForWebUIContext:function(e,t){if(t===df.WebUIContext.WebUIContextListHead)this._oHeader?.registerHeaderMenu(e);return!0},unbindHandlerForWebUIContext:function(e,t){if(t===df.WebUIContext.WebUIContextListHead)this._oHeader?.unregisterHeaderMenu(e);return!0},determineSelectorForWebUIContext:function(e){switch(e){case df.WebUIContext.WebUIContextListHead:return".WebList_ColHead";case df.WebUIContext.WebUIContextListRow:return"table[data-dfrowid]";case df.WebUIContext.WebUIContextListFull:return""}return null},retrieveValueFromWebUIContext:function(e,t){switch(t){case df.WebUIContext.WebUIContextListHead:{let t=df.dom.query(e,".WebList_ColCap");return t?t.innerHTML:""}case df.WebUIContext.WebUIContextListRow:if(!e.hasAttribute("data-dfrowid"))break;return e.getAttribute("data-dfrowid");case df.WebUIContext.WebUIContextListFull:{let t=e;for(;t&&t.hasAttribute&&!t.hasAttribute("data-dfrowid")&&t!=this._eElem;)t=t.parentNode;return t?.hasAttribute("data-dfrowid")?t.getAttribute("data-dfrowid"):""}}return null},getDragData:function(e,t){try{const e=t.getAttribute("data-dfrowid")||-1;let i;return e&&"empty"!=e&&-1!=e&&(""!=e||e>=0)?(i={...this._oModel.aData[this._oModel.rowIndexByRowId(e)]},Object.keys(i).forEach((function(e){0==e.indexOf("_")&&delete i[e]})),[{data:i},df.dragActions.WebList.ciDragRow]):[null,null]}catch(e){return console.error("Attempt to perform unsupported drag action"),[null,null]}},getDropData:function(e,t){const i=e._eDropElem&&e._eDropElem.getAttribute("data-dfrowid")||-1;let s;i&&-1!=i&&(""!=i||i>=0)&&(s={...this._oModel.aData[this._oModel.rowIndexByRowId(i)]},Object.keys(s).forEach((function(e){0==e.indexOf("_")&&delete s[e]})));return{data:s,action:df.dropActions.WebList.ciDropOnRow}},initDropZones:function(){if(this._aDropZones=[],df.WebList.base.initDropZones.call(this),this.isSupportedDropAction(df.dropActions.WebList.ciDropOnRow)){const e=df.dom.query(this._eElem,".WebList_BodyWrp");this.addDropZone(e)}},determineDropCandidate:function(e,t){if(t.find((e=>e.supportsDropAction(this,df.dropActions.WebControl.ciDropOnControl))))return[this._eElem,df.dropActions.WebControl.ciDropOnControl];if(!t.find((e=>e.supportsDropAction(this,df.dropActions.WebList.ciDropOnRow))))return[null,null];let i=document.elementFromPoint(e.e.clientX,e.e.clientY)?.closest("table[data-dfrowid]");if(i){const e=i.getAttribute("data-dfrowid");if("empty_placeholder"==e)return[i.previousElementSibling||i.nextElementSibling||i,df.dropActions.WebList.ciDropOnRow];if("empty"!=e)return[i,df.dropActions.WebList.ciDropOnRow];for(;i;){const e=i.getAttribute("data-dfrowid");if("empty"!=e&&"empty_placeholder"!=e)return[i,df.dropActions.WebList.ciDropOnRow];i=i.previousElementSibling}}return[null,null]},determineDropPosition:function(e,t){const i=df.sys.gui.getBoundRect(t),s=i.bottom-i.height/2;return e.e.clientY>=s?df.dropPositions.ciDropAfter:df.dropPositions.ciDropBefore},onControlDragOver:function(e,t,i){if(!this._bScrollQueued){let i=10,s=100;const o=df.sys.gui.getBoundRect(t._eZone),n=o.bottom-50;if(e.e.clientY<=o.bottom&&e.e.clientY>n){o.bottom-e.e.y<.5*n&&(s=20),this._bScrollQueued=!0,setTimeout((()=>{this.dragScroll(i)}),s)}const r=o.top+50;if(e.e.clientY>=o.top&&e.e.clientY<r){i=-i;e.e.y-o.top<.5*r&&(s=20),this._bScrollQueued=!0,setTimeout((()=>{this.dragScroll(i)}),s)}}},dragScroll:function(e){this._oBody.scroll(e,!1),this._bScrollQueued=!1},interactWithDropElem:function(e,t){if(e._eDropAction==df.dropActions.WebControl.ciDropOnControl)e.highlightElement();else{let i=document.createElement("table");df.dom.addClass(i,"WebList_Row WebList_DropPlaceHolder"),i.setAttribute("data-dfrowid","empty_placeholder");const s=this.getPlaceholderRowHeight();s&&s>0&&(i.style.height=String(s)+"px"),e.insertElement(i,t)}},doEmptyInteraction:function(e){if(this.isSupportedDropAction(df.dropActions.WebList.ciDropOnRow)){let t=document.createElement("table");df.dom.addClass(t,"WebList_Row WebList_DropPlaceHolder");const i=this.getPlaceholderRowHeight();i&&i>0&&(t.style.height=String(i)+"px");const s=df.dom.query(this._eElem,".WebList_Body table");return e.insertElement(t,s,df.dropPositions.ciDropBefore),df.dropActions.WebList.ciDropOnRow}return this.isSupportedDropAction(df.dropActions.WebControl.ciDropOnControl)?(e.highlightElement(),df.dropActions.WebControl.ciDropOnControl):null},hasData:function(){return this._oModel.aData&&this._oModel.aData.length>0},getPlaceholderRowHeight:function(){const e=this._oBody.iAvgRowHeight,t=df.dom.clientHeight(df.dom.query(this._eElem,".WebList_Body table"));return(e>0?e:t)||0},deserializeRows:function(e){return e},serializeRows:function(e){return e}})})(),df.WebListTouchHandler=function(e,t,i,s){this.oL=e,this.oV=t,this.oM=i,this.oC=s,this.iAutoScrollIncr=1,this.iSwipeStartOffset=0,this.iSwipeOffset=0,this.eSwipeRow=null,this.eSwipeRowStart=null,this.eSwipeLeftBtns=null,this.eSwipeRightBtns=null},df.defineClass("df.WebListTouchHandler",{afterRender:function(e){var t=this.oV;window.PointerEvent?df.dom.on("pointerdown",t.eBody,this.onPointerDown,this):df.dom.on("touchstart",t.eBody,this.onTouchStart,this),t.bScroll&&t.eBodyWrp.addEventListener&&this.oL.pbAutoColumnSizing&&t.eBodyWrp.addEventListener("touchmove",(function(e){e.preventDefault()}),{passive:!1})},onTouchStart:function(e){1===e.e.targetTouches.length&&this.touchScroll(!1,e)},onPointerDown:function(e){"pen"!==e.e.pointerType&&"touch"!==e.e.pointerType||this.touchScroll(!0,e)},touchScroll:function(e,t){var i,s,o,n,r,a,l,h,d,p,u,f,c,g,b=this,_=this.oV,m=0,C=0,w=Date.now(),S=325,y=0,v=!!_.bScroll,W=!1,D=!1;function R(t){var n;i=e?t.e.clientY:t.e.targetTouches[0].pageY,f=e?t.e.clientX:t.e.targetTouches[0].pageX,D&&W||!D&&Math.abs(u-f)>Math.abs(o-i)?(W=!0,this.swipeRow(t.getTarget(),u-f)):(W&&this.swipeRowCancel(),v&&((n=_.iScrollOffsetPx+(s-i))<0?n=.3*(d+(o-i)):n>l&&(n=l+.3*(d+(o-i)-l)),_.scrollTo(n,!1,!1,!0),t.stop())),s=i,c=f,(g||v)&&t.e.preventDefault()}function M(){var e,t,i,s;_.iAutoScroll===p&&C&&(e=Date.now()-w,_.iScrollOffsetPx<0||_.iScrollOffsetPx>l?(y||(s=Math.abs(-C*Math.exp(-e/S)/C),y=100*s,C=Math.max(-C/2e3,1)*(_.iScrollOffsetPx>l?h:-h)*s,a=_.iScrollOffsetPx+C,w=Date.now(),e=Date.now()-w),t=-C*Math.exp(-e/y)):t=-C*Math.exp(-e/S),i=a+t,t>.5||t<-.5?(_.scrollTo(i,!1,!1,!0),df.dom.animFrame(M,this)):(_.scrollTo(a,!1,!1,!0),a<0?I.call(b,-_.iScrollOffsetPx,i/-h*80):a>l&&I.call(b,l-_.iScrollOffsetPx,(i-l)/h*80)))}function T(t){e?(df.dom.off("pointerup",document,T,this),df.dom.off("pointercancel",document,T,this),df.dom.off("pointermove",document,R,this)):(df.dom.off("touchend",document,T,this),df.dom.off("touchcancel",document,T,this),df.dom.off("touchmove",document,R,this)),clearInterval(r),W&&this.swipeRowEnd(),v&&(_.iScrollOffsetPx<0?I.call(this,-_.iScrollOffsetPx,_.iScrollOffsetPx/-h*80):_.iScrollOffsetPx>l?I.call(this,l-_.iScrollOffsetPx,(_.iScrollOffsetPx-l)/h*80):W||(m>10||m<-10)&&(C=1.9*m,(a=Math.round(_.iScrollOffsetPx+C))>0&&a<l&&(a=_.snapToRow(a)),w=Date.now(),df.dom.animFrame(M,this))),(Math.abs(s-o)>15||Math.abs(c-u)>15)&&e&&(_.bCancelClick=!0,setTimeout((function(){_.bCancelClick=!1}),200))}function I(e,t){var i,s,o,n=this.oV;0!==e&&(i=n.iScrollOffsetPx,s=Date.now(),o=s+t,function t(){var r,a,l,h,d;n.iAutoScroll===p&&(r=Math.min(Date.now(),o),l=r-s,h=i,d=o-s,a=-e/2*(Math.cos(Math.PI*l/d)-1)+h,n.scrollTo(a,!1,!1,!0),r<o&&(a>.5||a<.5)&&df.dom.animFrame(t,this))}())}_.iAutoScroll=p=this.iAutoScrollIncr++,g=this.swipeStart(t.getTarget()),u=c=f=e?t.e.clientX:t.e.targetTouches[0].pageX,o=n=s=i=e?t.e.clientY:t.e.targetTouches[0].pageY,v&&(d=_.iScrollOffsetPx,l=_.getMaxPX(),h=.1*_.iTableHeight),e?(df.dom.on("pointerup",document,T,this),df.dom.on("pointercancel",document,T,this),df.dom.on("pointermove",document,R,this)):(df.dom.on("touchend",document,T,this),df.dom.on("touchcancel",document,T,this),df.dom.on("touchmove",document,R,this)),r=setInterval((function(){var e,t,s;t=(e=Date.now())-w,w=e,s=n-i,n=i,m=500*s/(1+t)*.8+.2*m}),50),setTimeout((function(){D=!0}),300)},showSwipeLeft:function(){var e,t=this.oV.currentRowElem();if(t&&this.swipeStart(t)){if(this.eSwipeRow&&!this.eSwipeRowStart&&this.iSwipeOffset<0)return this.swipeRowClose(this.eSwipeRow),!0;if(this.eSwipeRowStart&&(this.eSwipeRow&&this.eSwipeRow!==this.eSwipeRowStart&&this.swipeRowClose(this.eSwipeRow),this.eSwipeRow=this.eSwipeRowStart,this.eSwipeRowStart=null),this.eSwipeLeftBtns||this.eSwipeRightBtns||this.initSwipeRow(),this.eSwipeLeftBtns)return e=this.iSwipeStartOffset<0?0:this.eSwipeLeftBtns.offsetWidth,this.swipeAniOffset(this.eSwipeRow,e),!0}return!1},showSwipeRight:function(){var e,t=this.oV.currentRowElem();if(t&&this.swipeStart(t)){if(this.eSwipeRow&&!this.eSwipeRowStart&&this.iSwipeOffset>0)return this.swipeRowClose(this.eSwipeRow),!0;if(this.eSwipeRowStart&&(this.eSwipeRow&&this.eSwipeRow!==this.eSwipeRowStart&&this.swipeRowClose(this.eSwipeRow),this.eSwipeRow=this.eSwipeRowStart,this.eSwipeRowStart=null),this.eSwipeLeftBtns||this.eSwipeRightBtns||this.initSwipeRow(),this.eSwipeRightBtns)return e=this.iSwipeStartOffset>0?0:-this.eSwipeRightBtns.offsetWidth,this.swipeAniOffset(this.eSwipeRow,e),!0}return!1},swipeStart:function(e){for(var t,i,s,o,n,r=this.oL,a=this.oV,l=this.oM,h=!1;e&&e!==a.eBody;){if("TABLE"===e.tagName&&e.hasAttribute("data-dfisrow")){h=!0;break}e=e.parentNode}if(h){if(this.iSwipeStartOffset=0,this.eSwipeRow&&this.eSwipeRow===e)return this.iSwipeStartOffset=this.iSwipeOffset,!0;for(t=l.rowIndexByRowId(e.getAttribute("data-dfrowid")),i=l.aData[t],s=0;s<r._aSwipeBtns.length;s++)if(o=r._aSwipeBtns[s],n=i.aCells[o._iColIndex],o.isVisible(n))return this.eSwipeRowStart=e,!0;this.eSwipeRowStart=null}return!1},initSwipeRow:function(){var e,t,i,s,o,n,r,a,l,h,d,p=this.oM,u=this.oL,f=!1,c=!1;if(i=this.eSwipeRow){for(e=p.rowIndexByRowId(i.getAttribute("data-dfrowid")),s=['<table data-dfrowid="',(t=p.aData[e])?t.sRowId:"empty",'" class="WebList_SwipeBtns WebList_SwipeBtnsLeft"><tr>'],o=['<table data-dfrowid="',t?t.sRowId:"empty",'" class="WebList_SwipeBtns WebList_SwipeBtnsRight"><tr>'],d=0;d<u._aSwipeBtns.length;d++)r=u._aSwipeBtns[d],n=t.aCells[r._iColIndex],r.isVisible(n)&&(r.pbPositionLeft?(h=s,c=!0):(h=o,f=!0),h.push('<td data-dfswbtn="',d,'" class="WebList_SwipeBtn ',r.psCSSClass," ",n.sCssClassName,'" style="'),r.piWidth>0&&h.push("width: ",r.piWidth,"px; "),h.push("height: ",i.offsetHeight,'px">',r.btnHtml(n),"</td>"));s.push("</tr></table>"),o.push("</tr></table>"),c&&(this.eSwipeLeftBtns=a=df.dom.create(s.join("")),i.parentNode.insertBefore(a,i)),f&&(this.eSwipeRightBtns=l=df.dom.create(o.join("")),i.parentNode.insertBefore(l,i))}},swipeRow:function(e,t){var i,s=0,o=0;this.eSwipeRowStart&&(this.eSwipeRow&&this.swipeRowClose(this.eSwipeRow),this.eSwipeRow=this.eSwipeRowStart,this.eSwipeRowStart=null),this.eSwipeRow&&(this.eSwipeLeftBtns||this.eSwipeRightBtns||this.initSwipeRow(),this.eSwipeLeftBtns&&(o=this.eSwipeLeftBtns.offsetWidth),this.eSwipeRightBtns&&(s-=this.eSwipeRightBtns.offsetWidth),this.iSwipeOffset=i=Math.max(Math.min(this.iSwipeStartOffset-t,o),s),df.dom.translateX(this.eSwipeRow,i,!1))},swipeRowCancel:function(){this.eSwipeRow&&(this.swipeRowClose(this.eSwipeRow),this.eSwipeRow=null)},swipeRowClose:function(e){var t=this.eSwipeLeftBtns,i=this.eSwipeRightBtns;this.swipeAniOffset(e,0,(function(){t&&t.parentNode&&t.parentNode.removeChild(t),i&&i.parentNode&&i.parentNode.removeChild(i)})),this.eSwipeLeftBtns=null,this.eSwipeRightBtns=null},swipeRowEnd:function(){var e=this.iSwipeOffset;this.eSwipeRow&&(0===(e=this.iSwipeOffset>this.iSwipeStartOffset?this.iSwipeOffset>0?this.eSwipeLeftBtns.offsetWidth:0:this.iSwipeOffset<0?0-this.eSwipeRightBtns.offsetWidth:0)?(this.swipeRowClose(this.eSwipeRow),this.eSwipeRow=null):this.swipeAniOffset(this.eSwipeRow,e))},swipeAniOffset:function(e,t,i){df.dom.transition(e,"all 200ms",i,this),df.dom.translateX(e,t),this.iSwipeOffset=t},swipeBtnClick:function(e,t){for(var i,s=this.oL,o=this.oM,n=t,r=null,a=this.eSwipeRow;t&&t!==this.oV.eBody;){if("TABLE"===t.tagName&&t.hasAttribute("data-dfrowid")){r=t.getAttribute("data-dfrowid");break}t=t.parentNode}r&&(i=o.rowIndexByRowId(r))>=0&&(this.oC.selectRow("row",i),df.dom.addClass(n,"WebCon_Active"),s._aSwipeBtns[n.getAttribute("data-dfswbtn")].btnClick(e,o.aData[i].sRowId,(function(e){df.dom.removeClass(n,"WebCon_Active"),this.swipeRowClose(a),s.focus()}),this))}}),df.WebListRowModel=function(e,t){this.oL=e,this.oM=t,this.iColMin=20,this.iRound=df.sys.isIE&&df.sys.iVersion<=8?1:100,this.sTableWidth="100%",e._onSettingChange.on(this.onSettingChange,this)},df.defineClass("df.WebListRowModel",{init:function(){this.prepareLayout()},onSettingChange:function(e){"prepare-redraw"===e.sType&&this.prepareLayout()},rowHtml:function(e,t,i,s,o,n,r){var a,l,h,d=this.oL;if(e&&e.aCells.length<d._aColumns.length+d._aSwipeBtns.length)throw new df.Error(999,"List data is not containing enough columns ({{0}} / {{1}}).",d,[e.aCells.length,d._aColumns.length+d._aSwipeBtns.length]);for(t.push('<table data-dfisrow="true" data-dfitem="',r,'" data-dfrowid="',e?e.sRowId:"empty",this.oL.pbDragDropEnabled&&(this.oL.isSupportedDragAction(df.dragActions.WebList.ciDragRow)||this.oL.isSupportedDragAction(df.dragActions.WebMultiSelectList.ciDragRowSelection))?'" draggable="true"':'" ','" class="',this.rowClass(e,i,s,o,n),'" style="width:',this.sTableWidth,'">'),this.resizeRowHtml(t),l=0;l<this.oL._aColumnMapper.length;l++){if(!this.oL._aColumnMapper[l].pbRender||this.oL._aColumnMapper[l].pbHidden)continue;(h=this.oL._aColumnMapper[l]).pbNewLine&&t.push("</tr><tr>"),a=e&&(e.aCells[h._iColIndex].sTooltip||h.pbValueAsTooltip&&h.tooltipValue(e.aCells[h._iColIndex]))||"";let i=e&&e.fCellClass?e.fCellClass(h,e&&e.aCells[h._iColIndex]||null):this.cellClass(h,e&&e.aCells[h._iColIndex]||null);t.push('<td data-dfcol="',h._iCol,'" class="',i,'" title="',df.dom.encodeAttr(a),'"'),h.piListRowSpan>1&&t.push(' rowspan="',h.piListRowSpan,'"'),h.piListColSpan>1&&t.push(' colspan="',h.piListColSpan,'"'),h.pbVisible||t.push(df.cHideColumnCSS),t.push(">",e?this.cellHtml(h,e,e.aCells[h._iColIndex]):"&nbsp;","</td>")}t.push("</tr></table>")},cellClass:function(e,t){var i=[];return i.push(e._sCellClass),i.push(e.isEnabled()?df.CssEnabled:df.CssDisabled),e.pbEditable&&"WebGrid"===this.oL._sControlClass&&i.push("WebEditable"),i.push(e.peAlign===df.ciAlignLeft?"WebList_AlignLeft":e.peAlign===df.ciAlignCenter?"WebList_AlignCenter":e.peAlign===df.ciAlignRight?"WebList_AlignRight":""),e.peDataType===df.ciTypeBCD?i.push("dfData_BCD"):e.peDataType===df.ciTypeDate?i.push("dfData_Date"):i.push("dfData_Text"),e.psCSSClass&&i.push(e.psCSSClass),t&&t.sCssClassName&&i.push(t.sCssClassName),i.join(" ")},rowClass:function(e,t,i,s,o){var n=["WebList_Row"];return(e&&e.sRowId)===this.oM.sCurrentRowId&&n.push("WebList_Selected"),n.push(t?" WebList_RowOdd":" WebList_RowEven"),e||n.push("WebList_RowEmpty"),e&&e.sCssClassName&&n.push(e.sCssClassName),n.push(`Web_Level${i}`),s&&n.push("Web_First"),o&&n.push("Web_Last"),n.join(" ")},cellHtml:function(e,t,i){var s,o;return i=i||{sValue:"",sTooltip:"",sCssClassName:"",aOptions:[]},s=e._bHasFocus,e._bHasFocus=!1,o=t&&t.fCellHtml?t.fCellHtml.call(e,t.sRowId,i):e.cellHtml(t.sRowId,i),e._bHasFocus=s,o},resizeRowHtml:function(e){var t,i=this.aColWidths,s=!this.oL.pbAutoColumnSizing;for(e.push("<colgroup>"),t=0;t<i.length;t++)s||i[t].bFixed?e.push('<col data-dfcol="',i[t].oCol._iCol,'" style="width: ',i[t].iPixels,'px"></col>'):e.push('<col data-dfcol="',i[t].oCol._iCol,'" style="width: ',i[t].iPercent,'%"></col>');e.push("</colgroup>")},prepareLayout:function(){this.oL;var e,t,i,s,o,n=[],r=0,a=0,l=0,h=[],d=0,p=0;for(t=0;t<this.oL._aColumnMapper.length;t++)if(this.oL._aColumnMapper[t].pbRender&&!this.oL._aColumnMapper[t].pbHidden){for((i=this.oL._aColumnMapper[t]).piListColSpan=Math.max(i.piListColSpan,1),i.piListRowSpan=Math.max(i.piListRowSpan,1),i.pbNewLine&&n.length>0&&(n[a].length>r&&(r=n[a].length),a++,l=0);n[a]&&n[a][l];)l++;for(s=0;s<i.piListRowSpan;s++)for(n[a+s]||(n[a+s]=[]),o=0;o<i.piListColSpan;o++)n[a+s][l+o]=i;l+=i.piListColSpan}for(n[a]&&n[a].length>r&&(r=n[a].length),e=0;e<r;e++){for(h[e]={bDef:!1,bGues:!1,bFixed:!1,iWidth:0,oCol:null},a=0;a<n.length;a++)if(i=n[a][e]){if(1===i.piListColSpan){h[e].bDef=!0,h[e].bFixed=i.pbFixedWidth,h[e].iWidth=i.piWidth,h[e].oCol=i;break}h[e].bGues||(h[e].bGues=!0,h[e].bFixed=i.pbFixedWidth,h[e].iWidth=i.piWidth/i.piListColSpan,h[e].oCol=i)}h[e].bFixed?h[e].iWidth:p+=h[e].iWidth}for(e=0;e<h.length;e++)d+=h[e].iWidth,h[e].iPixels=h[e].iWidth,h[e].bFixed||(h[e].iPercent=Math.floor(h[e].iWidth*(100/p)*this.iRound)/this.iRound);this.aColWidths=h,this.oL.pbAutoColumnSizing?this.sTableWidth="100%":this.sTableWidth=d+"px"},recalcColumnSizes:function(e,t,i){var s,o,n,r,a,l,h=0;if(this.oL.pbAutoColumnSizing){for(r=this.calcPixelRatio(),s=e+1;s<this.aColWidths.length;s++)this.aColWidths[s].bFixed?this.aColWidths[s].iPixels:this.aColWidths[s].iPercent,(this.aColWidths[s].oCol.pbResizable||i)&&h++;for(this.aColWidths[e].bFixed?this.aColWidths[e].iPixels=this.aColWidths[e].iPixels+t:this.aColWidths[e].iPercent=(this.aColWidths[e].iPercent*r+t)/r;0!==Math.round(t||0)&&t!==n;)for(o=t/h,n=t,s=e+1;s<this.aColWidths.length;s++)(this.aColWidths[s].oCol.pbResizable||i)&&((l=(a=this.aColWidths[s].bFixed?this.aColWidths[s].iPixels:this.aColWidths[s].iPercent*r)-o)<this.iColMin&&(l=this.iColMin),this.aColWidths[s].bFixed?this.aColWidths[s].iPixels=l:this.aColWidths[s].iPercent=l/r,t-=a-l);for(s=0;s<this.aColWidths.length;s++)this.aColWidths[s].bFixed?this.aColWidths[s].oCol.piWidth=this.aColWidths[s].iPixels:this.aColWidths[s].oCol.piWidth=10*this.aColWidths[s].iPercent,this.aColWidths[s].oCol.addSync("piWidth")}else this.aColWidths[e].oCol.piWidth=this.aColWidths[e].iPixels=this.aColWidths[e].iPixels+t,this.aColWidths[e].oCol.addSync("piWidth");this.oL.redraw()},calcPixelRatio:function(){var e,t;for(t=this.oL._oBody.fullwidth(),e=0;e<this.aColWidths.length;e++)this.aColWidths[e].bFixed&&(t-=this.aColWidths[e].iPixels);return t/100},findVColNr:function(e){var t,i,s=this.oL,o=0;for(t=0;t<s._aColumnMapper.length;t++)if((i=s._aColumnMapper[t]).pbRender&&!i.pbHidden){if(i.pbNewLine&&(o=0),i===e)return o;o+=i.piListColSpan}return-1}}),df.WebListPlaceHolderView=function(e,t){this.oL=e,this.oM=t,this.eElem=null,t.onDataUpdate.on(this.onDataUpdate,this),e._onSettingChange.on(this.onSettingChange,this)},df.defineClass("df.WebListPlaceHolderView",{genHtml:function(e){var t=this.oL;e.push('<div class="WebList_PlaceHolder"',t.psPlaceHolder&&0===this.oM.aData.length?"":' style="display: none"',">",df.dom.encodeHtml(t.psPlaceHolder),"</div>")},afterRender:function(e){this.eElem=df.dom.query(e,"div.WebList_PlaceHolder")},onDataUpdate:function(e){this.oL.psPlaceHolder&&this.eElem&&(this.eElem.style.display=0===this.oM.aData.length?"":"none")},onSettingChange:function(e){var t=this.oL;this.eElem&&"prop"===e.sType&&"psPlaceHolder"===e.sProp&&(t.psPlaceHolder?df.dom.setText(this.eElem,t.psPlaceHolder):this.eElem.style.display="none")}}),(()=>{"use strict";var e=__webpack_require__(4074);df.WebListHeaderView=function(e,t,i){this.oL=e,this.oC=i,this.oR=e._oRowRenderer,this._oHeaderMenu=null,this._oHeaderMenuColumnList=null,this._oHeaderMenuColumnRestorer=null,this._bHeaderMenuPreviousState=!0,this._oColumnNewLineCache=[],e._onResize.on(this.onResize,this),e._onSettingChange.on(this.onSettingChange,this),e._onModulesCreated.on(this.onModulesCreated,this)},df.defineClass("df.WebListHeaderView",{onModulesCreated:function(t){var i=this.oL._oBody;i instanceof e.v&&i.onHorizontalScroll.on(this.onHorizontalScroll,this)},genHtml:function(e){var t=this.oL;e.push('<div class="WebList_Head"',t.pbShowHeader?"":' style="display:none"',">"),e.push('<div class="WebList_HeadWrp',t.pbColumnsResizable?" WebList_ColResizable":"",t.pbAutoColumnSizing?" WebList_AutoSize":" WebList_HorizScroll",'">'),this.headerHtml(e),e.push("</div>"),e.push("</div>")},afterRender:function(e){this.eHead=df.dom.query(e,"div.WebList_Head"),this.eHeadWrp=df.dom.query(e,"div.WebList_HeadWrp"),df.dom.on("click",this.eHead,this.onHeadClick,this),df.dom.on("mousedown",this.eHead,this.onHeadMouseDown,this),df.dom.on("dblclick",this.eHead,this.onHeadDblClick,this),this.refreshColumnList(),this.setColumnReordering(this.oL.pbAllowColumnReordering)},registerHeaderMenu:function(e){if(this._oHeaderMenu)throw new df.Error(999,"A WebContextMenu with the context 'ListHead' is already registered, only one is allowed.",this);this._oHeaderMenu=e},unregisterHeaderMenu:function(e){this._oHeaderMenu&&this._oHeaderMenu===e||console.warn("A WebContextMenu with the context 'ListHead' is already registered, only one is allowed.",this),this._oHeaderMenu=null},registerMenuColumnList:function(e){if(this._oHeaderMenuColumnList)throw new df.Error(999,"A WebMenuColumnList is already registered, only one is allowed.",this);if(!(e instanceof df.WebMenuColumnList))throw new df.Error(999,"registerMenuColumnList() should only be called with a WebMenuColumnList.",this);this._oHeaderMenuColumnList=e,this._oHeaderMenuColumnList.pbRender=this.oL.pbAllowColumnReordering},registerMenuColumnRestorer:function(e){if(this._oHeaderMenuColumnRestorer)throw new df.Error(999,"A WebMenuColumnRestorer is already registered, only one is allowed.",this);if(!(e instanceof df.WebMenuColumnRestorer))throw new df.Error(999,"registerMenuColumnRestorer() should only be called with a WebMenuColumnRestorer.",this);this._oHeaderMenuColumnRestorer=e,this._oHeaderMenuColumnRestorer.pbRender=this.oL.pbAllowColumnReordering},refreshColumnList:function(){this._oHeaderMenuColumnList?.refreshColumnList()},setColumnHiding:function(e){this._oHeaderMenuColumnList&&(this._oHeaderMenuColumnList.pbRender=e),this.refreshColumnList()},setColumnReordering:function(e){this._oHeaderMenuColumnRestorer&&(this._oHeaderMenuColumnRestorer.pbRender=e),e&&!df.sys.isMobile?df.dom.on("dragstart",this.eHead,this.onHeadMouseDownWithDraggingProxy,this):df.dom.off("dragstart",this.eHead,this.onHeadMouseDownWithDraggingProxy,this),this._oHeaderMenu?.refreshMenu()},onHeadMouseDownWithDraggingProxy:function(e){this.onHeadMouseDown(e,!0)},headerHtml:function(e){var t,i,s,o=this.oL,n=this.oR;e.push('<table style="width:',n.sTableWidth,'">'),n.resizeRowHtml(e),e.push("<tr>"),s=this.oL._aColumnMapper[this.oL._aColumnMapper.length-1];for(let n=0;n<this.oL._aColumnMapper.length;n++)this.oL._aColumnMapper[n].pbRender&&!this.oL._aColumnMapper[n].pbHidden&&((i=this.oL._aColumnMapper[n]).pbNewLine&&e.push("</tr><tr>"),t="WebList_ColHead",i._iCol===o.piSortColumn&&(t+=o.pbReverseOrdering?" WebList_Sorted":" WebList_SortedReverse"),o.pbColumnSortable&&i.pbSortable&&(t+=" WebList_Sortable"),i.headerCSS()&&(t+=" "+i.headerCSS()),t+=" "+this.oR.cellClass(i,null),e.push("<th ",this.oL.pbAllowColumnReordering?'draggable="true"':"",' class="',t,'" data-dfcol="',i._iCol,'"'),i.piListRowSpan>1&&e.push(' rowspan="',i.piListRowSpan,'"'),i.piListColSpan>1&&e.push(' colspan="',i.piListColSpan,'"'),i.psToolTip&&e.push(' title="',df.dom.encodeHtml(i.psToolTip),'"'),i.pbVisible||e.push(df.cHideColumnCSS),e.push("><div>"),e.push('<div class="WebList_ColCap">',i.headerHtml(),"</div>"),!i.pbResizable||o.pbAutoColumnSizing&&i===s||e.push('<div class="WebList_ColSep" data-dfcol="',i._iCol,'"></div>'),e.push("</div></th>"));e.push("</tr></table>")},updateHeader:function(){var e=[];const t=this.offsetHeight();this.oL.pbAllowColumnHiding&&this.refreshColumnList(),this.eHeadWrp&&(this.headerHtml(e),this.eHeadWrp.innerHTML=e.join("")),t!=this.offsetHeight()&&this.oL.sizeChanged()},offsetHeight:function(){if(this.eHead)return this.eHead.offsetHeight},onHeadClick:function(e){var t,i=e.getTarget();if(this.oL.isEnabled())for(;i.parentNode&&i!==this._eHead;){if("TH"===i.tagName&&i.hasAttribute("data-dfcol"))return t=parseInt(i.getAttribute("data-dfcol"),10),void(this.oC.headClick(e,t)&&e.stop());i=i.parentNode}},onHeadDblClick:function(e){var t,i=e.getTarget();if(this.oL.isEnabled())for(;i.parentNode&&i!==this._eHead;){if("TH"===i.tagName&&i.hasAttribute("data-dfcol"))return t=parseInt(i.getAttribute("data-dfcol"),10),void(this.oC.headDblClick(e,t)&&e.stop());i=i.parentNode}},onHeadMouseDown:function(e,t){var i=e.getTarget();if(!this.oL.isEnabled())return e.stop(),!1;if(0===e.e.button){if(!this._oHeaderMenu||!this._oHeaderMenu.isVisible()){if("WebList_ColSep"===i.className&&this.oL.pbColumnsResizable)return this._oHeaderMenu&&(this._bHeaderMenuPreviousState=this._oHeaderMenu.isEnabled(),this._oHeaderMenu.disable()),this.resizeColumn(e,parseInt(i.getAttribute("data-dfcol"),10)),e.stop(),!1;if((i.classList.contains("WebList_ColHead")||"WebList_ColCap"===i.className)&&this.oL.pbAllowColumnReordering&&t){for(this._oHeaderMenu&&(this._bHeaderMenuPreviousState=this._oHeaderMenu.isEnabled(),this._oHeaderMenu.disable());!i.classList.contains("WebList_ColHead");)i=i.parentNode;const t=parseInt(i.getAttribute("data-dfcol"),10),s=this;this._oColumnNewLineCache=[];for(let e=0;e<this.oL._aColumnMapper.length;e++)this.oL._aColumnMapper[e].pbNewLine&&(this._oColumnNewLineCache.push(e),this.oL._aColumnMapper[e].pbNewLine=!1);return this._oColumnNewLineCache.length>0&&this.oL.redraw(),setTimeout((function(){const i=df.dom.query(s.eHead,'.WebList_ColHead[data-dfcol="'+t+'"');s.moveColumn(i,e,t)}),this._oColumnNewLineCache.length>0?75:0),e.stop(),!1}return!0}this._oHeaderMenu.hideMenu()}},moveColumn:function(e,t,i){const s=this.oL._eElem.cloneNode(!0);var o=[];for(let e=0;e<this.oL._aColumnMapper.length;e++)this.oL._aColumnMapper[e].pbRender&&!this.oL._aColumnMapper[e].pbHidden&&o.push(e);const n=Array.prototype.indexOf.call(e.parentNode.children,e),r=o[n];var a=r;for(let t=0;t<e.childNodes.length;t++)e.removeChild(e.childNodes[t]);e.classList.add("WebList_Moving");const l=df.dom.query(this.oL._oBody.eBody,'td[data-dfcol="'+i+'"',!0);for(let e=0;e<l.length;e++)l[e].innerHTML="",l[e].classList.add("WebList_Moving");const h=e.getBoundingClientRect(),d=h.width/2,p=h.height/2,u=df.dom.query(s,"[data-dfcol]",!0);for(let e=0;e<u.length;e++)u[e].getAttribute("data-dfcol")!=i?u[e].parentNode.removeChild(u[e]):u[e].style.width="100%";const f=df.dom.query(s,".WebList_Scroll");f&&f.parentNode.removeChild(f);let c=df.dom.query(s,".WebList_HorizScroll",!0);for(let e=0;e<c.length;e++)df.dom.removeClass(c[e],"WebList_HorizScroll");if(this.oL.pbShowLabel){const e=df.dom.query(s,"div > label",!1);e&&e.parentNode.removeChild(e)}s.style.position="fixed",s.style.left=t.e.clientX-d+"px",s.style.top=t.e.clientY-p+"px",s.style.width=h.width+"px",s.style["pointer-events"]="none",(this.oL.topLayer()||document.body).appendChild(s);var g=document.body.style.overflow;document.body.style.overflow="hidden";const b=df.dom.query(this.oL._eElem,'[data-dfcol="'+i+'"',!0);function _(t){function i(e,t){const i=e.parentNode;i.removeChild(e),t>=i.childNodes.length?i.appendChild(e):i.insertBefore(e,i.childNodes[t])}i(e,t);for(let e=0;e<b.length;e++)i(b[e],t)}var m=Date.now();const C=this.oL._oBody.eTableWrp,w=20;function S(e){if(s.style.left=e.e.clientX-d+"px",s.style.top=e.e.clientY-p+"px",this.oL._oBody.eTableWrp){let t=C.getBoundingClientRect();Date.now()-m>100&&(e.e.clientX<t.left+w+w?(C.scrollLeft-=w,m=Date.now()):e.e.clientX>t.right-w-w&&(C.scrollLeft+=w,m=Date.now()))}let t=e.getTarget();for(;t.hasAttribute&&!t.hasAttribute("data-dfcol")&&t!=this.oL._eElem;)t=t.parentNode;let i=t;if(t.hasAttribute&&t.hasAttribute("data-dfcol"))for(;i.hasAttribute&&!i.hasAttribute("data-dfobj")&&t!=this.oL._eElem;)i=i.parentNode;if(!t.hasAttribute||!t.hasAttribute("data-dfcol")||i!==this.oL._eElem)return void _(n);if(t.classList.contains("WebList_Moving"))return;const r=t.getBoundingClientRect(),l=r.left+(r.right-r.left)/3,h=r.right-(r.right-r.left)/3;if(e.e.x>l&&e.e.x<h)return;let u=Array.prototype.indexOf.call(t.parentNode.children,t);e.e.x<=l?u>n&&u>0&&u--:e.e.x>h&&u<n&&u<t.parentNode.children.length-1&&u++,a=o[u],_(u)}df.dom.on("mouseup",window,(function e(t){if(this._oHeaderMenu&&this._oHeaderMenu.enable(this._bHeaderMenuPreviousState),0!==t.e.button)return;document.body.style.overflow=g,df.dom.off("mouseup",window,e,this),df.dom.off("mousemove",window,S,this),s.parentNode.removeChild(s);for(let e=0;e<this._oColumnNewLineCache.length;e++)this.oL._aColumnMapper[this._oColumnNewLineCache[e]].pbNewLine=!0;let o=t.getTarget();for(;o.hasAttribute&&!o.hasAttribute("data-dfcol")&&o!=this.oL._eElem;)o=o.parentNode;let n=o;if(o.hasAttribute&&o.hasAttribute("data-dfcol"))for(;n.hasAttribute&&!n.hasAttribute("data-dfobj")&&o!=this.oL._eElem;)n=n.parentNode;if(!o.hasAttribute||!o.hasAttribute("data-dfcol")||n!==this.oL._eElem)return void this.oL.redraw();const l=this.oL._aColumnMapper[r];this.oL._aColumnMapper.splice(r,1),this.oL._aColumnMapper.splice(a,0,l);let h=a<r?a:r;for(;h<this.oL._aColumnMapper.length;h++)this.oL._aColumnMapper[h].piPosition=h;this.oL.redraw(),this.oL.triggerLayoutChange(this.oL._aChildren[i])}),this),df.dom.on("mousemove",window,S,this)},resizeColumn:function(e,t){var i,s,o,n,r,a,l,h,d=this.oL,p=this.oR,u=0,f=0,c=0,g=0;(i=df.gui.dragMask(d.topLayer()||document.body)).style.cursor="e-resize",o=p.calcPixelRatio();let b=e.getTarget().parentNode;for(;b.hasAttribute&&!b.hasAttribute("data-dfcol")&&b!=this.oL._eElem;)b=b.parentNode;if(l=Array.prototype.indexOf.call(b.parentNode.children,b),h=e.getTarget().getBoundingClientRect(),d.pbAutoColumnSizing)for(a=l+1;a<p.aColWidths.length;a++)p.aColWidths[a].oCol.pbResizable&&(f=p.aColWidths[a].bFixed?p.aColWidths[a].iPixels:p.aColWidths[a].iPercent*o,g+=f-p.iColMin);else g=screen.width-h.left;function _(e){var t,i=e.getMouseX();(c=i-n)<r&&(c=r),c>g&&(c=g),t=u+c,s.style.left=t+"px"}function m(e){this._oHeaderMenu&&this._oHeaderMenu.enable(this._bHeaderMenuPreviousState),0===e.e.button&&(df.dom.off("mouseup",i,m,this),df.dom.off("mouseup",window,m,this),df.dom.off("mousemove",i,_,this),s.parentNode.removeChild(s),i.parentNode.removeChild(i),this.oR.recalcColumnSizes(l,c,!1),this.oL.triggerLayoutChange(this.oL._aChildren[t]))}n=e.getMouseX(),r=p.aColWidths[l].bFixed||!d.pbAutoColumnSizing?-p.aColWidths[l].iPixels+p.iColMin:-p.aColWidths[l].iPercent*o+p.iColMin,u=h.left,s=df.dom.create('<div class="WebList_ColResizer"></div>'),this.eHead.appendChild(s),s.style.left=u+"px",s.style.top=h.top+"px",s.style.height=d._eElem.clientHeight+"px",df.dom.on("mouseup",i,m,this),df.dom.on("mouseup",window,m,this),df.dom.on("mousemove",i,_,this)},colCell:function(e){return this.colCellByIndex(e._iCol)},colCellByIndex:function(e){return df.dom.query(this.eHeadWrp,"th.WebList_ColHead[data-dfcol='"+e+"']")},onSettingChange:function(e){var t=this.oL;if("redraw"===e.sType)this.updateHeader();else if("sorting"===e.sType)this.updateHeader();else if("prop"===e.sType)switch(e.sProp){case"piSortColumn":case"pbReverseOrdering":this.updateHeader();break;case"pbShowHeader":this.eHead&&(this.eHead.style.display=t.pbShowHeader?"":"none",t.sizeChanged());break;case"pbColumnsResizable":this.eHead&&df.dom.toggleClass(this.eHeadWrp,"WebList_ColResizable",t.pbColumnsResizable);break;case"pbAutoColumnSizing":df.dom.toggleClass(this.eHeadWrp,"WebList_AutoSize",this.oL.pbAutoColumnSizing),df.dom.toggleClass(this.eHeadWrp,"WebList_HorizScroll",!this.oL.pbAutoColumnSizing)}},onResize:function(e){this.eHead&&this.oL._oBody&&(this.eHead.style.paddingRight=this.oL._oBody.scrollbarWidth()+"px")},onHorizontalScroll:function(e){this.eHeadWrp&&(this.eHeadWrp.scrollLeft=e.nScrollX)}})})(),(()=>{"use strict";var e=__webpack_require__(4074);df.WebListFooterView=function(e,t,i){this.oL=e,this.oC=i,this.oR=e._oRowRenderer,this.oM=t,e._onResize.on(this.onResize,this),e._onSettingChange.on(this.onSettingChange,this),e._onModulesCreated.on(this.onModulesCreated,this)},df.defineClass("df.WebListFooterView",{onModulesCreated:function(t){var i=this.oL._oBody;i instanceof e.v&&i.onHorizontalScroll.on(this.onHorizontalScroll,this)},genHtml:function(e){var t=this.oL;e.push('<div class="WebList_Footer WebList_Body"',t.pbShowFooter?"":' style="display:none"',">"),e.push('<div class="WebList_FooterWrp WebList_BodyWrp',t.pbColumnsResizable?" WebList_ColResizable":"",t.pbAutoColumnSizing?" WebList_AutoSize":" WebList_HorizScroll",'">'),this.footerHtml(e),e.push("</div>"),e.push("</div>")},afterRender:function(e){this.eFooter=df.dom.query(e,"div.WebList_Footer"),this.eFooterWrp=df.dom.query(e,"div.WebList_FooterWrp")},footerHtml:function(e){let t={aCells:[],sCssClassName:"",sRowId:"_WebList_Footer",iGroupHeaderIndex:-1,fCellClass:function(e,t){var i=[];return i.push(e._sCellClass),i.push(df.CssDisabled),i.push(e.peFooterAlign===df.ciAlignLeft?"WebList_AlignLeft":e.peFooterAlign===df.ciAlignCenter?"WebList_AlignCenter":e.peFooterAlign===df.ciAlignRight?"WebList_AlignRight":""),e.peFooterDataType===df.ciTypeBCD?i.push("dfData_BCD"):e.peFooterDataType===df.ciTypeDate?i.push("dfData_Date"):i.push("dfData_Text"),e.psCSSClass&&i.push(e.psCSSClass),t&&t.sCssClassName&&i.push(t.sCssClassName),i.join(" ")},fCellHtml:function(e,t){let i=t.sValue;return 0===i.length?"&nbsp;":(i=df.sys.data.serverToType(i,this.peFooterDataType),i=df.sys.data.typeToDisplay(i,this.peFooterDataType,this.getWebApp(),this._bHasFocus,this.psFooterMask,this.piFooterPrecision),this.pbAllowHtml||(i=df.dom.encodeHtml(i)),""!==i?i:"&nbsp;")}},i=this.oL._aColumns.concat(this.oL._aSwipeBtns);i.sort((function(e,t){const i=e._iColIndex,s=t._iColIndex;return i<s?-1:i>s?1:0}));for(let e=0;e<i.length;e++)t.aCells.push({sValue:i[e].psFooterValue||"",sTooltip:"",sCssClassName:"",aOptions:[]});this.oR.rowHtml(t,e,!0)},updateFooter:function(){var e=[];this.eFooterWrp&&(this.footerHtml(e),this.eFooterWrp.innerHTML=e.join(""))},offsetHeight:function(){if(this.eFooter)return this.eFooter.offsetHeight},onSettingChange:function(e){var t=this.oL;if("redraw"===e.sType)this.updateFooter();else if("sorting"===e.sType)this.updateFooter();else if("prop"===e.sType)switch(e.sProp){case"piSortColumn":case"pbReverseOrdering":this.updateFooter();break;case"pbShowFooter":this.eFooter&&(this.eFooter.style.display=t.pbShowFooter?"":"none",t.sizeChanged());break;case"pbColumnsResizable":this.eFooter&&df.dom.toggleClass(this.eFooterWrp,"WebList_ColResizable",t.pbColumnsResizable);break;case"pbAutoColumnSizing":df.dom.toggleClass(this.eFooterWrp,"WebList_AutoSize",this.oL.pbAutoColumnSizing),df.dom.toggleClass(this.eFooterWrp,"WebList_HorizScroll",!this.oL.pbAutoColumnSizing)}},onResize:function(e){this.eFooter&&this.oL._oBody&&(this.eFooter.style.paddingRight=this.oL._oBody.scrollbarWidth()+"px")},onHorizontalScroll:function(e){this.eFooterWrp&&(this.eFooterWrp.scrollLeft=e.nScrollX)}})})(),df.WebListSwipeButton=function(e,t){df.WebListSwipeButton.base.constructor.call(this,e,t),this.prop(df.tString,"psCaption",""),this.prop(df.tInt,"piWidth",50),this.prop(df.tBool,"pbPositionLeft",!1),this.prop(df.tBool,"pbDynamic",!1),this.prop(df.tBool,"pbAllowHtml",!1),this.event("OnClick",df.cCallModeWait),this._iColIndex=0,this._bIsSwipeButton=!0},df.defineClass("df.WebListSwipeButton","df.WebBaseUIObject",{isVisible:function(e){return this.pbRender&&this.pbVisible&&(!this.pbDynamic||df.toBool(e.aOptions[0]))},btnHtml:function(e){var t="";return t=this.pbDynamic?e.sValue:this.psCaption,this.pbAllowHtml||(t=df.dom.encodeHtml(t)),t},btnClick:function(e,t,i,s){return this.fire("OnClick",[t],i,s),!0}}),df.wleManual=0,df.wleOpenOnRowChange=1,df.wleOpenOnRowClick=2,df.wleOpenOnRowClickCloseOnChange=3,df.wleOpenOnRowDoubleClick=4,df.wleOpenOnRowDoubleClickCloseOnChange=5,df.WebListExpandPanel=function(e,t){if(df.WebListExpandPanel.base.constructor.call(this,e,t),this.prop(df.tInt,"peMode",df.wleOpenOnRowClickCloseOnChange),this.prop(df.tBool,"pbShowLoading",!1),this.prop(df.tString,"psExpandedRow",""),this.prop(df.tBool,"pbFocusOnShow",!0),this.event("OnExpand",df.cCallModeDefault),this.event("OnCollapse",df.cCallModeDefault),this._sExpandedRow=null,this._bExpanding=!1,this.OnAfterExpand=new df.events.JSHandler,this._sControlClass="WebListExpPnl",this._bWrapDiv=!0,this.addSync("psExpandedRow"),!(t instanceof df.WebList))throw new df.Error(999,"WebListExpandPanel object '{{0}}' should be placed inside a WebList object.",this,[this.getLongName()]);this._oL=t,this._oL._onModulesCreated.addListener(this.onModulesCreated,this)},df.defineClass("df.WebListExpandPanel","df.WebBaseContainer",{onModulesCreated:function(e){this._oL._oBody.onRowsRendered.addListener(this.onRowsRendered,this),this._oL._oController.onCellClick.addListener(this.onCellClick,this),this._oL._oController.onCellDblClick.addListener(this.onCellDblClick,this),this._oL._oModel.onRowChange.addListener(this.onRowChange,this)},onCellClick:function(e){this.peMode!=df.wleOpenOnRowClick&&this.peMode!=df.wleOpenOnRowClickCloseOnChange||(this._sExpandedRow==e.sRowId?this.collapse():this.expand(e.sRowId))},onCellDblClick:function(e){this.peMode!=df.wleOpenOnRowDoubleClick&&this.peMode!=df.wleOpenOnRowDoubleClickCloseOnChange||(this._sExpandedRow==e.sRowId?this.collapse():this.expand(e.sRowId))},onRowChange:function(e){this.peMode==df.wleOpenOnRowChange?this._sExpandedRow!==e.sGotoRowId&&this.expand(e.sGotoRowId):this.peMode!=df.wleOpenOnRowClickCloseOnChange&&this.peMode!=df.wleOpenOnRowDoubleClickCloseOnChange||this._sExpandedRow!==e.sGotoRowId&&this.collapse()},afterRender:function(){df.WebListExpandPanel.base.afterRender.call(this),df.dom.on("focusin",this._eElem,this.onFocus,this),df.dom.on("click",this._eElem,this.onClick,this),df.dom.on("keydown keypress",this._eElem,(function(e){e.stopPropagation()}),this)},onFocus:function(e){e.stop()},onClick:function(e){e.stop()},collapse:function(){var e,t=this._oL._oBody;function i(t){e.parentNode&&e.parentNode.removeChild(e),df.dom.off("transitionend",e,i,this)}this._sExpandedRow&&(this.fire("OnCollapse"),this._eElem.parentNode&&(e=this._eElem.cloneNode(!0),df.dom.query(e,"input",!0).forEach((function(e){e.name=e.name+"_1"})),e.style.height=this._eElem.scrollHeight+"px",this._eElem.parentNode.insertBefore(e,this._eElem),this._eElem.parentNode.removeChild(this._eElem),df.dom.animFrame((function(){df.dom.animFrame((function(){df.dom.on("transitionend",e,i,this),df.dom.addClass(e,"WebLEP_Hidden"),df.dom.removeClass(e,"WebLEP_Visible"),e.style.height="0px"}),this)}),this)),df.dom.addClass(this._eElem,"WebLEP_Hidden"),df.dom.removeClass(this._eElem,"WebLEP_Visible"),t.setExtraRowHeight(this._sExpandedRow,0),this._sExpandedRow=null,this.afterHide())},expand:function(e){var t,i,s=this._oL._oBody;function o(e){i.style.height=null,this._bExpanding=!1,df.dom.off("transitionend",i,o,this),this.afterShow()}this._sExpandedRow&&this.collapse(),(t=s.row(e))&&(this._eElem?(this._eElem.style.display="none",df.dom.insertAfter(this._eElem,t)):(this.render(),df.dom.addClass(this._eElem,"WebLEP_Hidden"),this._eElem.style.display="none",df.dom.insertAfter(this._eElem,t),this.afterRender()),i=this._eElem,this.pbShowLoading&&df.dom.addClass(i,"WebCon_Loading"),this.fire("OnExpand",[e],(function(e){df.dom.removeClass(i,"WebCon_Loading")}),this),this.resizeHorizontal(),this.resizeVertical(),this._sExpandedRow=e,this.pbFocusOnShow&&this.focus(),df.dom.animFrame((function(){df.dom.on("transitionend",i,o,this),i.style.height="0px",i.style.display="",df.dom.animFrame((function(){var t;t=this.piHeight>0?this.piHeight+this.getHeightDiff(!1,!0,!1,!1):i.scrollHeight,i.style.height=t+"px",df.dom.addClass(i,"WebLEP_Visible"),df.dom.removeClass(i,"WebLEP_Hidden"),this._bExpanding=!0,s.setExtraRowHeight(e,t),s.scrollToRow(e)}),this)}),this))},onRowsRendered:function(e){var t;this._sExpandedRow&&this._eElem&&(this._eElem.parentNode||(t=this._oL._oBody.row(this._sExpandedRow))&&df.dom.insertAfter(this._eElem,t))},get_psExpandedRow:function(){return this._sExpandedRow||""},resize:function(){this.resizeHorizontal(),this.resizeVertical()},setInnerHeight:function(e){df.WebListExpandPanel.base.setInnerHeight.call(this,e)}}),(()=>{"use strict";var e=__webpack_require__(1740),t=__webpack_require__(4074);const i=e=>class extends e{define_WebGridView_mixin(e,t,i){this.eEditCell=null,this.oEditCol=null,this.sEditRowId=null,this.bCellEdit=!1,this.bStopFocus=!1,t.onColChange.on(this.onColChange,this),t.onBeforeRowChange.on(this.onBeforeRowChange,this),t.onAfterRowChange.on(this.onAfterRowChange,this)}afterRender(e){super.afterRender(e),this.editCell()}refreshDisplay(){this.eBody&&(this.unEditCell(!1),super.refreshDisplay(),this.editCell())}refreshRow(e,t){var i=e===this.sEditRowId;this.eBody&&(i&&(this.unEditCell(!1),i=!0),super.refreshRow(e,t),i&&this.editCell())}refreshCell(e,t){this.oEditCol===t&&this.sEditRowId===e||super.refreshCell(e,t)}insertRow(e,t){super.insertRow(e,t),this.oM.rowIdByRowIndex(e)===this.oM.sCurrentRowId&&this.editCell()}removeTopRow(){this.eEditCell&&this.oM.iCurrentRow===this.iRowDispOffset&&(this.unEditCell(!1),this.oL._eFocus.focus()),super.removeTopRow.call(this)}removeBottomRow(){this.eEditCell&&this.iRowDispLast===this.oM.iCurrentRow&&(this.unEditCell(!1),this.oL._eFocus.focus()),super.removeBottomRow.call(this)}editCell(){var e,t,i,s,o,n=this.oL,r=this.oM,a=r.iCurrentColumn,l=r.iCurrentRow;if((!this.bScroll||l>=this.iRowDispOffset&&l<=this.iRowDispLast)&&a>=0){if(!(i=n._aColumns[a])||!i.pbEditable)return;this.bCellEdit=s=i._bCellEdit,e=i._eElem,i._bIgnoreOnChange=!0,(t=this.cell(r.sCurrentRowId,a))&&(t!==this.eEditCell&&(s&&(t.innerHTML="",t.appendChild(e)),df.dom.addClass(t,"WebGrid_EditCell")),i.cellEdit(),n.hasFocus()&&(i.isEnabled()?s?(i.focus(!0),(df.sys.isIE||df.sys.isEdge&&df.sys.iVersion<13)&&setTimeout((function(){df.sys.isEdge?i.focus(!0):i instanceof df.WebColumn&&i._eControl.select()}),10)):(o=df.dom.getFirstFocusChild(t))?o.focus():n._eFocus.focus():n._eFocus.focus()),this.eEditCell=t,this.oEditCol=i,this.sEditRowId=r.sCurrentRowId),i._bIgnoreOnChange=!1}}unEditCell(e){var t,i,s,o=this.oR,n=this.oM;this.oEditCol&&(i=(t=this.oEditCol)._bCellEdit,s=n.rowIndexByRowId(this.sEditRowId),e&&i&&s>=0&&t.get("pbChanged")&&(n.aData[s].aCells[t._iColIndex].sValue=t.get_psValue()),t._eControl&&t._eControl.blur&&t._eControl.blur(),i&&t._eElem.parentNode&&t._eElem.parentNode.removeChild(t._eElem),s>=0&&(this.eEditCell.innerHTML=o.cellHtml(t,n.aData[s],n.aData[s].aCells[t._iColIndex])),df.dom.removeClass(this.eEditCell,"WebGrid_EditCell"),this.eEditCell=null,this.oEditCol=null,this.iEditRowId=null)}focus(){var e,t=this.oM;if(!this.bStopFocus&&(!this.bScroll||t.iCurrentRow>=this.iRowDispOffset&&t.iCurrentRow<=this.iRowDispLast)&&this.oEditCol)if(this.oEditCol._bCellEdit){if(this.oEditCol.focus(!0))return!0}else if(e=df.dom.getFirstFocusChild(this.eEditCell))return e.focus(),!0;return!1}onColChange(e){e.bRowChange||(this.unEditCell(!0),this.editCell())}onRowChange(e){this.unEditCell(!this.oL.pbDataAware),super.onRowChange(e),this.editCell()}onBeforeRowChange(e){this.bStopFocus=!0}onAfterRowChange(e){this.bStopFocus=!1,this.oL.hasFocus()&&this.focus()}};class s extends(i(e.L)){constructor(e,t,i){super(e,t,i),this.define_WebGridView_mixin(e,t,i)}}class o extends(i(t.v)){constructor(e,t,i){super(e,t,i),this.define_WebGridView_mixin(e,t,i)}}var n=__webpack_require__(5804),r=__webpack_require__(1493);const a=e=>class extends e{define_WebGridModel_mixin(e){this.iCurrentColumn=e.piCurrentColumn,this.onColChange=new df.events.JSHandler}appendRow(e){this.aData.length>0&&""===this.aData[this.aData.length-1].sRowId?(this.aData.splice(this.aData.length-1,0,e),this.iCurrentRow++):this.aData.push(e),this.sortData()&&(this.iCurrentRow=this.rowIndexByRowId(this.sCurrentRowId)),this.prepDisplay(),this.onDataUpdate.fire(this,{sType:"newrow",sRowId:e.sRowId})}};class l extends(a(n.M)){constructor(e){super(e),this.define_WebGridModel_mixin(e)}}class h extends(a(r.W)){constructor(e){super(e),this.define_WebGridModel_mixin(e)}}var d=__webpack_require__(9697);class p extends d.x{constructor(e,t){super(e,t),this.iChangeToCol=null,this.bNewRow=!1,this.tNewRow=null,this.iNewCount=0}selectRow(e,t,i,s){var o=this.oL,n=this.oL._oBody||{};if(o.pbDataAware||this.updateCacheFromColumns(),n.oEditCol&&n.oEditCol.validate&&n.oEditCol.get("pbChanged")&&!n.oEditCol.validate())return!1;super.selectRow(e,t,(function(e,s){var o,n,r=this.oM;null!==this.iChangeToCol&&this.iChangeToCol!==r.iCurrentColumn&&(n=r.iCurrentColumn,r.iCurrentColumn=this.iChangeToCol,r.onColChange.fire(this,{bRowChange:e,iGotoCol:this.iChangeToCol,iPrevCol:n})),this.iChangeToCol=null,e&&r.aData[t]&&(this.tOrigRow=df.sys.json.parse(df.sys.json.stringify(r.aData[t]))),e&&this.bNewRow&&((o=r.rowIndexByRowId(""))>=0&&(r.aData.splice(o,1),r.prepDisplay(),r.iCurrentRow=r.rowIndexByRowId(r.sCurrentRowId),r.onDataUpdate.fire(this,{sType:"remrow",sRowId:"",iRowIndex:o})),this.bNewRow=!1),i&&i.call(this,e,s)}),s)}processDataSet(e){this.updateCacheFromColumns(),super.processDataSet(e)}updateCacheFromColumns(){var e,t,i,s=this.oM,o=this.oL,n=s.iCurrentRow,r=null,a=!1;if(!o.pbDataAware&&n>=0){for(e=0;e<o._aColumns.length;e++)(t=o._aColumns[e]).get("pbChanged")&&(r||(r=JSON.parse(JSON.stringify(s.aData[n]))),i=t.get("psValue"),a=a||r.aCells[t._iColIndex].sValue!==i,r.aCells[t._iColIndex].sValue=i);r&&(a||""===r.sRowId)&&(""===r.sRowId&&(r.sRowId="new_"+this.iNewCount++),s.updateRow(s.sCurrentRowId,r))}}updateRow(e,t,i){this.bNewRow&&""===e&&""===t.sRowId&&(t.sRowId="new_"+this.iNewCount++),super.updateRow(e,t,i)}updateCell(e,t){this.tNewRow&&""===this.oM.sCurrentRowId?this.tNewRow.aCells[e._iColIndex].sValue=t:super.updateCell(e,t)}handleData(e,t,i,s,o){super.handleData.apply(this,arguments),0===this.oM.aData.length&&this.appendNewRow()}createNewRow(){var e,t,i=this.oL;for(e={sRowId:"",sCssClassName:"",aCells:[],iGroupHeaderIndex:-1},t=0;t<i._aColumns.length;t++)e.aCells[i._aColumns[t]._iColIndex]={sValue:i._aColumns[t].peDataType===df.ciTypeBCD?"0":"",sTooltip:"",sCssClassName:"",aOptions:[]};return e}appendNewRow(){var e,t=this.oL,i=this.oM;return!!t.pbAllowAppendRow&&(this.tNewRow=e=this.createNewRow(),this.selectRow("new",-1,(function(s,o){s&&(this.bNewRow=!0,i.aData.push(e),i.sCurrentRowId!==e.sRowId?this.setCurrentRowId(e.sRowId):i.iCurrentRow=i.rowIndexByRowId(e.sRowId),i.prepDisplay(),i.onDataUpdate.fire(this,{sType:"newrow",sRowId:e.sRowId,iRowIndex:i.aData.length-1}),t.pbOfflineEditing&&this.updateColumnsFromCache(!0)),this.tNewRow=null}),t.pbDataAware?null:e),!0)}insertNewRow(){var e,t=this.oL,i=this.oM,s=i.iCurrentRow;return t.pbAllowInsertRow?(this.tNewRow=e=this.createNewRow(),this.selectRow("new",-1,(function(o,n){o&&(this.bNewRow=!0,i.aData.splice(s,0,e),i.sCurrentRowId!==e.sRowId?this.setCurrentRowId(e.sRowId):i.iCurrentRow=i.rowIndexByRowId(e.sRowId),i.prepDisplay(),i.onDataUpdate.fire(this,{sType:"newrow",sRowId:e.sRowId,iRowIndex:i.iCurrentRow}),t.pbOfflineEditing&&this.updateColumnsFromCache(!0),this.tNewRow=null)}),t.pbDataAware?null:e),!0):this.appendNewRow()}clearRow(e){var t,i,s=this.oM,o=this.oL;if(e===s.sCurrentRowId&&s.iCurrentRow>=0)for(t=0;t<o._aColumns.length;t++)(i=o._aColumns[t]).get("pbChanged")&&(i.set("psValue",this.tOrigRow&&this.tOrigRow.aCells[i._iColIndex].sValue||""),i.set("pbChanged",!1))}setCurrentRowId(e){var t,i=this.oM;e!==i.sCurrentRowId&&null!==this.iChangeToCol&&this.iChangeToCol!==i.iCurrentColumn&&(t=i.iCurrentColumn,i.iCurrentColumn=this.iChangeToCol,i.onColChange.fire(this,{bRowChange:!0,iGotoCol:this.iChangeToCol,iPrevCol:t}),this.iChangeToCol=null),super.setCurrentRowId(e)}cellClick(e,t,i){var s=this.oM,o=this.oL;i>=0&&i!==s.iCurrentColumn&&o._aColumns[i].pbEditable&&(this.iChangeToCol=i),"empty"===t&&this.appendNewRow(),super.cellClick(e,t,i)}prevCol(){var e,t,i=this.oM,s=this.oL,o=!1;t=i.iCurrentColumn;for(let e=0;e<s._aColumnMapper.length;e++)if(s._aColumnMapper[e]._iCol===t){t=e;break}do{if(--t<0){if(o)break;o=!0,t=s._aColumnMapper.length-1}}while(!s._aColumnMapper[t].isEnabled()||!s._aColumnMapper[t].pbEditable||!s._aColumnMapper[t].pbRender||s._aColumnMapper[t].pbHidden||!s._aColumnMapper[t].pbVisible);if(t=s._aColumnMapper[t]._iCol,o){if(i.iCurrentRow>0)return this.iChangeToCol=t,this.selectRow("row",i.iCurrentRow-1),!0}else if(t!==i.iCurrentColumn)return e=i.iCurrentColumn,i.iCurrentColumn=t,i.onColChange.fire(this,{bRowChange:o,iGotoCol:t,iPrevCol:e}),!0;return!1}nextCol(){var e,t,i,s=this.oL,o=this.oM;e=o.iCurrentColumn;for(let t=0;t<s._aColumnMapper.length;t++)if(s._aColumnMapper[t]._iCol===e){e=t;break}if(!s._aColumnMapper[e].isEnabled()||s._aColumnMapper[e].validate&&s._aColumnMapper[e].validate()){do{if(++e>=s._aColumnMapper.length){if(t)break;t=!0,e=0}}while(!s._aColumnMapper[e].isEnabled()||!s._aColumnMapper[e].pbEditable||!s._aColumnMapper[e].pbRender||s._aColumnMapper[e].pbHidden||!s._aColumnMapper[e].pbVisible);if(e=s._aColumnMapper[e]._iCol,t)return this.iChangeToCol=e,o.iCurrentRow<o.aData.length-1?(this.selectRow("row",o.iCurrentRow+1),!0):this.appendNewRow();if(e!==o.iCurrentColumn)return i=o.iCurrentColumn,o.iCurrentColumn=e,o.onColChange.fire(this,{bRowChange:!1,iGotoCol:e,iPrevCol:i}),!0}return!0}selectCol(e){var t,i=this.oM,s=this.oL;e>=0&&e<s._aColumns.length&&s._aColumns[e].pbRender&&(t=i.iCurrentColumn,i.iCurrentColumn=e,i.onColChange.fire(this,{bRowChange:!1,iGotoCol:e,iPrevCol:t}))}keyDown(e){const t=e.oDOMEvent;if(t.matchKey(df.settings.gridKeys.prevCol)){if(this.prevCol())return t.stop(),!1}else if(t.matchKey(df.settings.gridKeys.nextCol)){if(this.nextCol())return t.stop(),!1}else{if(!t.matchKey(df.settings.gridKeys.newRow))return super.keyDown(e);if(this.insertNewRow())return t.stop(),!1}return!0}moveDownRow(){return!!super.moveDownRow.call(this)||!(this.oM.bPaged&&!this.oM.bLast)&&this.appendNewRow()}}df.WebGrid=function(e,t){df.WebGrid.base.constructor.call(this,e,t),this.prop(df.tBool,"pbAllowInsertRow",!0),this.prop(df.tBool,"pbAllowAppendRow",!0),this.prop(df.tInt,"piCurrentColumn",0),this.pbAutoSearch=!1,this.addSync("piCurrentColumn"),this._bRenderChildren=!0,this._sControlClass="WebGrid"},df.defineClass("df.WebGrid","df.WebList",{createView:function(){return this.pbScroll?new o(this,this._oModel,this._oController):new s(this,this._oModel,this._oController)},createController:function(){return new p(this,this._oModel)},createModel:function(){return this.peDbGridType!==df.gtAllData&&this.peDbGridType!==df.gtManual&&this.pbDataAware&&this.pbScroll?new h(this):new l(this)},renderChildren:function(){var e,t=this._oModel,i=null,s=null;for(e=0;e<this._aColumns.length;e++)this._aColumns[e].pbShowLabel=!1,this._aColumns[e].render(),this._aColumns[e].afterRender(),null==i&&this._aColumns[e].pbRender&&(i=this._aColumns[e]),null==s&&this._aColumns[e].pbRender&&this._aColumns[e].isEnabled()&&(s=this._aColumns[e]);t.iCurrentColumn<0&&(t.iCurrentColumn=s?s._iCol:i?i._iCol:0)},applyEnabled:function(e){df.WebList.base.applyEnabled.call(this,e)},prevCol:function(){this._oController.prevCol()},nextCol:function(){this._oController.nextCol()},selectCol:function(e){this._oController.selectCol(e)},insertNewRow:function(){return this._oController.insertNewRow()},appendNewRow:function(){return this._oController.appendNewRow()},clearRow:function(e){return this._oController.clearRow(e)},get_piCurrentColumn:function(){return this._oModel.iCurrentColumn},set_piCurrentColumn:function(e){this._oController.selectCol(e)},attachFocusEvents:function(){this._eFocus.tabIndex=-1,df.WebGrid.base.attachFocusEvents.call(this)},focus:function(){return!!(this._bFocusAble&&this.isEnabled()&&this._eFocus)&&(this._oBody.focus()||(this._eFocus.focus(),this.objFocus()),!0)}})})(),(()=>{"use strict";var e=__webpack_require__(9697);class t extends e.x{constructor(e,t){super(e,t),this._bAllChecked=!1,this._iBeginRange=-1}keyDown(e){const t=e.oDOMEvent;let i=this.oL,s=this.oM;if(i._bHasFocus){if(i.pbKeyboardSelection){if(t.matchKey(df.settings.listKeys.select))return this.toggleCurrentRow(),t.stop(),!1;if(t.matchKey(df.settings.listKeys.selectAll))return this.toggleSelectAll(),t.stop(),!1;if(t.matchKey(df.settings.listKeys.deSelectAll))return this.clearSelection(),t.stop(),!1;if(t.matchKey(df.settings.listKeys.scrollUp)||t.matchKey(df.settings.listKeys.scrollDown)||t.matchKey(df.settings.listKeys.scrollPageUp)||t.matchKey(df.settings.listKeys.scrollPageDown)||t.matchKey(df.settings.listKeys.scrollTop)||t.matchKey(df.settings.listKeys.scrollBottom)){let t=super.keyDown(e);return i.pbSelectionByRow&&(this.clearSelection(),this.setCurrentRow(!0)),this._iBeginRange=-1,t}if(t.matchKey(df.settings.listKeys.scrollRangeUp)){-1===this._iBeginRange&&(this._iBeginRange=s.iCurrentRow),this.clearSelection(),this.moveUpRow();for(let e=Math.min(s.iCurrentRow,this._iBeginRange);e<=Math.max(s.iCurrentRow,this._iBeginRange);e++){let t=s.rowIdByRowIndex(e);t&&this.setSelection(t,!0)}return t.stop(),!1}if(t.matchKey(df.settings.listKeys.scrollRangeDown)){-1===this._iBeginRange&&(this._iBeginRange=s.iCurrentRow),this.clearSelection(),this.moveDownRow();for(let e=Math.min(s.iCurrentRow,this._iBeginRange);e<=Math.max(s.iCurrentRow,this._iBeginRange);e++){let t=s.rowIdByRowIndex(e);t&&this.setSelection(t,!0)}return t.stop(),!1}return super.keyDown(e)}t.stop()}}cellClick(e,t,i,s){let o=this.oL,n=this.oM,r=n.rowIndexByRowId(t),a=!!s;if("empty"!==t)if(o.pbKeyboardSelection&&e.e.ctrlKey)this.toggleSelectionOfRow(t);else if(o.pbKeyboardSelection&&e.e.shiftKey){this.clearSelection();let e=this._iBeginRange=-1!==this._iBeginRange?this._iBeginRange:n.iCurrentRow,t=r>=e?1:-1;for(this.selectRow("row",r),r+=t;e!==r;){let i=n.rowIdByRowIndex(e);i&&this.setSelection(i,!0),e+=t}a=!0}else o.pbSelectionByRow?(this.clearSelection(),r>=0&&this.setSelection(t,!0)):i>=0&&o._aColumns[i]._bIsMultiSelectCapable&&this.setSelection(t,!o.isRowIdSelected(t));let l=super.cellClick(e,t,i,a);return a||(this._iBeginRange=-1),e.stop(),l}headClick(e,t){let i=this.oL._aColumns[t];if(i&&i._bIsMultiSelectCapable){if(e.getTarget().classList.contains("WebCB_Fake"))return this.toggleSelectAll(),e.stop(),!1}return super.headClick(e,t)}toggleSelectAll(){this._bAllChecked?this.clearSelection():this.selectAll(),this._iBeginRange=-1}setAllSelectedCheckboxState(e,t=!0){let i=this.oL._oHeader;this._bAllChecked=e,t&&i.updateHeader()}areAllRowsSelected(){return this._bAllChecked}toggleCurrentRow(){var e=this.oM;e.sCurrentRowId&&e.sCurrentRowId.length>0&&this.toggleSelectionOfRow(e.sCurrentRowId)}setCurrentRow(e){var t=this.oM;t.sCurrentRowId&&t.sCurrentRowId.length>0&&this.setSelection(t.sCurrentRowId,e)}toggleSelectionOfRow(e,t){var i=this.oL,s=this.oM;let o=i._paSelectedRowIds.findIndex((t=>t===e));o>=0?(i._paSelectedRowIds.splice(o,1),t||this.fireSelectionEvent("OnDeSelectRow",s.rowByRowId(e)),i._oBody.refreshRow(e,e)):(i._paSelectedRowIds.push(e),t||this.fireSelectionEvent("OnSelectRow",s.rowByRowId(e)),i._oBody.refreshRow(e,e)),this.setAllSelectedCheckboxState(!1)}isCurrentRowSelected(){var e=this.oL,t=this.oM;return!(!t.sCurrentRowId||t.sCurrentRowId.length<=0)&&e._paSelectedRowIds.findIndex((e=>e===t.sCurrentRowId))>=0}setSelection(e,t,i){var s=this.oL,o=this.oM;let n=s._paSelectedRowIds.findIndex((t=>t===e));t&&-1==n?(s._paSelectedRowIds.push(e),i||this.fireSelectionEvent("OnSelectRow",o.rowByRowId(e)),s._oBody.refreshRow(e,e)):!t&&n>=0&&(s._paSelectedRowIds.splice(n,1),i||this.fireSelectionEvent("OnDeSelectRow",o.rowByRowId(e)),s._oBody.refreshRow(e,e)),this.setAllSelectedCheckboxState(!1)}selectAll(){let e=this.oL,t=this.oM;e._paSelectedRowIds=[];for(let i=0;i<t.aData.length;i++)e._paSelectedRowIds.push(t.aData[i].sRowId),e._oBody.refreshRow(t.aData[i].sRowId,t.aData[i].sRowId);this.setAllSelectedCheckboxState(!0),this.fireSelectionEvent("OnSelectAllRows")}clearSelection(){let e=this.oL,t=e._paSelectedRowIds.slice();e._paSelectedRowIds=[];for(let i=0;i<t.length;i++)e._oBody.refreshRow(t[i],t[i]);this.setAllSelectedCheckboxState(!1),this.fireSelectionEvent("OnDeSelectAllRows")}fireSelectionEvent(e,t){let i=this.oL;const s=1,o=2,n=3,r=4;let a=0;switch(e){case"OnSelectRow":if(a=s,null==t)return;break;case"OnDeSelectRow":if(a=o,null==t)return;break;case"OnSelectAllRows":a=n;break;case"OnDeSelectAllRows":a=r;break;default:throw new df.Error(999,"Invalid selection Event")}i.addSync("paSelectedRowIds"),i.fireEx({sEvent:e,aParams:[a],tActionData:t,sAltServerName:"privateOnSelectEvent"})}}df.WebMuliSelectList=function(e,t){df.WebMuliSelectList.base.constructor.call(this,e,t),this._sControlClass="WebMultiSelectList WebList",this._aMultiSelectColumns=[],this.prop(df.tAdv,"paSelectedRowIds",null),this.prop(df.tBool,"pbSelectionByRow",!0),this.prop(df.tBool,"pbKeyboardSelection",!0),this.event("OnSelectRow",df.cCallModeDefault),this.event("OnDeSelectRow",df.cCallModeDefault),this.event("OnSelectAllRows",df.cCallModeDefault),this.event("OnDeSelectAllRows",df.cCallModeDefault),this._paSelectedRowIds=[]},df.defineClass("df.WebMuliSelectList","df.WebList",{addChild:function(e){e._bIsColumn&&e._bIsMultiSelectCapable&&this._aMultiSelectColumns.push(e),df.WebMuliSelectList.base.addChild.call(this,e)},createController:function(){return new t(this,this._oModel)},createRowModel:function(){return new df.WebMultiSelectListRowModel(this,this._oModel)},set_paSelectedRowIds:function(e){e=df.sys.vt.deserialize(e,[df.tString]),Array.isArray(e)||(e=[]),e&&e.length===this._paSelectedRowIds.length&&e.every(((e,t)=>e===this._paSelectedRowIds[t]))||(this._paSelectedRowIds=e,this._oController.setAllSelectedCheckboxState(!1,!1),this.redraw())},get_paSelectedRowIds:function(){return df.sys.vt.serialize(this._paSelectedRowIds,[df.tString])},isRowIdSelected:function(e){return this._paSelectedRowIds.find((t=>t===e))},hasCheckboxColumn:function(){return this._aMultiSelectColumns.length>0},gridRefresh:function(e,t){this._oController.setAllSelectedCheckboxState(!1),df.WebMuliSelectList.base.gridRefresh.call(this,e,t)},handleDataPage:function(e,t,i,s){this._oController.setAllSelectedCheckboxState(!1),df.WebMuliSelectList.base.handleDataPage.call(this,e,t,i,s)},dataSetAppendRow:function(){this._oController.setAllSelectedCheckboxState(!1),df.WebMuliSelectList.base.dataSetAppendRow.call(this)},dataSetInsertRowBefore:function(e){this._oController.setAllSelectedCheckboxState(!1),df.WebMuliSelectList.base.dataSetInsertRowBefore.call(this,e)},dataSetInsertRowAfter:function(e){this._oController.setAllSelectedCheckboxState(!1),df.WebMuliSelectList.base.dataSetInsertRowAfter.call(this,e)},dataSetRemoveRow:function(e){this._oController.setSelection(e,!1),df.WebMuliSelectList.base.dataSetRemoveRow.call(this,e)},removeRow:function(e){this._oController.setSelection(e,!1),df.WebMuliSelectList.base.dataSetRemoveRow.call(this,e)},determineSelectorForWebUIContext:function(e){return e===df.WebUIContext.WebUIContextListSelection?".WebList_MultiSelected":df.WebMuliSelectList.base.determineSelectorForWebUIContext.call(this,e)},retrieveValueFromWebUIContext:function(e,t){return t===df.WebUIContext.WebUIContextListSelection?this._paSelectedRowIds.join(","):df.WebMuliSelectList.base.retrieveValueFromWebUIContext.call(this,e,t)},getDragData:function(e,t){try{const e=t.getAttribute("data-dfrowid")||-1;let i;return e&&"empty"!=e&&-1!=e&&(""!=e||e>=0)?(i=[],this._paSelectedRowIds.includes(e)?this._paSelectedRowIds.forEach((e=>i.push({...this._oModel.aData[this._oModel.rowIndexByRowId(e)]}))):i.push({...this._oModel.aData[this._oModel.rowIndexByRowId(e)]}),i.forEach((e=>Object.keys(e).forEach((function(t){0==t.indexOf("_")&&delete e[t]})))),[{data:i},this._paSelectedRowIds.includes(e)?df.dragActions.WebMultiSelectList.ciDragRowSelection:df.dragActions.WebList.ciDragRow]):[null,null]}catch(e){return console.error("Attempt to perform unsupported drag action"),[null,null]}},onDragStart:function(e){var[t,i]=this.getDragData(e,e.e.target);if(t&&i){if(e.e.stopPropagation(),!this._eTempCrt&&i===df.dragActions.WebMultiSelectList.ciDragRowSelection){this._eTempCrt=document.createElement("div"),this._eTempCrt.classList.add("WebMultiSelectList"),this._eTempCrt.classList.add("WebDragDropMultiSelectionGhost"),this._eTempCrt.style.position="absolute",this._eTempCrt.style.top="0px",this._eTempCrt.style.right="0px",this._eTempCrt.style.bottom="0px",this._eTempCrt.style.width="max-content",this._eTempCrt.style.height="20px",this._eTempCrt.style.padding="7px",this._eTempCrt.style.backgroundColor="white",this._eTempCrt.style.border="solid gray 1px",this._eTempCrt.style["border-radius"]="5px",this._eTempCrt.style["z-index"]="-1";let t=document.createElement("p");t.innerText=this._paSelectedRowIds.length+this.getWebApp().getTrans("rows"),this._eTempCrt.appendChild(t),document.body.appendChild(this._eTempCrt),e.e.dataTransfer.setDragImage(this._eTempCrt,0,0)}this._aDragDropHelpers.forEach((s=>{s.onDragStart(e,this,e.e.target,t,i)}))}},onDragEnd:function(e){this._aDragDropHelpers.forEach((t=>{t.onDragEnd(e)})),this._eTempCrt&&(document.body.removeChild(this._eTempCrt),this._eTempCrt=null)}})})(),df.WebMultiSelectListRowModel=function(e,t){df.WebMultiSelectListRowModel.base.constructor.call(this,e,t),this._sCSSSelectedClass="WebList_MultiSelected",this._sCSSUnSelectedClass="WebList_MultiUnSelected"},df.defineClass("df.WebMultiSelectListRowModel","df.WebListRowModel",{rowClass:function(e,t){return e?this.oL._paSelectedRowIds.find((t=>t===e.sRowId))?df.WebMultiSelectListRowModel.base.rowClass.call(this,e,t)+" "+this._sCSSSelectedClass:df.WebMultiSelectListRowModel.base.rowClass.call(this,e,t)+" "+this._sCSSUnSelectedClass:df.WebMultiSelectListRowModel.base.rowClass.call(this,e,t)}}),df.WebColumn_mixin=function(e,t){if(this.getBase("df.WebColumn_mixin").constructor.call(this,e,t),!(t&&t instanceof df.WebList))throw new df.Error(999,"WebColumn object '{{0}}' should be placed inside a WebList object. Consider wrapping your column with a list or grid object.",this,[this.getLongName()]);this.prop(df.tBool,"pbGroupable",!0),this.prop(df.tBool,"pbSortable",!1),this.prop(df.tBool,"pbValueAsTooltip",!0),this.prop(df.tBool,"pbAllowHtml",!1),this.prop(df.tInt,"piWidth",0),this.prop(df.tString,"psCaption",""),this.prop(df.tBool,"pbNewLine",!1),this.prop(df.tInt,"piListColSpan",1),this.prop(df.tInt,"piListRowSpan",1),this.prop(df.tBool,"pbFixedWidth",!1),this.prop(df.tBool,"pbResizable",!0),this.prop(df.tBool,"pbHidden",!1),this.prop(df.tBool,"pbShowCaption",!0),this.prop(df.tInt,"piPosition",-1),this.prop(df.tBool,"pbHideable",!0),this.prop(df.tInt,"peFooterDataType",df.ciTypeText),this.prop(df.tInt,"peFooterAlign",-1),this.prop(df.tInt,"piFooterPrecision",0),this.prop(df.tString,"psFooterMask",""),this.prop(df.tString,"psFooterValue",""),this.addSync("pbHidden"),this.addSync("piPosition"),this.prop(df.tBool,"pbEditable",!0),this.event("OnHeaderClick",df.cCallModeDefault),this._sCellClass="WebCol",this._bCellEdit=!0,this._iColIndex=0,this._iCol=0,this._bIsColumn=!0},df.defineClass("df.WebColumn_mixin",{set_psFooterValue:function(e){this.psFooterValue!==e&&(this.psFooterValue=e,this._oParent._oFooter.updateFooter())},set_psFooterMask:function(e){this.psFooterMask!==e&&(this.psFooterMask=e,this._oParent._oFooter.updateFooter())},set_piFooterPrecision:function(e){this.piFooterPrecision!==e&&(this.piFooterPrecision=e,this._oParent._oFooter.updateFooter())},set_peFooterAlign:function(e){this.peFooterAlign!==e&&(this.peFooterAlign=e,this._oParent._oFooter.updateFooter())},set_peFooterDataType:function(e){this.peFooterDataType!==e&&(this.peFooterDataType=e,this._oParent._oFooter.updateFooter())},set_psValue:function(e){this.getBase("df.WebColumn_mixin").set_psValue.call(this,e),this._oParent instanceof df.WebGrid&&this._oParent.updateCurrentCell(this,e)},set_pbRender:function(e,t){"boolean"!=typeof t&&(t=!0);var i=this.pbRender!==e;this.getBase("df.WebColumn_mixin").set_pbRender.call(this,e),i&&(this.pbRender=e,this._oParent.rebuildColumnMapper(t))},set_pbShowCaption:function(e){this.pbShowCaption!==e&&(this.pbShowCaption=e,this._oParent._oHeader.updateHeader())},set_pbHidden:function(e,t){"boolean"!=typeof t&&(t=!0),this.pbHidden!==e&&(this.pbHidden=e,this._oParent.rebuildColumnMapper(t))},set_piPosition:function(e,t){"boolean"!=typeof t&&(t=!0),this.piPosition!==e&&(this.piPosition=e,this._oParent.rebuildColumnMapper(t))},set_pbHideable:function(e){this.pbHideable!==e&&(this.pbHideable=e,this._oParent.triggerRebuildHeaderMenu())},set_pbEditable:function(e){this.pbEditable!==e&&(this.pbEditable=e,this._oParent.redraw())},set_pbAllowHtml:function(e){this.pbAllowHtml!==e&&(this.pbAllowHtml=e,this._oParent.redraw())},set_piWidth:function(e){this.piWidth!==e&&(this.piWidth=e,this._oParent.redraw())},set_pbFixedWidth:function(e){this.pbFixedWidth!==e&&(this.pbFixedWidth=e,this._oParent.redraw())},set_pbNewLine:function(e){this.pbNewLine!==e&&(this.pbNewLine=e,this._oParent.redraw(),this._oParent.sizeChanged(!0))},set_psCaption:function(e){this.psCaption!==e&&(this.psCaption=e,this._oParent.redraw())},set_psCSSClass:function(e){var t=this.psCSSClass!==e;this.getBase("df.WebColumn_mixin").set_psCSSClass.call(this,e),t&&(this.psCSSClass=e,this._oParent.redraw())},set_piListColSpan:function(e){this.piListColSpan!==e&&(this.piListColSpan=e,this._oParent.redraw())},set_piListRowSpan:function(e){this.piListRowSpan!==e&&(this.piListRowSpan=e,this._oParent.redraw())},set_pbVisible:function(e){this.set_pbVisible!==e&&(this.getBase("df.WebColumn_mixin").set_pbVisible.call(this,e),this.pbVisible=e,this._oParent.redraw())},applyEnabled:function(e){this.getBase("df.WebColumn_mixin").applyEnabled.call(this,e),this._oParent.redraw()},onKey:function(e){this._oParent.onKeyDown(e)?this.getBase("df.WebColumn_mixin").onKey.call(this,e):e.e.cancelBubble=!0},headerCSS:function(){return null},headerHtml:function(){return this.psCaption&&this.pbShowCaption?this.psCaption:"&nbsp;"},cellHtml:function(e,t){var i,s;return i=df.sys.data.serverToType(t.sValue,this.peDataType),s=this.typeToDisplay(i),this.pbAllowHtml||(s=df.dom.encodeHtml(s)),""!==s?s:"&nbsp;"},tooltipValue:function(e){var t=df.sys.data.serverToType(e.sValue,this.peDataType);return this.typeToDisplay(t)},cellClickBefore:function(e,t,i){return!1},cellClickAfter:function(e,t,i){return!1},cellEdit:function(){},cellUnEdit:function(){},getTooltipElem:function(){var e=this._oParent.getColCell(this);return e||(e=this._oParent.getColHead(this)),e},getErrorElem:function(){return this.getTooltipElem()},selectAndFocus:function(){this._oParent instanceof df.WebGrid&&this._oParent.selectCol(this._iCol),this.focus()}}),df.WebColumnBase=df.mixin("df.WebColumn_mixin","df.WebForm"),df.WebColumn=function(e,t){df.WebColumn.base.constructor.call(this,e,t),this.prop(df.tInt,"peWordBreak",df.wbNone)},df.defineClass("df.WebColumn","df.WebColumnBase",{create:function(){this._sCellClass="WebCol "+df.classWordBreak(this.peWordBreak)},cellHtml:function(e,t){return this.pbPassword?t.sValue.replace(/./g,"&bull;"):df.WebColumn.base.cellHtml.call(this,e,t)},tooltipValue:function(e){return this.pbPassword?e.sValue.replace(/./g,"&bull;"):df.WebColumn.base.tooltipValue.call(this,e)},set_peWordBreak:function(e){this.peWordBreak!==e&&(this._sCellClass="WebCol "+df.classWordBreak(e),this._oParent.redraw())}}),df.WebColumnComboBase=df.mixin("df.WebColumn_mixin","df.WebCombo"),df.WebColumnCombo=function(e,t){df.WebColumnCombo.base.constructor.call(this,e,t),this._sCellClass="WebColCombo"},df.defineClass("df.WebColumnCombo","df.WebColumnComboBase",{afterRender:function(){df.WebColumnCombo.base.afterRender.call(this)},cellHtml:function(e,t){var i,s,o=t.sValue;if(this._aValues)for(i=0;i<this._aValues.length;i++)if(this._aValues[i].sValue===o)return this.pbAllowHtml?this._aValues[i].sDescription:df.dom.encodeHtml(this._aValues[i].sDescription);return s=df.sys.data.serverToType(o,this.peDataType),o=this.typeToDisplay(s),this.pbAllowHtml||(o=df.dom.encodeHtml(o)),""!==o?o:"&nbsp;"},onKey:function(e){var t=this;df.WebColumnCombo.base.onKey.apply(this,arguments),df.sys.isMoz&&(e.matchKey(df.settings.listKeys.scrollUp)||e.matchKey(df.settings.listKeys.scrollDown))&&(this._eControl.disabled=!0,setTimeout((function(){t._eControl.disabled=!t.isEnabled()}),20))}}),df.WebColumnCheckboxBase=df.mixin("df.WebColumn_mixin","df.WebCheckbox"),df.WebColumnCheckbox=function(e,t){df.WebColumnCheckbox.base.constructor.call(this,e,t),this._sTick=null,this._sCellClass="WebColCheckbox",this._sControlClass="WebCheckbox WebCheckboxColumn"},df.defineClass("df.WebColumnCheckbox","df.WebColumnCheckboxBase",{cellClickBefore:function(e,t,i){var s=e.getTarget();df.WebColumnCheckbox.base.cellClickBefore.call(this,e,t,i),df.dom.isParent(s,this._eElem)||"INPUT"!==s.tagName&&"SPAN"!==s.tagName||(this._sTick=t)},cellClickAfter:function(e,t,i){df.WebColumnCheckbox.base.cellClickAfter.call(this,e,t,i),this._sTick&&this.getWebApp().waitForCall((function(){this._bIgnoreOnChange=!1,this._sTick===this._oParent.currentRowId()&&(this.tick(),this._sTick=null),this._bIgnoreOnChange=!0}),this)},cellHtml:function(e,t){var i=[];return i.push('<div class="',this.genClass(),'"><div class="WebCon_Inner"><div><input type="checkbox"'),t.sValue===this.psChecked?i.push(' onclick="this.checked = true" checked="checked"'):i.push(' onclick="this.checked = false"'),this.isEnabled()||i.push(' disabled="disabled"'),this._oParent instanceof df.WebGrid||i.push(' tabindex="-1"'),i.push('><span class="WebCB_Fake"></span></div></div></div>'),i.join("")}}),df.WebColumnDateBase=df.mixin("df.WebColumn_mixin","df.WebDateForm"),df.WebColumnDate=function(e,t){df.WebColumnDate.base.constructor.call(this,e,t),this._sCellClass="WebCol"},df.defineClass("df.WebColumnDate","df.WebColumnDateBase",{afterRender:function(){df.WebColumnDate.base.afterRender.call(this)},onKey:function(e){this._bPickerVisible?e.matchKey(df.settings.calendarKeys.close)&&this._bPickerVisible&&(this.hideDatePicker(),e.stop()):df.WebColumnDate.base.onKey.call(this,e)}}),df.WebColumnButtonBase=df.mixin("df.WebColumn_mixin","df.WebBaseDEO"),df.WebColumnButton=function(e,t){df.WebColumnButton.base.constructor.call(this,e,t),this.prop(df.tString,"psBtnCssClass",""),this.prop(df.tBool,"pbDynamic",!1),this.event("OnClick",df.cCallModeWait),this._sControlClass="",this._sCellClass="WebColBtn",this._bCellEdit=!1},df.defineClass("df.WebColumnButton","df.WebColumnButtonBase",{openHtml:function(e){df.WebColumnButton.base.openHtml.call(this,e),e.push("<div>")},closeHtml:function(e){e.push("</div>"),df.WebColumnButton.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div"),df.WebColumnButton.base.afterRender.call(this)},set_psBtnCssClass:function(e){var t=this.psBtnCssClass!==e;this.psBtnCssClass=e,t&&this._oParent.redraw()},getControlValue:function(){return this.psValue},cellClickAfter:function(e,t,i){var s=e.getTarget();return!("BUTTON"!==s.tagName||!s.hasAttribute("data-dfbtnid")||!this.isEnabled()||(this.fire("OnClick",[s.getAttribute("data-dfbtnid"),t]),0))},cellHtml:function(e,t){var i,s,o=[],n="";if(this.isEnabled()||(n+=' disabled="disabled"'),this.pbDynamic)for(s=t.aOptions,i=0;i<s.length;i+=3)s[i]&&o.push('<button data-dfbtnid="',s[i],'" class="',s[i+1],'"',n,">",s[i+2],"</button>");else o.push('<button data-dfbtnid="DEFAULT"',n,' class="',this.psBtnCssClass,'">',this.psButtonCaption,"</button>");return o.join("")},focus:function(){var e;return!!(this._bFocusAble&&this.isEnabled()&&this._eControl&&this._eControl.focus&&(e=df.dom.query(this._eControl,"button")))&&(e.focus(),this.objFocus(),!0)}}),df.WebColumnImageBase=df.mixin("df.WebColumn_mixin","df.WebBaseDEO"),df.WebColumnImage=function(e,t){df.WebColumnImage.base.constructor.call(this,e,t),this.event("OnClick",df.cCallModeWait),this.prop(df.tBool,"pbImageByCSS",!1),this.prop(df.tBool,"pbDynamic",!1),this.prop(df.tInt,"pePosition",df.cwiFit),this.prop(df.tString,"psImageUrl",""),this.prop(df.tString,"psImageCSSClass",""),this.prop(df.tInt,"piImageWidth",0),this.prop(df.tInt,"piImageHeight",0),this._sControlClass="",this._sCellClass="WebColImg",this._bCellEdit=!1},df.defineClass("df.WebColumnImage","df.WebColumnImageBase",{openHtml:function(e){df.WebColumnImage.base.openHtml.call(this,e),e.push("<div>")},closeHtml:function(e){e.push("</div>"),df.WebColumnImage.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div"),df.WebColumnImage.base.afterRender.call(this)},set_psImageUrl:function(e){this.psImageUrl=e,this._oParent.redraw()},getControlValue:function(){return this.psValue},cellClickAfter:function(e,t,i){var s=e.getTarget();return!!(this.isEnabled()&&s.hasAttribute("data-dfimg")&&this.fire("OnClick",[s.getAttribute("data-dfimg"),t]))},cellHtml:function(e,t){var i,s,o,n=[],r="";if(this.piImageWidth>0&&(r+="width: "+this.piImageWidth+"px;"),this.piImageHeight>0&&(r+="height: "+this.piImageHeight+"px;"),this.piImageHeight>0&&this.piImageWidth>0)switch(this.pePosition){case df.cwiActual:break;case df.cwiStretch:r+=" background-size:100% 100%;";break;case df.cwiStretchHoriz:r+=" background-size: 100%; background-position: center center;";break;case df.cwiCenter:r+=" background-position: center center;";break;case df.cwiFit:r+=" background-size:contain; background-position: center center;";break;case df.cwiCover:r+=" background-size:cover; background-position: center center;"}if(this.pbDynamic)if((s=t.aOptions).length)for(i=0;i<s.length;i+=2)s[i]&&(o=s[i+1]||"",this.pbImageByCSS?n.push('<span style="',r,'" class="',s[i],'" data-dfimg="',s[i],'" title="',o,'"></span>'):0===this.piImageWidth||0===this.piImageHeight?n.push('<img style="',r,'" src="',s[i],'" data-dfimg="',s[i],'" title="',o,'">'):n.push('<span style="',r,"background-repeat: no-repeat; background-image: url('",s[i],'\');" data-dfimg="',s[i],'" title="',o,'"></span>'));else n.push('<span style="',r,'" class=""></span>');else this.pbImageByCSS?n.push('<span style="',r,'" class="',this.psImageCSSClass,'" data-dfimg="',this.psImageUrl,'"></span>'):n.push('<img style="',r,'" src="',this.psImageUrl,'" data-dfimg="',this.psImageUrl,'">');return n.join("")}}),df.WebColumnSuggestionBase=df.mixin("df.WebColumn_mixin","df.WebSuggestionForm"),df.WebColumnSuggestion=function(e,t){df.WebColumnSuggestion.base.constructor.call(this,e,t),this._sCellClass="WebCol"},df.defineClass("df.WebColumnSuggestion","df.WebColumnSuggestionBase",{onKey:function(e){var t=df.settings.suggestionKeys;if(this._bSuggestVisible){if(e.matchKey(t.moveUp))return this.suggestMove(-1),void e.stop();if(e.matchKey(t.moveDown))return this.suggestMove(1),void e.stop()}df.WebColumnSuggestion.base.onKey.call(this,e)}}),df.WebColumnLinkBase=df.mixin("df.WebColumn_mixin","df.WebBaseDEO"),df.WebColumnLink=function(e,t){df.WebColumnLink.base.constructor.call(this,e,t),this.event("OnClick",df.cCallModeWait),this._sControlClass="WebColLink",this._sCellClass="WebColLink WebWrp_None",this._bCellEdit=!1},df.defineClass("df.WebColumnLink","df.WebColumnLinkBase",{openHtml:function(e){df.WebColumnLink.base.openHtml.call(this,e),e.push('<a href="javascript:void(0);" target="_self">')},closeHtml:function(e){e.push("</a>"),df.WebColumnLink.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"a"),df.WebColumnLink.base.afterRender.call(this)},getControlValue:function(){return this.psValue},cellClickAfter:function(e,t,i){return!("A"!==e.getTarget().tagName||!this.isEnabled()||(this.fire("OnClick",[t,i]),0))},cellHtml:function(e,t){return'<a href="javascript:void(0);" target="_self">'+df.WebColumnLink.base.cellHtml.call(this,e,t)+"</a>"},onKey:function(e){e.e.cancelBubble=!0,e.matchKey(df.settings.formKeys.submit)?this.cellClick(e,this._oParent.currentRowId(),this.psValue):df.WebColumnLink.base.onKey.call(this,e)}}),df.WebColumnTagsBase=df.mixin("df.WebColumn_mixin","df.WebTagsForm"),df.WebColumnTags=function(e,t){df.WebColumnTags.base.constructor.call(this,e,t),this._sCellClass="WebTagsColumn WebTagsForm WebColTags",this.prop(df.tInt,"peWordBreak",df.wbWrap)},df.defineClass("df.WebColumnTags","df.WebColumnTagsBase",{cellHtml:function(e,t){var i=[];let s=this.parseSelectionValues(t.sValue);for(let e=0;e<s.length;e++)i.push('<div class="WebTgf_Tag">'),i.push('<span class="WebTgf_Text ',df.classWordBreak(this.peWordBreak),'">',df.dom.encodeHtml(this.truncate(s[e],this.piTagTruncateAt,!1)),"</span>"),i.push("</div>");return i.join("")},tooltipValue:function(e){return this.parseSelectionValues(e.sValue).join(", ")},set_peWordBreak:function(e){this.peWordBreak!==e&&this._oParent.redraw()}}),df.WebColumnSelectionIndicator=function(e,t){df.WebColumnSelectionIndicator.base.constructor.call(this,e,t),this.prop(df.tBool,"pbSelectAllCheckbox",!1),this._sCellClass="WebColumnSelectionIndicator WebColCheckbox",this._sControlClass="WebColumnSelectionIndicator WebCheckbox WebCheckboxColumn",this._bIsMultiSelectCapable=!0,this._bAllCheckedCheckbox=!1},df.defineClass("df.WebColumnSelectionIndicator","df.WebColumnCheckbox",{setAllSelectedCheckbox:function(e){e!==this._bAllCheckedCheckbox&&(this._bAllCheckedCheckbox=e,this.updateHeader())},create:function(){if(!(this._oParent instanceof df.WebMuliSelectList))throw new df.Error(999,"The parent of the a cWebColumnSelectionIndicator should be a cWebMultiSelectList.");return df.WebColumnSelectionIndicator.base.create.call(this)},headerCSS:function(){return this.pbSelectAllCheckbox?"WebCheckbox WebCheckboxColumn":null},headerHtml:function(){return this.pbSelectAllCheckbox?'<input class="WebMultiSelectList_SelectAllBox" type="checkbox"'+(this._oParent._oController.areAllRowsSelected()?'checked="checked"':"")+' tabindex="-1"><span class="WebMultiSelectList_SelectAllBox WebCB_Fake"></span>':df.WebColumnSelectionIndicator.base.headerHtml.call(this)},cellHtml:function(e,t){var i=[];return i.push('<div class="',this.genClass(),'"><div class="WebCon_Inner"><div><input type="checkbox"'),this._oParent.isRowIdSelected(e)?i.push(' onclick="this.checked = true" checked="checked"'):i.push(' onclick="this.checked = false"'),this.isEnabled()||i.push(' disabled="disabled"'),this._oParent instanceof df.WebGrid||i.push(' tabindex="-1"'),i.push('><span class="WebCB_Fake"></span></div></div></div>'),i.join("")},set_pbSelectAllCheckbox:function(e){this.pbSelectAllCheckbox!==e&&(this.pbSelectAllCheckbox=e,this._oParent._oHeader.updateHeader())}}),df.WebCommandBar=function(e,t){df.WebCommandBar.base.constructor.call(this,e,t),this.prop(df.tInt,"peRegion",df.ciRegionTop),this._eSizer=null,this._bWrapDiv=!0,this._bRenderChildren=!0,this._sControlClass="WebCommandBar"},df.defineClass("df.WebCommandBar","df.WebBaseUIObject",{addChild:function(e){if(!(e instanceof df.WebMenuBar||e instanceof df.WebToolBar))throw new df.Error(5201,"Invalid object structure: WebCommandBar can only contain WebMenuBar or WebToolBar objects.",this);df.WebCommandBar.base.addChild.call(this,e)},openHtml:function(e){df.WebCommandBar.base.openHtml.call(this,e),e.push('<div class="WebCmd_Sizer">')},closeHtml:function(e){e.push("</div>"),df.WebCommandBar.base.closeHtml.call(this,e)},renderChildren:function(e){var t,i,s,o;for(this._eSizer=df.dom.query(this._eElem,"div.WebCmd_Sizer"),t=0;t<this._aChildren.length;t++)(s=this._aChildren[t])instanceof df.WebBaseUIObject&&(i=s.render(),s instanceof df.WebToolBar?(o||(o=df.dom.create('<div class="WebCmd_ToolWrap"></div>'),this._eSizer.appendChild(o)),o.appendChild(i)):(o=null,this._eSizer.appendChild(i)))},prepareSize:function(){return this._bStretch=!1,this._eSizer&&(this._iWantedHeight=this._eSizer.scrollHeight),this._iWantedHeight},setOuterHeight:function(e){this._eElem&&(this._eElem.style.height=e+"px")}}),df.WebMenuBar=function(e,t){df.WebMenuBar.base.constructor.call(this,e,t),this.prop(df.tBool,"pbShowOnHover",!1),this.prop(df.tBool,"pbFocusable",!1),this._bShownByHover=!1,this._sSelectedItem=null,this._sExpanded=null,this._tHideTimeout=null,this._bIsMenuListener=!0,this._bWrapDiv=!0,this._bRenderChildren=!1,this._sControlClass="WebMenuBar"},df.defineClass("df.WebMenuBar","df.WebBaseMenu",{openHtml:function(e){df.WebMenuBar.base.openHtml.call(this,e),e.push('<ul class="WebBarRoot" tabindex="0">'),this.genMenuHtml(e)},closeHtml:function(e){e.push("</ul>"),e.push('<div style="clear: both"></div>'),df.WebMenuBar.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"ul"),df.WebMenuBar.base.afterRender.apply(this,arguments),df.dom.on("click",this._eControl,this.onMenuClick,this),df.dom.on("mouseover",this._eControl,this.onMouseOver,this),df.dom.on("mouseout",this._eControl,this.onMouseOut,this),df.dom.on("keydown",this._eControl,this.onKeyDown,this)},genMenuHtml:function(e){var t,i=this.getMenu();for(t=0;t<i.length;t++)this.genItemHtml(e,i[t],t.toString(),!0)},refreshMenu:function(){var e=[];this._eControl&&(this.genMenuHtml(e),this._eControl.innerHTML=e.join(""),this.exapndPath(this._sExpanded||"",!0))},onMenuClick:function(e){var t,i=null;if(this.isEnabled()){for(this.notifyReceived(),this._bShownByHover=!1,t=e.getTarget();!i&&t&&t!==this._eElem;)t.hasAttribute("data-df-path")&&(i=this.getItemByPath(t.getAttribute("data-df-path"))),t=t.parentNode;i&&(this.selectItem(i),i.bEnabled&&(this.isExpanded(i)?this.collapseItem(i):this.expandItem(i),i._oHandler.itemClick(i,(function(e){!e||i.hRef instanceof df.WebMenuItemCheckbox||this.collapseAll()}),this)&&this.getWebApp().returnFocus()),e.stop())}},onMouseOver:function(e){var t,i=null;if(this.isEnabled()){for(this.notifyReceived(),t=e.getTarget();!i&&t&&t!==this._eElem;)t.hasAttribute("data-df-path")&&(i=this.getItemByPath(t.getAttribute("data-df-path"))),t=t.parentNode;i&&(this.selectItem(i),(this._sExpanded||this.pbShowOnHover)&&(this._sExpanded||(this._bShownByHover=!0),i.aChildren.length>0?this.expandItem(i):this.collapseSubItems(i)),e.stop())}},onMouseOut:function(e){this.notifyLost(!0),e.stop()},selectItem:function(e){var t;this._sSelectedItem&&this._sSelectedItem!==e._sPath&&this._sSelectedItem!==e._sPath&&((t=this.getItemElemByPath(this._sSelectedItem))&&df.dom.removeClass(t,"WebItm_Selected"),this._sSelectedItem=null),e.bEnabled&&(t=this.getItemElemByPath(e._sPath),df.dom.addClass(t,"WebItm_Selected"),this._sSelectedItem=e._sPath)},isExpanded:function(e){return!(!this._sExpanded||this._sExpanded.substr(0,e._sPath.length)!==e._sPath)},exapndPath:function(e,t){let i=e.split("."),s="";t&&df.dom.addClass(this._eElem,"WebNoTransition");for(let e=0;e<i.length;e++){s+=e>0?"."+i[e]:i[e];let t=this.getItemByPath(s);t&&this.expandItem(t)}t&&df.dom.removeClass(this._eElem,"WebNoTransition")},expandItem:function(e){var t,i,s,o,n,r;if(this.collapseSubItems(e),e.aChildren.length>0&&e.bEnabled){for(this._sExpanded=e._sPath,t=this.getItemElemByPath(this._sExpanded);t&&t!==this._eElem;)t.hasAttribute("data-df-path")&&(df.dom.addClass(t,"WebItm_Expanded"),i=t),t=t.parentNode;i&&(s=i.lastChild,n=(o=i.getBoundingClientRect()).left,r=df.sys.gui.getViewportWidth(),n+s.offsetWidth>r&&(n=o.right-s.offsetWidth)<0&&(n=5),s.style.top=o.bottom+"px",s.style.left=n+"px")}},collapseSubItems:function(e){var t,i=e._sPath;if(this._sExpanded&&e._sPath!==this._sExpanded)if(t=this.getItemElemByPath(this._sExpanded))for(;t&&t!==this._eElem;){if(t.hasAttribute("data-df-path")){if(this._sExpanded=t.getAttribute("data-df-path"),this._sExpanded===i.substr(0,this._sExpanded.length))break;df.dom.removeClass(t,"WebItm_Expanded")}t=t.parentNode}else this.collapseAll()},collapseItem:function(e){var t=e._sPath;t.indexOf(".")>0?(t=t.substr(0,t.lastIndexOf(".")),this.expandItem(this.getItemByPath(t))):this.collapseAll()},collapseAll:function(){var e,t=df.dom.query(this._eControl,"li.WebItm_Expanded",!0);for(e=0;e<t.length;e++)df.dom.removeClass(t[e],"WebItm_Expanded");this._sExpanded=null},notifyLost:function(e){var t=this;e&&!this._bShownByHover||(this._tHideTimeout&&clearTimeout(this._tHideTimeout),this._tHideTimeout=setTimeout((function(){var i;t._tHideTimeout=null,t.collapseAll(),t._sSelectedItem&&((i=t.getItemElemByPath(t._sSelectedItem))&&df.dom.removeClass(i,"WebItm_Selected"),t._sSelectedItem=null),e&&t._bShownByHover&&t.getWebApp().returnFocus()}),150))},notifyReceived:function(){this._tHideTimeout&&(clearTimeout(this._tHideTimeout),this._tHideTimeout=null)},moveParent:function(){var e,t=this._sSelectedItem;t&&t.indexOf(".")>0&&(t=t.substr(0,t.lastIndexOf(".")),(e=this.getItemByPath(t))&&(this.collapseItem(e),this.selectItem(e)))},moveSibling:function(e){var t,i,s,o=!0;if(this._sSelectedItem){for(t=this._sSelectedItem.split(".");o||s&&!s.bEnabled;)t[t.length-1]=parseInt(t[t.length-1],10)+e,i=t.join("."),s=this.getItemByPath(i),o=!1;s&&(this.expandItem(s),this.selectItem(s))}},moveChild:function(){var e,t,i,s=!0;for(e=(t=this._sSelectedItem?this._sSelectedItem+".0":"0").split(".");s||i&&!i.bEnabled;)t=e.join("."),i=this.getItemByPath(t),e[e.length-1]=parseInt(e[e.length-1],10)+1,s=!1;i&&(this.expandItem(i),this.selectItem(i))},onKeyDown:function(e){var t,i=!1,s=this._sSelectedItem&&this._sSelectedItem.indexOf(".")<0;e.matchKey(df.settings.menuKeys.moveUp)?(s||this.moveSibling(-1),i=!0):e.matchKey(df.settings.menuKeys.moveDown)?(s?this.moveChild():this.moveSibling(1),i=!0):e.matchKey(df.settings.menuKeys.moveLeft)?(s?this.moveSibling(-1):this.moveParent(),i=!0):e.matchKey(df.settings.menuKeys.moveRight)?(s?this.moveSibling(1):this.moveChild(),i=!0):e.matchKey(df.settings.formKeys.submit)&&this._sSelectedItem&&(t=this.getItemByPath(this._sSelectedItem))&&(i=!0,t._oHandler.itemClick(t,(function(e){e&&(this.collapseAll(),this.getWebApp().returnFocus())}),this)),i&&(e.stop(),this._bShownByHover=!1)},onFocus:function(e){this.isEnabled()&&(this.notifyReceived(),this._eElem&&(df.dom.addClass(this._eElem,"WebCon_Focus"),this._sSelectedItem||this.moveChild()),this.pbFocusable&&this.objFocus(),this.fire("OnFocus"),this._bHasFocus=!0)},onBlur:function(e){this.notifyLost(!1),this._eElem&&df.dom.removeClass(this._eElem,"WebCon_Focus"),this.fire("OnBlur"),this._bHasFocus=!1}}),df.WebBaseMenuGroup=df.mixin("df.WebMenuProvider_mixin","df.WebObject"),df.WebMenuGroup=function(e,t){df.WebMenuGroup.base.constructor.apply(this,arguments),this._bActive=!1},df.defineClass("df.WebMenuGroup","df.WebBaseMenuGroup",{create:function(){var e=this.getView();e?(e.OnShow.addListener(this.showView,this),e.OnHide.addListener(this.hideView,this)):(this._bActive=!0,df.WebMenuGroup.base.create.apply(this,arguments))},showView:function(e){this._bActive=!0,this.psGroupName&&this.getHub().addProvider(this.psGroupName,this)},hideView:function(e){this._bActive=!1,this.psGroupName&&this.getHub().remProvider(this.psGroupName,this)},set_psGroupName:function(e){this._bActive&&df.WebMenuGroup.base.set_psGroupName.call(this,e)}}),df.WebToolBar=function(e,t){df.WebToolBar.base.constructor.apply(this,arguments),this.prop(df.tBool,"pbShowCaption",!1),this.prop(df.tInt,"peAlign",df.ciAlignLeft),this.prop(df.tBool,"pbShowIcons",!0),this.prop(df.tString,"psSubItemCaption","More.."),this._eControl=null,this._bWrapDiv=!0,this._sControlClass="WebToolBar"},df.defineClass("df.WebToolBar","df.WebMenuBar",{openHtml:function(e){df.WebToolBar.base.openHtml.call(this,e)},closeHtml:function(e){df.WebToolBar.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"ul"),df.WebToolBar.base.afterRender.call(this),this.set_pbShowCaption(this.pbShowCaption),this.set_pbShowIcons(this.pbShowIcons),this.set_peAlign(this.peAlign)},refreshMenu:function(){df.WebToolBar.base.refreshMenu.apply(this,arguments),this.adjustWidth()},genMenuHtml:function(e){df.WebToolBar.base.genMenuHtml.call(this,e),e.push('<li data-df-item="subitems" class="WebMenuItem WebTlb_SubItems WebTlb_NoFit" style="display: none;"><div><span class="WebItm_Icon">&nbsp;</span><a href="javascript: void(0);" target="_self">',this.psSubItemCaption,"</a></div><ul></ul></li>")},onMenuClick:function(e){var t;if(df.WebToolBar.base.onMenuClick.call(this,e),!e.bCanceled)for(t=e.getTarget();t&&t!==this._eElem;){if(t.hasAttribute("data-df-item"))return this._eControl.focus(),this._bSubMenuOpened?this.collapseAll():this.expandSub(),void e.stop();t=t.parentNode}},expandSub:function(){var e,t,i,s,o;(t=(e=df.dom.query(this._eControl,"li.WebTlb_NoFit")).lastChild)&&(df.dom.addClass(e,"WebItm_Expanded"),this._bSubMenuOpened=!0,s=(i=e.getBoundingClientRect()).left,o=df.sys.gui.getViewportWidth(),s+t.offsetWidth>o&&(s=i.right-t.offsetWidth)<0&&(s=5),t.style.top=i.bottom+"px",t.style.left=s+"px")},collapseAll:function(){var e;this._bSubMenuOpened&&(e=df.dom.query(this._eControl,"li.WebTlb_NoFit"),df.dom.addClass(e,"WebItm_Expanded"),this._bSubMenuOpened=!1),df.WebToolBar.base.collapseAll.apply(this,arguments)},adjustWidth:function(){var e,t,i,s,o,n;if(this._eControl)if(e=this._eControlWrp.clientWidth,n=df.dom.query(this._eControl,"li.WebTlb_NoFit"),this._eControl.scrollWidth>e){if((t=df.dom.query(this._eElem,"ul.WebBarRoot > li.WebMenuItem",!0)).length>1)for(o=df.dom.query(this._eControl,"li.WebTlb_NoFit > ul"),n.style.display="",s=t.length-2;this._eControl.scrollWidth>e&&s>=0;)i=t[s],o.appendChild(i),s--}else n.style.display="none"},resize:function(){var e=this._eControlWrp.clientWidth;this._iLastResizeSpace!==e&&(this._iLastResizeSpace=e,this.adjustWidth())},genClass:function(){var e=df.WebToolBar.base.genClass.apply(this,arguments);return e+=this._oParent instanceof df.WebCommandBar?" WebTlb_Command":" WebTlb_Standalone"},set_pbShowCaption:function(e){this._eControl&&(df.dom.toggleClass(this._eControl,"WebTlb_HideCaption",!e),this.refreshMenu())},set_pbShowIcons:function(e){this._eControl&&(df.dom.toggleClass(this._eControl,"WebTlb_HideIcons",!e),this.refreshMenu())},set_peAlign:function(e){this._eControlWrp&&(this._eControlWrp.style.textAlign=["left","center","right"][e])}}),df.WebActionBar=function(e,t){df.WebActionBar.base.constructor.apply(this,arguments),this._sControlClass+=" WebActionBar"},df.defineClass("df.WebActionBar","df.WebToolBar",{genMenuHtml:function(e){var t,i,s=this.getMenu(),o=!1;for(t=0;t<s.length;t++)(i=s[t]).sCSSClass||(i.sCSSClass="WebDefaultMenuItem"),i.eActionDisplay!==df.adBoth&&i.eActionDisplay!==df.adActionBar||this.genItemHtml(e,i,!0),o=o||i.eActionDisplay===df.adBoth||i.eActionDisplay===df.adMenu;if(e.push('<li data-df-item="subitems" class="WebMenuItem WebTlb_SubItems WebTlb_NoFit"',o?"":' style="display: none;"','><div><span class="WebItm_Icon">&nbsp;</span><a href="javascript: void(0);" target="_self">',this.psSubItemCaption,"</a></div><ul>"),o)for(t=0;t<s.length;t++)(i=s[t]).eActionDisplay!==df.adBoth&&i.eActionDisplay!==df.adMenu||this.genItemHtml(e,i,!0);e.push("</ul></li>")},adjustWidth:function(){var e,t,i,s,o;if(this._eControl&&(e=this._eControlWrp.clientWidth,this._eControl.scrollWidth>e&&(t=df.dom.query(this._eElem,"ul.WebBarRoot > li.WebMenuItem",!0)).length>1)){for(s=t.length-2;this._eControl.scrollWidth>e&&s>=0;)(i=t[s]).hasAttribute("data-df-path")&&this.getItemByPath(i.getAttribute("data-df-path")).eActionDisplay===df.adBoth&&i.parentNode.removeChild(i),s--;if(this._eControl.scrollWidth>e)for(o=df.dom.query(this._eControl,"li.WebTlb_NoFit > ul"),s=(t=df.dom.query(this._eElem,"ul.WebBarRoot > li.WebMenuItem",!0)).length-2;this._eControl.scrollWidth>e&&s>=0;)i=t[s],o.appendChild(i),s--;df.dom.query(this._eControl,"li.WebTlb_NoFit").style.display=""}},collapseAll:function(){this._eMask&&(df.dom.off("click",this._eMask,this.onMaskTouch,this),this._eMask.parentNode.removeChild(this._eMask),this._eMask=null),df.WebActionBar.base.collapseAll.apply(this,arguments)},expandItem:function(e){e&&e.aChildren.length>0&&this.showMask(),df.WebActionBar.base.expandItem.apply(this,arguments)},expandSub:function(){this.showMask(),df.WebActionBar.base.expandSub.apply(this,arguments)},showMask:function(){df.sys.isMobile&&(this._eMask=df.dom.create('<div class="WebMenu_Mask">&nbsp;</div>'),this._eElem.insertBefore(this._eMask,this._eElem.firstChild),df.dom.on("click",this._eMask,this.onMaskTouch,this))},onMaskTouch:function(e){this.collapseAll(),e.stop()}}),df.WebMenuItem=function(e,t){df.WebMenuItem.base.constructor.call(this,e,t),this.prop(df.tString,"psCaption",""),this.prop(df.tString,"psTextColor",""),this.prop(df.tBool,"pbBeginGroup",!1),this.prop(df.tString,"psGroupCaption",""),this.prop(df.tString,"psImage",""),this.prop(df.tString,"psToolTip",""),this.prop(df.tInt,"peActionDisplay",df.adBoth),this.event("OnClick",df.cCallModeWait),this.prop(df.tString,"psLoadViewOnClick",""),this._bShown=!0,this._oProv=null},df.defineClass("df.WebMenuItem","df.WebBaseUIObject",{itemClick:function(e,t,i){return this.fire("OnClick",[],(function(e){e.bCanceled||this.psLoadViewOnClick&&this.getWebApp().showView(this.psLoadViewOnClick),t.call(i,e.bClient||e.bServer||this.psLoadViewOnClick)}))},set_psCaption:function(e){this.psCaption=e,this.notifyChange()},set_psToolTip:function(e){this.psToolTip=e,this.notifyChange()},set_pbBeginGroup:function(e){this.pbBeginGroup=e,this.notifyChange()},set_psImage:function(e){this.psImage=e,this.notifyChange()},set_psHtmlId:function(e){this.psHtmlId=e,this.notifyChange()},set_psCSSClass:function(e){this.psCSSClass=e,this.notifyChange()},set_psTextColor:function(e){this.psTextColor=e,this.notifyChange()},set_psBackgroundColor:function(e){this.psBackgroundColor=e,this.notifyChange()},set_peActionDisplay:function(e){this.peActionDisplay=e,this.notifyChange()},set_pbVisible:function(e){this.pbVisible!==e&&(this.pbVisible=e,this.notifyChange())},set_pbRender:function(e){this.pbRender!==e&&(this.pbRender=e,this.pbRender?this.afterShow():this.afterHide(),this.notifyChange())},show:function(){},hide:function(){},applyEnabled:function(e){this.notifyChange()},notifyChange:function(){this.getProv().notifyChange()},getTooltipElem:function(){var e,t,i=this.getProv();if(i){if(!i.psGroupName)return i.getItemElemByHandler(this);for(e=i.getHub().getListeners(i.psGroupName),t=0;t<e.length;t++)if(e[t]._bShown)return e[t].getItemElemByHandler(this)}return null},getProv:function(){var e;if(!this._oProv){for(e=this;e&&!e._bIsMenuProv;)e=e._oParent;if(!e||!e._bIsMenuProv)throw new df.Error(999,"Menu item '{{0}}' should be wrapped by a menu object.",this,[this._sName]);this._oProv=e}return this._oProv},cssClass:function(){return this.psCSSClass},visible:function(){return this.pbRender&&this.pbVisible},customRender:function(){return!1},itemHtml:function(e){},itemRendered:function(e){}}),df.WebMenuItemCheckbox=function(e,t){df.WebMenuItemCheckbox.base.constructor.call(this,e,t),this.prop(df.tBool,"pbChecked",!1),this.addSync("pbChecked")},df.defineClass("df.WebMenuItemCheckbox","df.WebMenuItem",{itemClick:function(e,t,i){return e.hRef&&e.hRef.set_pbChecked(!e.hRef.isChecked()),df.WebMenuItemCheckbox.base.itemClick.apply(this,arguments)},isChecked:function(){return!0===this.pbChecked},set_pbChecked:function(e){this.pbChecked=e,this.notifyChange()}}),df.WebMenuColumnBase=function(e,t){df.WebMenuColumnBase.base.constructor.call(this,e,t),this._bProviderRequestAfterRender=!0},df.defineClass("df.WebMenuColumnBase","df.WebMenuItem",{getList:function(){if(this._oList)return this._oList;if(!this.getProv())throw new df.Error(999,"cWebMenuColumnBase could not find it's parent WebContextMenu.",this);if(!(this._oProv instanceof df.WebContextMenu))throw new df.Error(999,"cWebMenuColumnBase's provider should be a WebContextMenu.",this);let e=this._oProv._oRootControl;if(!(e instanceof df.WebList))throw new df.Error(999,"Control-Referece/Parent of cWebMenuColumnBase should be a WebList/WebGrid.",this);return this._oList=e}}),df.WebMenuColumnList=function(e,t){df.WebMenuColumnList.base.constructor.call(this,e,t),this._iAddedColums=0},df.defineClass("df.WebMenuColumnList","df.WebMenuColumnBase",{afterRender:function(){df.WebMenuColumnList.base.afterRender.call(this,arguments);let e=this.getList();if(!e)throw new df.Error(999,"WebMenuColumnList could not find it's WebList.",this);this.refreshColumnList(),e._oHeader?.registerMenuColumnList(this)},refreshColumnList:function(){if(this._iAddedColums)for(;this._iAddedColums;)this._aChildren[0].destroy(),this._aChildren.splice(0,1),this._iAddedColums--;var e=this.getList();if(!e)throw new df.Error(999,"WebMenuColumnList could not find it's WebList.",this);let t=e._aColumns.length;for(let i=0;i<t;i++){if(!e._aColumns[i].pbRender||0===e._aColumns[i].psCaption.length)continue;let t=new df.WebMenuItemCheckbox(null,this);t.psCaption=e._aColumns[i].psCaption,t.pbChecked=0==e._aColumns[i].pbHidden,t.pbEnabled=e._aColumns[i].pbHideable,t._oColumnRef=e._aColumns[i],t.create(),t.OnClick.on((function(t){this._oColumnRef.pbHideable?(e._aColumns.filter((function(e){return e.pbRender&&!e.pbHidden&&0!==e.psCaption.length})).length<=1?(this.set_pbChecked(!0),this._oColumnRef.set_pbHidden(!1)):(this.set_pbChecked(!this._oColumnRef.pbHidden),this._oColumnRef.set_pbHidden(!this._oColumnRef.pbHidden)),e.triggerLayoutChange(this._oColumnRef),t.stop()):t.stop()}),t),this._aChildren.splice(this._iAddedColums++,0,t)}this.getProv().refreshMenu()},addChild:function(e){df.WebMenuColumnList.base.addChild.call(this,e),this.getProv().refreshMenu()}}),df.WebMenuColumnRestorer=function(e,t){df.WebMenuColumnRestorer.base.constructor.call(this,e,t)},df.defineClass("df.WebMenuColumnRestorer","df.WebMenuColumnBase",{afterRender:function(){df.WebMenuColumnList.base.afterRender.call(this,arguments);let e=this.getList();if(!e)throw new df.Error(999,"WebMenuColumnRestorer could not find it's WebList.",this);e._oHeader?.registerMenuColumnRestorer(this)},itemClick:function(e,t,i){let s=this.getList();if(!s)throw new df.Error(999,"WebMenuColumnList could not find it's WebList.",this);return s.triggerRestoreColumnLayout(this),df.WebMenuColumnRestorer.base.itemClick.call(this,e,t,i)},addChild:function(){throw new df.Error(999,"a cWebMenuColumnRestorer is not supposed to have children.",this)}}),(()=>{"use strict";class e{oL=null;aColumns=[];aGroups=[];eDragGroup=null;onSizeChanged=new df.events.JSHandler;onGroupsChanged=new df.events.JSHandler;components={eMain:null,eContainer:null,eSubGroupBtn:null,eFieldsSelected:null,eChip:null,eSelectDropdown:null};constructor(e){this.oL=e,e._onSettingChange.on(this.onWebListSettingsChange,this),this.createElements(),this.updateColumns()}render(){return this.aGroups=this.oL._oModel.aGroups,this.renderGroups(),df.dom.addClass(this.components.eSelectDropdown,"Web_Hidden"),this.components.eMain}onWebListSettingsChange(e){this.updateColumns()}updateColumns(){this.aColumns=[],this.oL._aColumns.forEach((e=>{e.pbRender&&e.pbGroupable&&this.aColumns.push({iColumnId:e._iCol,sLabel:df.dom.encodeHtml(e.psCaption)})}))}createElements(){const e=this.components.eMain=df.dom.create('<div class="WebGrpSel_Container">\n                <div class="WebGrpSel_Head">\n                    <div id="WebGrpSel_Title">Group Columns</div>\n                    <div class="WebGrpSel_Chip">0</div>\n                </div>\n                <div class="WebGrpSel_Fields"></div>\n                <div class="WebGrpSel_Add">\n                    <button type="button" class="WebGrpSel_Add_Button">+ Add group</button>\n                    <div class="WebGrpSel_DropDown Web_Hidden"></div>\n                </div>\n            </div>\n        ');this.components.eChip=df.dom.query(e,".WebGrpSel_Chip"),this.components.eFieldsSelected=df.dom.query(e,".WebGrpSel_Fields"),this.components.eSubGroupBtn=df.dom.query(e,".WebGrpSel_Add_Button"),this.components.eSelectDropdown=df.dom.query(e,".WebGrpSel_DropDown"),df.dom.on("click",this.components.eMain,this.onMainClick,this),df.dom.on("click",this.components.eSubGroupBtn,this.onAddButtonClick,this),df.dom.on("click",this.components.eSelectDropdown,this.onAddDropDownClick,this),df.dom.on("click",this.components.eFieldsSelected,this.onFieldsClick,this),df.dom.on("change",this.components.eFieldsSelected,this.onFieldsChange,this),df.dom.on("dragstart",this.components.eFieldsSelected,this.onFieldsDragStart,this),df.dom.on("dragenter",this.components.eFieldsSelected,this.onFieldsDragEnter,this),df.dom.on("dragleave",this.components.eFieldsSelected,this.onFieldsDragLeave,this),df.dom.on("dragover",this.components.eFieldsSelected,this.onFieldsDragOver,this),df.dom.on("dragend",this.components.eFieldsSelected,this.onFieldsDragEnd,this),df.dom.on("drop",this.components.eFieldsSelected,this.onFieldsDragDrop,this)}onMainClick(e){e.stop()}onAddButtonClick(e){const t=this.components.eSelectDropdown,i=this.availableColumns();if(t.classList.contains("Web_Hidden")){this.components.eSelectDropdown.innerHTML=i.reduce(((e,t)=>e+`<div class="Web_Item" data-colid="${t.iColumnId}">${t.sLabel}</div>`),"");const e=this.components.eSubGroupBtn.getBoundingClientRect();t.style.top=e.bottom+"px",t.style.left=e.left+"px",df.dom.removeClass(t,"Web_Hidden")}else df.dom.addClass(t,"Web_Hidden")}columnIndexById(e){return this.aColumns.map((e=>e.iColumnId)).indexOf(parseInt(e,10))}onAddDropDownClick(e){const t=e.getTarget()?.closest(".Web_Item[data-colid]")?.dataset.colid||null;if(null==t)return;const i=this.columnIndexById(t);if(-1==i)return;const s=this.aColumns[i];this.aGroups.push({iColumnId:s.iColumnId,sLabel:s.sLabel,bReverse:!1}),this.renderGroups(),this.fireGroupsChanged(),df.dom.addClass(this.components.eSelectDropdown,"Web_Hidden")}availableColumns(){const e=this.aGroups.map((e=>e.iColumnId)),t=[];return this.aColumns.forEach((i=>{-1==e.indexOf(i.iColumnId)&&t.push(i)})),t}renderGroups(){const e=this.availableColumns();this.components.eFieldsSelected.innerHTML=this.aGroups.reduce(((t,i,s)=>(t+=`<div class="WebGrpSel_Group" data-group="${s}" draggable="true">\n                    <div class="WebGrpSel_Action" data-action="rearrange" title="Drag to rearrange"><i class="WebGrpSel_IconReaarrange"></i></div>\n                    <select class="WebGrpSel_GroupSelect" title="Select group col">\n                    <option value="${i.iColumnId}" selected>${i.sLabel}</option>\n            `,t+=e.reduce(((e,t,i)=>e+`<option value="${t.iColumnId}">${t.sLabel}</option>`),""),t+=`</select>\n                    <div class="WebGrpSel_Action" data-action="switchsort" title="Switch sorting direction"><i class="${i.bReverse?"WebGrpSel_IconSortAsc":"WebGrpSel_IconSortDesc"}"></i></div>\n                    <div class="WebGrpSel_Action" data-action="remove" title="Remove Group"><i class="WebGrpSel_IconRemove"></i></div>\n                </div>`)),""),df.dom.setText(this.components.eChip,this.aGroups.length),df.dom.setText(this.components.eSubGroupBtn,this.aGroups.length>0?"+ Add sub group":"+ Add group"),this.onSizeChanged.fire(this)}onFieldsClick(e){const t=e.getTarget().closest(".WebGrpSel_Action")?.dataset.action||null,i=e.getTarget().closest(".WebGrpSel_Group")?.dataset.group||null;if(null!=t&&null!=i&&this.aGroups[i])switch(t){case"remove":this.aGroups.splice(i,1),this.renderGroups(),this.fireGroupsChanged();break;case"switchsort":this.aGroups[i].bReverse=!this.aGroups[i].bReverse,this.renderGroups(),this.fireGroupsChanged()}}onFieldsChange(e){const t=e.getTarget().closest(".WebGrpSel_GroupSelect")?.value||null,i=e.getTarget().closest(".WebGrpSel_Group")?.dataset.group||null;if(null==t||null==i||!this.aGroups[i])return;const s=this.columnIndexById(t);-1!=s&&(this.aGroups[i].iColumnId=this.aColumns[s].iColumnId,this.aGroups[i].sLabel=this.aColumns[s].sLabel,this.renderGroups(),this.fireGroupsChanged())}onFieldsDragStart(e){const t=e.getTarget().closest(".WebGrpSel_Group")||null,i=t?.dataset.group||null;t&&null!=i&&this.aGroups[i]&&(e.e.dataTransfer.dropEffect="move",e.e.dataTransfer.effectAllowed="move",this.eDragGroup=t,t.classList.add("Web_Drag"))}onFieldsDragOver(e){const t=e.getTarget().closest(".WebGrpSel_Group")||null;this.eDragGroup&&null!=t&&(e.e.preventDefault(),e.stopPropagation(),e.e.dataTransfer.dropEffect="move",df.dom.isBefore(this.eDragGroup,t)?this.components.eFieldsSelected.insertBefore(this.eDragGroup,t):this.components.eFieldsSelected.insertBefore(this.eDragGroup,t.nextSibling))}onFieldsDragEnd(e){this.eDragGroup&&(e.e.preventDefault(),e.stopPropagation(),this.finishDrag())}onFieldsDragEnter(e){if(!this.eDragGroup)return;e.e.preventDefault(),e.stopPropagation();e.e.dataTransfer.dropEffect="move"}onFieldsDragDrop(e){this.eDragGroup&&(e.e.preventDefault(),e.stopPropagation(),this.finishDrag())}onFieldsDragLeave(e){this.eDragGroup&&(e.e.preventDefault(),e.stopPropagation())}finishDrag(){const e=this.eDragGroup?.dataset.group||null,t=this.eDragGroup?.nextElementSibling?.dataset.group||null;if(this.eDragGroup=null,null==e||!this.aGroups[e]||null!=t&&!this.aGroups[t])return;const i=this.aGroups[e];this.aGroups.splice(e,1),null!=t?this.aGroups.splice(t,0,i):this.aGroups.push(i),this.renderGroups(),this.fireGroupsChanged()}fireGroupsChanged(){this.onGroupsChanged.fire(this,{aGroups:this.aGroups})}}df.WebMenuGroupingSelector=function(e,t){df.WebMenuGroupingSelector.base.constructor.call(this,e,t),this._oGroupingSelector=null},df.defineClass("df.WebMenuGroupingSelector","df.WebMenuColumnBase",{afterRender:function(){df.WebMenuGroupingSelector.base.afterRender.call(this,arguments);let t=this.getList();if(!t)throw new df.Error(999,"WebMenuGroupingSelector could not find it's WebList.",this);this._oGroupingSelector=new e(t),this._oGroupingSelector.onSizeChanged.on(this.onSizeChange,this),t._oGrouping.registerMenuGroupingSelector(this._oGroupingSelector)},onSizeChange:function(e){this.getProv()?._oMenu?.updateMenuSize()},itemClick:function(e,t,i){},addChild:function(){throw new df.Error(999,"a WebMenuGroupingSelector is not supposed to have children.",this)},cssClass:function(){return df.WebMenuGroupingSelector.base.cssClass.call(this)+" WebMenuGroupingSelector"},visible:function(){if(df.WebMenuGroupingSelector.base.visible.call(this)){return this.getList().peGrouping==df.grpAutomatic}return!1},customRender:function(){return!0},itemHtml:function(e){e.push('<div class="WebMenuGrp_Placeholder"></div>')},itemRendered:function(e){this._oGroupingSelector&&e&&(e.removeChild(e.firstChild),e.appendChild(this._oGroupingSelector.render()))},itemHidden:function(){}})})(),df.WebCardContainer=function(e,t){df.WebCardContainer.base.constructor.call(this,e,t),this.prop(df.tBool,"pbShowBorder",!1),this.prop(df.tBool,"pbShowCaption",!1),this.prop(df.tBool,"pbSwipeCards",!1),this.prop(df.tString,"psCurrentCard",""),this.addSync("psCurrentCard"),this.event("OnCardChange",df.cCallModeWait),this._iHeightSet=null,this._aCards=[],this._eHead=null,this._oCurrent=null,this._bRendered=!1,this._bCC=!0,this._bWrapDiv=!0,this._bRenderChildren=!0,this._sControlClass="WebCardContainer",this._sCardClass="WebCC"},df.defineClass("df.WebCardContainer","df.WebBaseControl",{openHtml:function(e){df.WebCardContainer.base.openHtml.call(this,e),this.headHtml(e),e.push('<div class="',this._sCardClass,'_Body">')},headHtml:function(e){e.push('<div class="',this._sCardClass,'_Head">');for(let t=0;t<this._aCards.length;t++)this._aCards[t].tabButtonHtml(e);e.push('<div style="clear: both"></div></div>')},closeHtml:function(e){e.push("</div>"),e.push('<label class="',this._sCardClass,'_Caption"></label>'),df.WebCardContainer.base.closeHtml.call(this,e)},afterRender:function(){var e,t;for(this._eBody=df.dom.query(this._eElem,"div."+this._sCardClass+"_Body"),this._eHead=df.dom.query(this._eElem,"div."+this._sCardClass+"_Head"),this._eLabel=df.dom.query(this._eElem,"label."+this._sCardClass+"_Caption"),t=df.dom.query(this._eElem,"div."+this._sCardClass+"_Head > div.WebTab_Btn",!0),e=0;e<this._aCards.length;e++)e<t.length&&this._aCards[e].btnRendered(t[e]);df.WebCardContainer.base.afterRender.call(this),this.pbSwipeCards&&this.set_pbSwipeCards(!0),this.showCard(this._oCurrent,!0),this._bRendered=!0},set_pbSwipeCards:function(e){this._eBody&&(e?window.PointerEvent?df.dom.on("pointerdown",this._eBody,this.onPointerDown,this):df.dom.on("touchstart",this._eBody,this.onTouchStart,this):window.PointerEvent?df.dom.off("pointerdown",this._eBody,this.onPointerDown,this):df.dom.off("touchstart",this._eBody,this.onTouchStart,this),df.dom.toggleClass(this._eBody,"WebCC_Swipable",e))},onTouchStart:function(e){1===e.e.targetTouches.length&&this.touchSwipe(!1,e)},onPointerDown:function(e){"pen"!==e.e.pointerType&&"touch"!==e.e.pointerType||this.touchSwipe(!0,e)},touchSwipe:function(e,t){var i,s,o,n,r,a,l,h=null,d=!1,p=!1,u=-1,f=null,c=null,g=this._oCurrent,b=null,_=null,m=null;for(o=0;o<this._aCards.length;o++)if(this._aCards[o]===g&&(u=o),this._aCards[o].isActive())if(u<0)f=this._aCards[o];else if(!c&&u!==o){c=this._aCards[o];break}function C(t){var o;i=e?t.e.clientY:t.e.targetTouches[0].pageY,l=e?t.e.clientX:t.e.targetTouches[0].pageX,(p&&d||!p&&Math.abs(a-l)>Math.abs(s-i))&&(d=!0,r=l-a,b||(b=g._eElem,df.dom.addClass(b,"WebC_Swipe"),n=b.offsetWidth),r>0?(r=Math.min(n,r),f?(m||(_&&(df.dom.translateX(_,null,!1),df.dom.removeClass(_,"WebC_SwipeBelow"),_=null),f._eElem||f.renderCard(!1),m=f._eElem,df.dom.addClass(m,"WebC_SwipeBelow")),o=-.3*n+.3*r,df.dom.translateX(m,o,!1),df.dom.translateX(b,r,!1)):(r*=.17,df.dom.translateX(b,r,!1))):(r=Math.max(-n,r),c?(_||(m&&(df.dom.translateX(m,null,!1),df.dom.removeClass(m,"WebC_SwipeBelow"),m=null),c._eElem||c.renderCard(!1),_=c._eElem,df.dom.addClass(_,"WebC_SwipeBelow")),o=.3*n+.3*r,df.dom.translateX(_,o,!1),df.dom.translateX(b,r,!1)):(r*=.17,df.dom.translateX(b,r,!1))),t.stop())}function w(){h&&this.showCard(h,!1),m&&(df.dom.translateX(m,null,!1),df.dom.removeClass(m,"WebC_SwipeBelow")),_&&(df.dom.translateX(_,null,!1),df.dom.removeClass(_,"WebC_SwipeBelow")),b&&(df.dom.translateX(b,null,!1),df.dom.removeClass(b,"WebC_Swipe WebC_SwipeLeaving"))}function S(t){r>0?f&&m?r>.4*n?(h=f,r<n?(df.dom.transition(m,"all 200ms",w,this),df.dom.translateX(m,0,!1),df.dom.transition(b,"all 200ms"),df.dom.translateX(b,n,!1),df.dom.addClass(b,"WebC_SwipeLeaving")):w.call(this)):r<n?(df.dom.transition(m,"all 200ms",w,this),df.dom.translateX(m,.3*n,!1),df.dom.transition(b,"all 200ms"),df.dom.translateX(b,0,!1)):w.call(this):0!==r&&b&&df.dom.translateX(b,0,!1):c&&_?-r>.4*n?(h=c,-r<n?(df.dom.transition(_,"all 200ms",w,this),df.dom.translateX(_,0,!1),df.dom.transition(b,"all 200ms"),df.dom.translateX(b,-n,!1),df.dom.addClass(b,"WebC_SwipeLeaving")):w.call(this)):-r<n?(df.dom.transition(_,"all 200ms",w,this),df.dom.translateX(_,-.3*n,!1),df.dom.transition(b,"all 200ms"),df.dom.translateX(b,0,!1)):w.call(this):0!==r&&b&&(df.dom.transition(b,"all 100ms",w,this),df.dom.translateX(b,0,!1)),e?(df.dom.off("pointerup",window,S,this),df.dom.off("pointercancel",window,S,this),df.dom.off("pointermove",window,C,this)):(df.dom.off("touchend",window,S,this),df.dom.off("touchcancel",window,S,this),df.dom.off("touchmove",window,C,this))}this.pbSwipeCards&&g&&(c||f)&&(a=l=e?t.e.clientX:t.e.targetTouches[0].pageX,s=i=e?t.e.clientY:t.e.targetTouches[0].pageY,e?(df.dom.on("pointerup",window,S,this),df.dom.on("pointercancel",window,S,this),df.dom.on("pointermove",window,C,this)):(df.dom.on("touchend",window,S,this),df.dom.on("touchcancel",window,S,this),df.dom.on("touchmove",window,C,this)),setTimeout((function(){p=!0}),300))},renderChildren:function(e){var t,i,s;for(this.psCurrentCard&&(this._oCurrent=this.getWebApp().findObj(this.psCurrentCard)),s=0;s<this._aCards.length&&!this._oCurrent;s++)this._aCards[s].isActive()&&(this._oCurrent=this._aCards[s]);if(e=this._eControl=df.dom.query(this._eElem,"div."+this._sCardClass+"_Body"),this.hasDynamicHeight())for(s=0;s<this._aChildren.length;s++)(t=this._aChildren[s])instanceof df.WebBaseUIObject&&(i=t.render())&&e.appendChild(i);else this._oCurrent&&(i=this._oCurrent.render())&&e.appendChild(i)},afterRenderChildren:function(){this.hasDynamicHeight()?df.WebCardContainer.base.afterRenderChildren.apply(this,arguments):this._oCurrent&&this._oCurrent.afterRender()},hasDynamicHeight:function(){return!this.pbFillHeight&&this.piHeight<=0},addChild:function(e){if(e instanceof df.WebCard)this._aCards.push(e);else if(e instanceof df.WebBaseUIObject)throw new df.Error(999,"WebCardContainer objects cannot have controls as direct children '{{0}}'. Consider placing them within a WebCard.",this,[e.getLongName()||"oWebApp"]);df.WebCardContainer.base.addChild.call(this,e)},afterShow:function(){this._bShown=!0,this._oCurrent&&this._oCurrent.afterShow()},afterHide:function(){this._bShown=!1,this._oCurrent&&this._oCurrent.afterHide()},getNaturalHeight:function(){var e,t,i=0;for(e=0;e<this._aCards.length;e++)this._aCards[e].pbRender&&this._aCards[e]._eElem&&(t=this._aCards[e].getRequiredHeight())>i&&(i=t);return i+=this.getHeightDiff()},sizeHeight:function(e){var t=-1;if((t=this.pbFillHeight?e:this.piHeight>0?this.piHeight:this.getNaturalHeight())<this.piMinHeight&&(t=this.piMinHeight),this.setHeight(t),this.resizeCards(),t>0)return t},getVertHeightDiff:function(){var e=0;return this.peLabelPosition===df.ciLabelTop&&this._eLbl&&(e+=this._eLbl.offsetHeight),e+=this.getHeightDiff()},resize:function(){this._eElem&&this._bRendered&&(this.pbFillHeight?this.resizeCards():this.sizeHeight(-1))},resizeCards:function(){for(let e=0;e<this._aCards.length;e++)this._aCards[e]._eElem&&(this._aCards[e].resizeHorizontal(),this._aCards[e].resizeVertical())},getHeightDiff:function(){var e=0;return this.pbShowCaption&&this._eHead&&(e+=df.sys.gui.getVertBoxDiff(this._eHead,1)),this._eControl&&(e+=df.sys.gui.getVertBoxDiff(this._eControl),e+=df.sys.gui.getVertBoxDiff(this._eInner),e+=df.sys.gui.getVertBoxDiff(this._eControlWrp)),e},getMinHeight:function(){var e=0;return this.resize(),this.pbScroll?e=this.pbFillHeight?this.piMinHeight:Math.max(this.piHeight,this.piMinHeight):(e=this.getNaturalHeight())<this.piMinHeight&&(e=this.piMinHeight),e},renderAllCards:function(){var e,t;if(this._eControl)for(e=0;e<this._aCards.length;e++)this._aCards[e]._eElem||(t=this._aCards[e].render(),this._eControl.appendChild(t),this._aCards[e].afterRender())},set_piHeight:function(e){e<=0&&this.renderAllCards(),df.WebCardContainer.base.set_piHeight.call(this,e)},set_pbFillHeight:function(e){e||this.renderAllCards(),df.WebCardContainer.base.set_pbFillHeight.call(this,e)},attachFocusEvents:function(){this._eHead&&(window.addEventListener?(df.events.addDomCaptureListener("focus",this._eHead,this.onFocus,this),df.events.addDomCaptureListener("blur",this._eHead,this.onBlur,this)):(df.dom.on("focusin",this._eHead,this.onFocus,this),df.dom.on("focusout",this._eHead,this.onBlur,this)))},focus:function(e){var t;for(t=0;t<this._aChildren.length;t++)if(this._aChildren[t].focus&&this._aChildren[t].focus(e))return!0;return!1},conditionalFocus:function(e){var t;for(t=0;t<this._aChildren.length;t++)if(this._aChildren[t].conditionalFocus&&this._aChildren[t].conditionalFocus(e))return!0;return!1},onFocus:function(e){this._bHasFocus||df.WebCardContainer.base.onFocus.call(this,e),this._bLozingFocus=!1},onBlur:function(e){var t=this;this._bLozingFocus=!0,setTimeout((function(){t._bLozingFocus&&(df.WebCardContainer.base.onBlur.call(t,e),t._bLozingFocus=!1)}),100)},showCard:function(e,t){var i,s;if((this.isEnabled()||t)&&e&&e.isActive()){if(t||e===this._oCurrent||this.fireCardChange(e._sName,this._oCurrent&&this._oCurrent._sName||""),this._eElem)for(i=0;i<this._aCards.length;i++)(s=this._aCards[i])===e?(s._show(!!t),this._eLabel&&df.dom.setText(this._eLabel,s.psCaption)):s._hide(!!t);!t&&this._oCurrent&&this._oCurrent.afterHide(),this._oCurrent=e,t||this._oCurrent.afterShow(),this.getWebApp()&&this.getWebApp().notifyLayoutChange(this)}},fireCardChange:function(e,t){this.fire("OnCardChange",[e,t])},hideCard:function(e){var t,i,s=null,o=!1;if(e===this._oCurrent){for(t=0;t<this._aCards.length;t++){if((i=this._aCards[t]).isActive()){if(o)return void this.showCard(i);s=i}i===e&&(o=!0)}this.showCard(s)}},nextCard:function(){var e,t,i=!1;for(e=0;e<this._aCards.length;e++)if(t=this._aCards[e],i){if(t.isActive())return void this.showCard(t)}else i=t===this._oCurrent},previousCard:function(){var e,t,i=!1;for(e=this._aCards.length-1;e>=0;e--)if(t=this._aCards[e],i){if(t.isActive())return void this.showCard(t)}else i=t===this._oCurrent},get_psCurrentCard:function(){return this._oCurrent&&this._oCurrent.getLongName()||""},genClass:function(){var e=df.WebCardContainer.base.genClass.call(this);return this.pbShowCaption&&(e+=" WebCC_HasCaption"),this.pbShowBorder&&(e+=" WebCC_HasBorder"),e},set_pbShowBorder:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,"WebCC_HasBorder",e),this.sizeChanged())},set_pbShowCaption:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,"WebCC_HasCaption",e),this.sizeChanged())},set_psBackgroundColor:function(e){this._eLabel&&(this._eLabel.style.background=e||""),this._eControl&&(this._eControl.style.background=e||"")}}),df.WebCard=function(e,t){if(df.WebCard.base.constructor.call(this,e,t),!(t&&t instanceof df.WebCardContainer))throw new df.Error(999,"WebCard object '{{0}}' should be placed inside a WebCardContainer object. Consider wrapping your card with a card container.",this,[this.getLongName()]);this.prop(df.tString,"psCaption",""),this.prop(df.tString,"psBtnCSSClass",""),this.event("OnShow",df.cCallModeDefault),this.event("OnHide",df.cCallModeDefault),this._eBtn=null,this._eLbl=null,this._bCurrent=!1,this._bCC=!0,this._sControlClass="WebCard",this._bWrapDiv=!0},df.defineClass("df.WebCard","df.WebBaseContainer",{tabButtonHtml:function(e){e.push('<div class="WebTab_Btn ',this.isEnabled()?df.CssEnabled:df.CssDisabled," ",this.psBtnCSSClass,'" style="',this.pbRender&&this.pbVisible?"":"display: none;",'" ',this.isEnabled()?'tabindex="0"':'tabindex="-1"',"><span><label>",df.dom.encodeHtml(this.psCaption),"</label></span></div>")},afterRender:function(){df.WebCard.base.afterRender.call(this),this._eElem.style.display=""},btnRendered:function(e){this._eBtn=e,this._eLbl=df.dom.query(this._eBtn,"span > label"),df.dom.on("click",this._eBtn,this.onBtnClick,this),df.dom.on("click",this._eLbl,this.onBtnClick,this),df.events.addDomKeyListener(this._eBtn,this.onBtnKey,this)},attachFocusEvents:function(){window.addEventListener?(df.events.addDomCaptureListener("focus",this._eBtn,this.onBtnFocus,this),df.events.addDomCaptureListener("blur",this._eBtn,this.onBtnBlur,this)):(df.dom.on("focusin",this._eBtn,this.onBtnFocus,this),df.dom.on("focusout",this._eBtn,this.onBtnBlur,this))},prepareSize:function(){var e=df.WebCard.base.prepareSize.call(this);return this._bStretch=!0,e},onBtnClick:function(e){this.isEnabled()&&(this.show(),e.stop())},onBtnKey:function(e){this.isEnabled()&&e.matchKey(df.settings.tabKeys.enter)&&(this.show(),e.stop())},onBtnFocus:function(e){df.dom.addClass(this._eBtn,"WebTab_Focus")},onBtnBlur:function(e){df.dom.removeClass(this._eBtn,"WebTab_Focus")},_hide:function(e){this._eElem&&(this._eElem.style.visibility="hidden",df.dom.removeClass(this._eBtn,"WebTab_Current")),!e&&this._bCurrent&&this.fire("OnHide"),this._bCurrent=!1},_show:function(e){this._eElem?this._eElem.parentNode.firstChild&&this._eElem!==this._eElem.parentNode.firstChild&&this._eElem.parentNode.insertBefore(this._eElem,this._eElem.parentNode.firstChild):this.renderCard(!0),this._eElem.style.visibility="inherit",df.dom.addClass(this._eBtn,"WebTab_Current"),e||this._bCurrent||this.fire("OnShow"),this._bCurrent=!0},renderCard:function(e){var t=this.render();e&&this._oParent._eControl.firstChild?this._oParent._eControl.insertBefore(t,this._oParent._eControl.firstChild):this._oParent._eControl.appendChild(t),this.afterRender(),this.resizeHorizontal(),this.resizeVertical()},show:function(){this.isActive()&&this._oParent.showCard(this)},applyEnabled:function(e){df.WebCard.base.applyEnabled.call(this,e),this._eBtn&&(df.dom.toggleClass(this._eBtn,df.CssDisabled,!e),df.dom.toggleClass(this._eBtn,df.CssEnabled,e),df.dom.setTabIndex(this._eLbl,e?0:-1))},set_psCaption:function(e){this._eLbl&&(this._oParent._oCurrent===this&&this._oParent._eLabel&&df.dom.setText(this._oParent._eLabel,e),df.dom.setText(this._eLbl,e))},set_pbVisible:function(e){this._eBtn&&(this._eBtn.style.display=e&&this.pbRender?"":"none",this.pbVisible=e,this.getWebApp().waitForCall((function(){e?this._oParent._oCurrent||this._oParent.showCard(this):this._bCurrent&&this._oParent.hideCard(this),this.getWebApp().forceResize()}),this))},set_pbRender:function(e){this._eBtn&&(this._eBtn.style.display=e&&this.pbVisible?"":"none",this.pbRender!==e&&(this.pbRender=e,this.getWebApp().waitForCall((function(){e?this._oParent._oCurrent||this._oParent.showCard(this):this._bCurrent&&this._oParent.hideCard(this),this.getWebApp().forceResize()}),this)))},set_psTextColor:function(e){this._eLbl&&(this._eLbl.style.color=e||""),df.WebCard.base.set_psTextColor.call(this,e)},set_psBackgroundColor:function(e){this._eBtn&&(this._eBtn.style.background=e||""),df.WebCard.base.set_psBackgroundColor.call(this,e)},set_psBtnCSSClass:function(e){this._eBtn&&this.psBtnCSSClass!==e&&(df.dom.removeClass(this._eBtn,this.psBtnCSSClass),df.dom.addClass(this._eBtn,e))}}),df.WebTabContainer=function(e,t){df.WebTabContainer.base.constructor.call(this,e,t),this._sControlClass="WebTabContainer",this._sCardClass="WebTbc",this._bCC=!1},df.defineClass("df.WebTabContainer","df.WebCardContainer",{openHtml:function(e){this.pbShowCaption=!1,this.pbShowBorder=!1,df.WebTabContainer.base.openHtml.call(this,e)},addChild:function(e){if(e instanceof df.WebBaseUIObject&&!(e instanceof df.WebCard))throw new df.Error(999,"WebTabContainer objects cannot have controls as direct children '{{0}}'. Consider placing them within a WebTabPage.",this,[e.getLongName()||"oWebApp"]);df.WebTabContainer.base.addChild.call(this,e)},set_pbShowCaption:function(e){},set_pbShowBorder:function(e){},getHeightDiff:function(){var e=0;return this._eHead&&(e+=df.dom.clientHeight(this._eHead),e+=df.sys.gui.getVertBoxDiff(this._eHead,1)),this.pbShowCaption&&this._eLabelSpacer&&(e+=df.dom.clientHeight(this._eLabelSpacer),e+=df.sys.gui.getVertBoxDiff(this._eHead,1)),this._eControl&&(e+=df.sys.gui.getVertBoxDiff(this._eControl),e+=df.sys.gui.getVertBoxDiff(this._eInner),e+=df.sys.gui.getVertBoxDiff(this._eControlWrp)),e},focus:function(){var e,t;if(this._bFocusAble&&this.isEnabled()&&this._eElem)for(e=0;e<this._aCards.length;e++)if((t=this._aCards[e]).isActive()&&t._eBtn){try{t._eBtn.focus()}catch(e){}return this.objFocus(),!0}return!1}}),df.WebTabPage=function(e,t){if(!(t&&t instanceof df.WebTabContainer))throw this._sName=e,this._oParent=t,new df.Error(999,"WebTabPage object '{{0}}' should be placed inside a WebTabContainer object. Consider wrapping your tab page with a tab container.",this,[this.getLongName()]);df.WebTabPage.base.constructor.call(this,e,t),this._sControlClass="WebTabPage",this._bCC=!0},df.defineClass("df.WebTabPage","df.WebCard",{}),df.WebDatePicker=function(e,t){df.WebDatePicker.base.constructor.call(this,e,t),this.prop(df.tBool,"pbShowWeekNr",!0),this.prop(df.tBool,"pbShowToday",!0),this.prop(df.tInt,"piStartWeekAt",1),this.event("OnDateClick",df.cCallModeWait),this.OnRealtimeChange=new df.events.JSHandler,this.OnEnter=new df.events.JSHandler,this._eBuddy=null,this._bBuddyActive=!0,this._eElem=null,this._eFocus=null,this._eBody=null,this._eDispMonth=null,this._eDispYear=null,this._dSelected=new Date,this._iWeekSelected=df.sys.data.dateToWeek(this._dSelected),this._iDisplayYear=this._dSelected.getFullYear(),this._iDisplayMonth=this._dSelected.getMonth(),this._iLastDisplayYear=this._iDisplayYear,this._iLastDisplayMonth=this._iDisplayMonth,this._aMonthNames=df.lang.monthsLong,this._aMonthNamesShort=df.lang.monthsShort,this._aDaysShort=df.lang.daysShort,this._aDaysLong=df.lang.daysLong,this._sControlClass="WebDatePicker",this.peDataType=df.ciTypeDate},df.defineClass("df.WebDatePicker","df.WebBaseDEO",{create:function(){var e=this.getWebApp();this.psMask||e&&(this.psMask=e.psDateFormat)},openHtml:function(e){df.WebDatePicker.base.openHtml.call(this,e),e.push('<div class="WebDatePicker_FocusHolder" ',this.isEnabled()?'tabindex="0"':'tabindex="-1"',">"),e.push('<div class="WebDP">','<div class="WebDP_Wrp">','<div class="WebDP_Head">','<div class="WebDP_BtnPrev"><span></span></div>','<div class="WebDP_BtnNext"><span></span></div>','<div class="WebDP_BtnYear"><span></span><div class="WebDP_YearMnu"></div></div>','<div class="WebDP_BtnMonth"><span></span><div class="WebDP_MonthMnu"></div></div>','<div style="clear: both;"></div>',"</div>",'<div class="WebDP_Body">')},closeHtml:function(e){e.push("</div>"),e.push('<div class="WebDP_Footer"',this.pbShowToday?"":' style="display: none"',">",'<div class="WebDP_BtnToday">',this.getWebApp().getTrans("todayIs")," <span></span></div>","</div>"),e.push("</div>","</div>"),df.WebDatePicker.base.closeHtml.call(this,e),e.push("</div>")},afterRender:function(){this._eFocus=df.dom.query(this._eElem,"div.WebDatePicker_FocusHolder"),this._eBody=df.dom.query(this._eElem,"div.WebDP_Body"),this._eFooter=df.dom.query(this._eElem,"div.WebDP_Footer"),this._eDispMonth=df.dom.query(this._eElem,"div.WebDP_BtnMonth > span"),this._eDispYear=df.dom.query(this._eElem,"div.WebDP_BtnYear > span"),this._eDispToday=df.dom.query(this._eElem,"div.WebDP_BtnToday > span"),df.WebDatePicker.base.afterRender.call(this),df.dom.on("click",this._eElem,this.onWrapClick,this),df.dom.on("click",this._eBody,this.onBodyClick,this),df.dom.on("click",df.dom.query(this._eElem,"div.WebDP_BtnNext"),this.onNextClick,this),df.dom.on("click",df.dom.query(this._eElem,"div.WebDP_BtnPrev"),this.onPrevClick,this),df.dom.on("click",df.dom.query(this._eElem,"div.WebDP_BtnMonth"),this.onMonthClick,this),df.dom.on("click",df.dom.query(this._eElem,"div.WebDP_BtnYear"),this.onYearClick,this),df.dom.on("click",df.dom.query(this._eElem,"div.WebDP_BtnToday"),this.onTodayClick,this),this._eBuddy&&(this._eFocus=this._eBuddy),df.events.addDomKeyListener(this._eFocus,this.onKey,this),df.dom.on("focus",this._eFocus,this.onFocus,this),df.dom.on("blur",this._eFocus,this.onBlur,this),this.update()},set_pbShowWeekNr:function(e){this.pbShowWeekNr=e,this.displayCalendar()},set_pbShowToday:function(e){this._eFooter&&(this._eFooter.style.display=e?"":"none")},set_piStartWeekAt:function(e){this.piStartWeekAt=e,this.update()},update:function(){this._eElem&&(df.dom.setText(this._eDispMonth,this._aMonthNames[this._iDisplayMonth]),df.dom.setText(this._eDispYear,this._iDisplayYear),df.dom.setText(this._eDispToday,df.sys.data.applyDateMask(new Date,this.psMask,this.getWebApp().psDateSeparator)),this.displayCalendar())},displayCalendar:function(){var e,t,i,s,o,n,r,a,l,h,d,p=[];if(this._eBody){for(p.push("<div><table>"),a=this._iDisplayYear,l=this._iDisplayMonth,s=new Date,n=new Date(a,l,1,1,1,1),o=new Date(a,l+1,1,1,1,1),p.push('<tr class="WebDP_BodyHead">'),this.pbShowWeekNr&&p.push('<th class="WebDP_WeekNr">',this.getWebApp().getTrans("wk"),"</th>"),e=0;e<7;e++)i="",0!==(t=e+this.piStartWeekAt>6?e+this.piStartWeekAt-7:e+this.piStartWeekAt)&&6!==t||(i="WebDP_Weekend"),p.push('<th class="',i,'">',this.getDay(e,!0),"</th>");for(p.push("</tr>"),(t=n.getDay()-this.piStartWeekAt)<0&&(t=7+t),n.setDate(n.getDate()-t),t=0,r=0,p.push("<tr>");n<o||t<7&&0!==t||r<6;)(0===t||t>6)&&(r>0&&p.push("</tr><tr>"),r++,this.pbShowWeekNr&&p.push('<td class="WebDP_WeekNr">',df.sys.data.dateToWeek(n),"</td>"),t=0),i="WebDP_Day",n.getMonth()!==l&&(i+=(""!==i?" ":"")+"WebDP_Overflow"),0!==n.getDay()&&6!==n.getDay()||(i+=(""!==i?" ":"")+"WebDP_Weekend"),n.getDate()===this._dSelected.getDate()&&n.getMonth()===this._dSelected.getMonth()&&n.getFullYear()===this._dSelected.getFullYear()&&(i+=(""!==i?" ":"")+"WebDP_Selected"+(this.bHasFocus?" focussed":"")),n.getDate()===s.getDate()&&n.getMonth()===s.getMonth()&&n.getFullYear()===s.getFullYear()&&(i+=(""!==i?" ":"")+"WebDP_Today"),p.push('<td class="',i,'" data-date="',n.getDate(),'" data-month="',n.getMonth(),'" data-year="',n.getFullYear(),'">',n.getDate(),"</td>"),n.setDate(n.getDate()+1),t++;p.push("</table></div>"),this._iLastDisplayYear===this._iDisplayYear&&this._iLastDisplayMonth===this._iDisplayMonth?this._eBody.innerHTML=p.join(""):((d=df.dom.query(this._eBody,".WebDP_Old"))&&this._eBody.removeChild(d),h=df.dom.create(p.join("")),(d=this._eBody.firstChild)&&(d.firstChild.style.width=d.firstChild.clientWidth+"px",d.firstChild.style.height=d.firstChild.clientHeight+"px",df.dom.addClass(d,"WebDP_Old")),this._eBody.appendChild(h),d&&df.dom.addClass(d,this._iLastDisplayYear<this._iDisplayYear||this._iLastDisplayYear===this._iDisplayYear&&this._iLastDisplayMonth<this._iDisplayMonth?"WebDP_HideNext":"WebDP_HidePrev")),this._iLastDisplayYear=this._iDisplayYear,this._iLastDisplayMonth=this._iDisplayMonth}},setSelectedDate:function(e,t,i){e||(e=new Date,this.fireRTChange()),this._dSelected=e,this._iWeekSelected=df.sys.data.dateToWeek(this._dSelected),i||(this._iDisplayYear=this._dSelected.getFullYear(),this._iDisplayMonth=this._dSelected.getMonth(),t&&(this._iLastDisplayYear=this._iDisplayYear,this._iLastDisplayMonth=this._iDisplayMonth)),this.update()},getSelectedDate:function(){return new Date(this._dSelected.valueOf())},getDay:function(e,t){return(e+=this.piStartWeekAt)>6&&(e-=7),t?this._aDaysShort[e]:this._aDaysLong[e]},onMonthClick:function(e){var t,i,s,o,n,r=[],a=this;function l(e){var t=e.getTarget();t.getAttribute("data-month")&&(this._iDisplayMonth=parseInt(t.getAttribute("data-month"),10),n(),this.update(),this.focus(),e.stop())}function h(e){clearTimeout(i)}function d(e){clearTimeout(i),i=setTimeout(n,1200)}if(t=df.dom.query(this._eElem,"div.WebDP_MonthMnu"),n=function(){df.dom.off("click",t,l,this),df.dom.off("mouseover",t,h,this),df.dom.off("mouseout",t,d,this),t.style.display="none",clearTimeout(i),a._fMonthHide=null},this._fMonthHide)this._fMonthHide();else if(this.isEnabled()){for(this._fMonthHide=n,df.dom.on("click",t,l,this),df.dom.on("mouseover",t,h,this),df.dom.on("mouseout",t,d,this),r.push("<ul>"),s=0;s<12;s++)o=s===this._iDisplayMonth?"WebDP_Current":"",r.push('<li data-month="',s,'" class="',o,'">',this._aMonthNames[s],"</li>");r.push("</ul"),t.innerHTML=r.join(""),t.style.display="inline",i=setTimeout(n,2400),this.focus(),e.stop()}},onYearClick:function(e){var t,i,s,o,n,r,a,l,h=[],d=this;function p(e){var t=e.getTarget();t.getAttribute("data-year")&&(this._iDisplayYear=parseInt(t.getAttribute("data-year"),10),l(),this.update(),this.focus()),e.stop()}function u(e){clearTimeout(o)}function f(e){o=setTimeout(l,1200)}function c(){var e,t;e=i.nextSibling.getAttribute("data-year"),e--,s.parentNode.removeChild(s.previousSibling),t=document.createElement("li"),df.dom.setText(t,e),t.setAttribute("data-year",e),i.parentNode.insertBefore(t,i.nextSibling)}function g(){var e,t;e=s.previousSibling.getAttribute("data-year"),e++,i.parentNode.removeChild(i.nextSibling),t=document.createElement("li"),df.dom.setText(t,e),t.setAttribute("data-year",e),s.parentNode.insertBefore(t,s)}function b(e){var t,s;s=e.getTarget(),(t=s===i?c:g)(),n=setTimeout((function e(){t(),n=setTimeout(e,35)}),300),df.dom.addClass(s,s===i?"WebDP_UpDown":"WebDP_DownDown"),e.stop()}function _(e){clearTimeout(n),df.dom.removeClass(i,"WebDP_UpDown"),df.dom.removeClass(s,"WebDP_DownDown"),e.stop()}if(t=df.dom.query(this._eElem,"div.WebDP_YearMnu"),l=function(){t.style.display="none",df.dom.off("click",t,p,this),df.dom.off("mouseover",t,u,this),df.dom.off("mouseout",t,f,this),df.dom.off("mousedown",i,b,this),df.dom.off("mouseout",i,_,this),df.dom.off("mouseup",i,_,this),df.dom.off("mousedown",s,b,this),df.dom.off("mouseout",s,_,this),df.dom.off("mouseup",s,_,this),clearTimeout(o),d._fYearHide=null},this._fYearHide)this._fYearHide();else if(this.isEnabled()){for(this._fYearHide=l,h.push("<ul>"),h.push('<li class="WebDP_Up"></li>'),r=this._iDisplayYear-4;r<this._iDisplayYear+4;r++)a=r===this._iDisplayYear?"WebDP_Current":"",h.push('<li data-year="',r,'" class="',a,'">',r,"</li>");h.push('<li class="WebDP_Down"></li>'),h.push("</ul"),t.innerHTML=h.join(""),t.style.display="inline",i=df.dom.query(t,"li.WebDP_Up"),s=df.dom.query(t,"li.WebDP_Down"),df.dom.on("click",t,p,this),df.dom.on("mouseover",t,u,this),df.dom.on("mouseout",t,f,this),df.dom.on("mousedown",i,b,this),df.dom.on("mouseout",i,_,this),df.dom.on("mouseup",i,_,this),df.dom.on("mousedown",s,b,this),df.dom.on("mouseout",s,_,this),df.dom.on("mouseup",s,_,this),o=setTimeout(l,2400),this.focus(),e.stop()}},onNextClick:function(e){this.isEnabled()&&(this._iDisplayMonth++,this._iDisplayMonth>=12&&(this._iDisplayYear++,this._iDisplayMonth=0),this.update(),this.focus(),e.stop())},onPrevClick:function(e){this.isEnabled()&&(this._iDisplayMonth--,this._iDisplayMonth<0&&(this._iDisplayYear--,this._iDisplayMonth=11),this.update(),this.focus(),e.stop())},onBodyClick:function(e){var t,i=e.getTarget();this.isEnabled()&&i.getAttribute("data-date")&&(t=new Date(parseInt(i.getAttribute("data-year"),10),parseInt(i.getAttribute("data-month"),10),parseInt(i.getAttribute("data-date"),10),1,1,1),this.focus(),this.setSelectedDate(t,!1,!1),this.fireRTChange(),this.fireEnter(),this.fireDateClick(),e.stop())},onWrapClick:function(e){this.isEnabled()&&(this.focus(),e.stop())},onTodayClick:function(e){this.isEnabled()&&(this._dSelected=new Date,this._iDisplayYear=this._dSelected.getFullYear(),this._iDisplayMonth=this._dSelected.getMonth(),this.focus(),this.update(),this.fireRTChange(),this.fireEnter(),this.fireDateClick())},onKey:function(e){var t=new Date(this._dSelected.getTime());this._bBuddyActive&&this.isEnabled()&&(e.matchKey(df.settings.calendarKeys.dayUp)?(t.setDate(t.getDate()-7),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.dayDown)?(t.setDate(t.getDate()+7),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.dayLeft)?(t.setDate(t.getDate()-1),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.dayRight)?(t.setDate(t.getDate()+1),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.monthUp)?(t.setMonth(t.getMonth()+1),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.monthDown)?(t.setMonth(t.getMonth()-1),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.yearUp)?(t.setFullYear(t.getFullYear()+1),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.yearDown)?(t.setFullYear(t.getFullYear()-1),this.setSelectedDate(t),this.fireRTChange(),e.stop()):e.matchKey(df.settings.calendarKeys.enter)&&(this.fireDateClick(),this.fireEnter()||e.stop()))},fireRTChange:function(){this.OnRealtimeChange.fire(this,{dValue:this.getSelectedDate()})},fireEnter:function(){return this.OnEnter.fire(this,{dValue:this.getSelectedDate()})},fireDateClick:function(){this.fire("OnDateClick",[this.get("psValue")])},refreshDisplay:function(e){this.peDataType!==df.ciTypeDate&&this.peDataType!==df.ciTypeDateTime||this.setSelectedDate(e,!0,!1)},updateTypeVal:function(){this.peDataType!==df.ciTypeDate&&this.peDataType!==df.ciTypeDateTime||(this._tValue=this.getSelectedDate())},applyEnabled:function(e){df.WebDatePicker.base.applyEnabled.call(this,e),this._eFocus&&df.dom.setTabIndex(this._eFocus,e?0:-1)},focus:function(){return!!(this._bFocusAble&&this.isEnabled()&&this._eFocus)&&(this._eFocus.focus(),this._bLozingFocus=!1,this.objFocus(),!0)},onFocus:function(e){this._bBuddyActive&&this._bFocusAble&&this.isEnabled()&&this._eFocus&&(this.objFocus(),this._eElem&&df.dom.addClass(this._eElem,"WebCon_Focus"),this._bHasFocus=!0,this._bLozingFocus=!1)},onBlur:function(e){var t=this;this._bBuddyActive&&(this._bLozingFocus=!0,this.fireChange(),setTimeout((function(){t._bLozingFocus&&(t.updateTypeVal(),t.fireAutoFind(),t._eElem&&df.dom.removeClass(t._eElem,"WebCon_Focus"),t._bLozingFocus=!1)}),100))}}),df.tWebTreeItem={sId:df.tString,sParentId:df.tString,sName:df.tString,sAltText:df.tString,sValue:df.tString,sCSSClass:df.tString,sIcon:df.tString,bFolder:df.tBool,bLoadChildren:df.tBool,bExpanded:df.tBool},df.WebTreeView=function(e,t){df.WebTreeView.base.constructor.call(this,e,t),this.prop(df.tBool,"pbShowIcons",!0),this.prop(df.tBool,"pbAllowHtml",!1),this.prop(df.tString,"psSelectedId",""),this.prop(df.tString,"psSelectedValue",""),this.event("OnSelect",df.cCallModeWait),this.event("OnExpand",df.cCallModeDefault),this.event("OnCollapse",df.cCallModeDefault),this._aRootItems=[],this._aItems=[],this._iAutoNum=1e3,this._tSelectedNode=null,this._bRedraw=!1,this._eRootTable=null,this._eCurHoveredElem=null,this._fHoverTimeOut=null,this._sControlClass="WebTreeView"},df.defineClass("df.WebTreeView","df.WebBaseControl",{openHtml:function(e){df.WebTreeView.base.openHtml.call(this,e),e.push('<div class="WebTree_Body" style="height: 10px;" ',this.isEnabled()?'tabindex="0"':'tabindex="-1"',">")},closeHtml:function(e){e.push("</div>"),df.WebTreeView.base.closeHtml.call(this,e)},afterRender:function(){var e=this;this._eControl=df.dom.query(this._eElem,"div.WebTree_Body"),this._eFocus=this._eControl,df.WebTreeView.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onBodyClick,this),df.dom.on("dblclick",this._eControl,this.onBodyDblClick,this),df.events.addDomKeyListener(this._eElem,this.onKey,this),this.redraw(),setTimeout((function(){e._tSelectedNode&&e.scrollToElement(e._tSelectedNode._eElem)}),50),setTimeout((function(){e.dragDropCleanup(),e.dragDropInit()}),50)},applyEnabled:function(e){df.WebTreeView.base.applyEnabled.call(this,e),this._eFocus&&(this._eFocus.tabIndex=e?0:-1)},get_psSelectedId:function(){return this._tSelectedNode?this._tSelectedNode.sId:""},get_psSelectedValue:function(){return this._tSelectedNode?this._tSelectedNode.sValue:""},set_pbShowIcons:function(e){this.pbShowIcons=e,this.redraw()},select:function(e){var t=this.getNodeById(e);t&&this.doSelect(t,!1)},expand:function(e){var t=this.getNodeById(e);t&&t.bFolder&&this.expandNode(t)},collapse:function(e){var t=this.getNodeById(e);t&&this.collapseNode(t)},collapseAll:function(){var e;for(e=0;e<this._aItems.length;e++)this._aItems[e].bExpanded&&this.collapseNode(this._aItems[e])},refresh:function(e){var t,i,s,o=this.deserializeVT(this._tActionData);if(!(s=this._tSelectedNode&&(this._tSelectedNode.sId||""))&&this.psSelectedId&&(s=this.psSelectedId,this.psSelectedId=""),e){if(i=this.getNodeById(e))for(;i._aChildren.length>0;)this.doRemove(i._aChildren[0],!0)}else this.clear(),this.displayLoading();for(t=0;t<o.length;t++)(i=this.initNode(o[t])).sParentId||(i.sParentId=e||""),this.insert(i);s?(i=this.getNodeById(s))&&(this._tSelectedNode=i):this._tSelectedNode=null,this.redraw(),this.hideLoading()},updateNode:function(){var e,t,i=this.deserializeVT(this._tActionData);i.length>0&&(e=this.initNode(i[0]),(t=this.getNodeById(e.sId))&&(t.sName=e.sName,t.sAltText=e.sAltText,t.sValue=e.sValue,t.sCSSClass=e.sCSSClass,t.sIcon=e.sIcon,t.bFolder=e.bFolder,t.bLoadChildren=e.bLoadChildren,this.redraw()))},insertNode:function(){var e,t=this.deserializeVT(this._tActionData);t.length>0&&(e=this.initNode(t[0]),this.insert(e),this.redraw())},removeNode:function(e){var t=this.getNodeById(e);t&&(this.doRemove(t),this.redraw())},deserializeVT:df.sys.vt.generateDeserializer([df.tWebTreeItem]),loadSubNodes:function(e){var t="",i="",s=0;e?(e._bIsLoading=!0,this.displayLoading(e),t=e.sId,i=e.sValue,s=this.getLevel(e)):(this.clear(),this.displayLoading()),this.serverAction("LoadSubNodes",[t,i,s],null,(function(t){e&&(e._bIsLoading=!1,this.updateNodeCSS(e)),t.bError||(e?(e._bIsLoaded=!0,this.expandNode(e)):this.redraw()),this.hideLoading(e)}),this)},addSubItems:function(e){var t,i,s=this.deserializeVT(this._tActionData);for(t=0;t<s.length;t++)(i=this.initNode(s[t])).sParentId||(i.sParentId=e||""),this.insert(i)},initNode:function(e){return e._aChildren=[],e._tParent=null,e._eElem=null,e._eSubMenuRow=null,e._eSubMenuTable=null,e._bIsLoading=!1,e._bIsLoaded=e.bExpanded,e.sId||(this._iAutoNum++,e.sId=this._iAutoNum.toString()),e},insert:function(e){var t;if(this.getNodeById(e.sId))throw new df.Error(5151,"Node IDs must be unique (ID: '{{0}}')",this,[e.sId]);e.sParentId&&(t=this.getNodeById(e.sParentId)),t?(e._tParent=t,t._aChildren.push(e)):this._aRootItems.push(e),this._aItems.push(e)},clear:function(){var e;if(this._eRootTable)for(this._eControl.removeChild(this._eRootTable),e=0;e<this._aItems.length;e++)this._aItems[e]._eElem&&(this._aItems[e]._eElem.tNode=null),this._aItems[e]._eElem=null,this._aItems[e]._eSubMenuRow=null,this._aItems[e]._eSubMenuTable=null;this._tSelectedNode=null,this._aItems=[],this._aRootItems=[],this._eControl&&(this._eRootTable=this.constructTable(),this._eControl.appendChild(this._eRootTable))},redraw:function(){var e;if(this._eControl){if(this._bRedraw=!0,this._eRootTable)for(this._eControl.removeChild(this._eRootTable),e=0;e<this._aItems.length;e++)this._aItems[e]._eElem=null,this._aItems[e]._eSubMenuRow=null,this._aItems[e]._eSubMenuTable=null;this._eRootTable=this.constructTable(),this.constructMenu(this._aRootItems,this._eRootTable),this._eControl.appendChild(this._eRootTable),this._bRedraw=!1}},constructTable:function(){return document.createElement("table")},constructNode:function(e,t,i,s,o){var n,r,a,l;return n=e._aChildren.length>0||e.bLoadChildren,(r=t.insertRow(i)).setAttribute("data-dftree-id",e.sId),this.pbDragDropEnabled&&(e.bFolder?this.isSupportedDragAction(df.dragActions.WebTreeView.ciDragFolder)&&r.setAttribute("draggable",!0):this.isSupportedDragAction(df.dragActions.WebTreeView.ciDragItem)&&r.setAttribute("draggable",!0)),e._eElem=r,(a=r.insertCell(0)).innerHTML="<div>&nbsp;</div>",a=r.insertCell(r.cells.length),l=this.pbAllowHtml?e.sName:df.dom.encodeHtml(e.sName),a.innerHTML='<span class="WebTree_Text" title="'+df.dom.encodeAttr(e.sAltText)+'">'+l+"</span>",this.updateNodeCSS(e),n&&e.bExpanded&&(i++,this.constructSubmenu(e,t,i,o)),i},constructMenu:function(e,t){var i,s=0;for(i=0;i<e.length;i++)s=this.constructNode(e[i],t,s,0===i&&t===this.eRootTable,i===e.length-1),s++},constructSubmenu:function(e,t,i,s){var o,n,r;(o=t.insertRow(i)).className="WebTree_SubRow"+(this._bRedraw?"":" WebTree_HiddenSubRow"),(n=o.insertCell(0)).className=s?"WebTree_ConLast":"WebTree_Con",(n=o.insertCell(1)).innerHTML="<table></table>",r=df.dom.query(n,"table"),e._eSubMenuRow=o,e._eSubMenuTable=r,this.constructMenu(e._aChildren,r,!1),this._bRedraw||setTimeout((function(){e._eSubMenuRow&&df.dom.removeClass(e._eSubMenuRow,"WebTree_HiddenSubRow")}),20)},updateNodeCSS:function(e){var t,i,s,o,n;e._eElem&&(e._eElem.className=(e.bExpanded?"WebTree_Expanded":"WebTree_Collapsed")+(e===this._tSelectedNode?" WebTree_Selected":"")+" "+e.sCSSClass,t=this.isFirst(e),i=this.isLast(e),s=this.isRoot(e),o=this.hasChildren(e),e._eElem.cells[0].className="WebTree_Item WebTree_"+(t&&s||i?(t&&s?"Start":"")+(i?"End":""):"Entry")+(o?"Sub":""),this.pbShowIcons&&(n=e._eElem.cells[1],e.sIcon&&!e._bIsLoading?(n.style.backgroundImage="url('"+e.sIcon+"')",n.style.backgroundRepeat="no-repeat",n.className=(e.bFolder?"WebTree_Folder ":"WebTree_Icon ")+"WebTree_HasIcon"):(n.className=(e._bIsLoading?"WebTree_IconLoading ":"WebTree_NoIcon ")+(e.bFolder?"WebTree_Folder ":"WebTree_Icon "),n.style.backgroundImage="")))},toggle:function(e){e.bExpanded?this.collapseNode(e):this.expandNode(e)},expandNode:function(e){e.bExpanded=!0,e._bIsLoading||(this.fire("OnExpand",[e.sId,e.sValue,this.getLevel(e)]),!e._bIsLoaded&&e.bLoadChildren?this.loadSubNodes(e):(e._eElem&&(e._eSubMenuRow?df.dom.removeClass(e._eSubMenuRow,"WebTree_HiddenSubRow"):this.constructSubmenu(e,e._tParent?e._tParent._eSubMenuTable:this._eRootTable,e._eElem.rowIndex+1,this.isLast(e))),this.updateNodeCSS(e)))},collapseNode:function(e){if(e.bExpanded=!1,this.fire("OnCollapse",[e.sId,e.sValue,this.getLevel(e)]),e._eSubMenuRow&&df.dom.addClass(e._eSubMenuRow,"WebTree_HiddenSubRow"),this.isParent(this._tSelectedNode,e))for(;e&&!this.doSelect(e);)e=e._tParent;this.updateNodeCSS(e)},moveUp:function(){var e,t;if(this._tSelectedNode)if(t=this._tSelectedNode,(e=this.getPosition(t))>0){for(t=(t._tParent?t._tParent._aChildren:this._aRootItems)[e-1];t.bExpanded&&t._aChildren.length>0;)t=t._aChildren[t._aChildren.length-1];this.doSelect(t)}else t._tParent&&this.doSelect(t._tParent)},moveDown:function(){var e,t,i;if(this._tSelectedNode)if((e=this._tSelectedNode).bExpanded&&e._aChildren.length>0)this.doSelect(e._aChildren[0]);else for(;e;){if(t=e._tParent?e._tParent._aChildren:this._aRootItems,(i=this.getPosition(e))<t.length-1){this.doSelect(t[i+1]);break}e=e._tParent}else this._aRootItems.length>0&&this.doSelect(this._aRootItems[0])},doCollapse:function(){var e;this._tSelectedNode&&((e=this._tSelectedNode).bExpanded&&this.hasChildren(e)?this.collapseNode(e):e._tParent&&this.doSelect(e._tParent))},doExpand:function(){var e;this._tSelectedNode?!(e=this._tSelectedNode).bExpanded&&this.hasChildren(e)?this.expandNode(e):e._aChildren.length>0&&this.doSelect(e._aChildren[0]):this._aRootItems.length>0&&this.doSelect(this._aRootItems[0])},moveFirst:function(){this._aRootItems.length>0&&this.doSelect(this._aRootItems[0])},moveLast:function(){var e;if(this._aRootItems.length>0){for(e=this._aRootItems[this._aRootItems.length-1];e.bExpanded&&e._aChildren.length>0;)e=e._aChildren[e._aChildren.length-1];this.doSelect(e)}},doSelect:function(e,t){var i,s;return this.addSync("psSelectedId"),this.addSync("psSelectedValue"),i=this._tSelectedNode,this._tSelectedNode=e,s=this.psSelectedId!==e.sId,this.psSelectedId=e.sId,i&&this.updateNodeCSS(i),this.updateNodeCSS(e),e._eElem&&this.scrollToElement(e._eElem),!t&&s&&this.fire("OnSelect",[e.sId,e.sValue,this.getLevel(e)]),!0},doRemove:function(e,t){var i,s,o=!1;if(function e(t){for(;t._aChildren.length>0;)e.call(this,t._aChildren.pop());t._eElem=null,t._eSubMenuRow=null,t._eSubMenuTable=null,t===this._tSelectedNode&&(this._tSelectedNode=null,o=!0),df.sys.data.removeFromArray(this._aItems,t)}.call(this,e),s=e._tParent?e._tParent._aChildren:this._aRootItems)for(i=0;i<s.length;i++)if(s[i]===e){s.splice(i,1);break}o&&!t&&(s&&s.length>0?this.doSelect(s[i]||s[i-1]):this.doSelect(e._tParent||this._aItems[0]))},getPosition:function(e){var t,i;for(t=e._tParent?e._tParent._aChildren:this._aRootItems,i=0;i<t.length;i++)if(t[i]===e)return i;return-1},isLast:function(e){var t=e._tParent?e._tParent._aChildren:this._aRootItems;return t[t.length-1]===e},isFirst:function(e){return(e._tParent?e._tParent._aChildren:this._aRootItems)[0]===e},isRoot:function(e){return!e._tParent},isParent:function(e,t){for(;e;){if(e===t)return!0;e=e._tParent}return!1},getLevel:function(e){for(var t=1;e._tParent;)t++,e=e._tParent;return t},getNodeById:function(e){var t;for(t=0;t<this._aItems.length;t++)if(this._aItems[t].sId===e)return this._aItems[t];return null},hasChildren:function(e){return e.bLoadChildren&&!e._bIsLoaded||e._aChildren.length>0},scrollToElement:function(e){var t,i,s;i=df.sys.gui.getAbsoluteOffset(e),s=df.sys.gui.getAbsoluteOffset(this._eControl),(t=i.top-s.top)<this._eControl.scrollTop?this._eControl.scrollTop=t:t+e.offsetHeight>this._eControl.scrollTop+this._eControl.clientHeight&&(this._eControl.scrollTop=t+e.offsetHeight-this._eControl.clientHeight)},onBodyClick:function(e){var t,i=null,s=!0,o=e.getTarget();if(this.isEnabled()){for(;o&&!i&&o!==this._eElem;)o.className.indexOf("WebTree_Item")>=0&&(s=!1),i=o.getAttribute("data-dftree-id"),o=o.parentNode;(t=this.getNodeById(i))&&(s&&this._tSelectedNode!==t?(!t.bExpanded&&this.hasChildren(t)&&this.expandNode(t),this.doSelect(t)):this.toggle(t),e.stop()),this.focus()}},onBodyDblClick:function(e){var t=null,i=e.getTarget();if(this.isEnabled()){for(;i&&!t&&i!==this._eElem;)t=i.getAttribute("data-dftree-id"),i=i.parentNode;this.getNodeById(t)&&this.fireSubmit()&&e.stop()}},onKey:function(e){this.isEnabled()&&(e.matchKey(df.settings.treeKeys.moveUp)?(this.moveUp(),e.stop()):e.matchKey(df.settings.treeKeys.moveDown)?(this.moveDown(),e.stop()):e.matchKey(df.settings.treeKeys.collapse)?(this.doCollapse(),e.stop()):e.matchKey(df.settings.treeKeys.extend)?(this.doExpand(),e.stop()):e.matchKey(df.settings.treeKeys.moveFirst)?(this.moveFirst(),e.stop()):e.matchKey(df.settings.treeKeys.moveLast)?(this.moveLast(),e.stop()):e.matchKey(df.settings.treeKeys.enter)&&this.fireSubmit()&&e.stop())},displayLoading:function(e){e?this.updateNodeCSS(e):this._eControl&&df.dom.addClass(this._eControl,"WebTree_Loading")},hideLoading:function(e){e?this.updateNodeCSS(e):this._eControl&&df.dom.removeClass(this._eControl,"WebTree_Loading")},focus:function(){return!!(this._bFocusAble&&this.isEnabled()&&this._eFocus)&&(this._eFocus.focus(),this.objFocus(),!0)},onFocus:function(e){df.WebTreeView.base.onFocus.call(this,e),this._bLozingFocus=!1},onBlur:function(e){var t=this;this._bLozingFocus=!0,setTimeout((function(){t._bLozingFocus&&(df.WebTreeView.base.onBlur.call(t,e),t._bLozingFocus=!1)}),100)},determineSelectorForWebUIContext:function(e){switch(e){case df.WebUIContext.WebUIContextTreeviewFolder:case df.WebUIContext.WebUIContextTreeviewItem:return"tr[data-dftree-id]"}return null},verifyElementForWebUIContext:function(e,t){switch(t){case df.WebUIContext.WebUIContextTreeviewFolder:case df.WebUIContext.WebUIContextTreeviewItem:{if(!e.hasAttribute("data-dftree-id"))return!1;const i=e.getAttribute("data-dftree-id"),s=this.getNodeById(i);return s.bFolder&&t===df.WebUIContext.WebUIContextTreeviewFolder||!s.bFolder&&t===df.WebUIContext.WebUIContextTreeviewItem}}return!0},retrieveValueFromWebUIContext:function(e,t){switch(t){case df.WebUIContext.WebUIContextTreeviewFolder:case df.WebUIContext.WebUIContextTreeviewItem:if(!e.hasAttribute("data-dftree-id"))break;return e.getAttribute("data-dftree-id")}return null},getDragData:function(e,t){try{const e=t.getAttribute("data-dftree-id")||-1;let i,s;return e&&-1!=e&&(""!=e||e>=0)&&(i={...this.getNodeById(e)},Object.keys(i).forEach((function(e){0==e.indexOf("_")&&delete i[e]})),s=i.bFolder?df.dragActions.WebTreeView.ciDragFolder:df.dragActions.WebTreeView.ciDragItem),[{data:i},s]}catch(e){return console.error("Attempt to perform unsupported drag action"),[null,null]}},getDropData:function(e,t){if(e&&e._eDropElem){const t=e._eDropElem.getAttribute("data-dftree-id")||-1;let i,s;return t&&-1!=t&&(""!=t||t>=0)&&(i={...this.getNodeById(t)},Object.keys(i).forEach((function(e){0==e.indexOf("_")&&delete i[e]})),s=i.bFolder?df.dropActions.WebTreeView.ciDropOnFolder:df.dropActions.WebTreeView.ciDropOnItem),{data:i,action:s}}return null},initDraggableElements:function(){},initDropZones:function(){if(this._aDropZones=[],df.WebList.base.initDropZones.call(this),this.isSupportedDropAction(df.dropActions.WebTreeView.ciDropOnFolder)||this.isSupportedDropAction(df.dropActions.WebTreeView.ciDropOnItem)){const e=df.dom.query(this._eElem,".WebTree_Body");this.addDropZone(e)}},determineDropCandidate:function(e,t){if(t.find((e=>e.supportsDropAction(this,df.dropActions.WebControl.ciDropOnControl))))return[this._eElem,df.dropActions.WebControl.ciDropOnControl];let i=document.elementFromPoint(e.e.clientX,e.e.clientY)?.closest("tr[data-dftree-id]");if(i){let e=i.getAttribute("data-dftree-id");if(this.getNodeById(e).bFolder){if(t.find((e=>e.supportsDropAction(this,df.dropActions.WebTreeView.ciDropOnFolder))))return[i,df.dropActions.WebTreeView.ciDropOnFolder]}else if(t.find((e=>e.supportsDropAction(this,df.dropActions.WebTreeView.ciDropOnItem))))return[i,df.dropActions.WebTreeView.ciDropOnItem]}return[null,null]},determineDropPosition:function(e,t){return df.dropPositions.ciDropOn},interactWithDropElem:function(e,t){e._eDropAction,df.dropActions.WebControl.ciDropOnControl,e.highlightElement()},doEmptyInteraction:function(e){return this.isSupportedDropAction(df.dropActions.WebTreeView.ciDropOnRoot)?(e.highlightElement(),df.dropActions.WebTreeView.ciDropOnRoot):this.isSupportedDropAction(df.dropActions.WebControl.ciDropOnControl)?(e.highlightElement(),df.dropActions.WebControl.ciDropOnControl):null},onControlDragOver:function(e,t,i){i!=this._eCurHoveredElem&&(this._eCurHoveredElem=i,clearTimeout(this._fHoverTimeOut),this._eCurHoveredElem&&(this._fHoverTimeOut=setTimeout((()=>{this.expand(this._eCurHoveredElem.getAttribute("data-dftree-id"))}),1e3)))},hasData:function(){return this._aItems&&this._aItems.length>0}}),df.WebIFrame=function(e,t){df.WebIFrame.base.constructor.call(this,e,t),this.prop(df.tString,"psUrl",""),this.prop(df.tBool,"pbShowBorder",!0),this.event("OnLocationChange",df.cCallModeDefault),this._eWrapper=null,this._sContentHtml=null,this._sControlClass="WebIFrame"},df.defineClass("df.WebIFrame","df.WebBaseControl",{openHtml:function(e){var t;df.WebIFrame.base.openHtml.call(this,e),t="df_webiframe_"+df.dom.piDomCounter++,e.push('<div class="WebIFrm_Wrp"><iframe name="',t,'" scrolling="auto" frameborder="no"></iframe></div>')},afterRender:function(){this._eControl=df.dom.query(this._eElem,"iframe"),this._eWrapper=df.dom.query(this._eElem,"div.WebIFrm_Wrp"),df.WebIFrame.base.afterRender.call(this),df.dom.on("load",this._eControl,this.onFrameLoad,this),this.set_pbShowBorder(this.pbShowBorder),this.set_psUrl(this.psUrl),null!=this._sContentHtml&&this.writeHtmlContent()},onFrameLoad:function(e){var t=this._eControl.contentWindow.location.href;t&&this.psUrl!==t&&(this.psUrl=t,this.addSync("psUrl"),this.fire("OnLocationChange",[t]))},set_psUrl:function(e){this._eControl&&(this._eControl.src=e)},set_pbShowBorder:function(e){this._eWrapper&&df.dom.toggleClass(this._eWrapper,"WebIFrm_Box",e)},setHeight:function(e,t){this._eControl&&(e>0?(e=(e-=this.getVertHeightDiff())<0?0:e,this._eWrapper.style.height=e+"px"):this._eWrapper.style.height="80px")},getVertHeightDiff:function(){var e=df.WebForm.base.getVertHeightDiff.call(this);return e+=df.sys.gui.getVertBoxDiff(this._eWrapper)},setHtmlContent:function(e){this._sContentHtml=e,this.writeHtmlContent()},writeHtmlContent:function(){this._eControl&&(this._eControl.contentWindow.document.open("text/htmlreplace"),this._eControl.contentWindow.document.write(this._sContentHtml),this._eControl.contentWindow.document.close())}}),df.WebImage=function(e,t){df.WebImage.base.constructor.call(this,e,t),this.prop(df.tString,"psUrl",""),this.prop(df.tBool,"pbScroll",!1),this.prop(df.tInt,"pePosition",df.cwiActual),this.prop(df.tBool,"pbShowBorder",!1),this.prop(df.tBool,"pbFitZoom",!0),this.event("OnClick",df.cCallModeWait),this.pbServerOnClick=!1,this.psClientOnClick="",this._eImg=null,this._sLastUrl=null,this._iImageWidth=null,this._iImageHeight=null,this._bFocusAble=!1,this._sControlClass="WebImage"},df.defineClass("df.WebImage","df.WebBaseControl",{openHtml:function(e){df.WebImage.base.openHtml.call(this,e),e.push('<div class="WebImg_Wrp"><img>')},closeHtml:function(e){e.push("</div>"),df.WebImage.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebImg_Wrp"),this._eImg=df.dom.query(this._eElem,"div.WebImg_Wrp > img"),df.WebImage.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onClick,this),df.dom.on("load",this._eImg,this.onImageLoaded,this),this.set_pePosition(this.pePosition),this.set_pbShowBorder(this.pbShowBorder),this.set_piHeight(this.piHeight),this.updateImage()},set_psUrl:function(e){this.psUrl=e,this.updateImage()},set_pbScroll:function(e){this._eControl&&(this._eControl.style.overflowY=e&&this.pePosition!==df.cwiStretch?"auto":"hidden",this._eControl.style.overflowX=e&&this.pePosition!==df.cwiStretchHoriz&&this.pePosition!==df.cwiStretch?"auto":"hidden")},set_pePosition:function(e){this._eImg&&(this._eControl.scrollLeft=0,this._eControl.scrollTop=0,this._eImg.style.width=e===df.cwiStretch||e===df.cwiStretchHoriz?"100%":"",this._eImg.style.height=e===df.cwiStretch?"100%":"",this._eImg.style.marginLeft=e===df.cwiCenter?"auto":"",this._eImg.style.marginRight=e===df.cwiCenter?"auto":"",this._eImg.style.display="block",this._eImg.style.marginTop="",this.pePosition=e,this.set_pbScroll(this.pbScroll),this.centerImage())},set_pbShowBorder:function(e){this._eControl&&(df.dom.toggleClass(this._eControl,"WebImg_Box",e),this.pbShowBorder!==e&&this.sizeChanged())},set_psToolTip:function(e){this._eImg&&(this._eImg.alt=e,this._eImg.title=e)},updateImage:function(){this._iImageWidth=null,this._iImageHeight=null,this._eImg&&(this.psUrl!==this._sLastUrl&&(this._eImg.style.visibility="hidden"),this._eImg.src=this.psUrl,this._sLastUrl=this.psUrl,this.centerImage())},centerImage:function(){var e,t,i;this._eImg&&(this.pePosition===df.cwiFit&&this._iImageWidth>0&&(i=(t=this._eControl.clientWidth/this._iImageWidth)<(e=this._eControl.clientHeight/this._iImageHeight)?t:e,this.pbFitZoom||(i=i>1?1:i),i>0&&(this._eImg.style.width=Math.floor(this._iImageWidth*i)+"px")),this.pePosition!==df.cwiCenter&&this.pePosition!==df.cwiFit||(this._eImg.clientHeight<this._eControl.clientHeight?this._eImg.style.marginTop=Math.floor((this._eControl.clientHeight-this._eImg.clientHeight)/2)+"px":(this._eImg.style.marginTop="",this._eControl.scrollTop=Math.floor((this._eControl.scrollHeight-this._eControl.clientHeight)/2)),this._eImg.clientWidth<this._eControl.clientWidth?this._eImg.style.marginLeft=Math.floor((this._eControl.clientWidth-this._eImg.clientWidth)/2)+"px":(this._eImg.style.marginLeft="",this._eControl.scrollLeft=Math.floor((this._eControl.scrollWidth-this._eControl.clientWidth)/2))))},resize:function(){0===this._iImageWidth&&(this._iImageWidth=this._eImg.clientWidth,this._iImageHeight=this._eImg.clientHeight),this.centerImage()},onImageLoaded:function(e){this._iImageWidth=this._eImg.clientWidth,this._iImageHeight=this._eImg.clientHeight,this.centerImage(),this._eImg.style.visibility=""},onClick:function(e){this.isEnabled()&&this.fire("OnClick")&&e.stop()}}),df.WebHtmlBox=function(e,t){df.WebHtmlBox.base.constructor.call(this,e,t),this.prop(df.tBool,"pbScroll",!0),this.prop(df.tString,"psHtml",""),this.prop(df.tBool,"pbShowBorder",!1),this.event("OnClick",df.cCallModeWait),this._sControlClass="WebHtmlBox",this._bFocusAble=!1},df.defineClass("df.WebHtmlBox","df.WebBaseControl",{openHtml:function(e){df.WebHtmlBox.base.openHtml.call(this,e),e.push('<div class="WebHtml_Wrp">')},closeHtml:function(e){e.push("</div>"),df.WebHtmlBox.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebHtml_Wrp"),df.WebHtmlBox.base.afterRender.call(this),this.set_piHeight(this.piHeight),this.set_pbShowBorder(this.pbShowBorder),df.dom.on("click",this._eControl,this.onHtmlClick,this),this.updateHtml(this.psHtml)},updateHtml:function(e){this.psHtml=e,this._eControl&&(this._eControl.innerHTML=this.psHtml,this.sizeChanged())},appendHtml:function(e){this.psHtml+=e,this._eControl&&(this._eControl.innerHTML=this.psHtml,this.sizeChanged())},prependHtml:function(e){this.psHtml=e+this.psHtml,this._eControl&&(this._eControl.innerHTML=this.psHtml,this.sizeChanged())},updateHtmlArray:function(){var e=df.sys.vt.deserialize(this._tActionData,[df.tString]);this.updateHtml(e.join(""))},set_pbScroll:function(e){this._eControl&&(this._eControl.style.overflowY=this.pbFillHeight||this.piHeight>0?e?"auto":"hidden":"visible",this._eControl.style.overflowX=e?"auto":"")},set_pbShowBorder:function(e){this._eControl&&df.dom.toggleClass(this._eControl,"WebHtml_Box",e)},set_piHeight:function(e){this._eControl&&(df.WebHtmlBox.base.set_piHeight.call(this,e),this.piHeight=e,this.set_pbScroll(this.pbScroll))},set_psHtml:function(e){this.updateHtml(e)},set_pbFillHeight:function(e){df.WebHtmlBox.base.set_pbFillHeight.call(this,e),this.pbFillHeight=e,this.set_pbScroll(this.pbScroll)},onHtmlClick:function(e){for(var t=e.getTarget();t&&t!==this._eControl;)t.getAttribute("data-ServerOnClick")&&this.fire("OnClick",[t.getAttribute("data-ServerOnClick"),t.getAttribute("data-OnClickParam")||""]),t=t.parentNode}}),df.WebRadio=function(e,t){df.WebRadio.base.constructor.call(this,e,t),this.prop(df.tString,"psMasterName",""),this.prop(df.tString,"psGroupName",""),this.prop(df.tString,"psRadioValue",""),this.prop(df.tString,"psCaption",""),this.event("OnSelect",df.cCallModeDefault),this._oMaster=null,this._aRadios=[],this._sPrevChangeVal=null,this._iPrevSelected=null,this._eCaption=null,this._sControlClass="WebRadio"},df.defineClass("df.WebRadio","df.WebBaseDEO",{openHtml:function(e){df.WebRadio.base.openHtml.call(this,e),e.push('<input type="radio" name="',this.psGroupName,'" id="',this._sControlId,'"',this.isEnabled()?"":' disabled="disabled" tabindex="-1"','><span class="WebR_Fake"></span><label class="WebRadio_Caption" for="',this._sControlId,'"></label>'),this._oParent?._bIsContainer&&this._oParent?.isFlowLayout()&&e.push('<div style="clear: both"></div>')},afterRender:function(){var e=this.getWebApp();this._eControl=df.dom.query(this._eElem,"input"),this._eCaption=df.dom.query(this._eElem,"label.WebRadio_Caption"),this._eFakeBox=df.dom.query(this._eElem,".WebR_Fake"),this.set_psCaption(this.psCaption),this.set_psRadioValue(this.psRadioValue),this.psMasterName?(this._oMaster=e.findObj(this.psMasterName),this._oMaster.registerRadio(this),this.unSync("psValue"),this.unSync("pbChanged"),this.psValue=this._oMaster.psValue):this.registerRadio(this),df.WebRadio.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onClick,this),df.dom.on("click",this._eFakeBox,this.onFakeClick,this)},get_pbChanged:function(){return this._oMaster?this._oMaster.get_pbChanged():df.WebRadio.base.get_pbChanged.call(this)},set_psValue:function(e){var t;if(this._oMaster)this._oMaster.set_psValue(e);else for(df.WebRadio.base.set_psValue.call(this,e),t=0;t<this._aRadios.length;t++)if(this._aRadios[t]._eControl.checked){this._iPrevSelected=t;break}},get_psValue:function(){return this._oMaster?this._oMaster.get_psValue():df.WebRadio.base.get_psValue.call(this)},set_psRadioValue:function(e){this._eControl&&(this._eControl.value=e)},set_psCaption:function(e){this._eCaption&&(df.dom.setText(this._eCaption,e),this.psCaption!==e&&this.sizeChanged())},set_psTextColor:function(e){this._eCaption&&(this._eCaption.style.color=e||"")},set_psToolTip:function(e){df.WebRadio.base.set_psToolTip.call(this,e),this._eFakeBox&&(this._eFakeBox.title=e)},getControlValue:function(){var e;if(this._oMaster)return this._oMaster.getControlValue();for(e=0;e<this._aRadios.length;e++)if(this._aRadios[e]._eControl.checked)return this._aRadios[e].psRadioValue;return this.psValue},setControlValue:function(e){var t;if(this._oMaster)return this._oMaster.setControlValue(e);if(!this._aRadios[this._iPrevSelected]||!this._aRadios[this._iPrevSelected]._eControl.checked||this._aRadios[this._iPrevSelected].psRadioValue!==e)for(t=0;t<this._aRadios.length;t++)if(this._aRadios[t].psRadioValue===e)return void(this._aRadios[t]._eControl.checked=!0)},registerRadio:function(e){this._aRadios.push(e)},fireChange:function(){var e,t;if(this._oMaster)return this._oMaster.fireChange();for(this.updateTypeVal(),e=this.getServerVal(),t=0;t<this._aRadios.length;t++)this._sPrevChangeVal!==e&&this._aRadios[t].fire("OnChange",[e,this._sPrevChangeVal]),this._aRadios[t]._eControl.checked&&t!==this._iPrevSelected&&(this._aRadios[t].fire("OnSelect"),this._iPrevSelected=t);this._sPrevChangeVal=e},onClick:function(e){this.fireChange()},onFakeClick:function(e){this.isEnabled()&&(this.focus(),this._eControl.checked=!0,this.fireChange())}}),df.WebSlider=function(e,t){df.WebSlider.base.constructor.call(this,e,t),this.prop(df.tInt,"piMinValue",1),this.prop(df.tInt,"piMaxValue",10),this.prop(df.tInt,"piSliderValue",1),this.prop(df.tInt,"piInterval",1),this.prop(df.tBool,"pbVertical",!1),this.prop(df.tInt,"piHeight",0),this.prop(df.tBool,"pbShowMarkers",!1),this.prop(df.tInt,"piMaxMarkers",101),this.prop(df.tBool,"pbRanged",!1),this.prop(df.tInt,"piSliderStart",0),this.prop(df.tInt,"piFrom",1),this.prop(df.tInt,"piTo",3),this.prop(df.tBool,"pbShowValue",!0),this.prop(df.tBool,"pbShowRange",!1),this.prop(df.tBool,"pbMouseWheelScroll",!0),this._eSlider=null,this._eSliderWrp=null,this._eSliderBar=null,this._eControl=null,this._eLabels=null,this._eValueIndicator=null,this._bSelected=!1,this._bFocus=!1,this._eRangedSlider=null,this._iValueInterval=0,this._aLabels=[],this._aMarkers=[],this._iPrevChangePos=1,this._iPrevChangeFrom=0,this._iPrevChangeTo=0,this.unSync("psValue"),this._sControlClass="WebSlider"},df.defineClass("df.WebSlider","df.WebBaseDEO",{create:function(e){df.WebSlider.base.create.call(this,e),this.piSliderValue<this.piMinValue?this.piSliderValue=this.piMinValue:this.piSliderValue>this.piMaxValue&&(this.piSliderValue=this.piMaxValue),this._iPrevChangePos=this.piSliderValue,this.assertions(),this.piSliderValue>this.piMaxValue?this.piSliderValue=this.piMaxValue:this.piSliderValue<this.piMinValue&&(this.piSliderValue=this.piMinValue),this.pbRanged?(this.addSync("piFrom"),this.addSync("piTo")):this.addSync("piSliderValue")},openHtml:function(e){df.WebSlider.base.openHtml.call(this,e),this.pbShowValue&&e.push('<div class="WebSlider_ValueIndicatorWrapper">1</div>'),e.push('<div class="WebSlider_Wrapper',this.pbVertical?" WebSlider_Vertical":" WebSlider_Horizontal",this.pbRanged?" WebSlider_Range":" WebSlider_NoRange",'" ',this.isEnabled()?'tabindex="0"':'tabindex="-1"',">"),e.push('<div class="WebSlider_BarWrapper">'),e.push('<div class="WebSlider_Bar">'),e.push('<div class="WebSlider_InnerBar">'),this.pbShowRange&&e.push('<div class="WebSlider_ShowRange"></div>'),e.push("</div></div>"),e.push("</div>"),e.push('<div class="WebSlider_Labels">'),this.generateMarkers(),this.renderLabels(e),e.push("</div>"),e.push('<div class="WebSlider_SliderWrapper">'),e.push('<div class="WebSlider_Slider"></div>'),this.pbRanged&&e.push('<div class="WebSlider_SliderRanged WebSlider_Slider"></div>'),e.push("</div>")},closeHtml:function(e){e.push("</div>")},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebSlider_Wrapper"),this._eSlider=df.dom.query(this._eElem,"div.WebSlider_Slider"),this._eSliderWrp=df.dom.query(this._eElem,"div.WebSlider_SliderWrapper"),this._eSliderBar=df.dom.query(this._eElem,"div.WebSlider_Bar"),this._eSliderBarWrp=df.dom.query(this._eElem,"div.WebSlider_BarWrapper"),this._eSliderBarInner=df.dom.query(this._eElem,"div.WebSlider_InnerBar"),this._eLabels=df.dom.query(this._eElem,"div.WebSlider_Labels"),this._eValueIndicator=df.dom.query(this._eElem,"div.WebSlider_ValueIndicatorWrapper"),this.pbRanged&&(this._eRangedSlider=df.dom.query(this._eElem,"div.WebSlider_SliderRanged")),this.pbShowRange&&(this._eRangeIndicator=df.dom.query(this._eElem,"div.WebSlider_ShowRange")),df.WebSlider.base.afterRender.call(this),this.updateDisplay(),window.PointerEvent?df.dom.on("pointerdown",this._eControl,this.onPointerDown,this):df.dom.on("touchstart",this._eControl,this.onTouchDown,this),df.events.addDomMouseWheelListener(this._eSliderWrp,this.onMouseWheelScroll,this),this.pbRanged&&df.dom.on("mousedown",this._eRangedSlider,this.onMouseDown,this),df.dom.on("mousedown",this._eSlider,this.onMouseDown,this),df.dom.on("click",this._eLabels,this.onLabelClick,this),df.dom.on("click",this._eControl,this.onSliderClick,this)},assertions:function(){if(this.piInterval<=0)throw new df.Error(999,"The piInterval needs to be a positive number",this);if(this.piMaxValue===this.piMinValue)throw new df.Error(999,"Please specify a Max and a Min value",this);if(this.piMaxValue<this.piMinValue)throw new df.Error(999,"The max value is smaller then the min value",this);if((this.piMaxValue-this.piMinValue)%this.piInterval>0)throw new df.Error(999,"Your maximum, minimum and interval value do not match properly",this);if(this.piSliderValue<this.piMinValue||this.piSliderValue>this.piMaxValue)throw new df.Error(999,"Please specify the piSliderValue with a number between the piMinValue and piMaxValue",this);if((this.piSliderValue-this.piMinValue)%this.piInterval>0||(this.piMaxValue-this.piSliderValue)%this.piInterval>0)throw new df.Error(999,"The piSliderValue value is unreachable with the specified interval.",this);if(this.pbRanged){if(this.piFrom<this.piMinValue||this.piFrom>this.piMaxValue)throw new df.Error(999,"Please specify the piFrom with a number between the piMinValue and piMaxValue",this);if(this.piTo<this.piMinValue||this.piTo>this.piMaxValue)throw new df.Error(999,"Please specify the piTo with a number between the piMinValue and piMaxValue",this);if((this.piFrom-this.piMinValue)%this.piInterval>0||(this.piMaxValue-this.piFrom)%this.piInterval>0)throw new df.Error(999,"The piRangedValue value is unreachable with the specified interval.",this);if((this.piTo-this.piMinValue)%this.piInterval>0||(this.piMaxValue-this.piTo)%this.piInterval>0)throw new df.Error(999,"The piTo value is unreachable with the specified interval.",this)}},getVertHeightDiff:function(){var e=df.WebSlider.base.getVertHeightDiff.call(this);return this._eValueIndicator&&this.pbVertical&&(e+=this._eValueIndicator.offsetHeight),e},resize:function(e){this.positionLabels(),this.updateDisplay()},updateDisplay:function(){var e,t,i,s,o;this._eElem&&(s=this.getInterval()/this.piInterval,this.pbRanged?(t=s*(this.piFrom-this.piMinValue),i=s*(this.piTo-this.piMinValue),this.pbVertical?(this._eRangedSlider.style.top=t+"px",this._eSlider.style.top=i+"px"):(this._eRangedSlider.style.left=t+"px",this._eSlider.style.left=i+"px"),this.pbShowValue&&(this._eValueIndicator.innerHTML=this.piFrom+"-"+this.piTo),this.pbShowRange&&(this.pbVertical?(this._eRangeIndicator.style.top=t+"px",this._eRangeIndicator.style.height=i-t+"px"):(this._eRangeIndicator.style.left=t+"px",o=(o=i-t)<0?-o:o,this._eRangeIndicator.style.width=o+"px"))):(e=s*(this.piSliderValue-this.piMinValue),this.pbVertical?this._eSlider.style.top=e+"px":this._eSlider.style.left=e+"px",this.pbShowValue&&(this._eValueIndicator.innerHTML=this.piSliderValue),this.pbShowRange&&(this.pbVertical?(this._eRangeIndicator.style.top="0px",this._eRangeIndicator.style.height=e+"px"):(this._eRangeIndicator.style.left="0px",e=e<0?-e:e,this._eRangeIndicator.style.width=e+"px"))))},fillLabels:function(){this._tActionData&&(this._aLabels=df.sys.vt.deserialize(this._tActionData,[{sN:df.tString,sV:df.tString}]),this.generateMarkers(),this.updateLabels())},generateMarkers:function(){var e,t,i,s,o,n=this._aLabels;if(this._aMarkers=[],this.pbShowMarkers){if(i=this.piMaxMarkers,(o=(this.piMaxValue-this.piMinValue)/(i-1))<this.piInterval)s=this.piInterval;else for(s=this.piInterval;s<o||(this.piMaxValue-this.piMinValue)%s;)s+=this.piInterval;for(i=(this.piMaxValue-this.piMinValue)/s,e=0;e<=i;e++)(t={}).piSliderValue=s*e+this.piMinValue,t.psLabel="",this._aMarkers.push(t)}if(n)for(e=0;e<n.length;e++)(t={}).piSliderValue=parseFloat(n[e].sV,10),t.psLabel=n[e].sN,t.piSliderValue%this.piInterval==0&&t.piSliderValue<=this.piMaxValue&&t.piSliderValue>=this.piMinValue&&this._aMarkers.push(t);this._aMarkers=this._aMarkers.sort(this.sortLabels),this._aMarkers=this.removeDoubleValues(this._aMarkers)},sortLabels:function(e,t){return e.piSliderValue<t.piSliderValue?-1:e.piSliderValue>t.piSliderValue?1:e.piSliderValue===t.piSliderValue?0:void 0},removeDoubleValues:function(e){var t,i=[];for(t=0;t<e.length;t++)t+1===e.length?i.push(e[t]):e[t].piSliderValue===e[t+1].piSliderValue?(e[t].psLabel.length>e[t+1].psLabel.length?i.push(e[t]):i.push(e[t+1]),t++):i.push(e[t]);return i},renderLabels:function(e){var t;for(e.push('<div class="WebSlider_LabelMarkerWrapper"',0!==this._aLabels.length||this.pbShowMarkers?"":' style="display: none;"',">"),t=0;t<this._aMarkers.length;t++)e.push('<div class="WebSlider_LabelMarker" data-labelIndex="',t,'"></div>');for(e.push('</div><div class="WebSlider_LabelWrapper"',0===this._aLabels.length?' style="display: none;"':"",">"),t=0;t<this._aMarkers.length;t++)""!==this._aMarkers[t].psLabel&&e.push('<div class="WebSlider_LabelText" data-labelIndex="',t,'">',this._aMarkers[t].psLabel,"</div>");e.push("</div>")},positionLabels:function(){var e,t,i,s,o,n,r;for(s=this.getInterval()/this.piInterval,o=df.dom.query(this._eLabels,"div.WebSlider_LabelText",!0),i=df.dom.query(this._eLabels,"div.WebSlider_LabelMarker",!0),r=this.pbVertical?this._eSlider.offsetHeight/2:this._eSlider.offsetWidth/2,e=0;e<i.length;e++)t=0,t=r+s*(this._aMarkers[e].piSliderValue-this.piMinValue),this.pbVertical?i[e].style.top=t+"px":i[e].style.left=t+"px";for(e=0;e<o.length;e++)t=0,t=r+s*((n=this._aMarkers[o[e].getAttribute("data-labelIndex")].piSliderValue)-this.piMinValue),this.pbVertical?(t-=o[e].offsetHeight/2,o[e].style.top=t+"px"):(t-=(.6*((n-this.piMinValue)/(this.piMaxValue-this.piMinValue)-.5)+.5)*o[e].offsetWidth,o[e].style.left=t+"px")},updateLabels:function(){var e=[];this._eElem&&(this.renderLabels(e),this._eLabels.innerHTML=e.join(""),this.positionLabels())},increment:function(e,t){this.pbRanged?t?e?this.piTo<this.piMaxValue?this.piTo+=this.piInterval:this.piFrom>this.piMinValue&&(this.piFrom-=this.piInterval):this.piFrom<this.piTo&&(this.piTo-=this.piInterval):e?this.piTo<this.piMaxValue&&(this.piTo+=this.piInterval,this.piFrom+=this.piInterval):this.piFrom>this.piMinValue&&(this.piTo-=this.piInterval,this.piFrom-=this.piInterval):e&&this.piSliderValue!==this.piMaxValue?this.piSliderValue+=this.piInterval:e||this.piSliderValue===this.piMinValue||(this.piSliderValue-=this.piInterval),this.updateDisplay(),this.fireChange()},getInterval:function(){return(this.pbVertical?this._eSliderBarInner.offsetHeight:this._eSliderBarInner.offsetWidth)/((this.piMaxValue-this.piMinValue)/this.piInterval)},toPositive:function(e){return e=Math.sqrt(Math.pow(e,2))},getMaximalSliderPosition:function(){return this.pbVertical?this._eSliderBarInner.offsetHeight:this._eSliderBarInner.offsetWidth},onLabelClick:function(e){var t=e.getTarget();if(this.isEnabled()){for(;null===t.getAttribute("data-labelindex")||t===document;)if((t=t.parentNode)===document)return;this.piSliderValue=this._aMarkers[t.getAttribute("data-labelIndex")].piSliderValue,this.updateDisplay(),this.fireChange(),this.onFocus()}},onMouseDown:function(e){this.slide(0,this._eRangedSlider===e.eSource&&this.pbRanged,e)},onPointerDown:function(e){var t,i,s,o=10;"pen"!==e.e.pointerType&&"touch"!==e.e.pointerType||(t=e.e.clientX,i=e.e.clientY,t>(s=this._eSlider.getBoundingClientRect()).left-o&&t<s.right+o&&i>s.top-o&&i<s.bottom+o?this.slide(1,!1,e):this.pbRanged&&t>(s=this._eRangedSlider.getBoundingClientRect()).left-o&&t<s.right+o&&i>s.top-o&&i<s.bottom+o&&this.slide(1,!0,e))},onTouchDown:function(e){var t,i,s,o=10;t=e.e.targetTouches[0].clientX,i=e.e.targetTouches[0].clientY,t>(s=this._eSlider.getBoundingClientRect()).left-o&&t<s.right+o&&i>s.top-o&&i<s.bottom+o?this.slide(2,!1,e):this.pbRanged&&t>(s=this._eRangedSlider.getBoundingClientRect()).left-o&&t<s.right+o&&i>s.top-o&&i<s.bottom+o&&this.slide(2,!0,e)},onMouseWheelScroll:function(e){if(this.pbMouseWheelScroll){var t=e.getMouseWheelDelta();t>0?this.increment(!1,!1):t<0&&this.increment(!0,!1),e.stop()}},slide:function(e,t,i){var s,o,n,r,a,l=this.pbVertical;function h(t){return 0===e?l?t.getMouseY():t.getMouseX():1===e?l?t.e.clientY:t.e.clientX:2===e?l?t.e.targetTouches[0].clientY:t.e.targetTouches[0].clientX:0}function d(e){var i,o,l,d;l=(i=h(e))-s,this.toPositive(l),d=l/a,d=Math.round(this.toPositive(d)),s>i&&(d*=-1),(o=d*this.piInterval+n)<this.piMinValue?o=this.piMinValue:o>this.piMaxValue&&(o=this.piMaxValue),this.pbRanged?t?(this.piFrom=o,this.piFrom>this.piTo&&(t=!1,r=this.piFrom,this.piFrom=this.piTo,this.piTo=r)):(this.piTo=o,this.piTo<this.piFrom&&(t=!0,r=this.piFrom,this.piFrom=this.piTo,this.piTo=r)):this.piSliderValue=o,this.updateDisplay()}function p(t){o.parentNode.removeChild(o),0===e?(df.dom.off("mouseup",window,p,this),df.dom.off("mouseup",o,p,this),df.dom.off("mousemove",o,d,this)):1===e?(df.dom.off("pointerup",window,p,this),df.dom.off("pointerup",o,p,this),df.dom.off("pointermove",window,d,this)):2===e&&(df.dom.off("touchend",window,p,this),df.dom.off("touchend",o,p,this),df.dom.off("touchmove",window,d,this)),this.fireChange()}this.isEnabled()&&(a=this.getInterval(),(o=df.gui.dragMask(this.topLayer()||document.body)).style.cursor=l?"s-resize":"e-resize",s=h(i),this.getMaximalSliderPosition(),n=this.pbRanged?t?this.piFrom:this.piTo:this.piSliderValue,0===e?(df.dom.on("mouseup",window,p,this),df.dom.on("mouseup",o,p,this),df.dom.on("mousemove",o,d,this)):1===e?(df.dom.on("pointerup",window,p,this),df.dom.on("pointerup",o,p,this),df.dom.on("pointermove",window,d,this)):2===e&&(df.dom.on("touchend",window,p,this),df.dom.on("touchend",o,p,this),df.dom.on("touchmove",window,d,this)),i.stop(),this.focus())},onSliderClick:function(e){var t,i,s;this.isEnabled()&&(t=this._eSliderBarInner.getBoundingClientRect(),e.getMouseY()>=t.top-2&&e.getMouseY()<=t.bottom+2&&e.getMouseX()>=t.left-2&&e.getMouseX()<=t.right+2&&(s=(this.pbVertical?e.getMouseY()-t.top:e.getMouseX()-t.left)/(this.getInterval()/this.piInterval),(i=Math.round(s/this.piInterval)*this.piInterval+this.piMinValue)<this.piMinValue?i=this.piMinValue:i>this.piMaxValue&&(i=this.piMaxValue),this.pbRanged?i<this.piFrom?this.piFrom=i:i>this.iTo?this.piTo=i:i-this.piFrom<this.piTo-i?this.piFrom=i:this.piTo=i:this.piSliderValue=i,this.updateDisplay(),this.fireChange()))},onKey:function(e){return e.matchKey(df.settings.sliderKeys.sliderDown)?(this.increment(this.pbVertical,!this.pbVertical),void e.stop()):e.matchKey(df.settings.sliderKeys.sliderUp)?(this.increment(!this.pbVertical,!this.pbVertical),void e.stop()):e.matchKey(df.settings.sliderKeys.sliderLeft)?(this.increment(!1,this.pbVertical),void e.stop()):e.matchKey(df.settings.sliderKeys.sliderRight)?(this.increment(!0,this.pbVertical),void e.stop()):void df.WebSlider.base.onKey.call(this,e)},fireChange:function(){this._iPrevChangePos===this.piSliderValue&&this._iPrevChangeFrom===this.piFrom&&this._iPrevChangeTo===this.piTo||(this.pbChanged=!0,this.fire("OnChange",[this.piSliderValue,this._iPrevChangePos]),this._iPrevChangePos=this.piSliderValue,this._iPrevChangeFrom=this.piFrom,this._iPrevChangeTo=this.piTo)},set_piMinValue:function(e){this.piMinValue=e,this.resize(),this.generateMarkers(),this.updateLabels()},set_piMaxValue:function(e){this.piMaxValue=e,this.updateDisplay(),this.generateMarkers(),this.updateLabels()},set_piInterval:function(e){this.piInterval=e,this.updateDisplay(),this.generateMarkers(),this.updateLabels()},set_pbShowMarkers:function(e){this.pbShowMarkers=e,this.generateMarkers(),this.updateLabels()},set_piSliderValue:function(e){return e>this.piMaxValue?this.piSliderValue=this.piMaxValue:e<this.piMinValue?this.piSliderValue=this.piMinValue:this.piSliderValue=e,this._iPrevChangePos=this.piSliderValue,this.updateDisplay(),!1},set_piFrom:function(e){var t=this;return e>this.piMaxValue?this.piFrom=this.piMaxValue:e<this.piMinValue?this.piFrom=this.piMinValue:this.piFrom=e,this._iPrevChangeFrom=this.piFrom,this.piFrom>this.piTo?setTimeout((function(){var e,i;t.piFrom>t.piTo&&(e=t.piFrom,i=t._iPrevChangeFrom,t.piFrom=t.piTo,t.piTo=e,t._iPrevChangeFrom=t._iPrevChangeTo,t._iPrevChangeTo=i),t.updateDisplay()}),10):this.updateDisplay(),!1},set_piTo:function(e){var t=this;return e>this.piMaxValue?this.piTo=this.piMaxValue:e<this.piMinValue?this.piTo=this.piMinValue:this.piTo=e,this._iPrevChangeTo=this.piTo,this.piFrom>this.piTo?setTimeout((function(){var e,i;t.piFrom>t.piTo&&(e=t.piFrom,i=t._iPrevChangeFrom,t.piFrom=t.piTo,t.piTo=e,t._iPrevChangeFrom=t._iPrevChangeTo,t._iPrevChangeTo=i),t.updateDisplay()}),10):this.updateDisplay(),!1},get_pbChanged:function(){return this.pbChanged},get_psValue:function(){return this.piSliderValue.toString()},set_psValue:function(e){},attachFocusEvents:function(){this._eControl&&this.isEnabled()&&this.pbVisible&&(df.events.addDomCaptureListener("focus",this._eControl,this.onFocus,this),df.dom.on("blur",this._eControl,this.onBlur,this))},focus:function(){return!!(this._bFocusAble&&this.isEnabled()&&this._eControl)&&(this._eControl.focus(),this.objFocus(),!0)},onFocus:function(e){df.WebSlider.base.onFocus.call(this,e),this.focus(),this._bLozingFocus=!1},onBlur:function(e){var t=this;this._bLozingFocus=!0,setTimeout((function(){t._bLozingFocus&&(t.getWebApp().objBlur(t),t._eElem&&df.dom.removeClass(t._eElem,"WebCon_Focus"),t._bHasFocus=!1,t._bLozingFocus=!1)}),100)}}),df.WebSpacer=function(e,t){df.WebSpacer.base.constructor.call(this,e,t),this.prop(df.tInt,"piHeight",0),this.prop(df.tInt,"piMinHeight",0),this._sControlClass="WebSpacer",this._bFocusAble=!1},df.defineClass("df.WebSpacer","df.WebBaseControl",{openHtml:function(e){df.WebSpacer.base.openHtml.call(this,e),e.push('<div class="WebSpacer_Spacer">')},closeHtml:function(e){e.push("</div>"),df.WebSpacer.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebSpacer_Spacer"),df.WebSpacer.base.afterRender.call(this)}}),df.WebHorizontalLine=function(e,t){df.WebHorizontalLine.base.constructor.call(this,e,t),this._sControlClass="WebHorizontalLine",this._bFocusAble=!1},df.defineClass("df.WebHorizontalLine","df.WebBaseControl",{openHtml:function(e){df.WebHorizontalLine.base.openHtml.call(this,e),e.push("<hr/>")},closeHtml:function(e){df.WebHorizontalLine.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"hr"),df.WebHorizontalLine.base.afterRender.call(this)},set_psBackgroundColor:function(e){this._eControl&&(this._eControl.style.backgroundColor=e||"",this._eControl.style.color=e||"")}}),df.WebTimer=function(e,t){df.WebTimer.base.constructor.call(this,e,t),this.prop(df.tBool,"pbAutoStart",!0),this.prop(df.tBool,"pbAutoStop",!0),this.prop(df.tInt,"piInterval",2e3),this.prop(df.tBool,"pbRunning",!1),this.prop(df.tBool,"pbWaitForCall",!0),this.event("OnTimer",df.cCallModeDefault),this._tInterval=null,this._tTimeout=null,this._oView=null,this.addSync("pbRunning")},df.defineClass("df.WebTimer","df.WebObject",{create:function(){df.WebTimer.base.create.call(this),this._oView=this.getView(),this._oView?(this._oView.OnShow.on(this.showView,this),this._oView.OnHide.on(this.hideView,this)):this.pbAutoStart&&(this.pbRunning=!0,this.trigger())},destroy:function(){df.WebTimer.base.destroy.call(this),this._oView&&(this._oView.OnShow.off(this.showView,this),this._oView.OnHide.off(this.hideView,this))},timer:function(){this.pbRunning&&this.fire("OnTimer",[],(function(){this.trigger()}))},trigger:function(){var e=this;this.pbRunning?this.pbWaitForCall?(this._tInterval&&(clearInterval(this._tInterval),this._tInterval=null),this._tTimeout&&clearTimeout(this._tTimeout),this._tTimeout=setTimeout((function(){e.timer()}),this.piInterval)):this._tInterval||(this._tInterval=setInterval((function(){e.timer()}),this.piInterval)):(this._tInterval&&(clearInterval(this._tInterval),this._tInterval=null),this._tTimeout&&(clearTimeout(this._tTimeout),this._tTimeout=null))},set_pbRunning:function(e){this.pbRunning=e,this.trigger()},set_piInterval:function(e){this.piInterval!==e&&(this.piInterval=e,this._tInterval&&(clearInterval(this._tInterval),this._tInterval=null),this.trigger())},set_pbWaitForCall:function(e){this.pbWaitForCall=e,this.trigger()},showView:function(e){this.pbAutoStart&&(this.pbRunning=!0,this.trigger())},hideView:function(e){this.pbAutoStop&&(this.pbRunning=!1,this.trigger())}}),df.WebProgressBar=function(e,t){df.WebProgressBar.base.constructor.call(this,e,t),this.prop(df.tInt,"piMaxValue",100),this.prop(df.tInt,"piValue",0),this.prop(df.tBool,"pbShowPercentage",!0),this.prop(df.tString,"psCaption",""),this.prop(df.tInt,"piDecimals",""),this._eProgressBarWrp=null,this._eProgress=null,this._ePercentage=null,this.piColumnSpan=0,this.pbShowLabel=!1,this._sControlClass="WebProgressBar"},df.defineClass("df.WebProgressBar","df.WebBaseControl",{openHtml:function(e){df.WebProgressBar.base.openHtml.call(this,e),e.push('<div class="WebPB_Wrp',this.pbShowPercentage||this.psCaption?" WebPB_ShowPercentage":"",'">'),e.push("<div>"),e.push('<div class="WebPB_Progress"></div>'),""!==this.psCaption?e.push('<div class="WebPB_Percentage">',df.dom.encodeHtml(this.psCaption),"</div>"):e.push('<div class="WebPB_Percentage"></div>')},closeHtml:function(e){e.push("</div></div>"),df.WebProgressBar.base.closeHtml.call(this,e)},afterRender:function(){this._eProgressBarWrp=df.dom.query(this._eElem,".WebPB_Wrp"),this._eProgress=df.dom.query(this._eElem,".WebPB_Progress"),this._ePercentage=df.dom.query(this._eElem,".WebPB_Percentage"),this.set_piValue(this.piValue),df.WebProgressBar.base.afterRender.call(this)},getPercentage:function(e){var t,i=this.piDecimals;return void 0!==e&&(i=e),i=Math.pow(10,i),t=this.piValue/this.piMaxValue*100,Math.round(t*i)/i},set_piValue:function(e){this._eProgress&&(e=e>=0?e<=this.piMaxValue?e:this.piMaxValue:0,this.piValue=e,this._eProgress.style.width=this.getPercentage(2)+"%",df.dom.toggleClass(this._eProgress,"WebPB_Zero",0===e),this.psCaption||df.dom.setText(this._ePercentage,this.getPercentage()+"%"))},set_pbShowPercentage:function(e){this._ePercentage&&df.dom.toggleClass(this._eProgressBarWrp,"WebPB_ShowPercentage",e||this.psCaption)},set_psCaption:function(e){this._ePercentage&&(this.psCaption=e,df.dom.toggleClass(this._eProgressBarWrp,"WebPB_ShowPercentage",e||this.pbShowPercentage),e?df.dom.setText(this._ePercentage,e):this.set_piValue(this.piValue))},set_piMaxValue:function(e){this.piMaxValue=e,this.set_piValue(this.piValue)}}),df.WebFileUploadButton=function(e,t){df.WebFileUploadButton.base.constructor.call(this,e,t),this.prop(df.tString,"psCaption","Select file(s)"),this.prop(df.tInt,"peAlign",-1),this._sControlClass="WebButton WebUploadBtn"},df.defineClass("df.WebFileUploadButton","df.WebBaseFileUpload",{openHtml:function(e){df.WebFileUploadButton.base.openHtml.call(this,e),e.push('<button id="',this._sControlId,'"',this.isEnabled()?"":' disabled="disabled"'),this.peAlign>=0&&e.push(' style="text-align: ',df.sys.gui.cssTextAlign(this.peAlign),'"'),e.push(">",df.dom.encodeHtml(this.psCaption),"</button>"),this.fileHtml(e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"button"),df.WebFileUploadButton.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onBtnClick,this)},onBtnClick:function(e){var t=this._eElem;this.isEnabled()&&(df.dom.addClass(t,df.CssHit),setTimeout((function(){df.dom.removeClass(t,df.CssHit)}),df.hitTimeout),this.selectFiles())},set_psCaption:function(e){this._eControl&&df.dom.setText(this._eControl,e)},set_peAlign:function(e){this._eControl&&(this._eControl.style.textAlign=df.sys.gui.cssTextAlign(e))},applyEnabled:function(e){df.WebFileUploadButton.base.applyEnabled.call(this,e),this._eControl&&(this._eControl.disabled=!e)}}),df.ciUploadStateEmpty=0,df.ciUploadStateDisplay=1,df.ciUploadStateSelected=2,df.ciUploadStateUploading=3,df.ciUploadStateFinished=4,df.WebFileUploadForm=function(e,t){df.WebFileUploadForm.base.constructor.call(this,e,t),this.prop(df.tInt,"peState",df.ciUploadStateEmpty),this.prop(df.tBool,"pbShowMime",!1),this.prop(df.tString,"psFileName",""),this.prop(df.tInt,"piFileSize",0),this.prop(df.tString,"psFileMime",""),this.event("OnFileClick",df.cCallModeWait),this.addSync("peState"),this._sControlClass="WebFileFrm"},df.defineClass("df.WebFileUploadForm","df.WebBaseFileUpload",{openHtml:function(e){df.WebFileUploadForm.base.openHtml.call(this,e),e.push('<div class="WebFrm_Wrapper" tabindex="0"><div><div class="WebFile_Btn">'),this.fileHtml(e),e.push('</div><div class="WebFile_Content"></div></div></div>')},afterRender:function(){this._eControl=this._eWrap=df.dom.query(this._eElem,"div.WebFrm_Wrapper"),this._eContent=df.dom.query(this._eElem,"div.WebFile_Content"),this._ePrompt=df.dom.query(this._eElem,"div.WebFile_Btn"),df.WebFileUploadForm.base.afterRender.call(this),df.dom.on("click",this._eContent,this.onContentClick,this),df.dom.on("click",this._ePrompt,this.onPromptClick,this),df.events.addDomKeyListener(this._eControl,this.onKey,this),this.updateDetails()},onPromptClick:function(e){this.isEnabled()&&this.selectFiles()},onKey:function(e){e.matchKey(df.settings.formKeys.prompt)?this.isEnabled()&&(this.selectFiles(),e.stop()):e.matchKey(df.settings.tabKeys.enter)&&this.fireContentClick()&&e.stop()},fireContentClick:function(){return!(!this.isEnabled()||this.peState!==df.ciUploadStateFinished&&this.peState!==df.ciUploadStateDisplay||(this.fire("OnFileClick"),0))},updateDetails:function(){var e;this._eWrap&&(this.psFileName?(this.peState===df.ciUploadStateSelected?df.dom.addClass(this._eWrap,"WebFile_Pending"):df.dom.addClass(this._eWrap,"WebFile_HasFile"),e=this.psFileName,this.pbShowMime&&this.piFileSize>0&&this.psFileMime?e+=" (Size: "+df.sys.data.markupDataSize(this.piFileSize)+", Mime: "+this.psFileMime+")":this.piFileSize>0&&(e+=" ("+df.sys.data.markupDataSize(this.piFileSize)+")")):(df.dom.removeClass(this._eWrap,"WebFile_HasFile"),df.dom.removeClass(this._eWrap,"WebFile_Pending"),e=this.getWebApp().getTrans("no_file_selected")),df.dom.toggleClass(this._eContent,"WebFile_OnClick",this.pbServerOnFileClick&&(this.peState===df.ciUploadStateFinished||this.peState===df.ciUploadStateDisplay)),this._eContent.innerHTML='<div class="WebFile_Details">'+e+"</div>")},displaySelectedFileDetails:function(){var e;this._aFiles.length>0&&(e=this._aFiles[0].oFile,this.addSync("psFileName"),this.addSync("piFileSize"),this.addSync("psFileMime"),this._eState=this.peState,this.peState===df.ciUploadDisplay&&(this._sDisplayFileName=this.psFileName,this._iDisplayFileSize=this.piFileSize,this._sDisplayFileMime=this.psFileMime),this.peState=df.ciUploadStateSelected,this.psFileName=e.name,this.piFileSize=e.size,this.psFileMime=e.type),this.updateDetails()},displayStartWorking:function(){this.pbShowDialog?df.WebFileUploadForm.base.displayStartWorking.call(this):this._eContent.innerHTML='<div class="WebFile_Working"></div>'},displayProgress:function(e,t,i,s,o,n){var r;this.pbShowDialog?df.WebFileUploadForm.base.displayProgress.call(this,e,t,i,s,o,n):(r=o/n*100,this._eBar||(this._eContent.innerHTML='<div class="WebFile_Progress"><div class="WebFile_ProgressBar" style="width: 0%;"></div><div class="WebFile_ProgressLabel">0%</div></div>',this._eBar=df.dom.query(this._eContent,"div.WebFile_ProgressBar"),this._eLbl=df.dom.query(this._eContent,"div.WebFile_ProgressLabel")),this._eBar.style.width=Math.round(10*r)/10+"%",df.dom.setText(this._eLbl,Math.round(r)+"%"))},displayFinishWorking:function(){this.pbShowDialog?df.WebFileUploadForm.base.displayFinishWorking.call(this):this._eBar&&(this._eBar.style.width="100%")},displayFinished:function(e){this._eBar=null,this._eLbl=null,this.peState=e?df.ciUploadStateFinished:df.ciUploadStateSelected,this.updateDetails(),df.WebFileUploadForm.base.displayFinished.call(this,e)},onContentClick:function(e){this.fireContentClick()},applyEnabled:function(e){df.WebFileUploadForm.base.applyEnabled.call(this,e),this._eControl&&df.dom.setTabIndex(this._eControl,e?0:-1)}}),df.WebGroupBase=df.mixin("df.WebBaseContainer_mixin","df.WebBaseControl"),df.WebGroup=function(e,t){df.WebGroup.base.constructor.call(this,e,t),this.prop(df.tString,"psCaption",""),this.prop(df.tBool,"pbShowBorder",!0),this.prop(df.tBool,"pbShowCaption",!0),this.prop(df.tBool,"pbCollapsible",!1),this.prop(df.tBool,"pbExpanded",!0),this.event("OnExpand",df.cCallModeDefault),this.event("OnCollapse",df.cCallModeDefault),this._eCaption=null,this._sBaseClass="WebControl",this._sControlClass="WebGroup"},df.defineClass("df.WebGroup","df.WebGroupBase",{wrpOpenHtml:function(e){e.push('<div class="WebContainer">')},wrpCloseHtml:function(e){e.push("</div>"),e.push('<label class="WebGrp_Caption">',df.dom.encodeHtml(this.psCaption),"</label>"),e.push('<div class="WebGrp_ExpandBtn"></div>')},getRef:function(){df.WebGroup.base.getRef.call(this),this._eCaption=df.dom.query(this._eElem,"label.WebGrp_Caption"),this._eControl=df.dom.query(this._eElem,"div.WebCon_Inner > div"),this._eExpandBtn=df.dom.query(this._eElem,"div.WebGrp_ExpandBtn")},afterRender:function(){df.WebGroup.base.afterRender.call(this),df.dom.on("click",this._eExpandBtn,this.onExpandClick,this),df.dom.on("transitionend",this._eElem,this.onTransEnd,this),this._eContent&&df.dom.on("transitionend",this._eContent,this.onTransEndCancel,this)},genClass:function(){var e=df.WebGroup.base.genClass.call(this);return this.pbShowCaption&&(e+=" WebGrp_HasCaption"),this.pbShowBorder&&(e+=" WebGrp_HasBorder"),this.pbCollapsible&&(e+=" WebGrp_Collapsible "+(this.pbExpanded?"WebGrp_Expanded":"WebGrp_Collapsed")),e},set_psCaption:function(e){this._eCaption&&(df.dom.setText(this._eCaption,e),this.sizeChanged())},set_pbShowCaption:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,"WebGrp_HasCaption",e),this.sizeChanged())},set_pbShowBorder:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,"WebGrp_HasBorder",e),this.sizeChanged())},set_pbCollapsible:function(e){this._eElem&&(df.dom.toggleClass(this._eElem,"WebGrp_Collapsible",e),e?df.dom.addClass(this._eElem,this.pbExpanded?"WebGrp_Expanded":"WebGrp_Collapsed"):df.dom.removeClass(this._eElem,"WebGrp_Expanded WebGrp_Collapsed"))},set_pbExpanded:function(e){this._eElem&&this.pbCollapsible&&this.pbExpanded!==e&&(e?(df.dom.addClass(this._eElem,"WebGrp_Expanded"),df.dom.removeClass(this._eElem,"WebGrp_Collapsed"),this.fire("OnExpand")):(df.dom.addClass(this._eElem,"WebGrp_Collapsed"),df.dom.removeClass(this._eElem,"WebGrp_Expanded"),this.fire("OnCollapse")),this.sizeChanged(!0))},onExpandClick:function(e){this.isEnabled()&&this.set("pbExpanded",!this.pbExpanded)},onTransEnd:function(e){this.sizeChanged(!0)},onTransEndCancel:function(e){e.stopPropagation()},getMinHeight:function(){var e=0;return this.resize(),e=this.pbScroll?this.pbFillHeight?this.piMinHeight:Math.max(this.piHeight,this.piMinHeight):this.getRequiredHeight(),this._eControl&&(e+=df.sys.gui.getVertBoxDiff(this._eControl),e+=df.sys.gui.getVertBoxDiff(this._eInner),e+=df.sys.gui.getVertBoxDiff(this._eControlWrp)),e<this.piMinHeight&&(e=this.piMinHeight),e},setHeight:function(e,t){this._eControl&&(e>0?(e=(e-=this.getVertHeightDiff())<0?0:e,this._eContainer.style.height=e+"px"):this._eContainer.style.height="")},getVertHeightDiff:function(){var e=df.WebGroup.base.getVertHeightDiff.call(this);return e+=df.sys.gui.getVertBoxDiff(this._eContainer,3)},getHeightDiff:function(e,t,i,s){let o=df.WebGroup.base.getHeightDiff.call(this,e,t,i,s);return e&&(o+=this.getVertHeightDiff()),o},set_psBackgroundColor:function(e){this._eContainer&&(this._eContainer.style.background=e||""),this._eCaption&&(this._eCaption.style.background=e||"")},onFocus:function(e){},onBlur:function(e){}}),df.tWebBreadcrumbItem={sViewName:df.tString,sCrumbCaption:df.tString,sHeadCaption:df.tString},df.WebBreadcrumb=function(e,t){df.WebBreadcrumb.base.constructor.call(this,e,t),this.prop(df.tInt,"peBreadcrumbStyle",df.cCrumbHorizontal),this._eControl=null,this._eList=null,this._eCaption=null,this._eMask=null,this._aItems=[],this._bRedraw=!1,this._bDropDownExpanded=!1,this._tHideTimeout=null,this._bWrapDiv=!0,this._sControlClass="WebBreadcrumb"},df.defineClass("df.WebBreadcrumb","df.WebBaseControl",{openHtml:function(e){df.WebBreadcrumb.base.openHtml.call(this,e),this.peBreadcrumbStyle===df.cCrumbHorizontal?e.push('<div class="WebCrumbs_Body WebCrumbs_Horiz" tabindex="-1">'):e.push('<div class="WebCrumbs_Body WebCrumbs_DropDown" tabindex="-1">')},closeHtml:function(e){e.push("</div>"),df.WebBreadcrumb.base.closeHtml.call(this,e)},afterRender:function(){this._eControl=df.dom.query(this._eElem,"div.WebCrumbs_Body"),df.WebBreadcrumb.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onBodyClick,this),this.redraw()},set_peBreadcrumbStyle:function(e){this._eControl&&this.peBreadcrumbStyle!==e&&(this.peBreadcrumbStyle=e,this.redraw())},refresh:function(){var e,t=this.deserializeVT(this._tActionData);for(this.clear(),e=0;e<t.length;e++)this.append(t[e]);this.redraw()},onBodyClick:function(e){var t="",i=e.getTarget(),s=!1,o=!1;if(this.isEnabled()){for(this._tHideTimeout&&(clearTimeout(this._tHideTimeout),this._tHideTimeout=null);i&&!s&&i!==this._eElem;)i.className.indexOf("WebCrumb_Item")>=0?((t=i.getAttribute("data-dfview-name"))&&this.doSelect(t),s=!0):i.className.indexOf("WebCrumb_DropDownBtn")>=0?(this.showDropDown(),o=!0,s=!0):i=i.parentNode;this._bDropDownExpanded&&!o&&this.hideDropDown(),s&&e.stop()}},onBlur:function(e){var t=this;df.WebBreadcrumb.base.onBlur.call(this,e),this._bDropDownExpanded&&(this._tHideTimeout&&clearTimeout(this._tHideTimeout),this._tHideTimeout=setTimeout((function(){t._tHideTimeout=null,t.hideDropDown()}),150))},onMaskTouch:function(e){this.hideDropDown(),e.stop()},doSelect:function(e){this.serverAction("OnSelect",[e])},showDropDown:function(){this._eList&&this._aItems.length>1&&(df.dom.addClass(this._eList,"WebCrumbs_Expanded"),this._bDropDownExpanded=!0,df.sys.isMobile&&(this._eMask=df.dom.create('<div class="WebMenu_Mask">&nbsp;</div>'),this._eElem.insertBefore(this._eMask,this._eElem.firstChild),df.dom.on("click",this._eMask,this.onMaskTouch,this)))},hideDropDown:function(){this._eList&&(df.dom.removeClass(this._eList,"WebCrumbs_Expanded"),this._bDropDownExpanded=!1,this._eMask&&(df.dom.off("click",this._eMask,this.onMaskTouch,this),this._eMask.parentNode.removeChild(this._eMask),this._eMask=null))},resize:function(e){var t;this.peBreadcrumbStyle===df.cCrumbHorizontal&&this._eList&&this._eList.hasChildNodes()&&(t=df.dom.query(this._eList,"li div.WebCrumb_Caption",!0),this.resetWidths(t),this.adjustWidths())},resetWidths:function(e){var t;for(t=0;t<e.length;t++)e[t].style.width="auto",e[t].removeAttribute("title")},sumElementWidths:function(e){var t,i=0;for(t=0;t<e.length;t++)i+=e[t].offsetWidth;return i},reduceWidthsToTarget_li:function(e,t){var i,s,o,n,r,a,l=null,h=0;if(0===e.length)return 0;if((s=this.sumElementWidths(e)-t)<=0)return 0;for(o=Math.ceil(s/e.length),i=0;i<e.length;i++)n=(l=df.dom.query(e[i],"div.WebCrumb_Caption",!1)).offsetWidth-o,(n-=df.sys.gui.getHorizBoxDiff(l,0))<15?(l.style.width="15px",h=h+15-n):(r=n.toString()+"px",l.style.width=r),(a=df.dom.getText(l))&&l.setAttribute("title",a);for(i=0;i<e.length&&h>0;i++)(l=df.dom.query(e[i],"div.WebCrumb_Caption",!1)).offsetWidth>15&&(h=h+15-l.offsetWidth,l.style.width="15px");return h>0?h:0},adjustWidths:function(){var e,t,i,s;this._eList&&this._eList.hasChildNodes()&&(e=this.sumElementWidths(df.dom.query(this._eList,"li",!0)),this._eList.clientWidth<e&&((s=this._eList.getElementsByClassName("WebCrumb_Item")).length>0?(t=this._eList.clientWidth-this._eList.lastChild.offsetWidth,i=this.reduceWidthsToTarget_li(s,t)):i=this._eList.lastChild.offsetWidth-this._eList.clientWidth,i>0&&(s=this._eList.getElementsByClassName("WebCurrentCrumb"),t=this._eList.lastChild.offsetWidth-i-2,i=this.reduceWidthsToTarget_li(s,t))))},deserializeVT:df.sys.vt.generateDeserializer([df.tWebBreadcrumbItem]),append:function(e){this._aItems.push(e)},clear:function(){this._eList?this._eList.innerHTML="":this._eControl&&(this._eList=this.constructList(),this._eControl.appendChild(this._eList)),this._aItems=[]},redraw:function(){var e,t=null,i=this._aItems,s=[];this._eControl&&(this._bRedraw=!0,this.peBreadcrumbStyle===df.cCrumbHorizontal?(df.dom.removeClass(this._eControl,"WebCrumbs_DropDown"),df.dom.addClass(this._eControl,"WebCrumbs_Horiz")):(df.dom.removeClass(this._eControl,"WebCrumbs_Horiz"),df.dom.addClass(this._eControl,"WebCrumbs_DropDown")),this.peBreadcrumbStyle===df.cCrumbHorizontal?this._eCaption&&(this._eControl.removeChild(this._eCaption),this._eCaption=null):(this._eCaption||(t=document.createElement("div"),df.dom.addClass(t,"WebCrumb_Caption"),this._eControl.appendChild(t),this._eCaption=t),i.length?(""===i[i.length-1].sHeadCaption.trim()?s.push("&nbsp;"):(e=i[i.length-1].sHeadCaption.trim(),s.push(df.dom.encodeHtml(e))),this._eCaption.innerHTML=s.join("")):this._eCaption.innerHTML="&nbsp;",i.length>1&&this.peBreadcrumbStyle===df.cCrumbDropDown?df.dom.addClass(this._eCaption,"WebCrumb_DropDownBtn"):df.dom.removeClass(this._eCaption,"WebCrumb_DropDownBtn")),this._eList?this._eList.innerHTML="":this.peBreadcrumbStyle!==df.cCrumbCaption&&(this._eList=this.constructList(),this._eControl.appendChild(this._eList)),this.peBreadcrumbStyle!==df.cCrumbCaption&&this.constructItems(i),this._bRedraw=!1)},constructList:function(){var e=document.createElement("ul");return e.setAttribute("class","WebCrumbs"),e},constructItems:function(e){var t,i=!1,s="",o=[];for(0===e.length&&(o.push('<li class="WebCurrentCrumb">'),this.peBreadcrumbStyle===df.cCrumbHorizontal&&o.push('<div tabindex="-1">'),o.push('<div class="WebCrumb_Caption" tabindex="-1">'),o.push("&nbsp;"),o.push("</div>"),this.peBreadcrumbStyle===df.cCrumbHorizontal&&o.push("</div>"),o.push("</li>")),t=0;t<e.length;t++)t===e.length-1&&(i=!0),s=(s=i?'<li class="WebCurrentCrumb"':'<li class="WebCrumb_Item"')+' data-dfview-name="'+e[t].sViewName+'">',o.push(s),this.peBreadcrumbStyle===df.cCrumbHorizontal&&(i?o.push('<div tabindex="-1">'):o.push('<div class="WebCrumb_Arrow" tabindex="-1">')),o.push('<div class="WebCrumb_Caption" tabindex="-1">'),""===e[t].sCrumbCaption.trim()?o.push("&nbsp;"):o.push(df.dom.encodeHtml(e[t].sCrumbCaption)),o.push("</div>"),this.peBreadcrumbStyle===df.cCrumbHorizontal&&o.push("</div>"),o.push("</li>");this._eList.innerHTML=o.join("")}}),df.fpFloatByControl=1,df.fpFloatLeftSqueezeWebApp=2,df.fpFloatLeftPushWebApp=3,df.fpFloatFixed=4,df.fpFloatAbsolute=5,df.WebFloatingPanel=function(e,t){df.WebFloatingPanel.base.constructor.apply(this,arguments),this.prop(df.tInt,"piWidth",0),this.prop(df.tInt,"piHeight",0),this.prop(df.tInt,"piTop",-1),this.prop(df.tInt,"piLeft",-1),this.prop(df.tInt,"piBottom",-1),this.prop(df.tInt,"piRight",-1),this.prop(df.tInt,"piContentWidth",0),this.prop(df.tString,"psFloatByControl",""),this.prop(df.tBool,"pbHideOnBlur",!1),this.prop(df.tBool,"pbHideOnEscape",!1),this.prop(df.tBool,"pbFocusOnShow",!1),this.prop(df.tInt,"pePosition",df.fpFloatByControl),this.prop(df.tBool,"pbShrinkIfNoSpace",!1),this.prop(df.tBool,"pbNaturalWidth",!1),this.event("OnHide"),this._eMask=null,this.pbScroll=!1,this.pbVisible=!1,this._bViewVisible=!1,this._bWrapDiv=!1,this._bVisible=!1,this._bFloating=!0,this._sControlClass="WebFlPnl"},df.defineClass("df.WebFloatingPanel","df.WebBaseContainer",{create:function(){var e=this.getView();e?(e.OnAfterShow.on(this.showView,this),e.OnAfterHide.on(this.hideView,this),this._bViewVisible=e._bShown):this._bViewVisible=!0,df.WebFloatingPanel.base.create.apply(this,arguments)},destroy:function(){var e=this.getView();e&&(e.OnAfterShow.off(this.showView,this),e.OnAfterHide.off(this.hideView,this)),df.WebFloatingPanel.base.destroy.apply(this,arguments)},render:function(){var e=df.WebFloatingPanel.base.render.apply(this,arguments);return(this.topLayer()||document.body).appendChild(e),null},genClass:function(){var e=[df.WebFloatingPanel.base.genClass.call(this)];return this.pePosition===df.fpFloatByControl&&(e.push("WebFP_ArrowTop"),e.push("WebFP_FloatBy")),this.pePosition!==df.fpFloatLeftSqueezeWebApp&&this.pePosition!==df.fpFloatLeftPushWebApp||e.push("WebFP_FloatLeft"),this.pbVisible?e.push("WebFP_Visible"):e.push("WebFP_Hidden"),this.piContentWidth>0&&e.push("WebFP_FixedContentWidth"),e.join(" ")},openHtml:function(e){e.push('<div class="',this.genClass(),'" style="display: none"'),this.psHtmlId&&e.push(' id="',this.psHtmlId,'"'),e.push(' data-dfobj="',this.getLongName(),'"'),e.push(' tabindex="0" style=" ',this.pbRender?"":"display: none;",'"'),e.push(">"),e.push('<div tabindex="',this.pbHideOnBlur?"0":"-1",'" class="WebFP_FocusCatcher"></div>'),e.push('<div class="WebContainer">'),df.WebFloatingPanel.base.openHtml.apply(this,arguments)},closeHtml:function(e){df.WebFloatingPanel.base.closeHtml.apply(this,arguments),e.push("</div>"),e.push('<div tabindex="',this.pbHideOnBlur?"0":"-1",'" class="WebFP_FocusCatcher"></div>'),e.push('<div class="WebFP_Arrow"></div>'),e.push("</div>")},afterRender:function(){this._eArrow=df.dom.query(this._eElem,"div.WebFP_Arrow"),this._aFocusCatchers=df.dom.query(this._eElem,"div.WebFP_FocusCatcher",!0),df.WebFloatingPanel.base.afterRender.apply(this,arguments),df.events.addDomCaptureListener("focus",this._eElem,this.onCaptureFocus,this),df.events.addDomCaptureListener("blur",this._eElem,this.onCaptureBlur,this),df.events.addDomKeyListener(this._eElem,this.onKey,this),df.dom.on("focus",this._aFocusCatchers,this.onCatchFocus,this),this.piContentWidth>0&&(this._eSizer.style.width=this.piContentWidth+"px"),this.pbVisible&&this._bViewVisible?this.show():this.positionPnl()},show:function(){this.pbVisible=!0,this.addSync("pbVisible"),this._bViewVisible&&this.doShow()},doShow:function(){var e,t=this;this._bVisible=!0,this._eElem.style.display="",this._eElem.parentNode.lastChild!==this._eElem&&this._eElem.parentNode.appendChild(this._eElem),(this.pbHideOnBlur&&df.sys.isMobile||this.pePosition===df.fpFloatLeftPushWebApp)&&(this._eMask||(this._eMask=df.dom.create('<div class="WebMenu_Mask">&nbsp;</div>'),this._eElem.parentNode.insertBefore(this._eMask,this._eElem),df.dom.on("click",this._eMask,this.onMaskTouch,this))),this.pePosition===df.fpFloatByControl&&(e=this.getWebApp().findObj(this.psFloatByControl))&&e._eElem&&(this._eBlurBuddy=e._eElem,df.events.addDomCaptureListener("blur",e._eElem,this.onCaptureBlur,this)),this.positionPnl(),this.afterShow(),this._tHideBlurTimeout&&(clearTimeout(this._tHideBlurTimeout),this._tHideBlurTimeout=null),df.dom.removeClass(t._eElem,"WebFP_Hidden"),df.dom.addClass(t._eElem,"WebFP_Visible"),setTimeout((function(){t._eElem&&(t.positionPnl(),t.pbFocusOnShow&&(t.focus()||t._eElem.focus()))}),20),this.pePosition===df.fpFloatByControl&&(this._tPositionInterval=setInterval((function(){t.positionPnl()}),500))},getFloatByRefElem:function(){var e,t=null;return(e=this.getWebApp().findObj(this.psFloatByControl))&&(t=e._eElem,e.getTooltipElem&&(t=e.getTooltipElem()||t)),t},positionPnl:function(){var e,t,i,s,o,n,r,a,l,h=0,d=0,p=-1,u=0,f=!0;if(this._bVisible&&this._eElem){if(a=this.getWebApp(),o=this.piWidth,n=this.piHeight,i=df.dom.windowWidth(),s=df.dom.windowHeight(),n>(r=this._eElem.offsetHeight)&&(r=n),l=this._eElem.offsetWidth,this.pePosition===df.fpFloatByControl){if(this.psFloatByControl)if(t=this.getFloatByRefElem()){if(e=df.sys.gui.getBoundRect(t),o<=0&&!this.pbNaturalWidth&&(o=e.width),h=e.bottom,(d=e.left+e.width/2-(this.pbNaturalWidth?l:o)/2)<5&&(d=5),u=e.left+e.width/2-d,!(e.top||e.left||e.width||e.height))return}else h=this.piTop,d=this.piLeft;o>i-20&&(o=i-20),d+o>i&&(d=-1,p=10,u=o-(i-e.right+e.width/2-p)),h+r>s&&(this.pbShrinkIfNoSpace||e&&(h=Math.max(0,e.top-r),f=!1),h+n>s&&(n>0?n=s-h-30:h=s-n>0?s-n:0)),this._eElem.style.top=h+"px",this._eElem.style.left=d>=0?d+"px":"",this._eElem.style.right=p>=0?p+"px":"",this._eArrow.style.left=u+"px",this.setOuterWidth(o),n>0?(this._eContainer.style.height=n+"px",this._eElem.style.maxHeight=""):(n=s-h-30,this._eContainer.style.height="",this._eElem.style.maxHeight=n+"px"),df.dom.toggleClass(this._eElem,"WebFP_ArrowTop",f),df.dom.toggleClass(this._eElem,"WebFP_ArrowBottom",!f)}this.pePosition!==df.fpFloatLeftSqueezeWebApp&&this.pePosition!==df.fpFloatLeftPushWebApp||(this._eElem.style.top=df.Designer?"17px":"0px",this._eElem.style.left="0px",this._eElem.style.bottom="0px",this._eElem.style.position="fixed",this._eContainer.style.height="100%",this.setOuterWidth(this.pbVisible&&this.pbRender?this.piWidth:0),a&&a._eElem&&(this.pePosition===df.fpFloatLeftSqueezeWebApp?a._eElem.style.marginLeft=(this.pbVisible&&this.pbRender?this.piWidth:0)+"px":(a._eElem.parentNode.style.overflow="hidden",a._eElem.style.transform="translateX("+(this.pbVisible&&this.pbRender?this.piWidth:0)+"px)"))),this.pePosition===df.fpFloatFixed&&(this._eElem.style.top=this.piTop>=0?this.piTop+"px":"",this._eElem.style.left=this.piLeft>=0?this.piLeft+"px":"",this._eElem.style.bottom=this.piBottom>=0?this.piBottom+"px":"",this._eElem.style.right=this.piRight>=0?this.piRight+"px":"",o>=0&&(this.pbShrinkIfNoSpace&&o+Math.max(this.piLeft,0)+Math.max(this.piRight,0)>i&&(o=i-Math.max(this.piLeft,0)-Math.max(this.piRight,0)),this.setOuterWidth(o)),(n>=0||this.piBottom>=0&&this.piTop>=0)&&(this._eContainer.style.height="100%"),n>=0&&(this.pbShrinkIfNoSpace&&n+Math.max(this.piTop,0)+Math.max(this.piBottom,0)>s&&(n=s-Math.max(this.piTop,0)-Math.max(this.piBottom,0)),this._eElem.style.height=n+"px",this._eElem.style.maxHeight=""))}else this._eElem&&(this._eElem.style.top="0px",this._eElem.style.left="0px",this._eElem.style.bottom="",this._eElem.style.right="",this._eElem.style.height="",this._eElem.style.maxHeight="");this.resizeHorizontal(),df.WebFloatingPanel.base.resizeVertical.call(this)},setInnerHeight:function(e){e>df.dom.clientHeight(this._eContainer)&&(e=df.dom.clientHeight(this._eContainer)),df.WebFloatingPanel.base.setInnerHeight.call(this,e)},set_piHeight:function(e){df.WebFloatingPanel.base.set_piHeight.call(this,e),this._eElem&&(this.piHeight=e,this.positionPnl())},set_piWidth:function(e){var t=this.getWebApp();this._eElem&&(this.setOuterWidth(e),this.pePosition===df.fpFloatLeftSqueezeWebApp&&this.pbVisible&&this.pbRender&&t&&t._eElem&&(t._eElem.style.marginLeft=e+"px"))},set_pbVisible:function(e){this._eElem&&this.pbVisible!==e&&(e?this.show():this.hide(!1,"manual"))},set_pbRender:function(e){this._eElem&&this.pbRender!==e&&(df.WebFloatingPanel.base.set_pbRender.call(this,e),this.pbRender=e,e&&this.pbVisible?this.show():this.hide(!1,"manual"))},set_pePosition:function(e){var t;this._eElem&&this.pePosition!==e&&((t=this.getWebApp())&&t._eElem&&(e!==df.fpFloatLeftSqueezeWebApp&&this.pePosition===df.fpFloatLeftSqueezeWebApp&&(t._eElem.style.marginLeft=""),e!==df.fpFloatLeftPushWebApp&&this.pePosition===df.fpFloatLeftPushWebApp&&(t._eElem.parentNode.style.overflow="",t._eElem.style.transform="",this._eMask&&(df.dom.off("click",this._eMask,this.onMaskTouch,this),this._eMask.parentNode.removeChild(this._eMask),this._eMask=null))),this.pePosition=e,this.positionPnl())},set_piContentWidth:function(e){this._eContainer&&(this._eSizer.style.width=e+"px",df.dom.toggleClass(this._eElem,"WebFP_FixedContentWidth",e>0))},set_pbHideOnBlur:function(e){this._aFocusCatchers&&this._aFocusCatchers.forEach((function(t){df.dom.setTabIndex(t,e?0:-1)}))},hide:function(e,t){this.pbVisible=!1,this.addSync("pbVisible"),this.doHide(e,t||"manual")},doHide:function(e,t){var i=this,s=this.getWebApp();this._tPositionInterval&&(clearInterval(this._tPositionInterval),this._tPositionInterval=null),df.dom.addClass(i._eElem,"WebFP_Hidden"),df.dom.removeClass(i._eElem,"WebFP_Visible"),e||this.positionPnl(),this.afterHide(),this._eMask&&(df.dom.off("click",this._eMask,this.onMaskTouch,this),this._eMask.parentNode.removeChild(this._eMask),this._eMask=null),this._eBlurBuddy&&df.events.removeDomCaptureListener("blur",this._eBlurBuddy,this.onCaptureBlur,this),this.pePosition===df.fpFloatLeftSqueezeWebApp&&s&&s._eElem&&(s._eElem.style.marginLeft="0px"),this.fire("OnHide",[t]),setTimeout((function(){!i.pbVisible&&i._eElem&&(i._eElem.style.display="none",i._bVisible=!1)}),1500)},showView:function(e){this._bViewVisible=!0,this.pbVisible&&this._eElem&&this.doShow()},hideView:function(e){this._bViewVisible=!1,this.pbVisible&&this.doHide(!0,"auto_view")},onCaptureFocus:function(e){this._tHideBlurTimeout&&(clearTimeout(this._tHideBlurTimeout),this._tHideBlurTimeout=null)},onCaptureBlur:function(e){var t=this;this._tHideBlurTimeout&&clearTimeout(this._tHideBlurTimeout),this._tHideBlurTimeout=setTimeout((function(){t.pbHideOnBlur&&t.hide(!0,"auto_blur"),t._tHideBlurTimeout=null}),150)},onMaskTouch:function(e){this.pbHideOnBlur&&this.hide(!1,"auto_blur")},resizeVertical:function(){this.positionPnl(),df.WebFloatingPanel.base.resizeVertical.call(this)},resize:function(){this._eElem&&this.positionPnl()},onKey:function(e){e.matchKey(df.settings.calendarKeys.close)&&this._bVisible&&(this.hide(!0,"auto_escape"),e.stop())},onCatchFocus:function(e){this.pbHideOnBlur&&this.hide(!1,"auto_tabout")}}),df.WebMenuButton=function(e,t){df.WebMenuButton.base.constructor.apply(this,arguments),this.prop(df.tBool,"pbRenderAsAnchor",!0),this.prop(df.tBool,"pbHideOnBlur",!0),this.prop(df.tString,"psCaption",""),this.prop(df.tInt,"piMenuWidth",300),this.prop(df.tInt,"piMenuHeight",0),this.prop(df.tString,"psMenuCSSClass",""),this.prop(df.tString,"psMenuRootCaption",""),this.prop(df.tBool,"pbMenuShowCaption",!0),this.prop(df.tBool,"pbMenuShowIcons",!1),this.prop(df.tString,"psGroupName",""),this.prop(df.tBool,"pbOpenOnRoot",!1),this.pbShowLabel=!1,this._oPnl=null,this._oMenuList=null,this._sRealgroupName="",this._bIsMenu=!0,this._sControlClass="WebMenuButton"},df.defineClass("df.WebMenuButton","df.WebBaseMenu",{create:function(){this._sRealgroupName=this.psGroupName,this.psGroupName||(this.psGroupName="_WebMenuButtonGrp_"+df.dom.genDomId().toString()),df.WebMenuButton.base.create.apply(this,arguments)},openHtml:function(e){this.pbRenderAsAnchor?this._sControlClass="WebMenuAnchor":this._sControlClass+=" WebButton",df.WebMenuButton.base.openHtml.apply(this,arguments),this.pbRenderAsAnchor?e.push('<a id="',this._sControlId,'" href="javascript:void(0);" target="_self"',this.isEnabled()?"":' tabindex="-1"',"></a>"):e.push('<button id="',this._sControlId,'"',this.isEnabled()?"":' disabled="disabled"',"></button>")},afterRender:function(){this._eControl=df.dom.query(this._eElem,"button, a"),df.WebMenuButton.base.afterRender.call(this),df.dom.on("click",this._eControl,this.onBtnClick,this),df.events.addDomKeyListener(this._eElem,this.onKey,this),this.set_psCaption(this.psCaption)},onBtnClick:function(e){this.isEnabled()&&(this._oPnl&&this._oPnl.pbVisible?this.hideMenu():this.showMenu(),e.stop())},showMenu:function(){var e,t,i;this._oPnl?this.pbOpenOnRoot&&this._oMenuList.collapseAll():((e=this._oPnl=new df.WebFloatingPanel(null,this)).psFloatByControl=this.getLongName(),e.piWidth=this.piMenuWidth||150,e.piColumnCount=1,e.psCSSClass="WebMBPanel "+this.psMenuCSSClass,e.pbHideOnBlur=this.pbHideOnBlur,e.piHeight=this.piMenuHeight,e.create(),(t=this._oMenuList=new df.WebMenuList(null,this))._oMenuBtn=this,t.psGroupName=this.psGroupName,t.pbFillHeight=this.piMenuHeight>0,t.pbShowCaption=this.pbMenuShowCaption,t.pbShowIcons=this.pbMenuShowIcons,t.psRootCaption=this.psMenuRootCaption,t.pbAllowHtml=this.pbAllowHtml,t.create(),e.addChild(t),(i=e.render())&&this._eElem.parentNode.insertBefore(i,this._eElem),e.afterRender(),e.resizeHorizontal(),e.resizeVertical()),this._oPnl.show()},hideMenu:function(){this._oPnl.hide()},collapseAll:function(){this._oMenuList?.collapseAll()},levelUp:function(){this._oMenuList?.levelUp()},set_psCaption:function(e){this._eControl&&(e?df.dom.setText(this._eControl,e):this._eControl.innerHTML="")},set_psGroupName:function(e){return this._sRealgroupName=e,e||(e=this.psGroupName="_WebMenuButtonGrp_"+df.dom.genDomId().toString()),this._oMenuList&&this._oMenuList.set("psGroupName",e),df.WebMenuButton.base.set_psGroupName.call(this,e),!1},get_psGroupName:function(){return this._sRealgroupName},set_pbMenuShowCaption:function(e){this._oMenuList&&this._oMenuList.set("pbShowCaption",e)},set_pbMenuShowIcons:function(e){this._oMenuList&&this._oMenuList.set("pbShowIcons",e)},set_psMenuRootCaption:function(e){this._oMenuList&&this._oMenuList.set("psRootCaption",e)},set_psMenuCSSClass:function(e){this._oPnl&&this._oPnl.set("psCSSClass","WebMBPanel "+e)},set_piMenuWidth:function(e){this._oPnl&&this._oPnl.set("piWidth",e)},set_piMenuHeight:function(e){this._oPnl&&(this._oMenuList.set("pbFillHeight",e>0),this._oPnl.set("piHeight",e))},set_pbHideOnBlur:function(e){this._oPnl&&this._oPnl.set("pbHideOnBlur",e)},set_pbAllowHtml:function(e){this._oMenuList&&this._oMenuList.set("pbAllowHtml",e)},applyEnabled:function(e){df.WebMenuButton.base.applyEnabled.call(this,e),this._eControl&&(this._eControl.disabled=!e)},onKey:function(e){e.matchKey(df.settings.formKeys.submit)&&e.stopPropagation()},resize:function(){this._oPnl&&this._oPnl.resize()},destroy:function(){this._oPnl&&this._oPnl.destroy(),df.WebMenuButton.base.destroy.call(this)}}),df.WebMenuList=function(e,t){df.WebMenuList.base.constructor.apply(this,arguments),this.prop(df.tString,"psRootCaption",""),this.prop(df.tBool,"pbShowCaption",!0),this.prop(df.tBool,"pbShowBackItem",!0),this.prop(df.tBool,"pbShowIcons",!1),this._sCurrentMenu="",this._eCurrentMenu=null,this._oMenuBtn=null,this._bIsMenuListener=!0,this.pbShowLabel=!1,this._bRenderChildren=!1,this._sControlClass="WebMenuList"},df.defineClass("df.WebMenuList","df.WebBaseMenu",{openHtml:function(e){var t;df.WebMenuList.base.openHtml.apply(this,arguments),e.push('<div class="WebMenuWrp" tabindex="0">','<div class="WebML_Title"',this.pbShowCaption?"":' style="display: none"',">",'<span class="WebML_Caption">',this.psRootCaption,"</span>","</div>",'<div class="WebML_Panel',this.pbShowIcons?" WebML_ShowIcons":"",'">','<div class="WebML_Mnu WebML_Root WebML_Current" data-dfmenu-path="">'),t=this.getMenu(),this.genMenuHtml(e,t,!1),e.push("</div>","</div>")},closeHtml:function(e){e.push("</div>"),df.WebMenuList.base.closeHtml.apply(this,arguments)},afterRender:function(){var e,t;this._eControl=df.dom.query(this._eElem,"div.WebMenuWrp"),this._eMenuPanel=t=df.dom.query(this._eElem,"div.WebML_Panel"),this._eMenuTitle=df.dom.query(this._eElem,"div.WebML_Title"),this._eMenuCaption=df.dom.query(this._eElem,"span.WebML_Caption"),e=this._eCurrentMenu=df.dom.query(t,"div.WebML_Mnu"),df.WebMenuList.base.afterRender.apply(this,arguments),df.dom.on("click",t,this.onMenuClick,this),this.piHeight<=0&&!this.pbFillHeight&&df.dom.animFrame((function(){e.firstChild&&(t.style.height=this.getMenuHeight(this._eCurrentMenu)+"px",this.sizeChanged())}),this),this.notifyMenuRendered(this.getMenu())},genMenuHtml:function(e,t,i){var s,o,n;for(e.push("<ul>"),i&&this.pbShowBackItem&&e.push('<li class="WebML_Item WebML_Back" data-df-path="go-back"><a href="javascript:void(0);" target="_self">',this.getWebApp().getTrans("back"),"</a></li>"),s=0;s<t.length;s++)o=["WebML_Item",(n=t[s]).sCSSClass,n.bEnabled?df.CssEnabled:df.CssDisabled],n.aChildren.length>0&&o.push("WebML_HasSub"),n.bBeginGroup&&e.push('<li class="WebML_Divider">',n.sGroupCaption||"","</li>"),this.genItemHtml(e,n,!1);e.push("</ul>")},onMenuClick:function(e){for(var t,i,s,o,n=null,r=e.getTarget(),a=this;!t&&r&&r!==this._eElem;)if(r.hasAttribute("data-df-path")){if("go-back"===(n=r.getAttribute("data-df-path")))return this.levelUp(),void e.stop();t=this.getItemByPath(n)}else r=r.parentNode;t&&(t.bEnabled&&(t.aChildren.length>0&&((i=df.dom.query(this._eMenuPanel,'div.WebML_Mnu[data-dfmenu-path="'+t._sPath+'"]'))||((o=[]).push('<div class="WebML_Mnu WebML_HiddenSub" data-dfmenu-path="',t._sPath,'">'),this.genMenuHtml(o,t.aChildren,!0),o.push("</div>"),i=df.dom.create(o.join("")),this._eMenuPanel.appendChild(i),this.notifyMenuRendered(t.aChildren,i)),s=this._eCurrentMenu,df.dom.setText(this._eMenuCaption,t.sCaption),setTimeout((function(){s&&(df.dom.addClass(s,"WebML_HiddenParent"),df.dom.removeClass(s,"WebML_Current")),df.dom.addClass(i,"WebML_Current"),df.dom.removeClass(i,"WebML_HiddenSub"),a.OnUiUpdate.fire(this,{bUiDriven:!0}),a.updateMenuSize()}),20),this._sCurrentMenu=t._sPath,this._eCurrentMenu=i),t._oHandler.itemClick(t,(function(e){!e||!this._oMenuBtn||t.hRef instanceof df.WebMenuItemCheckbox||t.aChildren.length||this._oMenuBtn.hideMenu()}),this)),e.stop())},expandItem:function(e){e.aChildren.length>0?this._sCurrentMenu=e._sPath:this._sCurrentMenu="",this.refreshMenu(),this.OnUiUpdate.fire(this,{bUiDriven:!0})},showItem:function(e){var t=this.getItemByPath(e._sPath.substr(0,e._sPath.lastIndexOf(".")));t?this.expandItem(t):(this._sCurrentMenu="",this.refreshMenu())},collapseAll:function(){this._sCurrentMenu="",this.refreshMenu(),this.OnUiUpdate.fire(this,{bUiDriven:!0})},levelUp:function(){var e,t,i,s,o=null,n=this;this._sCurrentMenu&&(this._sCurrentMenu.indexOf(".")>0&&(this._sCurrentMenu=this._sCurrentMenu.substr(0,this._sCurrentMenu.lastIndexOf(".")),o=this.getItemByPath(this._sCurrentMenu)),o?i=o.aChildren:(this._sCurrentMenu="",i=this.getMenu()),(e=df.dom.query(this._eMenuPanel,'div.WebML_Mnu[data-dfmenu-path="'+this._sCurrentMenu+'"]'))||((s=[]).push('<div class="WebML_Mnu WebML_HiddenParent',i===this.getMenu()?" WebML_Root":"",'" data-dfmenu-path="',this._sCurrentMenu,'">'),this.genMenuHtml(s,i,!!this._sCurrentMenu),s.push("</div>"),e=df.dom.create(s.join("")),this._eMenuPanel.appendChild(e),this.notifyMenuRendered(i,e)),t=this._eCurrentMenu,o?df.dom.setText(this._eMenuCaption,o.sCaption):df.dom.setText(this._eMenuCaption,this.psRootCaption),setTimeout((function(){t&&(df.dom.addClass(t,"WebML_HiddenSub"),df.dom.removeClass(t,"WebML_Current")),df.dom.addClass(e,"WebML_Current"),df.dom.removeClass(e,"WebML_HiddenParent"),n.OnUiUpdate.fire(this,{bUiDriven:!0}),n.updateMenuSize()}),20),this._eCurrentMenu=e)},refreshMenu:function(){var e,t,i,s=[];this._eMenuPanel&&(this._sCurrentMenu&&(e=this.getItemByPath(this._sCurrentMenu)),e?t=e.aChildren:(this._sCurrentMenu="",t=this.getMenu()),s.push('<div class="WebML_Mnu WebML_Current',t===this.getMenu()?" WebML_Root":"",'" data-dfmenu-path="',this._sCurrentMenu,'">'),this.genMenuHtml(s,t,!!this._sCurrentMenu),s.push("</div>"),this._eMenuPanel.innerHTML=s.join(""),i=this._eMenuPanel.firstChild,this.notifyMenuRendered(t,i),e?df.dom.setText(this._eMenuCaption,e.sCaption):df.dom.setText(this._eMenuCaption,this.psRootCaption),this._eCurrentMenu=i,this.updateMenuSize())},updateMenuSize:function(e){var t;!this.pbFillHeight&&this.piHeight<=0&&this._eCurrentMenu&&(t=this.getMenuHeight(this._eCurrentMenu),this._eMenuPanel.style.height=t+"px",e||this.sizeChanged(),df.dom.animFrame((function(){var e;this._eCurrentMenu&&(e=this.getMenuHeight(this._eCurrentMenu))!==t&&(this._eMenuPanel.style.height=e+"px",this.sizeChanged())}),this))},setHeight:function(e){this._eMenuPanel&&(df.dom.toggleClass(this._eMenuPanel,"WebML_NoScollRoot",e<=0),e<=0&&this._eCurrentMenu?this._eMenuPanel.style.height=this.getMenuHeight(this._eCurrentMenu)+"px":(e<=80&&(e=80),e=(e-=this.getVertHeightDiff())<0?0:e,this._eMenuPanel.style.height=e+"px"))},getVertHeightDiff:function(){var e=df.WebMenuList.base.getVertHeightDiff.call(this);return e+=this._eMenuTitle?.offsetHeight,e+=df.sys.gui.getVertBoxDiff(this._eMenuPanel)},getMenuHeight:function(e){var t=e.firstChild.offsetHeight;return t+=df.sys.gui.getVertBoxDiff(e)},resize:function(){this.updateMenuSize(!0),df.WebMenuList.base.resize.call(this)},set_pbShowIcons:function(e){this._eMenuPanel&&df.dom.toggleClass(this._eMenuPanel,"WebML_ShowIcons",e)},set_psRootCaption:function(e){this.psRootCaption=e,this.refreshMenu()},set_pbShowBackItem:function(e){this.pbShowBackItem=e,this.refreshMenu()},set_pbShowCaption:function(e){this._eMenuTitle&&(this._eMenuTitle.style.display=e?"":"none")}}),df.colorFormatHex=1,df.colorFormatRGB=2,df.settings.colorPickKeys={colorUp:{iKeyCode:38,bCtrl:!1,bShift:!1,bAlt:!1},colorDown:{iKeyCode:40,bCtrl:!1,bShift:!1,bAlt:!1},colorLeft:{iKeyCode:37,bCtrl:!1,bShift:!1,bAlt:!1},colorRight:{iKeyCode:39,bCtrl:!1,bShift:!1,bAlt:!1},sliderUp:{iKeyCode:33,bCtrl:!1,bShift:!1,bAlt:!1},sliderDown:{iKeyCode:34,bCtrl:!1,bShift:!1,bAlt:!1},enter:{iKeyCode:13,bCtrl:!1,bShift:!1,bAlt:!1}},df.tWebColorPaletteItem={sColor:df.tString,sDescription:df.tString},df.WebColorPicker=function(e,t){df.WebColorPicker.base.constructor.apply(this,arguments),this.prop(df.tBool,"pbShowColorBar",!0),this.prop(df.tInt,"peColorFormat",df.colorFormatHex),this.prop(df.tInt,"piPaletteItemsPerRow",6),this.prop(df.tString,"psValue","#A53D40"),this.addSync("psValue"),this.event("OnChange"),this.OnRealtimeChange=new df.events.JSHandler,this.OnEnter=new df.events.JSHandler,this._tDoubleClick=null,this._iDoubleClickWait=800,this._aHSV=[0,0,0],this._aColorPalette=[],this._sControlClass="WebColorPicker"},df.defineClass("df.WebColorPicker","df.WebBaseControl",{create:function(e){df.WebColorPicker.base.create.apply(this,arguments),this.set_psValue(this.psValue)},openHtml:function(e){var t=["WebCP_Main"];df.WebColorPicker.base.openHtml.call(this,e),this.pbShowColorBar&&t.push("WebCP_ShowColorBar"),this._aColorPalette.length>0&&t.push("WebCP_ShowPalette"),e.push('<div class="',t.join(" "),'" tabindex="0">','<div class="WebCP_ColorPalette">'),this.genColorPaletteHtml(e),e.push("</div>",'<div class="WebCP_Picker">','<div class="WebCP_ColorMap">','<canvas width="0" height="0"></canvas>','<div class="WebCP_Pointer"></div>',"</div>",'<div class="WebCP_GradSlider">','<canvas width="0" height="0"></canvas>','<div class="WebCP_Slide"></div>',"</div>","</div>",'<div class="WebCP_ColorBar"></div>',"<div>")},closeHtml:function(e){df.WebColorPicker.base.closeHtml.call(this,e)},afterRender:function(){this._eFocus=this._eControl=df.dom.query(this._eElem,".WebCP_Main"),this._ePicker=df.dom.query(this._eElem,".WebCP_Picker"),this._eColorPalette=df.dom.query(this._eElem,".WebCP_ColorPalette"),this._eColorMap=df.dom.query(this._eElem,".WebCP_ColorMap"),this._eMapCanvas=df.dom.query(this._eElem,".WebCP_ColorMap canvas"),this._ePointer=df.dom.query(this._eElem,".WebCP_Pointer"),this._eGradSlider=df.dom.query(this._eElem,".WebCP_GradSlider"),this._eSliderCanvas=df.dom.query(this._eElem,".WebCP_GradSlider canvas"),this._eSlide=df.dom.query(this._eElem,".WebCP_Slide"),this._eColorBar=df.dom.query(this._eElem,".WebCP_ColorBar"),df.WebColorPicker.base.afterRender.call(this),df.dom.on("mousedown",this._eColorMap,this.startMapMouse,this),df.dom.on("mousedown",this._eGradSlider,this.startSliderMouse,this),df.dom.on("click",this._eColorPalette,this.onPaletteClick,this),df.dom.on("dblclick",this._eColorPalette,this.onPaletteDblClick,this),df.events.addDomKeyListener(this._eFocus,this.onKey,this),df.events.addDomMouseWheelListener(this._eFocus,this.onMouseWheelScroll,this),this._eColorBar.style.backgroundColor=this.psValue,df.dom.setText(this._eColorBar,this.psValue)},resize:function(){var e=0;this._aColorPalette.length>0&&(e+=this._eColorPalette.offsetHeight),this._ePicker.style.top=e+"px",df.WebColorPicker.base.resize.call(this),this._eControl.clientHeight&&(this._eMapCanvas.width===this._eColorMap.clientWidth&&this._eMapCanvas.height===this._eColorMap.clientHeight||(this.drawColorMap(),this.positionPointer()),this._eSliderCanvas.width===this._eGradSlider.clientWidth&&this._eSliderCanvas.height===this._eGradSlider.clientHeight||this.drawGradientSlider())},drawColorMap:function(){var e,t,i,s=this._eMapCanvas;s.width=this._eColorMap.clientWidth,s.height=this._eColorMap.clientHeight,this._mainctx||(this._mainctx=s.getContext("2d")),(e=this._mainctx).clearRect(0,0,s.width,s.height),(t=e.createLinearGradient(0,0,s.width,0)).addColorStop(0,"#F00"),t.addColorStop(1/6,"#FF0"),t.addColorStop(2/6,"#0F0"),t.addColorStop(.5,"#0FF"),t.addColorStop(4/6,"#00F"),t.addColorStop(5/6,"#F0F"),t.addColorStop(1,"#F00"),e.fillStyle=t,e.fillRect(0,0,s.width,s.height),(i=e.createLinearGradient(0,0,0,s.height)).addColorStop(0,"rgba(255,255,255,0)"),i.addColorStop(1,"rgba(255,255,255,1)"),e.fillStyle=i,e.fillRect(0,0,s.width,s.height)},positionPointer:function(){var e=0,t=0,i=this.getHSV();e=i[0]*this._eMapCanvas.width,t=(1-i[1])*this._eMapCanvas.height,e-=this._ePointer.offsetWidth/2,t-=this._ePointer.offsetHeight/2,this._ePointer.style.left=Math.round(e)+"px",this._ePointer.style.top=Math.round(t)+"px"},drawGradientSlider:function(){var e,t,i,s,o=this._eSliderCanvas;o.width=this._eGradSlider.clientWidth,o.height=this._eGradSlider.clientHeight,this._sliderctx||(this._sliderctx=o.getContext("2d")),(e=this._sliderctx).clearRect(0,0,o.width,o.height),(i=this.getHSV())[2]=1,s=this.HSVtoRGB(i),(t=e.createLinearGradient(0,0,0,o.height)).addColorStop(0,this.RGBtoHexString(s)),t.addColorStop(1,"#000000"),e.fillStyle=t,e.fillRect(0,0,o.width,o.height),this.positionSlider()},positionSlider:function(){var e=0;e=(1-this.getHSV()[2])*this._eSliderCanvas.height,e-=Math.round(this._eSlide.offsetHeight/2),this._eSlide.style.top=e+"px"},addPaletteItem:function(e,t){var i=[];this._aColorPalette.push({sColor:e,sDescription:t}),this._eElem&&(this.genColorPaletteHtml(i),this._eColorPalette.innerHTML=i.join(""),this.sizeChanged())},updatePalette:function(){var e=[];this._aColorPalette=this.deserializeVT(this._tActionData),this._eElem&&(this.genColorPaletteHtml(e),this._eColorPalette.innerHTML=e.join(""),df.dom.toggleClass(this._eControl,"WebCP_ShowPalette",this._aColorPalette.length>0),this.sizeChanged())},genColorPaletteHtml:function(e){var t,i,s=this._aColorPalette;if(s.length>0){for(e.push('<table class="WebCP_Palette"><colgroup>'),t=0;t<this.piPaletteItemsPerRow;t++)e.push('<col style="width: ',Math.floor(1e3/this.piPaletteItemsPerRow)/10,'%">');for(e.push("</colgroup><tr>"),t=0;t<s.length;t++)i=this.RGBtoHexString(this.stringToRGB(s[t].sColor)),t%this.piPaletteItemsPerRow==0&&t>0&&e.push("</tr><tr>"),e.push('<td class="WebCP_PalColor" style="background-color: ',i,'" data-palcolor="',i,'" title="',s[t].sDescription,'"></td>');e.push("</tr></table>")}},onPaletteClick:function(e){var t,i=e.getTarget(),s=this.psValue;if(this.isEnabled())for(;i&&i!==this._eColorPalette;){if(i.hasAttribute("data-palcolor"))return t=this.RGBtoHSV(this.stringToRGB(i.getAttribute("data-palcolor"))),this.setHSV(t),void this.OnRealtimeChange.fire(this,{sColor:this.psValue,sPrevColor:s});i=i.parentNode}},onPaletteDblClick:function(e){var t,i=e.getTarget();if(this.isEnabled())for(;i&&i!==this._eColorPalette;){if(i.hasAttribute("data-palcolor"))return t=this.RGBtoHSV(this.stringToRGB(i.getAttribute("data-palcolor"))),this.setHSV(t),this.OnEnter.fire(this,{sColor:this.psValue}),void e.stop();i=i.parentNode}},startMapMouse:function(e){var t,i,s,o,n=this.getHSV(),r=this;if(this.isEnabled()){if(this._tDoubleClick)return this.OnEnter.fire(this,{sColor:this.psValue}),clearTimeout(this._tDoubleClick),this._tDoubleClick=null,void e.stop();this._tDoubleClick=setTimeout((function(){r._tDoubleClick=null}),this._iDoubleClickWait),(t=df.gui.dragMask(this.topLayer()||document.body)).style.cursor="crosshair",i=df.sys.gui.getBoundRect(this._eMapCanvas),s=e.getMouseX()-i.left,o=e.getMouseY()-i.top,df.dom.on("mousemove",t,l,this),df.dom.on("mouseup",window,h,this),df.dom.on("mouseup",t,h,this),e.stop(),a.call(this)}function a(){var e=this.psValue;n[0]=s/i.width,n[1]=1-o/i.height,this.setHSV(n,!0),this.OnRealtimeChange.fire(this,{sColor:this.psValue,sPrevColor:e})}function l(e){s=Math.min(Math.max(e.getMouseX()-i.left,0),i.width),o=Math.min(Math.max(e.getMouseY()-i.top,0),i.height),a.call(this)}function h(e){this.fire("OnChange",[this.psValue]),this.focus(),df.dom.off("mouseup",t,h,this),df.dom.off("mouseup",window,h,this),df.dom.off("mousemove",t,l,this),t&&t.parentNode&&t.parentNode.removeChild(t)}},startSliderMouse:function(e){var t,i,s,o=this.getHSV(),n=this;if(this.isEnabled()){if(this._tDoubleClick)return this.OnEnter.fire(this,{sColor:this.psValue}),clearTimeout(this._tDoubleClick),void(this._tDoubleClick=null);this._tDoubleClick=setTimeout((function(){n._tDoubleClick=null}),this._iDoubleClickWait),(t=df.gui.dragMask(this.topLayer()||document.body)).style.cursor="n-resize",i=df.sys.gui.getBoundRect(this._eSliderCanvas),s=e.getMouseY()-i.top,df.dom.on("mousemove",t,a,this),df.dom.on("mouseup",window,l,this),df.dom.on("mouseup",t,l,this),e.stop(),r.call(this)}function r(){var e=this.psValue;o[2]=1-s/i.height,this.setHSV(o,!1),this.OnRealtimeChange.fire(this,{sColor:this.psValue,sPrevColor:e})}function a(e){s=Math.min(Math.max(e.getMouseY()-i.top,0),i.height),r.call(this)}function l(e){this.fire("OnChange",[this.psValue]),this.focus(),df.dom.off("mouseup",t,l,this),df.dom.off("mouseup",window,l,this),df.dom.off("mousemove",t,a,this),t&&t.parentNode&&t.parentNode.removeChild(t)}},adjustColor:function(e,t){var i=this.getHSV(),s=this.psColor;i[e]=Math.max(0,Math.min(1,i[e]+t/20)),this.setHSV(i,2!==e),this.OnRealtimeChange.fire(this,{sColor:this.psValue,sPrevColor:s}),this.fire("OnChange",[this.psValue])},onMouseWheelScroll:function(e){var t=e.getMouseWheelDelta();this.isEnabled()&&(t>0?this.adjustColor(2,1):t<0&&this.adjustColor(2,-1),e.stop())},onKey:function(e){this._dSelected,this.isEnabled()&&(e.matchKey(df.settings.colorPickKeys.colorUp)?(this.adjustColor(1,1),e.stop()):e.matchKey(df.settings.colorPickKeys.colorDown)?(this.adjustColor(1,-1),e.stop()):e.matchKey(df.settings.colorPickKeys.colorLeft)?(this.adjustColor(0,-1),e.stop()):e.matchKey(df.settings.colorPickKeys.colorRight)?(this.adjustColor(0,1),e.stop()):e.matchKey(df.settings.colorPickKeys.sliderUp)?(this.adjustColor(2,1),e.stop()):e.matchKey(df.settings.colorPickKeys.sliderDown)?(this.adjustColor(2,-1),e.stop()):e.matchKey(df.settings.colorPickKeys.enter)&&this.OnEnter.fire(this,{sColor:this.psValue}))},set_psValue:function(e){var t,i;i=this.stringToRGB(e),t=this.RGBtoHSV(i),this._aHSV[0]===t[0]&&this._aHSV[1]===t[1]&&this._aHSV[2]===t[2]||this.setHSV(t,!0)},set_pbShowColorBar:function(e){this._eColorBar&&(df.dom.toggleClass(this._eControl,"WebCP_ShowColorBar",e),this.drawColorMap(),this.drawGradientSlider())},getHSV:function(){return this._aHSV.slice()},setHSV:function(e,t){var i;this._aHSV=e,i=this.HSVtoRGB(e),this.peColorFormat===df.colorFormatHex?this.psValue=this.RGBtoHexString(i):this.psValue=this.RGBtoRgbString(i),this._eControl&&(this._eColorBar&&(this._eColorBar.style.backgroundColor=this.psValue,df.dom.setText(this._eColorBar,this.psValue)),this.positionPointer(),t?this.drawGradientSlider():this.positionSlider())},RGBtoHSV:function(e){var t,i,s,o,n,r,a,l,h;if(t=e[0]/255,i=e[1]/255,s=e[2]/255,r=a=Math.max(t,i,s),h=a-(l=Math.min(t,i,s)),n=0===a?0:h/a,a===l)o=0;else{switch(a){case t:o=(i-s)/h+(i<s?6:0);break;case i:o=(s-t)/h+2;break;case s:o=(t-i)/h+4}o/=6}return[o,n,r]},HSVtoRGB:function(e){var t,i,s,o,n,r,a,l,h=e[0],d=e[1],p=e[2];switch(r=p*(1-d),a=p*(1-(n=6*h-(o=Math.floor(6*h)))*d),l=p*(1-(1-n)*d),o%6){case 0:t=p,i=l,s=r;break;case 1:t=a,i=p,s=r;break;case 2:t=r,i=p,s=l;break;case 3:t=r,i=a,s=p;break;case 4:t=l,i=r,s=p;break;case 5:t=p,i=r,s=a}return[Math.round(255*t),Math.round(255*i),Math.round(255*s)]},RGBtoHexString:function(e){var t,i="#";for(t=0;t<e.length;t++)i+=df.sys.math.padZero(Math.round(e[t]).toString(16),2);return i},hexStringToRGB:function(e){return 7===e.length?[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]:4===e.length?[parseInt(e.substr(1,1)+e.substr(1,1),16),parseInt(e.substr(2,1)+e.substr(2,1),16),parseInt(e.substr(3,1)+e.substr(3,1),16)]:[0,0,0]},RGBtoRgbString:function(e){return"rgb("+e.join(",")+")"},rgbStringToRGB:function(e){var t,i;if(";"===(e=e.substr(4)).charAt(e.length-1)&&e.substr(0,e.length-1),")"===e.charAt(e.length-1)&&e.substr(0,e.length-1),3===(t=e.split(",")).length){for(i=0;i<3;i++)t[i]=Math.max(0,Math.min(255,parseInt(t[i],10)));return t}return[0,0,0]},stringToRGB:function(e){var t=[0,0,0];return"#"===e.substr(0,1)?t=this.hexStringToRGB(e):"rgb("===e.substr(0,4).toLowerCase()&&(t=this.rgbStringToRGB(e)),t},deserializeVT:df.sys.vt.generateDeserializer([df.tWebColorPaletteItem])}),df.WebColorForm=function(e,t){df.WebColorForm.base.constructor.apply(this,arguments),this.prop(df.tInt,"piPickWidth",300),this.prop(df.tInt,"piPickHeight",250),this.prop(df.tInt,"piPaletteItemsPerRow",8),this.prop(df.tInt,"peColorFormat",df.colorFormatHex),this.prop(df.tBool,"pbColorBackground",!1),this.prop(df.tBool,"pbAutoShow",!1),this.pbPromptButton=!0,this._sControlClass="WebForm WebColorForm"},df.defineClass("df.WebColorForm","df.WebForm",{afterRender:function(){df.WebColorForm.base.afterRender.call(this),df.dom.toggleClass(this._eWrap,"WebCF_ShowBox",!this.pbColorBackground),this._eColorBox=df.dom.create('<div class="WebCF_Box"></div>'),this._eWrap.insertBefore(this._eColorBox,this._eWrap.firstChild),df.dom.on("click",this._eColorBox,this.onColorClick,this),this.refreshDisplay(this._tValue)},initPicker:function(){var e,t;(e=this._oFloatingPanel=new df.WebFloatingPanel(null,this)).psFloatByControl=this.getLongName(),e.piWidth=this.piPickWidth,e.piHeight=this.piPickHeight,e.piColumnCount=1,e.pbHideOnBlur=!0,e.pbFocusOnShow=!0,e.pbHideOnEscape=!0,e.psCSSClass="NoWhitespace Shadow WebColorForm_FlPnl",e.OnHide.addListener(this.onPanelClose,this),e.create(),(t=this._oColorPicker=new df.WebColorPicker(null,this)).psValue=this.getServerVal(),t.piColumnSpan=0,t.pbFillHeight=!0,t.pbShowLabel=!1,t.pbShowColorBar=!1,t.peColorFormat=this.peColorFormat,t.psCSSClass="WebColorPicker_Form",t.piPaletteItemsPerRow=this.piPaletteItemsPerRow,t.OnRealtimeChange.addListener(this.onPickerChange,this),t.OnEnter.addListener(this.onPickerEnter,this),t.create(),e.addChild(t)},destroy:function(){this._oFloatingPanel&&this._oFloatingPanel.destroy(),df.WebColorForm.base.destroy.call(this)},renderPicker:function(){var e,t=this._oFloatingPanel;(e=t.render())&&this._eElem.parentNode.insertBefore(e,this._eElem),t.afterRender(),t.resizeHorizontal(),t.resizeVertical()},firePrompt:function(){this.showPicker()},showPicker:function(){this._oFloatingPanel||this.initPicker(),this._oFloatingPanel._eElem||this.renderPicker(),this._oColorPicker.set("psValue",this.getServerVal()),this._oFloatingPanel.show()},onColorClick:function(e){this.isEnabled()&&this.showPicker()},onPickerChange:function(e){this._tValue=e.sColor,this.refreshDisplay(e.sColor)},onPickerEnter:function(e){this._tValue=e.sColor,this.refreshDisplay(e.sColor),this._oFloatingPanel.hide(),this.focus(),this.fireChange()},onPanelClose:function(e){var t=e.aParams[0];this.fireChange(),"auto_blur"!==t&&(this._bSkipAutoShow=!0,this.focus())},onPickerClose:function(e){this._oFloatingPanel.hide()},set_pbColorBackground:function(e){this.set_psBackgroundColor(e?this.getServerVal():""),this._eWrap&&df.dom.toggleClass(this._eWrap,"WebCF_ShowBox",!e)},setControlValue:function(e){df.WebColorForm.base.setControlValue.call(this,e),this.pbColorBackground&&this.set_psBackgroundColor(e),this._eColorBox&&(this._eColorBox.style.backgroundColor=e)},set_piPickHeight:function(e){this._oFloatingPanel&&this._oFloatingPanel.set("piHeight",e)},set_piPickWidth:function(e){this._oFloatingPanel&&this._oFloatingPanel.set("piWidth",e)},set_piPaletteItemsPerRow:function(e){this._oColorPicker&&this._oColorPicker.set("piPaletteItemsPerRow",e)},addPaletteItem:function(e,t){this._oFloatingPanel||this.initPicker(),this._oColorPicker.addPaletteItem(e,t)},updatePalette:function(){this._oFloatingPanel||this.initPicker(),this._oColorPicker._tActionData=this._tActionData,this._oColorPicker.updatePalette(),this._oColorPicker._tActionData=null},onFocus:function(e){df.WebColorForm.base.onFocus.call(this,e),this.pbAutoShow&&this.isEnabled()&&!this.pbReadOnly&&!this._bSkipAutoShow&&this.showPicker(),this._bSkipAutoShow=!1}}),df.WebColumnHighlight=function(e,t){df.WebColumnHighlight.base.constructor.apply(this,arguments),this.prop(df.tString,"psHighlightCSSClass","WebHighlight"),this.prop(df.tString,"psHighlight",""),this.prop(df.tBool,"pbFullText",!0),this.prop(df.tBool,"pbSeparateWords",!0),this.prop(df.tBool,"pbCaseSensitive",!1),this._oRegEx=null},df.defineClass("df.WebColumnHighlight","df.WebColumnBase",{cellHtml:function(e,t){var i,s,o,n=this.psHighlightCSSClass;return i=df.sys.data.serverToType(t.sValue,this.peDataType),o=this.typeToDisplay(i),this.pbAllowHtml||(o=df.dom.encodeHtml(o)),this.psHighlight&&(s=this.getRegEx(),o=o.replace(s,(function(e){return'<span class="'+n+'">'+e+"</span>"}))),""!==o?o:"&nbsp;"},set_psHighlight:function(e){this.psHighlight!==e&&(this.psHighlight=e,this._oRegEx=null)},set_psHighlightCSSClass:function(e){this.psHighlightCSSClass=e,this._oParent.redraw()},set_pbFullText:function(e){this.pbFullText=e,this._oRegEx=null,this._oParent.redraw()},set_pbSeparateWords:function(e){this.pbSeparateWords=e,this._oRegEx=null,this._oParent.redraw()},set_pbCaseSensitive:function(e){this.pbCaseSensitive=e,this._oRegEx=null,this._oParent.redraw()},getRegEx:function(){var e,t,i,s;if(!this._oRegEx){for(e=this.pbSeparateWords?this.psHighlight.split(" "):[this.psHighlight],i=0;i<e.length;i++)e[i]=df.sys.data.escapeRegExp(e[i]);t="("+e.join("|")+")",this.pbFullText||(t="^"+t),s="g",this.pbCaseSensitive||(s+="i"),this._oRegEx=new RegExp(t,s)}return this._oRegEx}}),df.WebAccordionContainer=function(e,t){df.WebAccordionContainer.base.constructor.apply(this,arguments),this.prop(df.tBool,"pbOpenFirst",!0),this.prop(df.tBool,"pbAutoHeight",!0),this.prop(df.tBool,"pbMultiOpen",!1),this._sControlClass="WebAccordion",this._sCardClass="WebAC",this._bCC=!1},df.defineClass("df.WebAccordionContainer","df.WebCardContainer",{headHtml:function(e){},afterRender:function(){var e=this;df.WebAccordionContainer.base.afterRender.call(this),df.dom.on("transitionend",this._eElem,this.onTransEnd,this),this.openCardsAfterRender(),setTimeout((function(){df.dom.addClass(e._eElem,"WebAc_Rendered")}),100)},openCardsAfterRender:function(){var e,t;if(this.pbMultiOpen)for(e=0;e<this._aCards.length;e++)((t=this._aCards[e]).pbExpanded||t._bExpanded)&&this.showCard(t,!1)},renderChildren:function(e){var t,i,s,o,n,r=this.hasDynamicHeight();if(this.pbOpenFirst)for(this.psCurrentCard&&(this._oCurrent=this.getWebApp().findObj(this.psCurrentCard)),t=0;t<this._aCards.length&&!this._oCurrent;t++)this._aCards[t].isActive()&&(this._oCurrent=this._aCards[t]);for(n=this._eControl=df.dom.query(this._eElem,"div."+this._sCardClass+"_Body"),t=0;t<this._aCards.length;t++)s=[],this._aCards[t].tabButtonHtml(s),o=df.dom.create(s.join("")),n.appendChild(o),this._aCards[t].btnRendered(o),(r||this._aCards[t]===this._oCurrent)&&(i=this._aCards[t].render(),n.appendChild(i))},showCard:function(e,t){var i,s,o=this;if(this.isEnabled()||t){if(this.pbMultiOpen)e&&!t&&(e._bExpanded=!0,e._show(),e.afterShow());else if(e&&e.isActive()){if(t||e===this._oCurrent||this.fireCardChange(e._sName,this._oCurrent&&this._oCurrent._sName||""),this._eElem)for(i=0;i<this._aCards.length;i++)(s=this._aCards[i])===e?(s._show(!!t),df.dom.setText(this._eLabel,s.psCaption)):s._hide(!!t);this.pbMultiOpen||!t&&this._oCurrent&&this._oCurrent.afterHide(),this._oCurrent=e,t||this._oCurrent.afterShow(),this.getWebApp()&&this.getWebApp().notifyLayoutChange(this)}this.pbFillHeight||this.pbAutoHeight&&!this.pbMultiOpen||(this.sizeChanged(!0),setTimeout((function(){o.sizeChanged(!0)}),1e3))}},renderAllCards:function(){var e,t,i;for(e=0;e<this._aCards.length;e++)if(!(i=this._aCards[e])._eElem){if(t=i.render(),!i._eBtn)throw new df.Error(999,"Assertion: Accordion card should have a button element!");i._eBtn.nextSibling?i._eBtn.parentNode.insertBefore(t,i._eBtn.nextSibling):i._eBtn.parentNode.appendChild(t),i.afterRender()}},sizeHeight:function(e){var t=-1;if(this.pbFillHeight?t=e:this.piHeight>0&&(t=this.piHeight),t<this.piMinHeight&&(t=this.piMinHeight),this.setHeight(t),t>0)return t},setHeight:function(e){df.WebAccordionContainer.base.setHeight.call(this,e),this.pbFillHeight&&this._oCurrent&&(this._oCurrent._eElem.style.height=this.getCardHeight(this._oCurrent)+"px")},getCardHeight:function(e,t){var i;if(this.pbAutoHeight||this.pbFillHeight){if(this.piHeight>0||this.pbFillHeight){i=df.dom.clientHeight(this._eControl),i-=df.sys.gui.getVertBoxDiff(this._eControl,2);for(var s=0;s<this._aCards.length;s++)this._aCards[s]._eBtn&&(i-=this._aCards[s]._eBtn.offsetHeight);return i}return this.getNaturalHeight()-this.getHeightDiff()}return e&&df.dom.clientHeight(e._eSizer)||0},attachFocusEvents:function(){},resize:function(){var e,t=0;if(this._eElem&&this._bRendered){for((this.pbAutoHeight||this.pbFillHeight)&&(t=this.getCardHeight(null)),e=0;e<this._aCards.length;e++)this._aCards[e]._eElem&&(this._aCards[e]._eContainer.style.height=t>0?t+"px":"",this._aCards[e].resizeHorizontal(),this._aCards[e].resizeVertical());this.pbFillHeight||this.sizeHeight(-1)}},onTransEnd:function(e){this.sizeChanged(!0)},set_pbMultiOpen:function(e){if(this.pbMultiOpen=e,!e){for(var t=0;t<this._aCards.length;t++)this._aCards[t]._bExpanded=!1;this._oCurrent&&this.showCard(this._oCurrent)}},set_pbAutoHeight:function(e){this.pbAutoHeight!==e&&(this.pbAutoHeight=e,this.triggerCardResize(!e))},set_pbFillHeight:function(e){this.pbFillHeight!==e&&(df.WebAccordionContainer.base.set_pbFillHeight.call(this,e),this.triggerCardResize(!e))},triggerCardResize:function(e){var t;if(e)for(t=0;t<this._aCards.length;t++)this._aCards[t].setInnerHeight(0);if(this.pbMultiOpen)for(t=0;t<this._aCards.length;t++)this._aCards[t]._bExpanded&&this._aCards[t]._show();else this._oCurrent&&this.showCard(this._oCurrent);this.sizeChanged(!0)}}),df.WebAccordionCard=function(e,t){df.WebAccordionCard.base.constructor.apply(this,arguments),this.prop(df.tBool,"pbExpanded",!1),this.prop(df.tString,"psBtnBackgroundColor",""),this._bExpanded=!1,this.addSync("pbExpanded"),this._sControlClass="WebAcCard",this._sBaseClass="",this._bCC=!1},df.defineClass("df.WebAccordionCard","df.WebCard",{wrpOpenHtml:function(e){e.push('<div class="WebContainer">')},wrpCloseHtml:function(e){e.push("</div>")},afterRender:function(){df.WebAccordionCard.base.afterRender.call(this),this._bPanels?df.dom.on("transitionend",this._eMainArea,this.onTransEndCancel,this):df.dom.on("transitionend",this._eContent,this.onTransEndCancel,this),this.psBtnBackgroundColor&&this.set_psBtnBackgroundColor(this.psBtnBackgroundColor)},show:function(){this._bExpanded||df.WebAccordionCard.base.show.call(this)},hide:function(){this._bExpanded&&this._oParent.pbMultiOpen&&(this._bExpanded=!1,this._hide(),this.afterHide())},onBtnClick:function(e){this.isEnabled()&&(this._bExpanded?this._oParent.pbMultiOpen&&this.hide():this.show()),e.stop()},_hide:function(e){this._eElem&&(this._eElem.style.visibility="hidden",df.dom.addClass(this._eElem,"WebAcCard_Hidden"),df.dom.removeClass(this._eElem,"WebAcCard_Visible"),df.dom.removeClass(this._eBtn,"WebTab_Current"),this._eElem.style.height="0px"),!e&&this._bCurrent&&this.fire("OnHide"),this._bCurrent=!1},_show:function(e){if(!this._eElem&&this._oParent._eElem){var t=this.render();if(!this._eBtn)throw new df.Error(999,"Assertion: Accordion card should have a button element!");this._eBtn.nextSibling?this._eBtn.parentNode.insertBefore(t,this._eBtn.nextSibling):this._eBtn.parentNode.appendChild(t),this.afterRender(),this._oParent.resize()}this._eElem&&(this._eElem.style.visibility="inherit",df.dom.addClass(this._eElem,"WebAcCard_Visible"),df.dom.removeClass(this._eElem,"WebAcCard_Hidden"),df.dom.addClass(this._eBtn,"WebTab_Current"),this._eElem.style.height=this._oParent.getCardHeight(this)+"px"),e||this._bCurrent||this.fire("OnShow"),this._bCurrent=!0},get_pbExpanded:function(){return this._bExpanded},set_pbExpanded:function(e){this._Elem&&e!==this._bExpanded&&this.show()},set_psBtnBackgroundColor:function(e){this._eBtn&&(this._eBtn.style.background=e||"")},onTransEndCancel:function(e){e.stopPropagation()}}),(()=>{"use strict";var e=__webpack_require__(1740),t=__webpack_require__(5804),i=__webpack_require__(9697);df.WebHtmlListRowModel=function(e,t){df.WebHtmlListRowModel.base.constructor.call(this,e,t),this.rRegEx=/{{([a-zA-Z0-9_\-]*)}}/g},df.defineClass("df.WebHtmlListRowModel","df.WebListRowModel",{rowHtml:function(e,t,i){var s=this.oL,o=(this.oR,this);t.push(s._sHtmlTemplate.replace(this.rRegEx,(function(t,i){if("dfrowid"==i)return e.sRowId;var n=s._oColMap[i];return n?o.cellHtml(n,e,e.aCells[n._iColIndex]):t})))}});class s extends e.L{tableHtml(e){e.push(this.oL.psHtmlBefore),super.tableHtml(e),e.push(this.oL.psHtmlAfter)}onTableClick(e){var t=e.getTarget(),i=this,s=null,o=null,n=!0;if(this.oL.isEnabled()&&!this.bCancelClick){for(;t.parentNode&&t!==this.eBody&&!s;)t.hasAttribute("data-ServerOnElemClick")&&(o=t.getAttribute("data-ServerOnElemClick")),t.hasAttribute("data-dfisrow")&&(s=t.getAttribute("data-dfrowid")),t=t.parentNode;o&&(n=this.oL.fire("OnElemClick",[s||"",o])),n&&s&&this.oC.cellClick(e,s,-1)&&(this._bPreventSubmit=!0,setTimeout((function(){i.bPreventSubmit=!1}),250),e.stop())}}refreshCell(e,t){this.refreshDisplay()}refreshRow(e,t){this.refreshDisplay()}}df.WebHtmlList=function(e,t){df.WebHtmlList.base.constructor.call(this,e,t),this.prop(df.tString,"psHtmlBefore",""),this.prop(df.tString,"psHtmlTemplate",""),this.prop(df.tString,"psHtmlAfter",""),this._oColMap={},this._sHtmlTemplate,this.event("OnElemClick",df.cCallModeWait),this._sControlClass="WebHtmlList"},df.defineClass("df.WebHtmlList","df.WebList",{create:function(){this._sHtmlTemplate=this.initTemplate(this.psHtmlTemplate),df.WebHtmlList.base.create.call(this)},createTouchHandler:function(){return null},createPlaceHolder:function(){return null},createHeaderView:function(){return null},createRowModel:function(){return new df.WebHtmlListRowModel(this,this._oModel)},createView:function(){return new s(this,this._oModel,this._oController)},createController:function(){return new i.x(this,this._oModel)},createModel:function(){return new t.M(this)},openHtml:function(e){df.WebList.base.openHtml.call(this,e),this._oBody.genHtml(e)},afterRender:function(){this._eControl=this._eFocus=df.dom.query(this._eElem,"div.WebList_Focus"),this._oHeader&&this._oHeader.afterRender(this._eElem),this._oBody.afterRender(this._eElem),df.WebList.base.afterRender.call(this),this._bRenderChildren=!0,this.updateEnabled()},addChild:function(e){df.WebHtmlList.base.addChild.call(this,e),e._bIsColumn&&(this._oColMap[e._sName]=e)},initTemplate:function(e){return e.replace(/<\/?\w+/i,(function(e){return e+' data-dfisrow="true" data-dfrowid="{{dfrowid}}"'}))},updateTemplate:function(e){this.set_psHtmlTemplate(e)},set_psHtmlTemplate:function(e){this._sHtmlTemplate=this.initTemplate(e),this.redraw()},set_psHtmlBefore:function(e){this.psHtmlBefore=e,this.redraw()},set_psHtmlAfter:function(e){this.psHtmlAfter=e,this.redraw()}})})(),df.WebGeoLocation=function(e,t){df.WebGeoLocation.base.constructor.call(this,e,t),this.prop(df.tBool,"pbTracking",!1),this.prop(df.tBool,"pbAutoStart",!0),this.prop(df.tBool,"pbAutoStop",!0),this.prop(df.tNum,"pnLatitude",0),this.prop(df.tNum,"pnLongitude",0),this.prop(df.tNum,"pnAccuracy",0),this.prop(df.tNum,"pnSpeed",0),this.prop(df.tNum,"pnHeading",0),this.prop(df.tBool,"pbEnableHighAccuracy",!1),this.prop(df.tInt,"piMaxTimeout",0),this.prop(df.tInt,"piMinTimeout",200),this.prop(df.tInt,"piMaxAge",0),this.event("OnLocationChange",df.cCallModeDefault),this.event("OnError",df.cCallModeDefault),this.addSync("pnLatitude"),this.addSync("pnLongitude"),this.addSync("pnAccuracy"),this.addSync("pnSpeed"),this.addSync("pnHeading"),this._iWatchId=null,this._oView=null,this._iLocChTime=0,this._iLocChTimer=null},df.defineClass("df.WebGeoLocation","df.WebObject",{create:function(){df.WebGeoLocation.base.create.call(this),this.set_pbTracking(this.pbTracking),this._oView=this.getView(),this._oView?(this._oView.OnShow.on(this.showView,this),this._oView.OnHide.on(this.hideView,this)):this.pbAutoStart&&this.set("pbTracking",!1)},destroy:function(){df.WebGeoLocation.base.destroy.call(this),this._oView&&(this._oView.OnShow.off(this.showView,this),this._oView.OnHide.off(this.hideView,this))},showView:function(e){this.pbAutoStart&&this.set("pbTracking",!0)},hideView:function(e){this.pbAutoStop&&this.set("pbTracking",!1)},queryLocation:function(e,t){var i=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(s){i.updateProps(s),i.serverAction("QueryLocation_Callback",[e,t,0,df.fromNumber(i.pnLatitude),df.fromNumber(i.pnLongitude),df.fromNumber(i.pnAccuracy),df.fromNumber(i.pnSpeed),df.fromNumber(i.pnHeading)])}),(function(s){i.serverAction("QueryLocation_Callback",[e,t,s.code,"0","0","0","0","0"]),i.fire("OnError",[s.code,s.message])}),this.geoOptions())},updateProps:function(e){this.pnLatitude=e.coords.latitude,this.pnLongitude=e.coords.longitude,this.pnAccuracy=e.coords.accuracy||0,this.pnSpeed=e.coords.speed||0,this.pnHeading=e.coords.heading||0},fireLocationChange:function(){this.fireEx({sEvent:"OnLocationChange",aParams:[df.fromNumber(this.pnLatitude),df.fromNumber(this.pnLongitude),df.fromNumber(this.pnAccuracy),df.fromNumber(this.pnSpeed),df.fromNumber(this.pnHeading)],oEnv:this,sAltServerName:"TriggerLocationChange"}),this._iLocChTime=(new Date).getTime()},trackPosition:function(e){var t=this;this.updateProps(e);var i=(new Date).getTime()-this._iLocChTime;this.piMaxTimeout>0&&i<this.piMaxTimeout?this._iLocChTimer||(this._iLocChTimer=setTimeout((function(){t.fireLocationChange(),this._iLocChTimer=null}),i)):t.fireLocationChange()},set_pbTracking:function(e){var t=this;e!==(null!==this._iWatchId)&&(e?navigator.geolocation&&(this._iWatchId=navigator.geolocation.watchPosition((function(e){t.trackPosition(e)}),(function(e){t.fire("OnError",[e.code,e.message])}),this.geoOptions())):(navigator.geolocation&&null!==this._iWatchId&&navigator.geolocation.clearWatch(this._iWatchId),this._iWatchId=null))},geoOptions:function(){return{enableHighAccuracy:this.pbEnableHighAccuracy,maximumAge:this.piMaxAge>0?this.piMaxAge:1/0,timeout:this.piMaxTimeout>0?this.piMaxTimeout:1/0}}}),df.WebContextMenu=function(e,t){df.WebContextMenu.base.constructor.call(this,e,t),this.prop(df.tInt,"piMaxHeight",500),this.prop(df.tString,"psControlName",""),this.prop(df.tString,"psContextCSSSelector",""),this.prop(df.tInt,"peContext",df.WebUIContext.WebUIContextCustom),this.prop(df.tString,"psContextValue",""),this.prop(df.tBool,"pbChildScopes",!1),this.prop(df.tString,"psContextScopeName",""),this.prop(df.tBool,"pbAllowHtml"),this.prop(df.tString,"psGroupName"),this.prop(df.tBool,"pbShowIcons",!1),this.event("OnContextMenuOpen",df.cCallModeDefault,"privateOnContextMenuOpen"),this.event("OnItemClick"),this.pePosition=df.fpFloatFixed,this.piWidth=200,this.piHeight=-1,this.piColumnCount=1,this.pbHideOnEscape=!0,this._bIsMenuProv=!0,this._oRootControl=null,this._bRendered=!1,this._oMenu=null,this._oChildrenCache=[]},df.defineClass("df.WebContextMenu","df.WebFloatingPanel",{set_psControlName:function(e,t){if(this.psControlName!==e||t){if(this.unbind(),this.psControlName=e,"window"===this.psControlName?this._oRootControl={_eElem:document.documentElement}:this.psControlName.length>0?this._oRootControl=this.getWebApp().findObj(this.psControlName):this._oRootControl=this.getWebApp(),!this._oRootControl)throw new df.Error(999,"WebContextMenu could not find the Scope/Control.");this.bind()}},set_peContext:function(e){this.peContext!==e&&(this.unbind(),this.peContext=e,this.bind())},set_psContextCSSSelector:function(e){this.psContextCSSSelector!==e&&this.peContext===df.WebUIContext.WebUIContextCustom&&(this.unbind(),this.psContextCSSSelector=e,this.bind())},set_pbShowIcons:function(e){this._oMenu?.set_pbShowIcons(this.pbShowIcons=e)},set_psGroupName:function(e){this._oMenu?.set_psGroupName(this.psGroupName=e)},set_pbAllowHtml:function(e){this._oMenu?.set_pbAllowHtml(this.pbAllowHtml=e)},refresh:function(){this._oMenu&&(this._oMenu._tActionData=this._tActionData,this._oMenu.refresh(),this._oMenu._tActionData=null)},updateItem:function(e,t){this._oMenu&&(this._oMenu._tActionData=this._tActionData,this._oMenu.updateItem(e,t),this._oMenu._tActionData=null)},insertItem:function(e){this._oMenu&&(this._oMenu._tActionData=this._tActionData,this._oMenu.insertItem(e),this._oMenu._tActionData=null)},removeItem:function(e){this._oMenu?.removeItem(e)},notifyChange:function(){this._oMenu?.notifyChange()},refreshMenu:function(){this._oMenu&&(this._oMenu._aMenu=null,this._oMenu.refreshMenu())},collapseAll:function(){this._oMenu?.collapseAll()},hideMenu:function(){df.events.removeDomCaptureListener("click",document,this.onClickGeneral,this),df.events.removeDomCaptureListener("contextmenu",document,this.hideMenu,this),this.hide()},create:function(){this.set_psControlName(this.psControlName,!0),this._oMenu=new df.WebMenuList("MenuList",this),this._oMenu.objFocus=function(){},this._oMenu._oMenuBtn=this,this._oMenu.pbShowCaption=!1,this._oMenu.pbShowBackItem=!0,this._oMenu.pbShowIcons=this.pbShowIcons;var e=this;for(this._oMenu.getMenuHeight=function(t){var i=t.firstChild.offsetHeight;return(i+=df.sys.gui.getVertBoxDiff(t))<=e.piMaxHeight?i:e.piMaxHeight},this._fMenuBaseClick=this._oMenu.onMenuClick,this._oMenu.onMenuClick=function(t){e._fMenuBaseClick.apply(this,arguments);let i,s=t.getTarget();if(s)for(;!i&&s&&s!==this._eElem&&s.hasAttribute;){if(s.hasAttribute("data-df-path"))return i=this.getItemByPath(s.getAttribute("data-df-path")),void(i&&i.bEnabled&&0===i.aChildren.length&&(i.hRef instanceof df.WebMenuItemCheckbox||this._oMenuBtn.hideMenu(),e.fire("OnItemClick",[i.sId,i.sCaption])));s=s.parentNode}},this._oMenu._hContextMenu=this,this._oMenu.create();this._oChildrenCache.length;)this._oMenu.addChild(this._oChildrenCache[0]),this._oChildrenCache.splice(0,1);df.WebContextMenu.base.addChild.call(this,this._oMenu),df.WebContextMenu.base.create.call(this,arguments)},privateStopEvent:function(e){e.stop()},destroy:function(){this._bRendered&&df.dom.off("contextmenu",this._eElem,this.privateStopEvent,this),this.unbind(),df.WebContextMenu.base.destroy.apply(this,arguments)},genClass:function(){return["WebContextMenu",df.WebContextMenu.base.genClass.call(this)].join(" ")},afterRender:function(){this._bRendered=!0,df.WebContextMenu.base.afterRender.apply(this,arguments),df.dom.on("contextmenu",this._eElem,this.privateStopEvent,this),this.bind()},afterRenderChildren:function(){var e;if(df.WebContextMenu.base.afterRenderChildren.apply(this,arguments),this._oMenu&&this._oMenu._aChildren)for(let t=0;t<this._oMenu._aChildren.length;t++)(e=this._oMenu._aChildren[t])._bProviderRequestAfterRender&&e.afterRender()},isRootControlReady:function(){return this._oRootControl&&this._oRootControl._eElem},afterRenderRootControl:function(){this.rebind()},bind:function(){if(!this.isRootControlReady())return this._hRootControlAfterRender=this._oRootControl?.OnAfterRender,void this._hRootControlAfterRender?.on(this.afterRenderRootControl,this);if(this._oRootControl&&this._oRootControl._eElem){if(this.pbChildScopes&&!df.WebUIContext.isChildScopeCompatible(this.peContext))throw new df.Error(999,"WebContextMenu cannot use pbChildScopes with this peContext.");if(this.useCSSSelectorOfObject(this._oRootControl,this.pbChildScopes),this._oRootControl.bindHandlerForWebUIContext&&this.pbChildScopes&&!this._oRootControl.bindHandlerForWebUIContext(this,this.peContext))throw new df.Error(999,"WebContextMenu's assinged control does not allow binding with the current peContext.");df.dom.on("contextmenu",this._oRootControl._eElem,this.onContextMenuOpen,this)}else if(!this._hRootControlAfterRender)throw new df.Error(999,"WebContextMenu could not find an element for the RootControl.")},useCSSSelectorOfObject:function(e,t){if(this.peContext===df.WebUIContext.WebUIContextCustom)return!0;if(!e.determineSelectorForWebUIContext){if(t)return!1;throw new df.Error(999,"WebContextMenu could not contact the assigned control since it does not support the required interface.")}let i=e.determineSelectorForWebUIContext(this.peContext);if(null==i){if(t)return!1;throw new df.Error(999,"WebContextMenu's assinged control does not support the desired peContext.")}return this.psContextCSSSelector=i,this.addSync("psContextCSSSelector"),!0},unbind:function(){if(this._hRootControlAfterRender&&(this._hRootControlAfterRender.off(this.afterRenderRootControl,this),this._hRootControlAfterRender=null),this._oRootControl&&this._oRootControl._eElem)this._oRootControl.unbindHandlerForWebUIContext&&this.pbChildScopes&&(this._oRootControl.unbindHandlerForWebUIContext(this,this.peContext)||console.warn("WebContextMenu's assinged control does not allow unbinding with the current peContext.")),df.dom.off("contextmenu",this._oRootControl._eElem,this.onContextMenuOpen,this),df.events.removeDomCaptureListener("click",document,this.onClickGeneral,this),df.events.removeDomCaptureListener("contextmenu",document,this.hideMenu,this),this.hideMenu();else if(this._bRendered)throw new df.Error(999,"WebContextMenu could not find a element for the RootControl.")},rebind:function(){this.unbind(),this.bind()},addChild:function(e){if(!(e instanceof df.WebMenuItem))throw new df.Error(999,"WebMenuContext only supports menu items/checkboxes ("+e.getLongName()+").");this._oMenu?this._oMenu.addChild(e):this._oChildrenCache.push(e)},getVisibleChildCount:function(){let e=0;if(this._oMenu&&this._oMenu._aChildren)for(let t=0;t<this._oMenu._aChildren.length;t++)this._oMenu._aChildren[t].pbRender&&this._oMenu._aChildren[t].pbVisible&&e++;for(let t=0;t<this._oChildrenCache.length;t++)this._oMenu._aChildren[t].pbRender&&this._oMenu._aChildren[t].pbVisible&&e++;return this._oMenu?._aDynamicMenu&&(e+=this._oMenu._aDynamicMenu.length),e},showView:function(e){df.WebContextMenu.base.showView.apply(this,arguments),this.rebind()},hideView:function(e){df.WebContextMenu.base.hideView.apply(this,arguments),this.unbind()},show:function(){this.isEnabled()&&(this.pbVisible=!0,this._bViewVisible&&this.doShow())},isVisible:function(){return!0===this.pbVisible},onClickGeneral:function(e){this._eElem.contains(e.getTarget())||(df.events.removeDomCaptureListener("click",document,this.onClickGeneral,this),df.events.removeDomCaptureListener("contextmenu",document,this.hideMenu,this),this.hideMenu())},onContextMenuOpen:function(e){this._bRendered||(this.render(),this.afterRender());let t=document.elementFromPoint(e.e.clientX,e.e.clientY),i=this._oRootControl;if(this.pbChildScopes){let e=t;for(;!e.hasAttribute("data-dfobj")&&e!=this._oRootControl._eElem;){if(!e.parentNode||!e.parentNode.hasAttribute)throw new df.Error(999,"WebContextMenu could not find a TargetScope control element.");e=e.parentNode}if(i=this.getWebApp()?.findObj(e.getAttribute("data-dfobj")),!i)throw new df.Error(999,"WebContextMenu could not find a TargetScope control.");if(!this.useCSSSelectorOfObject(i,!0))return}let s=0===this.psContextCSSSelector.length;for(;t&&t.matches&&t!==this._oRootControl._eElem&&!s&&(s=t.matches(this.psContextCSSSelector),!s);)t=t.parentNode;this.psContextScopeName=i.getLongName(),this.addSync("psContextScopeName");let o=!i.verifyElementForWebUIContext||i.verifyElementForWebUIContext(t,this.peContext);if(this.isEnabled()&&s&&o&&this.getVisibleChildCount()){if(e.stop(),this.psContextValue="",i.retrieveValueFromWebUIContext&&this.peContext>df.WebUIContext.WebUIContextCustom){let e=i.retrieveValueFromWebUIContext(t,this.peContext);if(null==e)throw new df.Error(999,"WebContextMenu's assinged control does not support the desired peContext or we passed the wrong element.");if(e.toString)this.psContextValue=e.toString();else{if(!(e instanceof Object))throw new df.Error(999,"WebContextMenu could not convert the determined Value returned by the assigned control.");this.psContextValue=JSON.stringify(e)}}this.addSync("psContextValue"),df.events.addDomCaptureListener("click",document,this.onClickGeneral,this),df.events.addDomCaptureListener("contextmenu",document,this.hideMenu,this),this.fire("OnContextMenuOpen",[],(function(t){if("1"===t.sReturnValue)return;this._oMenu._sCurrentMenu="",this.refreshMenu(),this.piLeft=e.e.clientX,this.piTop=e.e.clientY,this.show();let i=df.sys.gui.getBoundRect(this._oMenu._eCurrentMenu);i.right>window.innerWidth&&window.innerWidth-i.left<=i.width?this.piLeft=i.left-i.width:i.right>window.innerWidth&&(this.piLeft=window.innerWidth-i.width),i.bottom>window.innerHeight&&window.innerHeight-i.top>=i.height?this.piTop=i.top-i.height:i.bottom>window.innerHeight&&(this.piTop=window.innerHeight-i.height),this.positionPnl()}))}},doHide:function(e,t){var i=this.getWebApp();this._tPositionInterval&&(clearInterval(this._tPositionInterval),this._tPositionInterval=null),df.dom.addClass(this._eElem,"WebFP_Hidden"),df.dom.removeClass(this._eElem,"WebFP_Visible"),e||this.positionPnl(),this.afterHide(),this._eMask&&(df.dom.off("click",this._eMask,this.onMaskTouch,this),this._eMask.parentNode.removeChild(this._eMask),this._eMask=null),this._eBlurBuddy&&df.events.removeDomCaptureListener("blur",this._eBlurBuddy,this.onCaptureBlur,this),this.pePosition===df.fpFloatLeftSqueezeWebApp&&i&&i._eElem&&(i._eElem.style.marginLeft="0px"),this.fire("OnHide",[t]),!this.pbVisible&&this._eElem&&(this._eElem.style.display="none",this._bVisible=!1)},enable:function(e){this.pbEnabled=null===e||e},disable:function(){this.pbEnabled=!1},createMenuItem:function(e){let t=new df.WebMenuItem(null,this);return t.psCaption=e,t.create(),t},createCheckedMenuItem:function(e,t){let i=new df.WebMenuItemCheckbox(null,this);return i.psCaption=e,i.pbChecked=t,i.create(),i},createCheckedMenuItem:function(e,t,i){let s=new df.WebMenuItemCheckbox(null,this);return s.psCaption=e,s.pbChecked=t,s.pbEnabled=i,s.create(),s}}),df.WebDrawing=function(e,t){df.WebDrawing.base.constructor.apply(this,arguments),this.prop(df.tInt,"peDrawingJustification",0),this.prop(df.tInt,"piDrawingWidth",0),this.prop(df.tInt,"piDrawingHeight",0),this.prop(df.tInt,"peResizeMode",0),this.prop(df.tBool,"pbNoContextMenu",!1),this.prop(df.tBool,"pbZoomable",!1),this.prop(df.tNumber,"pfMinZoom",.125),this.prop(df.tNumber,"pfMaxZoom",4),this.prop(df.tNumber,"pfDefaultZoom",1),this.prop(df.tBool,"pbClientOnResize",!1),this.prop(df.tBool,"pbDebugOutline",!1),this.prop(df.tInt,"piDebugOutlineWidth",1),this.prop(df.tString,"psDebugOutlineColor",""),this.prop(df.tBool,"pbShowBorder",!1),this.prop(df.tString,"psCanvasBackgroundColor",""),this._eDrawing=null,this.drawingItemMap=new Map,this.drawingsBuffered=!1,this.globalScale=1,this.panOffset={x:0,y:0},this.previousMousePosition=void 0,this.ns="http://www.w3.org/2000/svg",this._zoomBtns=void 0,this._btnZoomIn=void 0,this._btnZoomOut=void 0,this._btnZoomReset=void 0,this.wdResizeModeDisabled=0,this.wdResizeModeScale=1,this.wdResizeModeCrop=2,this.wdInteractionOnMouseDown=1,this.wdInteractionOnMouseUp=2,this.wdInteractionOnMouseEnter=4,this.wdInteractionOnMouseLeave=8,this.wdInteractionOnMouseMove=16,this.wdInteractionOnMouseClick=32,this.wdInteractionOnMouseDoubleClick=64,this.wdInteractionOnMouseDrag=128,this._bJSSizing=!0},df.defineClass("df.WebDrawing","df.WebBaseControl",{create:function(){if(this.peResizeMode===this.wdResizeModeScale&&(this.piDrawingWidth<=0||this.piDrawingHeight<=0))throw new df.Error(999,"A piDrawingWidth and piDrawingHeight have to be defined when peResizeMode is set to Scaling.");if(this.pfMinZoom<0)throw new df.Error(999,"pfMinZoom cannot go below 0");if(this.pfMinZoom>this.pfMaxZoom)throw new df.Error(999,"pfMinZoom cannot be higher than pfMaxZoom");if(this.pfMaxZoom<this.pfMinZoom)throw new df.Error(999,"pfMaxZoom cannot be lower than pfMinZoom");if(this.pfDefaultZoom<this.pfMinZoom||this.pfDefaultZoom>this.pfMaxZoom)throw new df.Error(999,"The default zoom cannot be lower or higher than the pfMinZoom and/or pfMaxZoom")},openHtml:function(e){df.WebDrawing.base.openHtml.call(this,e),e.push('<div class="WebDrawing-wrp">'),e.push('    <div class="WebDrawing-wrp-inner">'),e.push('        <div class="WebDrawing-zoom-buttons" style="display: none;">'),e.push('            <button class="WebDrawing-btn-zoom WebDrawing-btn-zoom-in">+</button>'),e.push('            <button class="WebDrawing-btn-zoom WebDrawing-btn-zoom-reset">&#x21bb</button>'),e.push('            <button class="WebDrawing-btn-zoom WebDrawing-btn-zoom-out">-</button>'),e.push("        </div>"),e.push('        <svg xmlns="http://www.w3.org/2000/svg" style="background-color:'+this.psCanvasBackgroundColor+'"></svg>'),e.push("    </div>"),e.push("</div>")},afterRender:function(){this.initializeDrawing(),this.drawingsBuffered&&(this.drawingsBuffered=!1,this.createSVGDomElements(this.drawingItemMap)),df.WebDrawing.base.afterRender.call(this),this.set_pbShowBorder(this.pbShowBorder)},initializeDrawing:function(){this._eControl=df.dom.query(this._eElem,".WebDrawing-wrp"),this._eDrawing=this._eControl.querySelector("svg"),this._zoomBtns=this._eControl.querySelector(".WebDrawing-zoom-buttons"),this._btnZoomIn=this._eControl.querySelector(".WebDrawing-btn-zoom-in"),this._btnZoomOut=this._eControl.querySelector(".WebDrawing-btn-zoom-out"),this._btnZoomReset=this._eControl.querySelector(".WebDrawing-btn-zoom-reset"),this.pbNoContextMenu&&this._eDrawing.addEventListener("contextmenu",(e=>e.preventDefault())),this.pbDebugOutline&&(this._eDrawing.style.border=this.piDebugOutlineWidth+"px solid black",this._eDrawing.style.borderColor=this.psDebugOutlineColor),this.pbZoomable&&(this._zoomBtns.style.display="block",this.globalScale=this.pfDefaultZoom,this._eDrawing.addEventListener("wheel",(e=>{e.preventDefault(),this.globalScale+=-.001*e.deltaY,this.updateViewBox()})),this._eDrawing.addEventListener("mousedown",(e=>{this.previousMousePosition=this.getMousePos(e)})),this._eDrawing.addEventListener("touchstart",(e=>{this.previousMousePosition=this.getTouchPos(e)})),this._eDrawing.addEventListener("mousemove",(e=>{if(0!==e.buttons&&void 0!==this.previousMousePosition){e.preventDefault();const t=this.getMousePos(e);this.viewPanning(t)}})),this._eDrawing.addEventListener("touchmove",(e=>{if(void 0!==this.previousMousePosition){e.preventDefault();const t=this.getTouchPos(e);this.viewPanning(t)}})),this._btnZoomIn.addEventListener("click",(()=>{this.globalScale+=.1,this.updateViewBox()})),this._btnZoomOut.addEventListener("click",(()=>{this.globalScale+=-.1,this.updateViewBox()})),this._btnZoomReset.addEventListener("click",(()=>{this.globalScale=this.pfDefaultZoom,this.updateViewBox()}))),this.updateViewBox()},viewPanning:function(e){const t=this.previousMousePosition.x-e.x,i=this.previousMousePosition.y-e.y;let s=t/this.globalScale,o=i/this.globalScale;if(this.peResizeMode===this.wdResizeModeScale){const e=Math.min(this._eControl.clientWidth/this.piDrawingWidth,this._eControl.clientHeight/this.piDrawingHeight);s/=e,o/=e}this.panOffset.x+=s,this.panOffset.y+=o,this.updateViewBox(),this.previousMousePosition=e},updateViewBox:function(){this.globalScale=Math.min(Math.max(this.pfMinZoom,this.globalScale),this.pfMaxZoom);let e=this.piDrawingWidth,t=this.piDrawingHeight;this.peResizeMode===this.wdResizeModeCrop&&(e=this._eControl.clientWidth,t=this._eControl.clientHeight);const i=e/2,s=t/2,o=e/this.globalScale,n=t/this.globalScale,r=this.panOffset.x+(i-o/2),a=this.panOffset.y+(s-n/2);this._eDrawing.setAttributeNS(null,"viewBox",`${r} ${a} ${o} ${n}`)},updateSizes:function(){if(this.peResizeMode!==this.wdResizeModeDisabled){if(this._eControl.clientHeight&&(this._eDrawing.width.baseVal.value!==this._eControl.clientWidth||this._eDrawing.height.baseVal.value!==this._eControl.clientHeight)){if(this.peResizeMode===this.wdResizeModeScale){const e=this._eControl.clientHeight/this.piDrawingHeight,t=this._eControl.clientWidth/this.piDrawingWidth,i=this.piDrawingWidth*t,s=this.piDrawingHeight*e;this._eDrawing.setAttributeNS(null,"width",i.toString()),this._eDrawing.setAttributeNS(null,"height",s.toString())}else this.peResizeMode===this.wdResizeModeCrop&&(this._eDrawing.setAttributeNS(null,"width",this._eControl.clientWidth.toString()),this._eDrawing.setAttributeNS(null,"height",this._eControl.clientHeight.toString()));if(this.updateViewBox(),this.pbClientOnResize){const e=this.createResizeEventData(this._eDrawing.width.baseVal.value,this._eDrawing.height.baseVal.value);this.serverAction("HandleResize",[],e)}}}else this._eDrawing.setAttributeNS(null,"width",this.piDrawingWidth.toString()),this._eDrawing.setAttributeNS(null,"height",this.piDrawingHeight.toString())},setHeight:function(e,t){df.WebDrawing.base.setHeight.call(this,e,t),t&&df.dom.animFrame(this.updateSizes,this)},createResizeEventData:function(e,t){const i={};return i.fViewWidth=e,i.fViewHeight=t,i},updateInstructions:function(){this.drawingItemMap=this.collectInstructions(this._tActionData,this.drawingItemMap),this.setGroupingPositions(),this.updateDrawing()},clearDrawing:function(){this._eDrawing&&(this.drawingItemMap=new Map,this._eDrawing.innerHTML="",this.initializeDrawing())},updateDrawing:function(){this._eDrawing?this.createSVGDomElements(this.drawingItemMap):this.drawingsBuffered=!0},setGroupingPositions:function(){for(const e of this.drawingItemMap.keys()){const t=this.drawingItemMap.get(e);t.subDrawingItemMap.size>0&&(t.drawingItemData.position=this.getCentroidOfGrouping(t),this.drawingItemMap.set(e,t))}},adjustChildrenPosition:function(e,t){if(e.subDrawingItemMap.size>0)for(const[i,s]of e.subDrawingItemMap.entries()){const o=this.cloneObject(s.drawingItemData.position),n=s.drawingItemData.position.x-t.x,r=s.drawingItemData.position.y-t.y;if(s.drawingItemData.position.x=e.drawingItemData.position.x+n,s.drawingItemData.position.y=e.drawingItemData.position.y+r,void 0!==s.drawingItemData.shape)switch(s.drawingItemData.shape.type){case"rectangle":case"rounded-rectangle":case"image":{const i=s.drawingItemData.shape.data.topLeft.x-t.x,o=s.drawingItemData.shape.data.topLeft.y-t.y,n=s.drawingItemData.shape.data.bottomRight.x-t.x,r=s.drawingItemData.shape.data.bottomRight.y-t.y;s.drawingItemData.shape.data.topLeft.x=e.drawingItemData.position.x+i,s.drawingItemData.shape.data.topLeft.y=e.drawingItemData.position.y+o,s.drawingItemData.shape.data.bottomRight.x=e.drawingItemData.position.x+n,s.drawingItemData.shape.data.bottomRight.y=e.drawingItemData.position.y+r;break}case"path":for(const i of s.drawingItemData.shape.data.subPoints){const s=i.position.x-t.x,o=i.position.y-t.y;if(i.position.x=e.drawingItemData.position.x+s,i.position.y=e.drawingItemData.position.y+o,i.position2){const s=i.position2.x-t.x,o=i.position2.y-t.y;i.position2.x=e.drawingItemData.position.x+s,i.position2.y=e.drawingItemData.position.y+o}}}this.adjustChildrenPosition(s,o),e.subDrawingItemMap.set(i,s)}},collectInstructions:function(e,t){let i=0;for(let s=0;s<e.length;s++){const o=e[s];let n={subDrawingItemMap:new Map,hasEntered:!1,hasLeft:!0};if(""===o.sId&&(o.sType.startsWith("create-")&&i++,o.sId=`!${i}`),t.has(o.sId)?n=t.get(o.sId):t.forEach((e=>{e.subDrawingItemMap.size>0&&e.subDrawingItemMap.has(o.sId)&&(n=e.subDrawingItemMap.get(o.sId))})),"create-group"===o.sType){const t=e.findIndex((e=>"create-group"===e.sType&&e.sId===o.sId)),i=e.findIndex((e=>"end-create-group"===e.sType&&e.sId===o.sId));if(-1===i)throw new df.Error(999,`Group "${o.sId}" has no corresponding EndCreateGroup instruction.`);const r=e.slice(t+1,i);void 0===n.drawingItemData&&(n.drawingItemData={visible:!0,shadowOffset:{x:0,y:0}});const a=r.filter((e=>e.sId===o.sId));for(const e of a){n=this.applyGroupedInstruction(n,e);const t=r.findIndex((t=>t.sId===e.sId&&t.sType===e.sType));r.splice(t,1)}n.subDrawingItemMap=this.collectInstructions(r,n.subDrawingItemMap),s=i}else if("create-layer"===o.sType){const t=e.findIndex((e=>"create-layer"===e.sType&&e.sId===o.sId)),i=e.findIndex((e=>"end-create-layer"===e.sType&&e.sId===o.sId));if(-1===i)throw new df.Error(999,`Layer "${o.sId}" has no corresponding EndCreateLayer instruction.`);const r=e.slice(t+1,i);void 0===n.drawingItemData&&(n.drawingItemData={visible:!0,shadowOffset:{x:0,y:0}}),n.subDrawingItemMap=this.collectInstructions(r,n.subDrawingItemMap),s=i}else"delete-item"===o.sType?(this.deleteItem(o.sId),n=null):n=n.subDrawingItemMap.size>0?this.applyGroupedInstruction(n,o):this.applyInstruction(n,o);n&&t.set(o.sId,n)}return t},applyInstruction:function(e,t){if(e.drawingItemData=this.applyCreateInstruction(e.drawingItemData,t),void 0===e.drawingItemData)throw new df.Error(999,`There is no shape created for "${t.sId}", cannot apply styling. Maybe you mistyped the ID?`);return e=this.applyNormalInstructions(e,t)},applyGroupedInstruction:function(e,t){return e=this.applyNormalInstructions(e,t)},applyCreateInstruction:function(e,t){const i=t.sType,s=t.asParams;if(i.startsWith("create-")&&this.mapHasId(t.sId))throw new df.Error(999,`A shape with the id "${t.sId}" already exists`);switch(void 0===e&&((e={}).position={x:0,y:0},e.scale={width:1,height:1},e.shadowOffset={x:0,y:0},e.visible=!0,e.closed=!1),i){case"create-rectangle":{const[t,i,o,n,r]=s;e.shape={},e.shape.data={topLeft:{x:parseFloat(t),y:parseFloat(i)},bottomRight:{x:parseFloat(t)+parseFloat(o),y:parseFloat(i)+parseFloat(n)}},s.length>4?(e.shape.type="rounded-rectangle",e.shape.data.radius=parseFloat(r)):e.shape.type="rectangle",e.position=this.getCentroid([e.shape.data.topLeft,e.shape.data.bottomRight]);break}case"create-circle":{const[t,i,o]=s;e.shape={},e.shape.type="circle",e.shape.data={radius:parseFloat(o)},e.position.x=parseFloat(t),e.position.y=parseFloat(i);break}case"create-ellipse":{const[t,i,o,n]=s;e.shape={},e.shape.type="ellipse",e.shape.data={radiusX:parseFloat(o),radiusY:parseFloat(n)},e.position.x=parseFloat(t),e.position.y=parseFloat(i);break}case"create-path":e.shape={},e.shape.type="path",e.shape.data={subPoints:[]};break;case"create-line":{const[t,i,o,n]=s;e.shape={},e.shape.type="path",e.shape.data={subPoints:[]},e.shape.data.subPoints.push({type:"moveTo",position:{x:parseFloat(t),y:parseFloat(i)}}),e.shape.data.subPoints.push({type:"lineTo",position:{x:parseFloat(o),y:parseFloat(n)}});break}case"create-text":{const[t,i,o,n,r,a,l,h]=s;e.shape={},e.shape.type="text",e.shape.params=s,e.textContent=o,e.position.x=parseFloat(t),e.position.y=parseFloat(i),e.fontFamily=n,e.fontSize=parseFloat(r),e.fillColor="black",e.strokeColor="transparent",s.length>5&&(e.justification=this.enumJustificationIntToString(parseInt(a))),s.length>6&&(e.fontWeight=l),s.length>7&&(e.textDecoration=h);break}case"create-image":case"create-svg":{const[t]=s;e.shape=this.getImageShapeData(s),e.imagePath=t;break}}return e},getImageShapeData:function(e){const[t,i,s,o,n]=e,r={type:"image"};return e.length>3?r.data={topLeft:{x:parseFloat(i),y:parseFloat(s)},bottomRight:{x:parseFloat(o),y:parseFloat(n)}}:r.data={topLeft:{x:parseFloat(i),y:parseFloat(s)}},r},applyNormalInstructions:function(e,t){const i=t.sType,s=t.asParams;switch(i){case"add":e.drawingItemData.shape.data.subPoints.push({type:"add",position:{x:parseFloat(s[0]),y:parseFloat(s[1])}}),e.drawingItemData.position=this.getCentroid(e.drawingItemData.shape.data.subPoints.map((e=>e.position)));break;case"moveTo":e.drawingItemData.shape.data.subPoints.push({type:"moveTo",position:{x:parseFloat(s[0]),y:parseFloat(s[1])}}),e.drawingItemData.position=this.getCentroid(e.drawingItemData.shape.data.subPoints.map((e=>e.position)));break;case"lineTo":e.drawingItemData.shape.data.subPoints.push({type:"lineTo",position:{x:parseFloat(s[0]),y:parseFloat(s[1])}}),e.drawingItemData.position=this.getCentroid(e.drawingItemData.shape.data.subPoints.map((e=>e.position)));break;case"quadraticCurveTo":e.drawingItemData.shape.data.subPoints.push({type:"quadraticCurveTo",position:{x:parseFloat(s[2]),y:parseFloat(s[3])},position2:{x:parseFloat(s[0]),y:parseFloat(s[1])}}),e.drawingItemData.position=this.getCentroid(e.drawingItemData.shape.data.subPoints.map((e=>e.position)));break;case"closePath":e.drawingItemData.shape.data.subPoints.push({type:"closePath"}),e.drawingItemData.closed=!0;break;case"strokeWidth":e.drawingItemData.strokeWidth=parseFloat(s[0]);break;case"strokeColor":e.drawingItemData.strokeColor=s[0];break;case"strokeCap":e.drawingItemData.strokeCap=this.enumStrokeCapIntToString(parseInt(s[0]));break;case"strokeJoin":e.drawingItemData.strokeJoin=this.enumStrokeJoinIntToString(parseInt(s[0]));break;case"dashOffset":e.drawingItemData.dashOffset=parseFloat(s[0]);break;case"strokeDashes":e.drawingItemData.strokeDistance=s[0],s.length>1&&(e.drawingItemData.whitespaceDistance=s[1]);break;case"fillColor":e.drawingItemData.fillColor=s[0];break;case"shadowColor":e.drawingItemData.shadowColor=s[0];break;case"shadowBlur":e.drawingItemData.shadowBlur=parseFloat(s[0]);break;case"shadowOffset":e.drawingItemData.shadowOffset={x:parseFloat(s[0]),y:parseFloat(s[1])};break;case"fontFamily":e.drawingItemData.fontFamily=s[0];break;case"fontSize":e.drawingItemData.fontSize=parseFloat(s[0]);break;case"fontWeight":e.drawingItemData.fontWeight=s[0];break;case"textDecoration":e.drawingItemData.textDecoration=s[0];break;case"fontJustification":e.drawingItemData.justification=this.enumJustificationIntToString(parseInt(s[0]));break;case"textDecoration":e.DrawingItemData.textDecoration=s[0];break;case"textContent":e.drawingItemData.textContent=s[0];break;case"set-visibility":e.drawingItemData.visible=1==s[0];break;case"toggle-visibility":e.drawingItemData.visible=!e.drawingItemData.visible;break;case"position":{const t=this.cloneObject(e.drawingItemData.position);e.drawingItemData.position.x=parseFloat(s[0]),e.drawingItemData.position.y=parseFloat(s[1]),void 0!==e.drawingItemData.position&&this.adjustChildrenPosition(e,t);break}case"rotation":e.drawingItemData.rotation=parseFloat(s[0]),s.length>1&&(e.drawingItemData.rotateInPlace=s[1]);break;case"scaling":void 0===e.drawingItemData.scale&&(e.drawingItemData.scale={}),e.drawingItemData.scale.width=parseFloat(s[0]),e.drawingItemData.scale.height=parseFloat(s[1]);break;case"enable-interaction":{void 0===e.enabledInteractions&&(e.enabledInteractions=0);const t=parseInt(s[0]);e.enabledInteractions=e.enabledInteractions|t;break}case"disable-interaction":{void 0===e.enabledInteractions&&(e.enabledInteractions=0);const t=parseInt(s[0]);e.enabledInteractions&t&&(e.enabledInteractions=e.enabledInteractions^t);break}case"add-tooltip":e.drawingItemData.tooltip=s[0]}return e},getCentroidOfGrouping:function(e){const t=[];for(const i of e.subDrawingItemMap.values())i.subDrawingItemMap.size>0&&(i.drawingItemData.position=this.getCentroidOfGrouping(i)),t.push(i.drawingItemData.position);return this.getCentroid(t)},createSVGDomElements:function(e){for(const[t,i]of e)if(this.createSVGDomElement(t,i),void 0!==i.drawingItemData.pathItem){const e=this._eDrawing.querySelector(`[df-wd-item-id="${t}"]`);null===e?this._eDrawing.appendChild(i.drawingItemData.pathItem):e.isEqualNode(i.drawingItemData.pathItem)||e.replaceWith(i.drawingItemData.pathItem)}},createSVGDomElement:function(e,t){if(t.subDrawingItemMap.size>0){t.drawingItemData.pathItem=document.createElementNS(this.ns,"g"),t.drawingItemData.pathItem.setAttributeNS(null,"style","pointer-events: bounding-box; transform-origin: center; transform-box: fill-box;");for(const[i,s]of t.subDrawingItemMap.entries()){this.createSVGDomElement(i,s),this.applyStylesForGroupChildren(s,t.drawingItemData),t.drawingItemData.pathItem.setAttribute("df-wd-item-id",e),this.applyTransformStyles(t.drawingItemData);const o=t.drawingItemData.pathItem.querySelector(`:scope > *[df-wd-item-id="${e}"]`);null===o?t.drawingItemData.pathItem.appendChild(s.drawingItemData.pathItem):o.isEqualNode(t.drawingItemData.pathItem)||o.replaceWith(s.drawingItemData.pathItem)}this.assignEvent(e,t)}else{if(void 0===t.drawingItemData.shape||""===t.drawingItemData.shape.type)return;this.createSVGData(e,t.drawingItemData),this.applyStyles(t.drawingItemData),this.applyTransformStyles(t.drawingItemData),this.assignEvent(e,t)}},createSVGData:function(e,t){switch(t.shape.type){case"rectangle":t.pathItem=document.createElementNS(this.ns,"rect"),t.pathItem.setAttributeNS(null,"x",t.shape.data.topLeft.x.toString()),t.pathItem.setAttributeNS(null,"y",t.shape.data.topLeft.y.toString()),t.pathItem.setAttributeNS(null,"width",(t.shape.data.bottomRight.x-t.shape.data.topLeft.x).toString()),t.pathItem.setAttributeNS(null,"height",(t.shape.data.bottomRight.y-t.shape.data.topLeft.y).toString());break;case"rounded-rectangle":t.pathItem=document.createElementNS(this.ns,"rect"),t.pathItem.setAttributeNS(null,"x",t.shape.data.topLeft.x.toString()),t.pathItem.setAttributeNS(null,"y",t.shape.data.topLeft.y.toString()),t.pathItem.setAttributeNS(null,"width",(t.shape.data.bottomRight.x-t.shape.data.topLeft.x).toString()),t.pathItem.setAttributeNS(null,"height",(t.shape.data.bottomRight.y-t.shape.data.topLeft.y).toString()),t.pathItem.setAttributeNS(null,"rx",t.shape.data.radius.toString()),t.pathItem.setAttributeNS(null,"ry",t.shape.data.radius.toString());break;case"circle":t.pathItem=document.createElementNS(this.ns,"circle"),t.pathItem.setAttributeNS(null,"cx",t.position.x.toString()),t.pathItem.setAttributeNS(null,"cy",t.position.y.toString()),t.pathItem.setAttributeNS(null,"r",t.shape.data.radius.toString());break;case"ellipse":t.pathItem=document.createElementNS(this.ns,"ellipse"),t.pathItem.setAttributeNS(null,"cx",t.position.x.toString()),t.pathItem.setAttributeNS(null,"cy",t.position.y.toString()),t.pathItem.setAttributeNS(null,"rx",t.shape.data.radiusX.toString()),t.pathItem.setAttributeNS(null,"ry",t.shape.data.radiusY.toString());break;case"path":{const e=[];t.pathItem=document.createElementNS(this.ns,"path");for(let i=0;i<t.shape.data.subPoints.length;i++){const s=t.shape.data.subPoints[i];switch(s.type){case"add":case"lineTo":0===i?e.push(`M ${s.position.x},${s.position.y}`):e.push(`L ${s.position.x},${s.position.y}`);break;case"moveTo":e.push(`M ${s.position.x},${s.position.y}`);break;case"quadraticCurveTo":e.push(`Q ${s.position2.x},${s.position2.y} ${s.position.x},${s.position.y}`);break;case"closePath":e.push("Z")}}t.pathItem.setAttributeNS(null,"d",e.join(" "));break}case"text":t.pathItem=document.createElementNS(this.ns,"text"),t.pathItem.setAttributeNS(null,"x",t.position.x.toString()),t.pathItem.setAttributeNS(null,"y",t.position.y.toString()),t.pathItem.setAttributeNS(null,"font-family",t.fontFamily),t.pathItem.setAttributeNS(null,"font-size",t.fontSize.toString()),t.pathItem.setAttributeNS(null,"text-anchor",t.justification),t.pathItem.setAttributeNS(null,"font-weight",t.fontWeight),t.pathItem.setAttributeNS(null,"text-decoration",t.textDecoration),t.pathItem.setAttributeNS(null,"stroke",t.strokeColor),t.pathItem.setAttributeNS(null,"fill",t.fillColor),t.pathItem.textContent=t.textContent;break;case"image":t.pathItem=document.createElementNS(this.ns,"image"),t.pathItem.setAttributeNS(null,"x",t.shape.data.topLeft.x.toString()),t.pathItem.setAttributeNS(null,"y",t.shape.data.topLeft.y.toString()),void 0!==t.shape.data.bottomRight&&(t.pathItem.setAttributeNS(null,"width",(t.shape.data.bottomRight.x-t.shape.data.topLeft.x).toString()),t.pathItem.setAttributeNS(null,"height",(t.shape.data.bottomRight.y-t.shape.data.topLeft.y).toString())),t.pathItem.setAttributeNS(null,"href",t.imagePath),t.pathItem.setAttributeNS(null,"onmousedown","return false")}t.pathItem.setAttribute("df-wd-item-id",e)},applyStylesForGroupChildren:function(e,t){if(e.subDrawingItemMap.size>0)for(const i of e.subDrawingItemMap.values())this.applyStylesForGroupChildren(i,t);void 0===e.drawingItemData.strokeWidth&&void 0!==t.strokeWidth&&e.drawingItemData.pathItem.setAttributeNS(null,"stroke-width",t.strokeWidth.toString()),void 0===e.drawingItemData.strokeColor&&void 0!==t.strokeColor&&e.drawingItemData.pathItem.setAttributeNS(null,"stroke",t.strokeColor),void 0===e.drawingItemData.strokeCap&&void 0!==t.strokeCap&&e.drawingItemData.pathItem.setAttributeNS(null,"stroke-linecap",t.strokeCap),void 0===e.drawingItemData.strokeJoin&&void 0!==t.strokeJoin&&e.drawingItemData.pathItem.setAttributeNS(null,"stroke-linejoin",t.strokeJoin);const i=[];void 0===e.drawingItemData.strokeDistance&&void 0!==t.strokeDistance&&i.push(t.strokeDistance),void 0===e.drawingItemData.whitespaceDistance&&void 0!==t.whitespaceDistance&&i.push(t.whitespaceDistance),i.length>0&&e.drawingItemData.pathItem.setAttributeNS(null,"stroke-dasharray",i.join()),void 0===e.drawingItemData.dashOffset&&void 0!==t.dashOffset&&e.drawingItemData.pathItem.setAttributeNS(null,"stroke-dashoffset",t.dashOffset),"path"===e.drawingItemData.shape?.type&&void 0===e.drawingItemData.fillColor&&!1===e.drawingItemData.closed&&e.drawingItemData.pathItem.setAttributeNS(null,"fill","none"),void 0===e.drawingItemData.fillColor&&void 0!==t.fillColor&&e.drawingItemData.pathItem.setAttributeNS(null,"fill",t.fillColor);const s=[];if(0===e.drawingItemData.shadowOffset.x&&0===e.drawingItemData.shadowOffset.y&&0!==t.shadowOffset.x&&0!==t.shadowOffset.y?s.push(`${t.shadowOffset.x}px ${t.shadowOffset.y}px`):s.push("0px 0px"),void 0===e.drawingItemData.shadowBlur&&void 0!==t.shadowBlur&&s.push(`${t.shadowBlur}px`),void 0===e.drawingItemData.shadowColor&&void 0!==t.shadowColor&&s.push(t.shadowColor),s.length>1&&e.drawingItemData.pathItem.setAttributeNS(null,"style",`filter: drop-shadow(${s.join(" ")});`),!1===t.visible?e.drawingItemData.pathItem.setAttributeNS(null,"visibility","hidden"):e.drawingItemData.pathItem.setAttributeNS(null,"visibility",""),void 0===e.drawingItemData.tooltip&&void 0!==t.tooltip){let i=document.createElementNS(this.ns,"title");i.textContent=t.tooltip,e.drawingItemData.pathItem.append(i)}},applyStyles:function(e){void 0!==e.strokeWidth&&e.pathItem.setAttributeNS(null,"stroke-width",e.strokeWidth.toString()),void 0!==e.strokeColor?e.pathItem.setAttributeNS(null,"stroke",e.strokeColor):e.pathItem.setAttributeNS(null,"stroke","black"),void 0!==e.strokeCap&&e.pathItem.setAttributeNS(null,"stroke-linecap",e.strokeCap),void 0!==e.strokeJoin&&e.pathItem.setAttributeNS(null,"stroke-linejoin",e.strokeJoin),void 0!==e.strokeDistance&&void 0===e.whitespaceDistance&&e.pathItem.setAttributeNS(null,"stroke-dasharray",e.strokeDistance),void 0!==e.strokeDistance&&void 0!==e.whitespaceDistance&&e.pathItem.setAttributeNS(null,"stroke-dasharray",e.strokeDistance+","+e.whitespaceDistance),void 0!==e.dashOffset&&e.pathItem.setAttributeNS(null,"stroke-dashoffset",e.dashOffset),"path"===e.shape?.type&&void 0===e.fillColor&&!1===e.closed&&e.pathItem.setAttributeNS(null,"fill","none"),void 0!==e.fillColor?e.pathItem.setAttributeNS(null,"fill",e.fillColor):e.pathItem.setAttributeNS(null,"fill","transparent");const t=[];if(0!==e.shadowOffset.x&&0!==e.shadowOffset.y?t.push(`${e.shadowOffset.x}px ${e.shadowOffset.y}px`):t.push("0px 0px"),e.shadowBlur&&t.push(`${e.shadowBlur}px`),e.shadowColor&&t.push(e.shadowColor),t.length>1&&e.pathItem.setAttributeNS(null,"style",`filter: drop-shadow(${t.join(" ")});`),!0===e.visible?e.pathItem.setAttributeNS(null,"visibility",""):e.pathItem.setAttributeNS(null,"visibility","hidden"),void 0!==e.tooltip){let t=document.createElementNS(this.ns,"title");t.textContent=e.tooltip,e.pathItem.append(t)}},applyTransformStyles:function(e){let t=[];void 0!==e.rotation&&t.push(`rotate(${e.rotation})`),void 0!==e.rotateInPlace&&e.pathItem.setAttributeNS(null,"transform-origin",e.position.x+" "+e.position.y),void 0!==e.scale&&1!==e.scale?.width&&1!==e.scale?.height&&t.push(`scale(${e.scale.width}, ${e.scale.height})`),t.length>0&&e.pathItem.setAttributeNS(null,"transform",t.join(" "))},assignEvent:function(e,t){if(e.startsWith("!"))return;const i=t.drawingItemData.pathItem;t.enabledInteractions&this.wdInteractionOnMouseClick&&i.addEventListener("click",(i=>{this.handleEvent("HandleMouseClick",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseDoubleClick&&i.addEventListener("dblclick",(i=>{this.handleEvent("HandleMouseDoubleClick",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseUp&&i.addEventListener("mouseup",(i=>{this.handleEvent("HandleMouseUp",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseDown&&i.addEventListener("mousedown",(i=>{i.preventDefault(),this.handleEvent("HandleMouseDown",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseMove&&i.addEventListener("mousemove",(i=>{this.handleEvent("HandleMouseMove",i,e,t),0!==i.buttons&&this.handleEvent("HandleMouseDrag",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseDrag&&i.addEventListener("mousemove",(i=>{0!==i.buttons&&this.handleEvent("HandleMouseDrag",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseEnter&&i.addEventListener("mouseenter",(i=>{this.handleEvent("HandleMouseEnter",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseLeave&&i.addEventListener("mouseleave",(i=>{this.handleEvent("HandleMouseLeave",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseUp&&i.addEventListener("touchend",(i=>{this.handleEvent("HandleMouseUp",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseClick&&i.addEventListener("touchstart",(i=>{i.preventDefault(),this.handleEvent("HandleMouseClick",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseDown&&i.addEventListener("touchstart",(i=>{i.preventDefault(),this.handleEvent("HandleMouseDown",i,e,t)})),t.enabledInteractions&this.wdInteractionOnMouseMove&&i.addEventListener("touchmove",(i=>{this.handleEvent("HandleMouseMove",i,e,t)}))},handleEvent:function(e,t,i,s){const o=this.createEventData(s.drawingItemData,t);this.serverAction("ReceiveEventData",[e,i],o,null)},createEventData:function(e,t){const i={eMouseButtons:0,tMousePosition:{fX:0,fY:0}};if(void 0!==t.touches&&t.touches.length>0){let e;e=this.getTouchPos(t),i.tMousePosition.fX=e.x,i.tMousePosition.fY=e.y}else if(void 0!==t.buttons){let e;i.eMouseButtons=t.buttons,e=this.getMousePos(t),i.tMousePosition.fX=e.x,i.tMousePosition.fY=e.y}return i.tPosition={},i.tPosition.fX=e.position?.x??0,i.tPosition.fY=e.position?.y??0,i.fRotation=e.rotation??0,i.tScaling={},i.tScaling.fWidth=e.scale?.width??1,i.tScaling.fHeight=e.scale?.height??1,i.sStrokeColor=e.strokeColor??"transparent",i.fStrokeWidth=e.strokeWidth??0,i.iStrokeCap=this.enumStrokeCapStringToInt(e.strokeCap),i.iStrokeJoin=this.enumStrokeJoinStringToInt(e.strokeJoin),i.fDashOffset=e.dashOffset??0,i.sFillColor=e.fillColor??"transparent",i.sShadowColor=e.shadowColor??"transparent",i.fShadowBlur=e.shadowBlur??0,i.tShadowOffset={},i.tShadowOffset.fX=e.shadowOffset?.x??0,i.tShadowOffset.fY=e.shadowOffset?.y??0,i.sTextContent=e.textContent??"",i.sFontFamily=e.fontFamily??"sans-serif",i.fFontSize=e.fontSize??10,i.eJustification=this.enumJustificationStringToInt(e.justification),i.sFontWeight=e.fontWeight??"",i.sTextDecoration=e.textDecoration??"",i},getMousePos:function(e){const t=this._eDrawing.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},getTouchPos:function(e){const t=this._eDrawing.getBoundingClientRect();return{x:e.touches[0].clientX-t.left,y:e.touches[0].clientY-t.top}},getCentroid:function(e){const t=e.map((e=>e.x)).reduce(((e,t)=>e+t)),i=e.map((e=>e.y)).reduce(((e,t)=>e+t)),s={};return s.x=t/e.length,s.y=i/e.length,s},deleteItem:function(e){this.drawingItemMap=this.recursiveDeleteFromMap(e,this.drawingItemMap)},recursiveDeleteFromMap:function(e,t){const i=[];for(const[s,o]of t.entries())if(o.subDrawingItemMap.size>0&&(o.subDrawingItemMap=this.recursiveDeleteFromMap(e,o.subDrawingItemMap)),s===e){i.push(s);const e=this._eDrawing.querySelector(`:scope > *[df-wd-item-id="${s}"]`);null!==e&&this._eDrawing.removeChild(e)}for(const e of i)t.delete(e);return t},cloneObject:function(e){return JSON.parse(JSON.stringify(e))},blobImageToBase64:function(e){return new Promise(((t,i)=>{const s=new FileReader;s.onloadend=()=>{const e=s.result.replace("data:image/png;base64,","");t(e)},s.readAsDataURL(e)}))},mapHasId:function(e){return this.checkMapChildren(e,this.drawingItemMap)},checkMapChildren:function(e,t){for(const[i,s]of t.entries()){if(i===e)return!0;if(s.subDrawingItemMap.size>0&&this.checkMapChildren(e,s.subDrawingItemMap))return!0}return!1},exportDrawingToImage:async function(){const e=this._eDrawing.cloneNode(!0),t=e.querySelectorAll("image");for(const e of t){const t=await fetch(e.href.baseVal),i=await t.blob(),s=new FileReader;s.readAsDataURL(i);const o=await new Promise((e=>{s.onloadend=()=>{e(s.result)}}));e.setAttributeNS(null,"href",o)}const i=document.createElement("drawing");i.width=e.width.baseVal.value,i.height=e.height.baseVal.value;const s=i.getContext("2d"),o=(new XMLSerializer).serializeToString(e),n=new Image,r=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),a=new FileReader;a.readAsDataURL(r),n.src=await new Promise((e=>{a.onloadend=()=>{e(a.result)}})),n.addEventListener("load",(()=>{s.drawImage(n,0,0);let e=i.toDataURL("image/png").replace("data:image/png;base64,","");this.serverAction("OnReceiveImage",[e])}))},exportDrawingDataToJSON:function(){const e=JSON.stringify(Object.fromEntries(this.drawingItemMap));this.serverAction("OnReceiveJSONExport",[e],null,null)},importDrawingFromJSON:function(e){this.drawingItemMap=Object.entries(JSON.parse(e)),this.updateDrawing()},enumStrokeCapStringToInt(e){switch(e){case"round":return 0;case"square":return 1;default:return 2}},enumStrokeCapIntToString(e){switch(e){case 0:return"round";case 1:return"square";default:return"butt"}},enumStrokeJoinStringToInt(e){switch(e){case"miter":default:return 0;case"round":return 1;case"bevel":return 2}},enumStrokeJoinIntToString(e){switch(e){case 0:default:return"miter";case 1:return"round";case 2:return"bevel"}},enumJustificationStringToInt(e){switch(e){default:case"start":return 0;case"middle":return 1;case"end":return 2}},enumJustificationIntToString(e){switch(e){default:case 0:return"start";case 1:return"middle";case 2:return"end"}},set_psCanvasBackgroundColor(e){this._eDrawing.style.backgroundColor=e},set_pbShowBorder:function(e){this.pbShowBorder=e,this._eControl&&df.dom.toggleClass(this._eControl,"WebDrawing_Box",this.pbShowBorder)}}),df.WebDropZone=function(e,t){this._eZone=e,this._oControl=t,this._eInsertedElem=null,this._aHelpers=[],this._eDropPosition=-1,this._eDropElem=null,this._eDropAction=-1,this._iEnterCount=0},df.defineClass("df.WebDropZone",{highlight:function(e){df.dom.addClass(this._eZone,"WebCon_DropZone"),this.attachHandlers(),this._aHelpers.push(e)},unhighlight:function(){df.dom.removeClass(this._eZone,"WebCon_DropZone"),this.detachHandlers(),this.removeDropElemInteractions(),this._aHelpers=[],this._eDropPosition=-1,this._eDropElem=null,this._eDropAction=-1,this._iEnterCount=0},destroy:function(){this.unhighlight()},attachHandlers:function(){df.dom.on("dragenter",this._eZone,this.onDragEnter,this),df.dom.on("dragleave",this._eZone,this.onDragLeave,this),df.dom.on("dragover",this._eZone,this.onDragOver,this),df.dom.on("drop",this._eZone,this.onDrop,this)},detachHandlers:function(){df.dom.off("dragenter",this._eZone,this.onDragEnter,this),df.dom.off("dragleave",this._eZone,this.onDragLeave,this),df.dom.off("dragover",this._eZone,this.onDragOver,this),df.dom.off("drop",this._eZone,this.onDrop,this)},getDropData:function(){return this._oControl.getDropData(this)},onDrop:function(e){e.e.preventDefault(),this._oControl.onDrop(e,this,this._eDropAction),this.removeDropElemInteractions(),this._iEnterCount=0},onDragOver:function(e){if(e.e.preventDefault(),this.controlHasData()){const[t,i]=this.getDropCandidate(e),s=this.isOverDropPlaceHolder(e);let o;null!=t||s||(this.removeDropElemInteractions(),this._eDropElem=null,o=this._eDropPosition=0),null==t||s||(o=this.getDropPosition(e,t)),o>0&&null!=t&&(t!=this._eDropElem||this._eDropPosition!=o)&&!s&&(this.removeDropElemInteractions(),this._eDropElem=t,this._eDropPosition=o,this._eDropAction=i,this.interactWithDropElem()),this._oControl.onControlDragOver(e,this,t)}else this._eDropPosition=df.dropPositions.ciDropOnEmpty,this._eDropElem=null,this._eDropAction=this.doEmptyInteraction();return!1},onDragEnter:function(e){e.e.preventDefault(),this._iEnterCount++},onDragLeave:function(e){e.e.preventDefault(),this._iEnterCount--,this._iEnterCount<=0&&(this.removeDropElemInteractions(),this._eDropElem=null,this._eDropPosition=0,this._iEnterCount=0)},getDropCandidate:function(e){const[t,i]=this._oControl.determineDropCandidate(e,this._aHelpers);return[t,i]},getDropPosition:function(e,t){return this._oControl.determineDropPosition(e,t)},isOverDropPlaceHolder:function(e){let t=document.elementFromPoint(e.e.x,e.e.y);return!!t&&t.classList.contains("DfDragDrop_PlaceHolder")},controlHasData:function(){return this._oControl.hasData()},removeDropElemInteractions:function(){this.removeInsertedElement(),this.clearHighlight()},interactWithDropElem:function(){this._oControl.interactWithDropElem(this,this._eDropElem)},doEmptyInteraction:function(){return this._oControl.doEmptyInteraction(this)},highlightElement:function(){this._eDropElem&&df.dom.addClass(this._eDropElem,"WebCon_DragHover")},clearHighlight:function(){this._eDropElem&&df.dom.removeClass(this._eDropElem,"WebCon_DragHover")},insertElement:function(e,t,i){if(!this._eInsertedElem){switch(df.dom.addClass(e,"DfDragDrop_PlaceHolder"),e.setAttribute("data-dfdropplaceholder",!0),i||this._eDropPosition){case df.dropPositions.ciDropBefore:t.insertAdjacentElement("beforebegin",e);break;case df.dropPositions.ciDropAfter:t.insertAdjacentElement("afterend",e);break;case df.dropPositions.ciDropOnEmpty:t.appendChild(e)}this._eInsertedElem=e}},removeInsertedElement:function(){this._eInsertedElem&&(this._eInsertedElem?.parentNode?.removeChild(this._eInsertedElem),this._eInsertedElem=null)}}),df.tDragDropDataKvPair={sKey:df.tString,sValue:df.tString},df.tGenericDragDropData={aDragData:[df.tDragDropDataKvPair],aDropData:[df.tDragDropDataKvPair]},df.WebDragDropHelper=function(e,t){df.WebDragDropHelper.base.constructor.call(this,e,t),this.event("OnHelperReady",df.cCallModeWait),this._aSources=[],this._aTargets=[],this._oDragData=null,this._oDragObj=null},df.defineClass("df.WebDragDropHelper","df.WebObject",{create:function(){df.WebDragDropHelper.base.create.call(this),this.fire("OnHelperReady")},registerDragSource:function(e,t){var i=this.getWebApp().findObj(e);let s=!1;for(let e=0;e<this._aSources.length;e++){let o=this._aSources[e];o.oControl==i&&(o.aActions.push(parseInt(t)),s=!0)}if(!s){const e={oControl:i,aActions:[parseInt(t)]};this._aSources.push(e)}i.registerDragSource(this,parseInt(t))},registerDropTarget:function(e,t){var i=this.getWebApp().findObj(e);let s=!1;for(let e=0;e<this._aTargets.length;e++){let o=this._aTargets[e];o.oControl==i&&(o.aActions.push(parseInt(t)),s=!0)}if(!s){const e={oControl:i,aActions:[parseInt(t)]};this._aTargets.push(e)}i.registerDropTarget(this,parseInt(t))},highlightDropZones:function(){this._aTargets.forEach((e=>{e.oControl.highlightDropZones(this)}))},onDragStart:function(e,t,i,s,o){if(!s||!this.supportsDragAction(t,o))return!1;this.highlightDropZones(),this._oDragData={oControl:t,eElem:i,oData:s}},onDragEnd:function(e){this.cleanupHelper(),df.dragdrop.stopDropZones()},cleanupHelper:function(){this._aTargets.forEach((e=>{e.oControl.cleanupDropZones()})),this._oDragData=null},serializeDragDropData:df.sys.vt.generateSerializer(df.tGenericDragDropData),onDrop:function(e,t,i){if(this._oDragData&&i&&this.supportsDropAction(i._oControl,i._eDropAction)){const e=i.getDropData();var s={DragData:this._oDragData.oData,DropData:e};this.serverAction("Drop",[this._oDragData.oControl.getLongName(),i._oControl.getLongName(),i._eDropPosition],s)}this.onDragEnd(e)},onDragOver:function(){},destroyDragObj:function(){this._oDragObj.destroy(),this._oDragObj=null},supportsDragAction(e,t){for(let i=0;i<this._aSources.length;i++){let s=this._aSources[i];if(s.oControl==e)for(let e=0;e<s.aActions.length;e++)if(s.aActions[e]==t)return!0}return!1},supportsDropAction(e,t){for(let i=0;i<this._aTargets.length;i++){let s=this._aTargets[i];if(s.oControl==e)for(let e=0;e<s.aActions.length;e++)if(s.aActions[e]==t)return!0}return!1}}),df.WebDragDropUploadBase=df.mixin("df.WebFileUpload_Mixin","df.WebDragDropHelper"),df.WebDragDropFileHelper=function(e,t){df.WebDragDropFileHelper.base.constructor.call(this,e,t),this._oCurDropZone=null},df.defineClass("df.WebDragDropFileHelper","df.WebDragDropUploadBase",{create:function(){df.WebDragDropFileHelper.base.create.call(this),df.dragdrop.registerHelper(this)},onFileDrag:function(e){this.highlightDropZones()},onDragEnd:function(e){df.WebDragDropFileHelper.base.onDragEnd.call(this)},onDrop:function(e,t,i){const s=this._oDragData,o=i.getDropData(),n=df.dragdrop.containsFiles(e.e);if((s||n)&&i&&this.supportsDropAction(i._oControl,i._eDropAction))if(n)this._tempDropData=o,this._oCurDropZone=i,this.initFiles(e.e.dataTransfer.files),this.startUpload();else{var r={DragData:s.oData,DropData:o};this.serverAction("Drop",[this._oDragData.oControl.getLongName(),i._oControl.getLongName(),i._eDropPosition],r)}this.onDragEnd(e)},doStartUpload:function(e,t){const i={DragData:t,DropData:this._tempDropData};this.serverAction("FileDrop",[this._oCurDropZone._oControl.getLongName(),this._oCurDropZone._eDropPosition],i,e)},cleanupHelper:function(e){df.WebDragDropFileHelper.base.cleanupHelper.call(this),this._tempDropData=null}})})();
//# sourceMappingURL=df-min.js.map